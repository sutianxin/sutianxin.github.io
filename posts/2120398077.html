<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Spring-Cloudå­¦ä¹ ï¼ˆå…­ï¼‰-Sentinel | Arno</title><meta name="keywords" content="â˜•Java,ğŸ’»åç«¯å­¦ä¹ ,ğŸ‘¢Spring Boot,ğŸ‘¨â€âœˆï¸Sentinel"><meta name="author" content="å¤©æ˜•"><meta name="copyright" content="å¤©æ˜•"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="sentinelæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æµé‡é˜²å«å…µï¼Œç±»ä¼¼ä¹‹å‰å­¦çš„Hystrix"><meta property="og:type" content="article"><meta property="og:title" content="Spring-Cloudå­¦ä¹ ï¼ˆå…­ï¼‰-Sentinel"><meta property="og:url" content="https://sutianxin.top/posts/2120398077.html"><meta property="og:site_name" content="Arno"><meta property="og:description" content="sentinelæ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿçš„æµé‡é˜²å«å…µï¼Œç±»ä¼¼ä¹‹å‰å­¦çš„Hystrix"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://gitee.com/sutianxin/blogImage/raw/master/20210504192236.jpg"><meta property="article:published_time" content="2021-02-22T06:56:10.000Z"><meta property="article:modified_time" content="2021-05-04T11:22:48.029Z"><meta property="article:author" content="å¤©æ˜•"><meta property="article:tag" content="â˜•Java"><meta property="article:tag" content="ğŸ’»åç«¯å­¦ä¹ "><meta property="article:tag" content="ğŸ‘¢Spring Boot"><meta property="article:tag" content="ğŸ‘¨â€âœˆï¸Sentinel"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://gitee.com/sutianxin/blogImage/raw/master/20210504192236.jpg"><link rel="shortcut icon" href="/img/favicon.png"><link rel="canonical" href="https://sutianxin.top/posts/2120398077"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"search.xml",languages:{hits_empty:"æ‰¾ä¸åˆ°æ‚¨æŸ¥è¯¢çš„å†…å®¹ï¼š${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"ç¹",msgToSimplifiedChinese:"ç°¡"},noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!0},copy:{success:"å¤åˆ¶æˆåŠŸ",error:"å¤åˆ¶é”™è¯¯",noSupport:"æµè§ˆå™¨ä¸æ”¯æŒ"},relativeDate:{homepage:!1,post:!1},runtime:"å¤©",date_suffix:{just:"åˆšåˆš",min:"åˆ†é’Ÿå‰",hour:"å°æ—¶å‰",day:"å¤©å‰",month:"ä¸ªæœˆå‰"},copyright:void 0,lightbox:"mediumZoom",Snackbar:{chs_to_cht:"ä½ å·²åˆ‡æ¢ä¸ºç¹ä½“",cht_to_chs:"ä½ å·²åˆ‡æ¢ä¸ºç®€ä½“",day_to_night:"ä½ å·²åˆ‡æ¢ä¸ºæ·±è‰²æ¨¡å¼",night_to_day:"ä½ å·²åˆ‡æ¢ä¸ºæµ…è‰²æ¨¡å¼",bgLight:"#49b1f5",bgDark:"#121212",position:"top-right"},source:{jQuery:"https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js",justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js",css:"https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css"},fancybox:{js:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js",css:"https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"}},isPhotoFigcaption:!1,islazyload:!0,isanchor:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2021-05-04 19:22:48"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,a={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(a)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme");"dark"===e?activateDarkMode():"light"===e&&activateLightMode();e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"))})(window)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zyoushuo/Blog@latest/hexo/css/loading_style_1.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zhheo/JS-Heo@main/hidescrollbar/hidescrollbar.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/zyoushuo/Blog@latest/hexo/css/loading_style_2.css"><link rel="stylesheet" href="/css/cover.css"><link rel="stylesheet" href="/css/copyright.css"><link href="https://cdn.jsdelivr.net/gh/sviptzk/StaticFile_HEXO@latest/butterfly/css/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/flipcountdown.css"><link rel="stylesheet" href="/css/year.css"><link rel="stylesheet" href="/css/Lete.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/PaddyLin-xum/wenjian@master/css/fontanimation.css"><link href="https://cdn.bootcdn.net/ajax/libs/botui/0.3.9/botui-theme-default.css" rel="stylesheet"><link rel="stylesheet" href="/css/iconfont.css"><link rel="stylesheet" href="/css/twikoo.css"><style>#article-container.post-content h1:before,h2:before,h3:before,h4:before,h5:before,h6:before{-webkit-animation:avatar_turn_around 1s linear infinite;-moz-animation:avatar_turn_around 1s linear infinite;-o-animation:avatar_turn_around 1s linear infinite;-ms-animation:avatar_turn_around 1s linear infinite;animation:avatar_turn_around 1s linear infinite}</style><link rel="stylesheet" href="/css/font.css" media="defer" onload='this.media="all"'><meta name="generator" content="Hexo 5.4.0"></head><body><a href="javascript:void(0);" onclick="preloader.endLoading()" title="ç‚¹å‡»è·³è¿‡åŠ¨ç”»"><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="wizard-scene"><div class="wizard-objects"><div class="wizard-square"></div><div class="wizard-circle"></div><div class="wizard-triangle"></div></div><div class="wizard"><div class="wizard-body"></div><div class="wizard-right-arm"><div class="wizard-right-hand"></div></div><div class="wizard-left-arm"><div class="wizard-left-hand"></div></div><div class="wizard-head"><div class="wizard-beard"></div><div class="wizard-face"><div class="wizard-adds"></div></div><div class="wizard-hat"><div class="wizard-hat-of-the-hat"></div><div class="wizard-four-point-star --first"></div><div class="wizard-four-point-star --second"></div><div class="wizard-four-point-star --third"></div></div></div></div></div></div></a><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" data-lazy-src="/img/avatar.png" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">80</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ ‡ç­¾</div><div class="length-num">17</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/categories/"><div class="headline">åˆ†ç±»</div><div class="length-num">12</div></a></div></div></div><hr><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gucheng"></use></svg><span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gushu1"></use></svg><span>æ–‡ç« </span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gushu"></use></svg><span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guwan"></use></svg><span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gujianzhu-01"></use></svg><span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofengwenfangsibaoyantaimoyan_huaban_huaban"></use></svg><span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-red_envelope"></use></svg><span>æ‹“å±•</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/random/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingbaozhu"></use></svg><span>éšæœºæ–‡ç« </span></a></li><li><a class="site-page child faa-parent animated-hover" href="/adjust/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingguadeng"></use></svg><span>æ›´æ¢èƒŒæ™¯</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/statistics/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingjiutan"></use></svg><span>æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://sutianxin.gitee.io"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingzhongguojie"></use></svg><span>å›½å†…é•œåƒ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingzhuzi"></use></svg><span>å¯¼èˆªæ </span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bb/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxinghulu"></use></svg><span>å“”å“”</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingshanzi"></use></svg><span>éŸ³ä¹</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofenggudaiqiwujiuqijue_huaban_huaban"></use></svg><span>ç¤¾äº¤</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofenggudaileqixun_huaban_huaban_huaban"></use></svg><span>å‹é“¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofenggudaileqibianzhong_huaban_huaban_huaban_huaban"></use></svg><span>æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guqin"></use></svg><span>å…³äºæˆ‘</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(https://gitee.com/sutianxin/blogImage/raw/master/20210504192236.jpg)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Arno</a></span><span id="weather-v2-plugin-simple"></span><div id="menus"><div id="search-button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> æœç´¢</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gucheng"></use></svg><span>é¦–é¡µ</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gushu1"></use></svg><span>æ–‡ç« </span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gushu"></use></svg><span>å½’æ¡£</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guwan"></use></svg><span>æ ‡ç­¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gujianzhu-01"></use></svg><span>åˆ†ç±»</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/comments/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofengwenfangsibaoyantaimoyan_huaban_huaban"></use></svg><span>ç•™è¨€æ¿</span></a></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-red_envelope"></use></svg><span>æ‹“å±•</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/random/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingbaozhu"></use></svg><span>éšæœºæ–‡ç« </span></a></li><li><a class="site-page child faa-parent animated-hover" href="/adjust/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingguadeng"></use></svg><span>æ›´æ¢èƒŒæ™¯</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/statistics/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingjiutan"></use></svg><span>æ–‡ç« ç»Ÿè®¡</span></a></li><li><a class="site-page child faa-parent animated-hover" target="_blank" rel="noopener" href="https://sutianxin.gitee.io"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingzhongguojie"></use></svg><span>å›½å†…é•œåƒ</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/box/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingzhuzi"></use></svg><span>å¯¼èˆªæ </span></a></li><li><a class="site-page child faa-parent animated-hover" href="/bb/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxinghulu"></use></svg><span>å“”å“”</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-xianxingshanzi"></use></svg><span>éŸ³ä¹</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="javascript:void(0);"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofenggudaiqiwujiuqijue_huaban_huaban"></use></svg><span>ç¤¾äº¤</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofenggudaileqixun_huaban_huaban_huaban"></use></svg><span>å‹é“¾</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-gufengwujianzhongguofenggudaileqibianzhong_huaban_huaban_huaban_huaban"></use></svg><span>æœ‹å‹åœˆ</span></a></li></ul></div><div class="menus_item"><a class="site-page faa-parent animated-hover" href="/about/"><svg class="icon faa-tada" aria-hidden="true"><use xlink:href="#icon-guqin"></use></svg><span>å…³äºæˆ‘</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">Spring-Cloudå­¦ä¹ ï¼ˆå…­ï¼‰-Sentinel</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">å‘è¡¨äº</span><time class="post-meta-date-created" datetime="2021-02-22T06:56:10.000Z" title="å‘è¡¨äº 2021-02-22 14:56:10">2021-02-22</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°äº</span><time class="post-meta-date-updated" datetime="2021-05-04T11:22:48.029Z" title="æ›´æ–°äº 2021-05-04 19:22:48">2021-05-04</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/Spring-Cloud/">Spring Cloud</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">å­—æ•°æ€»è®¡:</span><span class="word-count">7.5k</span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="ä¸€ã€Sentinel"><a href="#ä¸€ã€Sentinel" class="headerlink" title="ä¸€ã€Sentinel"></a>ä¸€ã€Sentinel</h1><blockquote><p>åˆ†å¸ƒå¼ç³»ç»Ÿçš„æµé‡é˜²å«å…µï¼Œç±»ä¼¼ä¹‹å‰å­¦çš„Hystrix</p></blockquote><h2 id="1-1ã€æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-1ã€æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.1ã€æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.1ã€æ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><p>éšç€å¾®æœåŠ¡çš„æµè¡Œï¼ŒæœåŠ¡å’ŒæœåŠ¡ä¹‹é—´çš„ç¨³å®šæ€§å˜å¾—è¶Šæ¥è¶Šé‡è¦ã€‚Sentinel ä»¥æµé‡ä¸ºåˆ‡å…¥ç‚¹ï¼Œä»æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ã€ç³»ç»Ÿè´Ÿè½½ä¿æŠ¤ç­‰å¤šä¸ªç»´åº¦ä¿æŠ¤æœåŠ¡çš„ç¨³å®šæ€§ã€‚</p></blockquote><h2 id="1-2ã€ç‰¹å¾"><a href="#1-2ã€ç‰¹å¾" class="headerlink" title="1.2ã€ç‰¹å¾"></a>1.2ã€ç‰¹å¾</h2><p>Sentinel å…·æœ‰ä»¥ä¸‹ç‰¹å¾:</p><ul><li><strong>ä¸°å¯Œçš„åº”ç”¨åœºæ™¯</strong>ï¼šSentinel æ‰¿æ¥äº†é˜¿é‡Œå·´å·´è¿‘ 10 å¹´çš„åŒåä¸€å¤§ä¿ƒæµé‡çš„æ ¸å¿ƒåœºæ™¯ï¼Œä¾‹å¦‚ç§’æ€ï¼ˆå³çªå‘æµé‡æ§åˆ¶åœ¨ç³»ç»Ÿå®¹é‡å¯ä»¥æ‰¿å—çš„èŒƒå›´ï¼‰ã€æ¶ˆæ¯å‰Šå³°å¡«è°·ã€é›†ç¾¤æµé‡æ§åˆ¶ã€å®æ—¶ç†”æ–­ä¸‹æ¸¸ä¸å¯ç”¨åº”ç”¨ç­‰ã€‚</li><li><strong>å®Œå¤‡çš„å®æ—¶ç›‘æ§</strong>ï¼šSentinel åŒæ—¶æä¾›å®æ—¶çš„ç›‘æ§åŠŸèƒ½ã€‚æ‚¨å¯ä»¥åœ¨æ§åˆ¶å°ä¸­çœ‹åˆ°æ¥å…¥åº”ç”¨çš„å•å°æœºå™¨ç§’çº§æ•°æ®ï¼Œç”šè‡³ 500 å°ä»¥ä¸‹è§„æ¨¡çš„é›†ç¾¤çš„æ±‡æ€»è¿è¡Œæƒ…å†µã€‚</li><li><strong>å¹¿æ³›çš„å¼€æºç”Ÿæ€</strong>ï¼šSentinel æä¾›å¼€ç®±å³ç”¨çš„ä¸å…¶å®ƒå¼€æºæ¡†æ¶/åº“çš„æ•´åˆæ¨¡å—ï¼Œä¾‹å¦‚ä¸ Spring Cloudã€Dubboã€gRPC çš„æ•´åˆã€‚æ‚¨åªéœ€è¦å¼•å…¥ç›¸åº”çš„ä¾èµ–å¹¶è¿›è¡Œç®€å•çš„é…ç½®å³å¯å¿«é€Ÿåœ°æ¥å…¥ Sentinelã€‚</li><li><strong>å®Œå–„çš„ SPI æ‰©å±•ç‚¹</strong>ï¼šSentinel æä¾›ç®€å•æ˜“ç”¨ã€å®Œå–„çš„ SPI æ‰©å±•æ¥å£ã€‚æ‚¨å¯ä»¥é€šè¿‡å®ç°æ‰©å±•æ¥å£æ¥å¿«é€Ÿåœ°å®šåˆ¶é€»è¾‘ã€‚ä¾‹å¦‚å®šåˆ¶è§„åˆ™ç®¡ç†ã€é€‚é…åŠ¨æ€æ•°æ®æºç­‰ã€‚</li></ul><p>Sentinel çš„ä¸»è¦ç‰¹æ€§ï¼š</p><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221121616.png" alt="image-20210221121615924"></p><h2 id="1-3ã€ç»„æˆéƒ¨åˆ†"><a href="#1-3ã€ç»„æˆéƒ¨åˆ†" class="headerlink" title="1.3ã€ç»„æˆéƒ¨åˆ†"></a>1.3ã€ç»„æˆéƒ¨åˆ†</h2><ul><li>æ ¸å¿ƒåº“ï¼ˆJava å®¢æˆ·ç«¯ï¼‰ä¸ä¾èµ–ä»»ä½•æ¡†æ¶/åº“ï¼Œèƒ½å¤Ÿè¿è¡Œäºæ‰€æœ‰ Java è¿è¡Œæ—¶ç¯å¢ƒï¼ŒåŒæ—¶å¯¹ Dubbo / Spring Cloud ç­‰æ¡†æ¶ä¹Ÿæœ‰è¾ƒå¥½çš„æ”¯æŒã€‚</li><li>æ§åˆ¶å°ï¼ˆDashboardï¼‰åŸºäº Spring Boot å¼€å‘ï¼Œæ‰“åŒ…åå¯ä»¥ç›´æ¥è¿è¡Œï¼Œä¸éœ€è¦é¢å¤–çš„ Tomcat ç­‰åº”ç”¨å®¹å™¨ã€‚</li></ul><h2 id="1-4ã€ä¸Hystrixçš„å¯¹æ¯”"><a href="#1-4ã€ä¸Hystrixçš„å¯¹æ¯”" class="headerlink" title="1.4ã€ä¸Hystrixçš„å¯¹æ¯”"></a>1.4ã€ä¸Hystrixçš„å¯¹æ¯”</h2><h3 id="1ã€Hystrix"><a href="#1ã€Hystrix" class="headerlink" title="1ã€Hystrix"></a>1ã€Hystrix</h3><ul><li>éœ€è¦ç¨‹åºå‘˜è‡ªå·±æ‰‹å·¥æ­å»ºç›‘æ§å¹³å°</li><li>æ²¡æœ‰ä¸€å¥—webç•Œé¢å¯ä»¥ç»™æˆ‘ä»¬è¿›è¡Œæ›´ç»†ç²’åº¦åŒ–çš„é…ç½®</li></ul><h3 id="2ã€Sentinel"><a href="#2ã€Sentinel" class="headerlink" title="2ã€Sentinel"></a>2ã€Sentinel</h3><ul><li>å•ç‹¬ä¸€ä¸ªç»„ä»¶ï¼Œå¯ä»¥ç‹¬ç«‹å‡ºæ¥</li><li>ç›´æ¥ç•Œé¢åŒ–çš„ç»†ç²’åº¦ç»Ÿä¸€é…ç½®</li></ul><h1 id="äºŒã€å®‰è£…ä½¿ç”¨"><a href="#äºŒã€å®‰è£…ä½¿ç”¨" class="headerlink" title="äºŒã€å®‰è£…ä½¿ç”¨"></a>äºŒã€å®‰è£…ä½¿ç”¨</h1><h2 id="2-1ã€ä¸‹è½½sentinel"><a href="#2-1ã€ä¸‹è½½sentinel" class="headerlink" title="2.1ã€ä¸‹è½½sentinel"></a>2.1ã€ä¸‹è½½sentinel</h2><blockquote><p>åˆ° <a target="_blank" rel="noopener" href="https://github.com/alibaba/Sentinel/releases">https://github.com/alibaba/Sentinel/releases</a> ä¸‹è½½sentinelåˆ°æœ¬åœ°</p></blockquote><h2 id="2-2ã€è¿è¡Œ"><a href="#2-2ã€è¿è¡Œ" class="headerlink" title="2.2ã€è¿è¡Œ"></a>2.2ã€è¿è¡Œ</h2><h3 id="1ã€å‰æ"><a href="#1ã€å‰æ" class="headerlink" title="1ã€å‰æ"></a>1ã€å‰æ</h3><ul><li>JDK8ç¯å¢ƒå®‰è£…é…ç½®å®Œæˆ</li><li>8080ç«¯å£ä¸èƒ½è¢«å ç”¨</li></ul><h3 id="2ã€è¿è¡Œå‘½ä»¤"><a href="#2ã€è¿è¡Œå‘½ä»¤" class="headerlink" title="2ã€è¿è¡Œå‘½ä»¤"></a>2ã€è¿è¡Œå‘½ä»¤</h3><blockquote><p>åœ¨sentinel jaråŒ…ç›®å½•ä¸‹æ‰“å¼€cmdçª—å£ï¼Œè¾“å…¥</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">java -jar sentinel-dashboard-1.7.0.jar </span><br></pre></td></tr></table></figure><h3 id="3ã€è®¿é—®ç®¡ç†é¡µé¢"><a href="#3ã€è®¿é—®ç®¡ç†é¡µé¢" class="headerlink" title="3ã€è®¿é—®ç®¡ç†é¡µé¢"></a>3ã€è®¿é—®ç®¡ç†é¡µé¢</h3><blockquote><p>è®¿é—®<a href="http://localhost:8080ï¼Œè´¦å·å¯†ç å‡ä¸ºsentinel">http://localhost:8080ï¼Œè´¦å·å¯†ç å‡ä¸ºsentinel</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221140253.png" alt="image-20210221140252835"></p><h1 id="ä¸‰ã€åˆå§‹åŒ–æ¼”ç¤ºå·¥ç¨‹"><a href="#ä¸‰ã€åˆå§‹åŒ–æ¼”ç¤ºå·¥ç¨‹" class="headerlink" title="ä¸‰ã€åˆå§‹åŒ–æ¼”ç¤ºå·¥ç¨‹"></a>ä¸‰ã€åˆå§‹åŒ–æ¼”ç¤ºå·¥ç¨‹</h1><blockquote><p>å¯åŠ¨Nacos 8848</p></blockquote><h2 id="3-1ã€åˆ›å»ºSentinelå¾®æœåŠ¡æ¨¡å—"><a href="#3-1ã€åˆ›å»ºSentinelå¾®æœåŠ¡æ¨¡å—" class="headerlink" title="3.1ã€åˆ›å»ºSentinelå¾®æœåŠ¡æ¨¡å—"></a>3.1ã€åˆ›å»ºSentinelå¾®æœåŠ¡æ¨¡å—</h2><h3 id="1ã€å»ºmodule"><a href="#1ã€å»ºmodule" class="headerlink" title="1ã€å»ºmodule"></a>1ã€å»ºmodule</h3><blockquote><p>æ–°å»ºcloudalibaba-sentinel-service8401</p></blockquote><h3 id="2ã€POM"><a href="#2ã€POM" class="headerlink" title="2ã€POM"></a>2ã€POM</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.csp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>sentinel-datasource-nacos<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-sentinel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.6.3<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3ã€YML"><a href="#3ã€YML" class="headerlink" title="3ã€YML"></a>3ã€YML</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8401</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloudalibaba-sentinel-service</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="comment"># nacosæ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">transport:</span></span><br><span class="line">        <span class="comment"># é…ç½®sentinel dashboardåœ°å€</span></span><br><span class="line">        <span class="attr">dashboard:</span> <span class="string">localhost:8080</span></span><br><span class="line">        <span class="comment"># é»˜è®¤8719ç«¯å£ï¼Œå¦‚æœè¢«å ç”¨ä¼šè‡ªåŠ¨ä»8719å¼€å§‹ä¾æ¬¡+1æ‰«æ</span></span><br><span class="line">        <span class="comment"># ç›´åˆ°æ‰¾åˆ°æœªè¢«å ç”¨çš„ç«¯å£</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">8719</span></span><br><span class="line">        </span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4ã€ä¸»å¯åŠ¨ç±»"><a href="#4ã€ä¸»å¯åŠ¨ç±»" class="headerlink" title="4ã€ä¸»å¯åŠ¨ç±»"></a>4ã€ä¸»å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MainApp8401</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MainApp8401.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€ä¸šåŠ¡ç±»"><a href="#5ã€ä¸šåŠ¡ç±»" class="headerlink" title="5ã€ä¸šåŠ¡ç±»"></a>5ã€ä¸šåŠ¡ç±»</h3><blockquote><p>ä¸šåŠ¡ç±»FlowLimitController</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlowLimitController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testA&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;------testA&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testB&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;------testB&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2ã€å¯åŠ¨sentinelå’Œ8401å¾®æœåŠ¡"><a href="#2ã€å¯åŠ¨sentinelå’Œ8401å¾®æœåŠ¡" class="headerlink" title="2ã€å¯åŠ¨sentinelå’Œ8401å¾®æœåŠ¡"></a>2ã€å¯åŠ¨sentinelå’Œ8401å¾®æœåŠ¡</h2><blockquote><p>å‘ç°sentinelæ§åˆ¶å°ä¸­ç©ºç©ºå¦‚ä¹Ÿ</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221143519.png" alt="image-20210221143518461"></p><blockquote><p>è¿™æ˜¯ç”±äºsentinelå†…éƒ¨é‡‡ç”¨äº†æ‡’åŠ è½½ï¼Œéœ€è¦æˆ‘ä»¬è®¿é—®ä¸€æ¬¡8401å¾®æœåŠ¡ï¼Œè¿™ä¸ªå¾®æœåŠ¡æ‰ä¼šå±•ç°åœ¨sentinelæ§åˆ¶å°ä¸Šï¼Œè®¿é—® <a target="_blank" rel="noopener" href="http://localhost:8401/testA">http://localhost:8401/testA</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221143651.png" alt="image-20210221143651616"></p><blockquote><p>è¿™ä¸ªæ—¶å€™å¯ä»¥çœ‹åˆ°å¾®æœåŠ¡å·²ç»è¢«sentinelæ‰€ç›‘æ§</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221143717.png" alt="image-20210221143717393"></p><h1 id="å››ã€æµæ§ï¼ˆæµé‡æ§åˆ¶ï¼‰è§„åˆ™"><a href="#å››ã€æµæ§ï¼ˆæµé‡æ§åˆ¶ï¼‰è§„åˆ™" class="headerlink" title="å››ã€æµæ§ï¼ˆæµé‡æ§åˆ¶ï¼‰è§„åˆ™"></a>å››ã€æµæ§ï¼ˆæµé‡æ§åˆ¶ï¼‰è§„åˆ™</h1><h2 id="4-1ã€åŸºæœ¬ä»‹ç»"><a href="#4-1ã€åŸºæœ¬ä»‹ç»" class="headerlink" title="4.1ã€åŸºæœ¬ä»‹ç»"></a>4.1ã€åŸºæœ¬ä»‹ç»</h2><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221145035.png" alt="img"></p><blockquote><p>è¿›ä¸€æ­¥è§£é‡Šè¯´æ˜</p></blockquote><ul><li>èµ„æºåï¼šå”¯ä¸€åç§°ï¼Œé»˜è®¤è¯·æ±‚è·¯å¾„</li><li>é’ˆå¯¹æ¥æºï¼šSentinelå¯ä»¥é’ˆå¯¹è°ƒç”¨è€…è¿›è¡Œé™æµï¼Œå¡«å†™å¾®æœåŠ¡åï¼Œé»˜è®¤defaultï¼ˆä¸åŒºåˆ†æ¥æºï¼‰</li><li>é˜ˆå€¼ç±»å‹/å•æœºé˜€å€¼ï¼š<ul><li>QPSï¼ˆæ¯ç§’é’Ÿçš„è¯·æ±‚æ•°é‡ï¼‰ï¼šå½“è°ƒç”¨è¯¥apiçš„QPSè¾¾åˆ°é˜ˆå€¼çš„æ—¶å€™ï¼Œè¿›è¡Œé™æµã€‚</li><li>çº¿ç¨‹æ•°ï¼šå½“è°ƒç”¨è¯¥apiçš„çº¿ç¨‹æ•°è¾¾åˆ°é—½å€¼çš„æ—¶å€™ï¼Œè¿›è¡Œé™æµ</li></ul></li><li>æ˜¯å¦é›†ç¾¤ï¼šä¸éœ€è¦é›†ç¾¤</li><li>æµæ§æ¨¡å¼ï¼š<ul><li>ç›´æ¥ï¼šapiè¾¾åˆ°é™æµæ¡ä»¶æ—¶ç›´æ¥é™æµ</li><li>å…³è”ï¼šå½“å…³è”çš„èµ„æºè¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œå°±é™æµè‡ªå·±ã€‚</li><li>é“¾è·¯ï¼šåªè®°å½•æŒ‡å®šé“¾è·¯ä¸Šçš„æµé‡ï¼ˆæŒ‡å®šèµ„æºä»å…¥å£èµ„æºè¿›æ¥çš„æµé‡ï¼Œå¦‚æœè¾¾åˆ°é˜ˆå€¼ï¼Œå°±è¿›è¡Œé™æµï¼‰ã€APIçº§åˆ«çš„é’ˆå¯¹æ¥æºã€‘</li></ul></li><li>æ•ˆæœ<ul><li>å¿«é€Ÿå¤±è´¥ï¼šç›´æ¥å¤±è´¥ï¼ŒæŠ›å¼‚å¸¸</li><li>Warm upï¼šæ ¹æ®codeFactorï¼ˆå†·åŠ è½½å› å­ï¼Œé»˜è®¤3ï¼‰çš„å€¼ï¼Œä»é˜ˆå€¼/codeFactorï¼Œç»è¿‡é¢„çƒ­æ—¶é•¿ï¼Œæ‰è¾¾åˆ°è®¾ç½®çš„QPSé˜ˆå€¼</li><li>æ’é˜Ÿç­‰å¾…ï¼šåŒ€é€Ÿæ’é˜Ÿï¼Œè®©è¯·æ±‚ä»¥åŒ€é€Ÿé€šè¿‡ï¼Œä¸å€¼ç±»å‹å¿…é¡»è®¾ç½®ä¸ºQPSï¼Œå¦åˆ™æ— æ•ˆã€‚</li></ul></li></ul><h2 id="4-2ã€æµæ§æ¨¡å¼"><a href="#4-2ã€æµæ§æ¨¡å¼" class="headerlink" title="4.2ã€æµæ§æ¨¡å¼"></a>4.2ã€æµæ§æ¨¡å¼</h2><h3 id="1ã€ç›´æ¥ï¼ˆé»˜è®¤ï¼‰"><a href="#1ã€ç›´æ¥ï¼ˆé»˜è®¤ï¼‰" class="headerlink" title="1ã€ç›´æ¥ï¼ˆé»˜è®¤ï¼‰"></a>1ã€ç›´æ¥ï¼ˆé»˜è®¤ï¼‰</h3><blockquote><p>ç›´æ¥ï¼šapiè¾¾åˆ°é™æµæ¡ä»¶æ—¶ç›´æ¥é™æµ</p><p>é…ç½®</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221151300.png" alt="img"></p><blockquote><p>åœ¨sentinelæ§åˆ¶å°ã€ç°‡ç‚¹é“¾è·¯ã€‘-ã€/testAã€‘ä¸­ï¼Œä¸º/testAèµ„æºæ·»åŠ æµæ§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221150350.png" alt="image-20210221150350774"></p><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221150517.png" alt="image-20210221150516941"></p><blockquote><p>æ­¤æ—¶/testAçš„æµæ§è§„åˆ™ä¸ºæ¯ç§’é’Ÿåªèƒ½ç‚¹1æ¬¡ï¼Œå¦‚æœè¶…è¿‡æ¬¡æ•°å°±ä¼šæŠ¥ã€flow limitingã€‘</p><p>æ­£å¸¸è®¿é—®ï¼Œä¸€ç§’é’Ÿç‚¹ä¸€æ¬¡çš„æƒ…å†µä¸‹</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221150743.png" alt="image-20210221150743330"></p><blockquote><p>éæ­£å¸¸è®¿é—®æƒ…å†µä¸‹ï¼Œä¸€ç§’é’Ÿè®¿é—®å¤šæ¬¡</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221150814.png" alt="image-20210221150814186"></p><h3 id="2ã€å…³è”"><a href="#2ã€å…³è”" class="headerlink" title="2ã€å…³è”"></a>2ã€å…³è”</h3><blockquote><p>å…³è”ï¼šå½“å…³è”çš„èµ„æºè¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œå°±é™æµè‡ªå·±ã€‚</p><p>å‡è®¾Controllerä¸­æœ‰ä¸¤ä¸ªèµ„æºABï¼Œå½“ä¸Aå…³è”çš„èµ„æºBè¾¾åˆ°é˜ˆå€¼åï¼Œå°±é™æµAè‡ªå·±ã€‚</p><p>é…ç½®</p><p>å½“Bçš„QPSè¾¾åˆ°1ï¼ˆå³Bä¸€ç§’å†…è¢«è®¿é—®å¤šæ¬¡ï¼‰æ—¶ï¼Œé™æµA</p><p>ä¾‹å¦‚æ”¯ä»˜æ¥å£è¾¾åˆ°é˜ˆå€¼æ—¶ï¼Œé™æµä¸‹è®¢å•æ¥å£</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221153406.png" alt="image-20210221153406525"></p><blockquote><p>ä½¿ç”¨POSTMAN æ¨¡æ‹Ÿå¹¶å‘å¯†é›†è®¿é—®testB</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221154556.png" alt="image-20210221154555941"></p><blockquote><p>ä½¿ç”¨postmanå‘é€è¯·æ±‚åè®¿é—®/testAï¼Œæ­¤æ—¶/testAæŒ‚äº†</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221154811.png" alt="image-20210221154811947"></p><h3 id="3ã€é“¾è·¯"><a href="#3ã€é“¾è·¯" class="headerlink" title="3ã€é“¾è·¯"></a>3ã€é“¾è·¯</h3><blockquote><p>å¤šä¸ªè¯·æ±‚è°ƒç”¨äº†åŒä¸€ä¸ªå¾®æœåŠ¡</p></blockquote><h2 id="4-3ã€æµæ§æ•ˆæœ"><a href="#4-3ã€æµæ§æ•ˆæœ" class="headerlink" title="4.3ã€æµæ§æ•ˆæœ"></a>4.3ã€æµæ§æ•ˆæœ</h2><h3 id="1ã€ç›´æ¥-gt-å¿«é€Ÿå¤±è´¥"><a href="#1ã€ç›´æ¥-gt-å¿«é€Ÿå¤±è´¥" class="headerlink" title="1ã€ç›´æ¥-&gt;å¿«é€Ÿå¤±è´¥"></a>1ã€ç›´æ¥-&gt;å¿«é€Ÿå¤±è´¥</h3><blockquote><p>ç›´æ¥å¤±è´¥ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼šã€Blocked by Sentinelã€‘ï¼ˆflow limitingï¼‰</p></blockquote><h3 id="2ã€é¢„çƒ­"><a href="#2ã€é¢„çƒ­" class="headerlink" title="2ã€é¢„çƒ­"></a>2ã€é¢„çƒ­</h3><blockquote><p>è¯´æ˜ï¼šå…¬å¼ï¼šé˜ˆå€¼é™¤ä»¥coldFactorï¼ˆé»˜è®¤å€¼ä¸º3ï¼‰ï¼Œç»è¿‡é¢„çƒ­æ—¶é•¿åæ‰ä¼šè¾¾åˆ°é˜ˆå€¼</p></blockquote><ul><li>æ¦‚è¿°</li></ul><blockquote><p>å½“æµé‡çªç„¶å¢å¤§çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¸¸å¸¸ä¼šå¸Œæœ›ç³»ç»Ÿä»ç©ºé—²çŠ¶æ€åˆ°ç¹å¿™çŠ¶æ€çš„åˆ‡æ¢çš„æ—¶é—´é•¿ä¸€äº›ã€‚å³å¦‚æœç³»ç»Ÿåœ¨æ­¤ä¹‹å‰é•¿æœŸå¤„äºç©ºé—²çš„çŠ¶æ€ï¼Œæˆ‘ä»¬å¸Œæœ›å¤„ç†è¯·æ±‚çš„æ•°é‡æ˜¯ç¼“æ­¥çš„å¢å¤šï¼Œç»è¿‡é¢„æœŸçš„æ—¶é—´ä»¥åï¼Œåˆ°è¾¾ç³»ç»Ÿå¤„ç†è¯·æ±‚ä¸ªæ•°çš„æœ€å¤§å€¼ã€‚Warm Upï¼ˆå†·å¯åŠ¨ï¼Œé¢„çƒ­ï¼‰æ¨¡å¼å°±æ˜¯ä¸ºäº†å®ç°è¿™ä¸ªç›®çš„çš„ã€‚</p><p>è¿™ä¸ªåœºæ™¯ä¸»è¦ç”¨äºå¯åŠ¨éœ€è¦é¢å¤–å¼€é”€çš„åœºæ™¯ï¼Œä¾‹å¦‚å»ºç«‹æ•°æ®åº“è¿æ¥ç­‰ã€‚</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221164221.png" alt="image-20210221164220167"></p><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221164649.png" alt="image-20210221164649046"></p><blockquote><p>ä¸ºèµ„æº/testBæ–°å¢ä¸€ä¸ªæµæ§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221164820.png" alt="image-20210221164820127"></p><blockquote><p>åœ¨ä¸€æ®µæ—¶é—´å†…å¿«é€Ÿè®¿é—®/testBï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°ï¼Œèµ„æº/testBè¢«é™æµ</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221165340.png" alt="image-20210221165340581"></p><blockquote><p>5såå†è®¿é—®/testBï¼Œå‘ç°å·²ç»å¯ä»¥æ…¢æ…¢æ‰¿å—çš„ä½è¯·æ±‚</p><p>åº”ç”¨åœºæ™¯ï¼š</p><ul><li>ç§’æ€ç³»ç»Ÿå†å¼€å¯çš„ç¬é—´ä¼šæœ‰å¾ˆå¤šæµé‡ç›´æ¥æ¶Œä¸Šæ¥ï¼Œå¾ˆå¯èƒ½ç›´æ¥æŠŠç³»ç»Ÿæ‰“æ­»ï¼Œé¢„çƒ­æ–¹å¼å°±æ˜¯ä¸ºäº†ä¿æŠ¤ç³»ç»Ÿï¼Œå¯ä»¥æ…¢æ…¢æŠŠæµé‡æ”¾è¿›æ¥ï¼Œæ…¢æ…¢åœ°æŠŠé˜ˆå€¼å¢é•¿åˆ°è®¾ç½®çš„é˜ˆå€¼ã€‚</li></ul></blockquote><h3 id="3ã€æ’é˜Ÿç­‰å¾…"><a href="#3ã€æ’é˜Ÿç­‰å¾…" class="headerlink" title="3ã€æ’é˜Ÿç­‰å¾…"></a>3ã€æ’é˜Ÿç­‰å¾…</h3><blockquote><p>åŒ€é€Ÿæ’é˜Ÿï¼Œé˜ˆå€¼å¿…é¡»è®¾ç½®ä¸ºQPS</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221170241.png" alt="img"></p><blockquote><p>è¿™ç§æ–¹å¼ä¸»è¦ç”¨äºå¤„ç†é—´éš”æ€§çªå‘çš„æµé‡ï¼Œä¾‹å¦‚æ¶ˆæ¯é˜Ÿåˆ—ã€‚æƒ³è±¡ä¸€ä¸‹è¿™æ ·çš„åœºæ™¯ï¼Œæœ‰æŸä¸€ç§’å†…æœ‰å¤§é‡è¯·æ±‚åˆ°æ¥ï¼Œè€Œæ¥ä¸‹æ¥çš„å‡ ç§’åˆ™å¤„äºç©ºé—²çŠ¶æ€ï¼Œæˆ‘ä»¬å¸Œæœ›ç³»ç»Ÿèƒ½å¤Ÿåœ¨æ¥ä¸‹æ¥çš„ç©ºé—²æœŸé—´é€æ¸å¤„ç†è¿™äº›è¯·æ±‚ï¼Œè€Œä¸æ˜¯åœ¨ç¬¬ä¸€ç§’ç›´æ¥æ‹’ç»å¤šä½™çš„è¯·æ±‚ã€‚</p></blockquote><ul><li>ä¿®æ”¹èµ„æº/testBçš„æµæ§æ•ˆæœ</li></ul><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221170612.png" alt="image-20210221170612528"></p><blockquote><p>ä¿®æ”¹ä¸šåŠ¡ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FlowLimitController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testA&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testA</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;------testA&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/testB&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">testB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;testB...&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;------testB&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨POSTMANè¿›è¡Œæµ‹è¯•</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221171142.png" alt="image-20210221171142702"></p><blockquote><p>å¯åŠ¨ï¼ŒæŸ¥çœ‹ç»“æœï¼Œå¯ä»¥çœ‹åˆ°æ¯ä¸ªä¸€ç§’æœ‰ä¸€ä¸ªè¯·æ±‚æ’é˜Ÿè¿‡æ¥è®¿é—®/testB</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221171637.png" alt="image-20210221171637049"></p><h2 id="4-4ã€é™çº§è§„åˆ™"><a href="#4-4ã€é™çº§è§„åˆ™" class="headerlink" title="4.4ã€é™çº§è§„åˆ™"></a>4.4ã€é™çº§è§„åˆ™</h2><h3 id="1ã€é™çº§è§„åˆ™è¯´æ˜"><a href="#1ã€é™çº§è§„åˆ™è¯´æ˜" class="headerlink" title="1ã€é™çº§è§„åˆ™è¯´æ˜"></a>1ã€é™çº§è§„åˆ™è¯´æ˜</h3><blockquote><p>åœ¨sentinelæ§åˆ¶å°ã€é™çº§è§„åˆ™ã€‘ä¸­ç‚¹å‡»ã€æ–°å¢é™çº§è§„åˆ™ã€‘</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221172312.png" alt="image-20210221172311770"></p><blockquote><p>é…ç½®é™çº§è§„åˆ™å‚æ•°ï¼Œå…¶ä¸­</p><ul><li>RTï¼šå¹³å‡å“åº”æ—¶é—´ï¼Œç§’çº§<ul><li>å¹³å‡å“åº”æ—¶é—´ <strong>è¶…å‡ºé˜ˆå€¼</strong> ä¸” <strong>åœ¨æ—¶é—´çª—å£å†…é€šè¿‡çš„è¯·æ±‚&gt;=5</strong>ï¼Œä¸¤ä¸ªæ¡ä»¶åŒæ—¶æ»¡è¶³åè§¦å‘é™çº§ï¼Œçª—å£æœŸè¿‡åå…³é—­æ–­è·¯å™¨</li><li>RTæœ€å¤§ä¸º4900ï¼Œæ›´å¤§çš„éœ€è¦é€šè¿‡ <strong>-Dcsp.sentinel.statistic.max.rt=XXXX</strong> æ‰èƒ½ç”Ÿæ•ˆ</li></ul></li><li>å¼‚å¸¸æ¯”ä¾‹ï¼Œç§’çº§<ul><li>QPS &gt;= 5 ä¸”å¼‚å¸¸æ¯”ä¾‹ï¼ˆç§’çº§ç»Ÿè®¡ï¼‰è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè§¦å‘é™çº§ï¼›æ—¶é—´çª—å£ç»“æŸåï¼Œå…³é—­é™çº§</li></ul></li><li>å¼‚å¸¸æ•°ï¼Œåˆ†é’Ÿçº§<ul><li>å¼‚å¸¸æ•°ï¼ˆåˆ†é’Ÿç»Ÿè®¡ï¼‰è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè§¦å‘é™çº§ï¼›æ—¶é—´çª—å£ç»“æŸåï¼Œå…³é—­é™çº§</li></ul></li></ul></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221172755.png" alt="image-20210221172755551"></p><h3 id="2ã€è¿›ä¸€æ­¥è¯´æ˜"><a href="#2ã€è¿›ä¸€æ­¥è¯´æ˜" class="headerlink" title="2ã€è¿›ä¸€æ­¥è¯´æ˜"></a>2ã€è¿›ä¸€æ­¥è¯´æ˜</h3><blockquote><p>Sentinel ç†”æ–­é™çº§ä¼šåœ¨è°ƒç”¨é“¾è·¯ä¸­æŸä¸ªèµ„æºå‡ºç°ä¸ç¨³å®šçŠ¶æ€æ—¶ï¼ˆä¾‹å¦‚è°ƒç”¨è¶…æ—¶æˆ–è€…å¼‚å¸¸æ¯”ä¾‹å‡é«˜ï¼‰ï¼Œå¯¹è¿™ä¸ªèµ„æºçš„è°ƒç”¨è¿›è¡Œé™åˆ¶ï¼Œè®©è¯·æ±‚å¿«é€Ÿå¤±æ•ˆï¼Œé¿å…å½±å“åˆ°å…¶ä»–çš„èµ„æºè€Œå¯¼è‡´çº§è”é”™è¯¯ã€‚</p><p>å½“èµ„æºè¢«é™çº§åï¼Œåœ¨æ¥ä¸‹æ¥çš„é™çº§æ—¶é—´çª—å£ä¹‹å†…ï¼Œå¯¹è¯¥èµ„æºçš„è°ƒç”¨éƒ½è‡ªåŠ¨ç†”æ–­ï¼ˆé»˜è®¤è¡Œä¸ºæ—¶æŠ›å‡ºDegradeExceptionï¼‰</p><p><strong>Sentinelçš„æ–­è·¯å™¨ä¸­æ²¡æœ‰åŠå¼€çŠ¶æ€</strong></p></blockquote><h3 id="3ã€RT"><a href="#3ã€RT" class="headerlink" title="3ã€RT"></a>3ã€RT</h3><ul><li>å¹³å‡å“åº”æ—¶é—´ï¼ˆDEGRADE_GRADE_RTï¼‰ï¼šå½“1så†…æŒç»­è¿›å…¥5ä¸ªè¯·æ±‚ï¼Œå¯¹åº”æ—¶åˆ»çš„<strong>å¹³å‡å“åº”æ—¶é—´</strong>ï¼ˆç§’çº§ï¼‰å‡è¶…è¿‡é˜ˆå€¼ï¼ˆcountï¼Œä»¥msä¸ºå•ä½ï¼‰ï¼Œé‚£ä¹ˆåœ¨æ¥ä¸‹çš„æ—¶é—´çª—å£ï¼ˆDegradeRuleä¸­çš„timewindow,ä»¥sä¸ºå•ä½ï¼‰ä¹‹å†…ï¼Œå¯¹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨åœ°ç†”æ–­ï¼ˆæŠ›å‡ºDegradeException)ã€‚æ³¨æ„Sentinelé»˜è®¤ç»Ÿè®¡çš„RTä¸Šé™æ˜¯4900msï¼Œè¶…å‡ºæ­¤é˜€å€¼çš„éƒ½ä¼šç®—ä½œ4900msï¼Œè‹¥éœ€è¦å˜æ›´æ­¤ä¸Šé™å¯ä»¥é€šè¿‡å¯åŠ¨é…ç½®é¡¹-Dcsp.sentinel.statistic.max.rt-xxxæ¥é…ç½®ã€‚</li></ul><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221174427.png" alt="img"></p><blockquote><p>ä¿®æ”¹ä¸šåŠ¡ç±»ä»£ç ï¼Œæ·»åŠ æ–¹æ³•å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/testD&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testD</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123; TimeUnit.SECONDS.sleep(<span class="number">1</span>); &#125; <span class="keyword">catch</span> (InterruptedException e) &#123; e.printStackTrace(); &#125;</span><br><span class="line">    log.info(<span class="string">&quot;testD æµ‹è¯•RT&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------testD&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®ï¼Œæ–°å¢é™çº§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221175223.png" alt="image-20210221175222781"></p><blockquote><p>ä½¿ç”¨JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221175305.png" alt="image-20210221175305530"></p><blockquote><p>å¯åŠ¨JMeteråè®¿é—®/testDï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221175557.png" alt="image-20210221175557472"></p><blockquote><p>ç»“è®ºï¼šæŒ‰ç…§ä¸Šè¿°é…ç½®ï¼Œæ°¸è¿œä¸€ç§’é’Ÿæ‰“è¿›æ¥10ä¸ªçº¿ç¨‹ï¼ˆå¤§äº5ä¸ªï¼‰è°ƒç”¨testDï¼Œæˆ‘ä»¬å¸Œæœ›è¿™äº›è¯·æ±‚çš„å¹³å‡å“åº”æ—¶é—´æ˜¯200msï¼Œå¦‚æœå¹³å‡å“åº”æ—¶é—´è¶…è¿‡200msï¼Œåœ¨æœªæ¥çš„ä¸€ç§’é’Ÿå†…ï¼Œæ–­è·¯å™¨æ‰“å¼€ï¼Œä¿é™©ä¸è·³é—¸ï¼Œå¾®æœåŠ¡ä¸å¯ç”¨ã€‚</p><p>åç»­åœæ­¢jmeterï¼Œæ²¡æœ‰é‚£ä¹ˆå¤§çš„è®¿é—®é‡åï¼Œæ–­è·¯å™¨å…³é—­ï¼Œå¾®æœåŠ¡æ¢å¤ã€‚</p></blockquote><h3 id="4ã€å¼‚å¸¸æ¯”ä¾‹"><a href="#4ã€å¼‚å¸¸æ¯”ä¾‹" class="headerlink" title="4ã€å¼‚å¸¸æ¯”ä¾‹"></a>4ã€å¼‚å¸¸æ¯”ä¾‹</h3><ul><li>å¼‚å¸¸æ¯”ä¾‹ï¼šå½“èµ„æºçš„æ¯ç§’è®¿é—®é‡ &gt;= 5ï¼Œä¸”æ¯ç§’å¼‚å¸¸æ€»æ•°å é€šè¿‡é‡æ¯”ä¾‹è¶…è¿‡é˜ˆå€¼ä¹‹åï¼Œèµ„æºè¿›å…¥é™çº§çŠ¶æ€ï¼Œå³åœ¨æ¥ä¸‹æ¥çš„æ—¶é—´çª—å£ä¹‹å†…ï¼Œå¯¹è¿™ä¸ªæ–¹æ³•çš„è°ƒç”¨éƒ½ä¼šè‡ªåŠ¨åœ°è¿”å›ï¼Œå¼‚å¸¸æ¯”ä¾‹çš„é˜ˆå€¼èŒƒå›´ä¸º[0.0,1.0]ï¼Œä»£è¡¨0%-100%</li></ul><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221180654.png" alt="img"></p><blockquote><p>ä¿®æ”¹ä¸šåŠ¡ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/testD&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testD</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    log.info(<span class="string">&quot;testD å¼‚å¸¸æ¯”ä¾‹&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------testD&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®ï¼Œè®¾ç½®å¼‚å¸¸æ¯”ä¾‹ä¸º20%</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221181748.png" alt="image-20210221181748353"></p><blockquote><p>ä½¿ç”¨JMeterè¿›è¡Œå‹æµ‹ï¼Œç„¶åå†æ¬¡è®¿é—®/testDï¼ŒæŸ¥çœ‹ç»“æœ</p><p>æ­¤æ—¶èµ„æº/testDæŒ‚äº†</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221181850.png" alt="image-20210221181850537"></p><blockquote><p>å…³é—­jmeterï¼Œåœ¨æ—¶é—´çª—å£æœŸç»“æŸåå†æ¬¡è®¿é—®/testDï¼Œç›´æ¥è¿”å›é”™è¯¯é¡µé¢</p><p><strong>ç”±äºè¿™æ¬¡è¯·æ±‚ä¸­è¯·æ±‚æ•°å°äº5ï¼Œæ‰€ä»¥æ²¡æœ‰æœåŠ¡é™çº§ã€‚</strong></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221181956.png" alt="image-20210221181956643"></p><blockquote><p>ç»“è®º</p></blockquote><ul><li>å•ç‹¬è®¿é—®ä¸€æ¬¡ï¼Œå¿…ç„¶æ¥ä¸€æ¬¡æŠ¥é”™ä¸€æ¬¡ï¼ˆint age = 10 / 0ï¼‰ï¼Œè°ƒä¸€æ¬¡é”™ä¸€æ¬¡</li><li>å¼€å¯JMeteråï¼Œç›´æ¥é«˜å¹¶å‘å‘é€è¯·æ±‚ï¼Œå¤šæ¬¡è°ƒç”¨è¾¾åˆ°æˆ‘ä»¬çš„é…ç½®æ¡ä»¶äº†ï¼Œæ–­è·¯å™¨å¼€å¯ï¼Œå¾®æœåŠ¡ä¸å¯ç”¨ï¼Œæ­¤æ—¶ä¸å†æŠ¥errorè€Œæ˜¯æœåŠ¡é™çº§ã€‚</li></ul><h3 id="5ã€å¼‚å¸¸æ•°"><a href="#5ã€å¼‚å¸¸æ•°" class="headerlink" title="5ã€å¼‚å¸¸æ•°"></a>5ã€å¼‚å¸¸æ•°</h3><ul><li>å¼‚å¸¸æ•°ï¼šå½“èµ„æºè¿‘ä¸€åˆ†é’Ÿçš„å¼‚å¸¸æ•°ç›®è¶…è¿‡é˜ˆå€¼ä¹‹åä¼šè¿›è¡Œç†”æ–­ã€‚æ³¨æ„ï¼Œç”±äºç»Ÿè®¡æ—¶é—´çª—å£æ˜¯åˆ†é’Ÿçº§åˆ«çš„ï¼Œè‹¥æ—¶é—´çª—å£å°äº60sï¼Œåˆ™ç»“æŸç†”æ–­åä»å¯èƒ½å†æ¬¡è¿›å…¥ç†”æ–­çŠ¶æ€ã€‚</li><li>æ—¶é—´çª—å£ä¸€å®šè¦å¤§äºç­‰äº60sã€‚</li></ul><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221191750.png" alt="img"></p><blockquote><p>åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/testE&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testE</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;testE æµ‹è¯•å¼‚å¸¸æ•°&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------testE æµ‹è¯•å¼‚å¸¸æ•°&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨æ§åˆ¶å°ä¸­ç»™/testEæ·»åŠ é™çº§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221195517.png" alt="image-20210221195516085"></p><blockquote><p>çŸ­æ—¶é—´å†…è¿ç»­è®¿é—®5æ¬¡<a target="_blank" rel="noopener" href="http://localhost:8401/testE">http://localhost:8401/testE</a> ï¼Œç„¶åå†æ¬¡è®¿é—®/testEï¼ŒæŸ¥çœ‹ç»“æœ</p><ul><li>å‰é¢äº”æ¬¡ï¼Œè¿”å›çš„æ˜¯Error Page</li><li>ç¬¬å…­æ¬¡è®¿é—®è¿”å›é™çº§æç¤ºã€‚</li></ul></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221195655.png" alt="image-20210221195655293"></p><h1 id="äº”ã€çƒ­ç‚¹keyé™æµ"><a href="#äº”ã€çƒ­ç‚¹keyé™æµ" class="headerlink" title="äº”ã€çƒ­ç‚¹keyé™æµ"></a>äº”ã€çƒ­ç‚¹keyé™æµ</h1><h2 id="5-1ã€åŸºæœ¬ä»‹ç»"><a href="#5-1ã€åŸºæœ¬ä»‹ç»" class="headerlink" title="5.1ã€åŸºæœ¬ä»‹ç»"></a>5.1ã€åŸºæœ¬ä»‹ç»</h2><p>ä½•ä¸ºçƒ­ç‚¹ï¼Ÿçƒ­ç‚¹å³ç»å¸¸è®¿é—®çš„æ•°æ®ã€‚å¾ˆå¤šæ—¶å€™æˆ‘ä»¬å¸Œæœ›ç»Ÿè®¡æŸä¸ªçƒ­ç‚¹æ•°æ®ä¸­è®¿é—®é¢‘æ¬¡æœ€é«˜çš„ Top K æ•°æ®ï¼Œå¹¶å¯¹å…¶è®¿é—®è¿›è¡Œé™åˆ¶ã€‚æ¯”å¦‚ï¼š</p><ul><li>å•†å“ ID ä¸ºå‚æ•°ï¼Œç»Ÿè®¡ä¸€æ®µæ—¶é—´å†…æœ€å¸¸è´­ä¹°çš„å•†å“ ID å¹¶è¿›è¡Œé™åˆ¶</li><li>ç”¨æˆ· ID ä¸ºå‚æ•°ï¼Œé’ˆå¯¹ä¸€æ®µæ—¶é—´å†…é¢‘ç¹è®¿é—®çš„ç”¨æˆ· ID è¿›è¡Œé™åˆ¶</li></ul><p>çƒ­ç‚¹å‚æ•°é™æµä¼šç»Ÿè®¡ä¼ å…¥å‚æ•°ä¸­çš„çƒ­ç‚¹å‚æ•°ï¼Œå¹¶æ ¹æ®é…ç½®çš„é™æµé˜ˆå€¼ä¸æ¨¡å¼ï¼Œå¯¹åŒ…å«çƒ­ç‚¹å‚æ•°çš„èµ„æºè°ƒç”¨è¿›è¡Œé™æµã€‚çƒ­ç‚¹å‚æ•°é™æµå¯ä»¥çœ‹åšæ˜¯ä¸€ç§ç‰¹æ®Šçš„æµé‡æ§åˆ¶ï¼Œä»…å¯¹åŒ…å«çƒ­ç‚¹å‚æ•°çš„èµ„æºè°ƒç”¨ç”Ÿæ•ˆã€‚</p><blockquote><p>æ ¹æ®è¯·æ±‚å¸¦çš„æŸäº›å‚æ•°è¿›è¡Œé™æµ</p></blockquote><h2 id="5-2ã€é…ç½®çƒ­ç‚¹é™æµ"><a href="#5-2ã€é…ç½®çƒ­ç‚¹é™æµ" class="headerlink" title="5.2ã€é…ç½®çƒ­ç‚¹é™æµ"></a>5.2ã€é…ç½®çƒ­ç‚¹é™æµ</h2><h3 id="1ã€å¤ä¹ hystrix"><a href="#1ã€å¤ä¹ hystrix" class="headerlink" title="1ã€å¤ä¹ hystrix"></a>1ã€å¤ä¹ hystrix</h3><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221212226.png" alt="img"></p><h3 id="2ã€åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ ä»£ç "><a href="#2ã€åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ ä»£ç " class="headerlink" title="2ã€åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ ä»£ç "></a>2ã€åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ ä»£ç </h3><ul><li>è¿™é‡Œ@SentinelResourceæ³¨è§£çš„valueå±æ€§è¦æ±‚å”¯ä¸€ï¼Œä¸€èˆ¬ä¸è¯·æ±‚Mappingç›¸åŒï¼Œå°†æ¥åœ¨sentinelæ§åˆ¶å°æ·»åŠ çƒ­ç‚¹keyé™æµæ—¶å¯ä»¥ç”¨@SentinelResourceæ³¨è§£çš„valueä½œä¸ºèµ„æºåã€‚</li><li>@SentinelResourceæ³¨è§£çš„blockHandlerå±æ€§ç”¨äºæŒ‡å®šå…œåº•æ–¹æ³•ï¼Œéœ€è¦åœ¨å…œåº•æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ä¸­æ·»åŠ ä¸€ä¸ªBlockExceptionç±»å‹çš„å‚æ•°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/testHotKey&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;testHotkey&quot;,blockHandler = &quot;deal_testHotKey&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testHotKey</span><span class="params">(<span class="meta">@RequestParam(value = &quot;p1&quot;,required = false)</span> String p1,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="meta">@RequestParam(value = &quot;p2&quot;,required = false)</span> String p2)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//int age = 10/0;</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------testHotKey&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å…œåº•æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deal_testHotKey</span> <span class="params">(String p1, String p2, BlockException exception)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------deal_testHotKey,o(â•¥ï¹â•¥)o&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€åœ¨sentinelæ§åˆ¶å°ä¸­æ·»åŠ çƒ­ç‚¹è§„åˆ™"><a href="#3ã€åœ¨sentinelæ§åˆ¶å°ä¸­æ·»åŠ çƒ­ç‚¹è§„åˆ™" class="headerlink" title="3ã€åœ¨sentinelæ§åˆ¶å°ä¸­æ·»åŠ çƒ­ç‚¹è§„åˆ™"></a>3ã€åœ¨sentinelæ§åˆ¶å°ä¸­æ·»åŠ çƒ­ç‚¹è§„åˆ™</h3><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221214652.png" alt="image-20210221214650652"></p><h3 id="4ã€åœ¨æ§åˆ¶å°ä¸­æ·»åŠ é…ç½®"><a href="#4ã€åœ¨æ§åˆ¶å°ä¸­æ·»åŠ é…ç½®" class="headerlink" title="4ã€åœ¨æ§åˆ¶å°ä¸­æ·»åŠ é…ç½®"></a>4ã€åœ¨æ§åˆ¶å°ä¸­æ·»åŠ é…ç½®</h3><blockquote><p>æ·»åŠ çš„é…ç½®å¦‚ä¸‹</p><p>ä¸‹é¢çš„é…ç½®è¡¨ç¤ºï¼šå¯¹äº/testHotkeyè¯·æ±‚ï¼Œå¦‚æœå¸¦p1å‚æ•°è®¿é—®ï¼Œé‚£ä¹ˆä¸€ç§’é’Ÿæœ€å¤šè®¿é—®ä¸€æ¬¡</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221214920.png" alt="image-20210221214920044"></p><h3 id="5ã€æµ‹è¯•"><a href="#5ã€æµ‹è¯•" class="headerlink" title="5ã€æµ‹è¯•"></a>5ã€æµ‹è¯•</h3><blockquote><p>åœ¨ä¸€ç§’é’Ÿå†…å¤šæ¬¡è®¿é—®<a target="_blank" rel="noopener" href="http://localhost:8401/testHotkey?p1=a">http://localhost:8401/testHotkey?p1=a</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221215443.png" alt="image-20210221215443934"></p><h3 id="6ã€ç»“è®º"><a href="#6ã€ç»“è®º" class="headerlink" title="6ã€ç»“è®º"></a>6ã€ç»“è®º</h3><blockquote><p>æ–¹æ³•testHotKeyé‡Œé¢ç¬¬ä¸€ä¸ªå‚æ•°åªè¦QPSè¶…è¿‡1æ¬¡/sï¼Œé‚£ä¹ˆç›´æ¥åšé™çº§å¤„ç†ï¼ŒåŒæ—¶è°ƒç”¨æˆ‘ä»¬è‡ªå·±å®šä¹‰çš„å…œåº•æ–¹æ³•ã€‚</p><p>å¦‚æœè¯·æ±‚å‚æ•°ä¸­ä¸å«æœ‰p1å‚æ•°ï¼Œé‚£ä¹ˆå¦‚ä½•è®¿é—®éƒ½ä¸ä¼šæœ‰é—®é¢˜ã€‚</p><p>å¦‚æœåœ¨@SentinelResourceæ³¨è§£ä¸­ä¸æŒ‡å®šblockHandlerå±æ€§ï¼Œé‚£ä¹ˆä¼šç›´æ¥å°†é”™è¯¯é¡µé¢è¿”å›åˆ°å‰å°ï¼Œååˆ†ä¸å‹å¥½ã€‚</p></blockquote><h3 id="7ã€è¡¥å……"><a href="#7ã€è¡¥å……" class="headerlink" title="7ã€è¡¥å……"></a>7ã€è¡¥å……</h3><blockquote><p>ä¿®æ”¹ä¸šåŠ¡ç±»ï¼Œåœ¨testHotkeyæ–¹æ³•ä¸­æ·»åŠ ä¸€ä¸ªè¿è¡Œæ—¶å¼‚å¸¸ï¼Œé‡å¯æµ‹è¯•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/testHotKey&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;testHotkey&quot;,blockHandler = &quot;deal_testHotKey&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testHotKey</span><span class="params">(<span class="meta">@RequestParam(value = &quot;p1&quot;,required = false)</span> String p1,</span></span></span><br><span class="line"><span class="function"><span class="params">                         <span class="meta">@RequestParam(value = &quot;p2&quot;,required = false)</span> String p2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> age = <span class="number">10</span>/<span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------testHotKey&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å…œåº•æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">deal_testHotKey</span> <span class="params">(String p1, String p2, BlockException exception)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------deal_testHotKey,o(â•¥ï¹â•¥)o&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœï¼šç›´æ¥è¿”å›äº†Error page</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221223928.png" alt="image-20210221223927546"></p><blockquote><p>è¿™è¡¨æ˜ï¼š@SentinelResouceåªè´Ÿè´£sentinelæ§åˆ¶å°å‡ºçš„é”™ï¼Œä¸è´Ÿè´£ç¨‹åºæœ¬èº«è¿è¡Œæ—¶å¼‚å¸¸ã€‚</p></blockquote><h2 id="5-3ã€å‚æ•°ä¾‹å¤–é¡¹"><a href="#5-3ã€å‚æ•°ä¾‹å¤–é¡¹" class="headerlink" title="5.3ã€å‚æ•°ä¾‹å¤–é¡¹"></a>5.3ã€å‚æ•°ä¾‹å¤–é¡¹</h2><blockquote><p>ä¸Šè¿°æ¡ˆä¾‹æ¼”ç¤ºäº†ç¬¬ä¸€ä¸ªå‚æ•°p1ï¼Œå½“QPSè¶…è¿‡1sä¸€æ¬¡ç‚¹å‡»åé©¬ä¸Šè¢«é™æµã€‚</p></blockquote><h3 id="1ã€é…ç½®"><a href="#1ã€é…ç½®" class="headerlink" title="1ã€é…ç½®"></a>1ã€é…ç½®</h3><blockquote><p>æ™®é€šæƒ…å†µä¸‹ï¼šå½“p1çš„QPSè¾¾åˆ°1æ¬¡1sæ—¶é©¬ä¸Šè¢«é™æµ</p><p>æˆ‘ä»¬å¸Œæœ›p1å‚æ•°æ˜¯æŸä¸ªç‰¹æ®Šå€¼æ—¶ï¼Œä»–çš„é™æµå€¼å’Œå¹³æ—¶ä¸ä¸€æ ·ã€‚</p></blockquote><ul><li>ç»™p1è®¾ç½®ä¸€ä¸ªç‰¹æ®Šå€¼ï¼ŒåŠ å…¥å½“p1çš„å€¼ä¸º5æ—¶ï¼Œä»–çš„é˜ˆå€¼å¯ä»¥è¾¾åˆ°200</li><li>ä¿®æ”¹é…ç½®</li></ul><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221222425.png" alt="image-20210221222425693"></p><blockquote><p>æµ‹è¯•ï¼šåœ¨ä¸€ç§’å†…å¤šæ¬¡è®¿é—®<a target="_blank" rel="noopener" href="http://localhost:8401/testHotkey?p1=3">http://localhost:8401/testHotkey?p1=3</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221222553.png" alt="image-20210221222553598"></p><blockquote><p>æµ‹è¯•ï¼šåœ¨ä¸€ç§’å†…å¤šæ¬¡è®¿é—®<a target="_blank" rel="noopener" href="http://localhost:8401/testHotkey?p1=5">http://localhost:8401/testHotkey?p1=5</a></p><p>æ­¤æ—¶ç”±äºé…ç½®äº†å‚æ•°ä¾‹å¤–é¡¹ï¼Œæ‰€ä»¥åœ¨ä¸€ç§’å†…å¤šæ¬¡è®¿é—®ä¹Ÿä¸ä¼šé™çº§ã€‚</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221222652.png" alt="image-20210221222652243"></p><h3 id="2ã€å‰æè¯´æ˜"><a href="#2ã€å‰æè¯´æ˜" class="headerlink" title="2ã€å‰æè¯´æ˜"></a>2ã€å‰æè¯´æ˜</h3><blockquote><p>çƒ­ç‚¹å‚æ•°çš„æ³¨æ„ç‚¹ï¼Œå‚æ•°å¿…é¡»æ˜¯<strong>åŸºæœ¬ç±»å‹</strong>æˆ–è€…<strong>String</strong></p></blockquote><h1 id="å…­ã€ç³»ç»Ÿè§„åˆ™"><a href="#å…­ã€ç³»ç»Ÿè§„åˆ™" class="headerlink" title="å…­ã€ç³»ç»Ÿè§„åˆ™"></a>å…­ã€ç³»ç»Ÿè§„åˆ™</h1><h2 id="6-1ã€ä»‹ç»"><a href="#6-1ã€ä»‹ç»" class="headerlink" title="6.1ã€ä»‹ç»"></a>6.1ã€ä»‹ç»</h2><blockquote><p>Sentinel ç³»ç»Ÿè‡ªé€‚åº”é™æµä»<strong>æ•´ä½“ç»´åº¦</strong>å¯¹åº”ç”¨å…¥å£æµé‡è¿›è¡Œæ§åˆ¶ï¼Œç»“åˆåº”ç”¨çš„ Loadã€CPU ä½¿ç”¨ç‡ã€æ€»ä½“å¹³å‡ RTã€å…¥å£ QPS å’Œå¹¶å‘çº¿ç¨‹æ•°ç­‰å‡ ä¸ªç»´åº¦çš„ç›‘æ§æŒ‡æ ‡ï¼Œé€šè¿‡è‡ªé€‚åº”çš„æµæ§ç­–ç•¥ï¼Œè®©ç³»ç»Ÿçš„å…¥å£æµé‡å’Œç³»ç»Ÿçš„è´Ÿè½½è¾¾åˆ°ä¸€ä¸ªå¹³è¡¡ï¼Œè®©ç³»ç»Ÿå°½å¯èƒ½è·‘åœ¨æœ€å¤§ååé‡çš„åŒæ—¶ä¿è¯ç³»ç»Ÿæ•´ä½“çš„ç¨³å®šæ€§ã€‚</p><p>åœ¨ç³»ç»Ÿå±‚é¢å¯¹è¿›å…¥çš„æµé‡è¿›è¡Œæ§åˆ¶ã€‚</p></blockquote><h2 id="6-2ã€æ–°å¢ç³»ç»Ÿè§„åˆ™"><a href="#6-2ã€æ–°å¢ç³»ç»Ÿè§„åˆ™" class="headerlink" title="6.2ã€æ–°å¢ç³»ç»Ÿè§„åˆ™"></a>6.2ã€æ–°å¢ç³»ç»Ÿè§„åˆ™</h2><blockquote><p>åœ¨sentinelæ§åˆ¶å°ä¸­é€‰æ‹©ã€ç³»ç»Ÿè§„åˆ™ã€‘-ã€æ–°å¢ç³»ç»Ÿè§„åˆ™ã€‘</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221225151.png" alt="image-20210221225151304"></p><blockquote><p>æ·»åŠ é…ç½®é¡µé¢åŠæ¨¡å¼è¯´æ˜å¦‚ä¸‹</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221225306.png" alt="image-20210221225306468"></p><ul><li><strong>Load è‡ªé€‚åº”</strong>ï¼ˆä»…å¯¹ Linux/Unix-like æœºå™¨ç”Ÿæ•ˆï¼‰ï¼šç³»ç»Ÿçš„ load1 ä½œä¸ºå¯å‘æŒ‡æ ‡ï¼Œè¿›è¡Œè‡ªé€‚åº”ç³»ç»Ÿä¿æŠ¤ã€‚å½“ç³»ç»Ÿ load1 è¶…è¿‡è®¾å®šçš„å¯å‘å€¼ï¼Œä¸”ç³»ç»Ÿå½“å‰çš„å¹¶å‘çº¿ç¨‹æ•°è¶…è¿‡ä¼°ç®—çš„ç³»ç»Ÿå®¹é‡æ—¶æ‰ä¼šè§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼ˆBBR é˜¶æ®µï¼‰ã€‚ç³»ç»Ÿå®¹é‡ç”±ç³»ç»Ÿçš„ <code>maxQps * minRt</code> ä¼°ç®—å¾—å‡ºã€‚è®¾å®šå‚è€ƒå€¼ä¸€èˆ¬æ˜¯ <code>CPU cores * 2.5</code>ã€‚</li><li><strong>CPU usage</strong>ï¼ˆ1.5.0+ ç‰ˆæœ¬ï¼‰ï¼šå½“ç³»ç»Ÿ CPU ä½¿ç”¨ç‡è¶…è¿‡é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼ˆå–å€¼èŒƒå›´ 0.0-1.0ï¼‰ï¼Œæ¯”è¾ƒçµæ•ã€‚</li><li><strong>å¹³å‡ RT</strong>ï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹³å‡ RT è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ï¼Œå•ä½æ˜¯æ¯«ç§’ã€‚</li><li><strong>å¹¶å‘çº¿ç¨‹æ•°</strong>ï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„å¹¶å‘çº¿ç¨‹æ•°è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚</li><li><strong>å…¥å£ QPS</strong>ï¼šå½“å•å°æœºå™¨ä¸Šæ‰€æœ‰å…¥å£æµé‡çš„ QPS è¾¾åˆ°é˜ˆå€¼å³è§¦å‘ç³»ç»Ÿä¿æŠ¤ã€‚</li></ul><blockquote><p>æ·»åŠ ç³»ç»Ÿè§„åˆ™ï¼Œè®¾ç½®å…¥å£QPSé˜ˆå€¼ä¸º1</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221225529.png" alt="image-20210221225529528"></p><blockquote><p>åœ¨ä¸šåŠ¡ç±»ä¸­æ–°å¢æ–¹æ³•å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/testC&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">testC</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    log.info(Thread.currentThread().getName() + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;testB...&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;------testC&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯å¾®æœåŠ¡ï¼Œåœ¨ä¸€ç§’å†…å¤šæ¬¡è®¿é—®<a target="_blank" rel="noopener" href="http://localhost:8401/testC">http://localhost:8401/testC</a> ï¼ŒæŸ¥çœ‹ç»“æœï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°æ²¡æœ‰åœ¨æµæ§è§„åˆ™ä¸­é…ç½®è¿‡çš„testCä¹Ÿè¢«é™æµäº†</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221230134.png" alt="image-20210221230134803"></p><h1 id="ä¸ƒã€-SentinelResource"><a href="#ä¸ƒã€-SentinelResource" class="headerlink" title="ä¸ƒã€@SentinelResource"></a>ä¸ƒã€@SentinelResource</h1><h2 id="7-1ã€æŒ‰èµ„æºåç§°é™æµ-åç»­å¤„ç†"><a href="#7-1ã€æŒ‰èµ„æºåç§°é™æµ-åç»­å¤„ç†" class="headerlink" title="7.1ã€æŒ‰èµ„æºåç§°é™æµ + åç»­å¤„ç†"></a>7.1ã€æŒ‰èµ„æºåç§°é™æµ + åç»­å¤„ç†</h2><h3 id="1ã€å¯åŠ¨Nacoså’ŒSentinel"><a href="#1ã€å¯åŠ¨Nacoså’ŒSentinel" class="headerlink" title="1ã€å¯åŠ¨Nacoså’ŒSentinel"></a>1ã€å¯åŠ¨Nacoså’ŒSentinel</h3><h3 id="2ã€ä¿®æ”¹8401å¾®æœåŠ¡"><a href="#2ã€ä¿®æ”¹8401å¾®æœåŠ¡" class="headerlink" title="2ã€ä¿®æ”¹8401å¾®æœåŠ¡"></a>2ã€ä¿®æ”¹8401å¾®æœåŠ¡</h3><blockquote><p>ç¼–å†™ä¸€ä¸ªRateLimitControllerä¸šåŠ¡ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RateLimitController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/byResource&quot;)</span></span><br><span class="line">    <span class="meta">@SentinelResource(value = &quot;byResource&quot;, blockHandler = &quot;handleException&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">byResource</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">200</span>, <span class="string">&quot;æŒ‰èµ„æºåç§°é™æµæµ‹è¯•OK&quot;</span>, <span class="keyword">new</span> Payment(<span class="number">2020L</span>, <span class="string">&quot;serial001&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">handleException</span><span class="params">(BlockException exception)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">444</span>, exception.getClass().getCanonicalName() + <span class="string">&quot;\t æœåŠ¡ä¸å¯ç”¨&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é‡æ–°å¯åŠ¨ï¼Œæµ‹è¯•</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221234008.png" alt="image-20210221234008117"></p><h3 id="3ã€æŒ‰èµ„æºåè¿›è¡Œé™æµ"><a href="#3ã€æŒ‰èµ„æºåè¿›è¡Œé™æµ" class="headerlink" title="3ã€æŒ‰èµ„æºåè¿›è¡Œé™æµ"></a>3ã€æŒ‰èµ„æºåè¿›è¡Œé™æµ</h3><blockquote><p>åœ¨sentinelæ§åˆ¶å°ä¸­ç‚¹å‡»ã€ç°‡ç‚¹é“¾è·¯ã€‘ï¼Œå…¶ä¸­byResouceå°±æ˜¯èµ„æºåç§°</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221234150.png" alt="image-20210221234150402"></p><blockquote><p>åœ¨ã€ç°‡ç‚¹é“¾è·¯ã€‘-ã€byResourceã€‘ä¸€è¡Œä¸­ç‚¹å‡»ã€æµæ§ã€‘ï¼Œæ·»åŠ é…ç½®</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221234835.png" alt="image-20210221234835362"></p><blockquote><p>æµ‹è¯•ï¼Œåœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡è®¿é—®<a target="_blank" rel="noopener" href="http://localhost:8401/byResource">http://localhost:8401/byResource</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221235142.png" alt="image-20210221235142379"></p><h3 id="4ã€é¢å¤–é—®é¢˜"><a href="#4ã€é¢å¤–é—®é¢˜" class="headerlink" title="4ã€é¢å¤–é—®é¢˜"></a>4ã€é¢å¤–é—®é¢˜</h3><blockquote><p>æ­¤æ—¶å…³é—­8401å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹Sentinelæ§åˆ¶å°ï¼Œå¯ä»¥å‘ç°æµæ§è§„åˆ™æ¶ˆå¤±äº†</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221235400.png" alt="image-20210221235400848"></p><ul><li>æµæ§è§„åˆ™æ˜¯<strong>ä¸´æ—¶</strong>çš„</li></ul><h2 id="7-2ã€æŒ‰ç…§Urlåœ°å€é™æµ-åç»­å¤„ç†"><a href="#7-2ã€æŒ‰ç…§Urlåœ°å€é™æµ-åç»­å¤„ç†" class="headerlink" title="7.2ã€æŒ‰ç…§Urlåœ°å€é™æµ + åç»­å¤„ç†"></a>7.2ã€æŒ‰ç…§Urlåœ°å€é™æµ + åç»­å¤„ç†</h2><blockquote><p>é€šè¿‡è®¿é—®çš„URLæ¥é™æµï¼Œä¼šè¿”å›Sentinelè‡ªå¸¦é»˜è®¤çš„é™æµå¤„ç†ä¿¡æ¯ã€‚</p></blockquote><h3 id="1ã€ä¿®æ”¹RateLimitController"><a href="#1ã€ä¿®æ”¹RateLimitController" class="headerlink" title="1ã€ä¿®æ”¹RateLimitController"></a>1ã€ä¿®æ”¹RateLimitController</h3><blockquote><p>æ–°å¢ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•æ²¡æœ‰è‡ªå®šä¹‰çš„å…œåº•æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/rateLimit/byUrl&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;byUrl&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult <span class="title">byUrl</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">200</span>,<span class="string">&quot;æŒ‰urlé™æµæµ‹è¯•OK&quot;</span>,<span class="keyword">new</span> Payment(<span class="number">2020L</span>,<span class="string">&quot;serial002&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€è®¿é—®æ–°å¢çš„æ–¹æ³•"><a href="#2ã€è®¿é—®æ–°å¢çš„æ–¹æ³•" class="headerlink" title="2ã€è®¿é—®æ–°å¢çš„æ–¹æ³•"></a>2ã€è®¿é—®æ–°å¢çš„æ–¹æ³•</h3><blockquote><p>è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210221235934.png" alt="image-20210221235934057"></p><h3 id="3ã€åœ¨Sentinelæ§åˆ¶å°è¿›è¡Œé…ç½®"><a href="#3ã€åœ¨Sentinelæ§åˆ¶å°è¿›è¡Œé…ç½®" class="headerlink" title="3ã€åœ¨Sentinelæ§åˆ¶å°è¿›è¡Œé…ç½®"></a>3ã€åœ¨Sentinelæ§åˆ¶å°è¿›è¡Œé…ç½®</h3><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222000127.png" alt="image-20210222000127076"></p><h3 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h3><blockquote><p>åœ¨ä¸€ç§’å†…å¤šæ¬¡è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:8401/rateLimit/byUrl">http://localhost:8401/rateLimit/byUrl</a> ï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222000301.png" alt="image-20210222000301562"></p><blockquote><p>å¯ä»¥çœ‹å‡ºï¼Œå¦‚æœæ²¡æœ‰è‡ªå®šä¹‰å…œåº•æ–¹æ³•ï¼Œå°±ç›´æ¥ç”¨sentinelè‡ªå¸¦çš„å…œåº•æ–¹æ³•</p></blockquote><h2 id="7-3ã€ä¸Šé¢å…œåº•æ–¹æ¡ˆé¢ä¸´çš„é—®é¢˜"><a href="#7-3ã€ä¸Šé¢å…œåº•æ–¹æ¡ˆé¢ä¸´çš„é—®é¢˜" class="headerlink" title="7.3ã€ä¸Šé¢å…œåº•æ–¹æ¡ˆé¢ä¸´çš„é—®é¢˜"></a>7.3ã€ä¸Šé¢å…œåº•æ–¹æ¡ˆé¢ä¸´çš„é—®é¢˜</h2><ul><li>ç³»ç»Ÿé»˜è®¤çš„ï¼Œæ²¡æœ‰ä½“ç°æˆ‘ä»¬è‡ªå·±çš„ä¸šåŠ¡éœ€æ±‚</li><li>ä¾ç…§ç°æœ‰æ¡ä»¶ï¼Œæˆ‘ä»¬è‡ªå®šä¹‰çš„å¤„ç†æ–¹æ³•åˆå’Œä¸šåŠ¡ä»£ç è€¦åˆåœ¨ä¸€å—ï¼Œä¸ç›´è§‚</li><li>æ¯ä¸€ä¸ªä¸šåŠ¡æ–¹æ³•éƒ½æœ‰è‡ªå·±çš„å…œåº•æ–¹æ³•ï¼Œä»£ç è†¨èƒ€åŠ å‰§</li><li>å…¨å±€ç»Ÿä¸€çš„å¤„ç†æ–¹æ³•æ²¡æœ‰ä½“ç°ã€‚</li></ul><h2 id="7-4ã€å®¢æˆ·è‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘"><a href="#7-4ã€å®¢æˆ·è‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘" class="headerlink" title="7.4ã€å®¢æˆ·è‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘"></a>7.4ã€å®¢æˆ·è‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘</h2><h3 id="1ã€åˆ›å»ºCustomerBlockerHandlerç±»"><a href="#1ã€åˆ›å»ºCustomerBlockerHandlerç±»" class="headerlink" title="1ã€åˆ›å»ºCustomerBlockerHandlerç±»"></a>1ã€åˆ›å»ºCustomerBlockerHandlerç±»</h3><blockquote><p>è¿™ä¸ªç±»ç”¨äºè‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CustomerBlockerHandler</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonResult <span class="title">handlerException</span> <span class="params">(BlockException blockException)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">7777</span>,<span class="string">&quot;å®¢æˆ·è‡ªå®šä¹‰ï¼Œglobal handlerException ------------1&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> CommonResult <span class="title">handlerException2</span> <span class="params">(BlockException blockException)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">7777</span>,<span class="string">&quot;å®¢æˆ·è‡ªå®šä¹‰ï¼Œglobal handlerException ------------2&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ä¿®æ”¹ä¸šåŠ¡ç±»"><a href="#2ã€ä¿®æ”¹ä¸šåŠ¡ç±»" class="headerlink" title="2ã€ä¿®æ”¹ä¸šåŠ¡ç±»"></a>2ã€ä¿®æ”¹ä¸šåŠ¡ç±»</h3><blockquote><p>æ·»åŠ æ–¹æ³•å¦‚ä¸‹ï¼Œ@SentinleResourceå‚æ•°ä¸­</p><ul><li>valueæŒ‡å®šèµ„æºå</li><li>blockHandlerClassæŒ‡å®šé™æµå¤„ç†ç±»</li><li>blockHandleræŒ‡å®šé™æµå¤„ç†ç±»ä¸­çš„é™æµå¤„ç†æ–¹æ³•</li></ul><p>å³customerBlockerHandleræ–¹æ³•çš„é™æµå¤„ç†ä¸šåŠ¡ç”±<strong>CustomerBlockerHandlerç±»</strong>ä¸­çš„<strong>handlerException2æ–¹æ³•</strong>å¤„ç†</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/rateLimit/customerBlockerHandler&quot;)</span></span><br><span class="line"><span class="meta">@SentinelResource(</span></span><br><span class="line"><span class="meta">    value = &quot;customerBlockerHandler&quot;,</span></span><br><span class="line"><span class="meta">    blockHandlerClass = CustomerBlockerHandler.class,</span></span><br><span class="line"><span class="meta">    blockHandler = &quot;handlerException2&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult <span class="title">customerBlockerHandler</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">200</span>,<span class="string">&quot;å®¢æˆ·è‡ªå®šä¹‰å¤„ç†ç±»&quot;</span>,<span class="keyword">new</span> Payment(<span class="number">2020L</span>,<span class="string">&quot;serial002&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€é‡å¯æœåŠ¡ï¼Œæµ‹è¯•æ–°æ–¹æ³•ï¼Œæ·»åŠ æµæ§è§„åˆ™"><a href="#3ã€é‡å¯æœåŠ¡ï¼Œæµ‹è¯•æ–°æ–¹æ³•ï¼Œæ·»åŠ æµæ§è§„åˆ™" class="headerlink" title="3ã€é‡å¯æœåŠ¡ï¼Œæµ‹è¯•æ–°æ–¹æ³•ï¼Œæ·»åŠ æµæ§è§„åˆ™"></a>3ã€é‡å¯æœåŠ¡ï¼Œæµ‹è¯•æ–°æ–¹æ³•ï¼Œæ·»åŠ æµæ§è§„åˆ™</h3><blockquote><p>è®¿é—®<a target="_blank" rel="noopener" href="http://localhost/rateLimit/customerBlockerHandler">http://localhost/rateLimit/customerBlockerHandler</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222002549.png" alt="image-20210222002549684"></p><blockquote><p>ä¸ºcustomerBlockerHandleræ–¹æ³•æ·»åŠ æµæ§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222002539.png" alt="image-20210222002538578"></p><h3 id="4ã€æµ‹è¯•æˆ‘ä»¬è‡ªå®šä¹‰çš„é™æµå¤„ç†ä¸šåŠ¡ç±»"><a href="#4ã€æµ‹è¯•æˆ‘ä»¬è‡ªå®šä¹‰çš„é™æµå¤„ç†ä¸šåŠ¡ç±»" class="headerlink" title="4ã€æµ‹è¯•æˆ‘ä»¬è‡ªå®šä¹‰çš„é™æµå¤„ç†ä¸šåŠ¡ç±»"></a>4ã€æµ‹è¯•æˆ‘ä»¬è‡ªå®šä¹‰çš„é™æµå¤„ç†ä¸šåŠ¡ç±»</h3><blockquote><p>åœ¨ä¸€ç§’é’Ÿå†…è¿ç»­è®¿é—® <a target="_blank" rel="noopener" href="http://localhost/rateLimit/customerBlockerHandler">http://localhost/rateLimit/customerBlockerHandler</a> æŸ¥çœ‹ç»“æœ</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222002732.png" alt="image-20210222002732531"></p><h3 id="5ã€Controlleræ–¹æ³•ä¸è‡ªå®šä¹‰é™æµä¸šåŠ¡å¤„ç†æ–¹æ³•å¯¹äºå…³ç³»"><a href="#5ã€Controlleræ–¹æ³•ä¸è‡ªå®šä¹‰é™æµä¸šåŠ¡å¤„ç†æ–¹æ³•å¯¹äºå…³ç³»" class="headerlink" title="5ã€Controlleræ–¹æ³•ä¸è‡ªå®šä¹‰é™æµä¸šåŠ¡å¤„ç†æ–¹æ³•å¯¹äºå…³ç³»"></a>5ã€Controlleræ–¹æ³•ä¸è‡ªå®šä¹‰é™æµä¸šåŠ¡å¤„ç†æ–¹æ³•å¯¹äºå…³ç³»</h3><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222002830.png" alt="image-20210222002830021"></p><h1 id="å…«ã€æœåŠ¡ç†”æ–­åŠŸèƒ½"><a href="#å…«ã€æœåŠ¡ç†”æ–­åŠŸèƒ½" class="headerlink" title="å…«ã€æœåŠ¡ç†”æ–­åŠŸèƒ½"></a>å…«ã€æœåŠ¡ç†”æ–­åŠŸèƒ½</h1><blockquote><p>sentinelæ•´åˆ<strong>ribbon</strong> + <strong>openFeign</strong> + <strong>fallback</strong></p></blockquote><h2 id="8-1ã€sentinelæ•´åˆRibbon"><a href="#8-1ã€sentinelæ•´åˆRibbon" class="headerlink" title="8.1ã€sentinelæ•´åˆRibbon"></a>8.1ã€sentinelæ•´åˆRibbon</h2><blockquote><p>ç¨‹åºæ¶æ„å›¾å¦‚ä¸‹</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222104755.png" alt="image-20210222104747783"></p><h3 id="1ã€åˆ›å»ºæœåŠ¡æä¾›è€…9003"><a href="#1ã€åˆ›å»ºæœåŠ¡æä¾›è€…9003" class="headerlink" title="1ã€åˆ›å»ºæœåŠ¡æä¾›è€…9003"></a>1ã€åˆ›å»ºæœåŠ¡æä¾›è€…9003</h3><blockquote><p>åˆ›å»ºå¾®æœåŠ¡æ¨¡å— ã€cloudalibaba-provider-payment9003ã€‘</p></blockquote><ul><li>pom</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>yml</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9003</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-payment-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line"></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>ä¸»å¯åŠ¨ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentMain9003</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(PaymentMain9003.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä¸šåŠ¡ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> HashMap&lt;Long, Payment&gt; hashMap = <span class="keyword">new</span> HashMap();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">static</span> &#123;</span><br><span class="line">        hashMap.put(<span class="number">1L</span>, <span class="keyword">new</span> Payment(<span class="number">1L</span>, <span class="string">&quot;28a8c1e3bc2742d8848569891fb42181&quot;</span>));</span><br><span class="line">        hashMap.put(<span class="number">2L</span>, <span class="keyword">new</span> Payment(<span class="number">2L</span>, <span class="string">&quot;bba8c1e3bc2742d8848569891ac32182&quot;</span>));</span><br><span class="line">        hashMap.put(<span class="number">3L</span>, <span class="keyword">new</span> Payment(<span class="number">3L</span>, <span class="string">&quot;6ua8c1e3bc2742d8848569891xt92183&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/paymentSQL/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">paymentSQL</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        Payment payment = hashMap.get(id);</span><br><span class="line">        CommonResult&lt;Payment&gt; result = <span class="keyword">new</span> CommonResult(<span class="number">200</span>, <span class="string">&quot;from mysql,serverPort:  &quot;</span> + serverPort, payment);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•</li></ul><blockquote><p>å¯åŠ¨9003ï¼Œè®¿é—® <a target="_blank" rel="noopener" href="http://localhost:9003/paymentSQL/1">http://localhost:9003/paymentSQL/1</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222113152.png" alt="image-20210222113152026"></p><h3 id="2ã€æ ¹æ®9003åˆ›å»ºæœåŠ¡æä¾›è€…9004"><a href="#2ã€æ ¹æ®9003åˆ›å»ºæœåŠ¡æä¾›è€…9004" class="headerlink" title="2ã€æ ¹æ®9003åˆ›å»ºæœåŠ¡æä¾›è€…9004"></a>2ã€æ ¹æ®9003åˆ›å»ºæœåŠ¡æä¾›è€…9004</h3><h3 id="3ã€åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…84"><a href="#3ã€åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…84" class="headerlink" title="3ã€åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…84"></a>3ã€åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…84</h3><ul><li>pom</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-sentinel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>ymlé…ç½®æ–‡ä»¶</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">84</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-order-comsumer</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">    <span class="attr">sentinel:</span></span><br><span class="line">      <span class="attr">transport:</span></span><br><span class="line">        <span class="attr">dashboard:</span> <span class="string">localhost:8080</span></span><br><span class="line">        <span class="attr">port:</span> <span class="number">8179</span></span><br><span class="line"><span class="attr">service-url:</span></span><br><span class="line">  <span class="attr">nacos-user-service:</span> <span class="string">http://nacos-payment-provider</span></span><br></pre></td></tr></table></figure><ul><li>ä¸»å¯åŠ¨ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderNacosMain84</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(OrderNacosMain84.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ApplicationContextConfig</li></ul><blockquote><p>å¾€Spring å®¹å™¨ä¸­æ³¨å…¥ä¸€ä¸ªRestTemplateå¯¹è±¡</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationContextConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">getRestTemplate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€84å¾®æœåŠ¡ä¸­çš„ä¸šåŠ¡ç±»"><a href="#4ã€84å¾®æœåŠ¡ä¸­çš„ä¸šåŠ¡ç±»" class="headerlink" title="4ã€84å¾®æœåŠ¡ä¸­çš„ä¸šåŠ¡ç±»"></a>4ã€84å¾®æœåŠ¡ä¸­çš„ä¸šåŠ¡ç±»</h3><blockquote><p>CircleBreakerControllerçš„å…¨éƒ¨ä»£ç </p><ul><li>å…¶ä¸­fallbackç®¡javaè¿è¡Œæ—¶å¼‚å¸¸</li><li>blockHandlerç®¡sentinelè¿è§„å¼‚å¸¸</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CircleBreakerController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String SERVICE_URL = <span class="string">&quot;http://nacos-payment-provider&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/consumer/fallback/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="comment">//@SentinelResource(value = &quot;fallback&quot;) //æ²¡æœ‰é…ç½®</span></span><br><span class="line"><span class="comment">//@SentinelResource(value = &quot;fallback&quot;,fallback = &quot;handlerFallback&quot;) //fallbackåªè´Ÿè´£ä¸šåŠ¡å¼‚å¸¸</span></span><br><span class="line"><span class="comment">//@SentinelResource(value = &quot;fallback&quot;,blockHandler = &quot;blockHandler&quot;) //blockHandleråªè´Ÿè´£sentinelæ§åˆ¶å°é…ç½®è¿è§„</span></span><br><span class="line">    <span class="comment">//@SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handlerFallback&quot;, blockHandler = &quot;blockHandler&quot;,</span></span><br><span class="line">            exceptionsToIgnore = &#123;IllegalArgumentException.class&#125;)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">fallback</span><span class="params">(<span class="meta">@PathVariable</span> Long id)</span> </span>&#123;</span><br><span class="line">        CommonResult&lt;Payment &gt; result = restTemplate.getForObject(SERVICE_URL + <span class="string">&quot;/paymentSQL/&quot;</span> + id, CommonResult.class, id);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (id == <span class="number">4</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;IllegalArgumentException,éæ³•å‚æ•°å¼‚å¸¸....&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (result.getData() == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException(<span class="string">&quot;NullPointerException,è¯¥IDæ²¡æœ‰å¯¹åº”è®°å½•,ç©ºæŒ‡é’ˆå¼‚å¸¸&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//fallback</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">handlerFallback</span><span class="params">(<span class="meta">@PathVariable</span> Long id, Throwable e)</span> </span>&#123;</span><br><span class="line">        Payment payment = <span class="keyword">new</span> Payment(id, <span class="string">&quot;null&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">444</span>, <span class="string">&quot;å…œåº•å¼‚å¸¸handlerFallback,exceptionå†…å®¹  &quot;</span> + e.getMessage(), payment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//blockHandler</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult <span class="title">blockHandler</span><span class="params">(<span class="meta">@PathVariable</span> Long id, BlockException blockException)</span> </span>&#123;</span><br><span class="line">        Payment payment = <span class="keyword">new</span> Payment(id, <span class="string">&quot;null&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">445</span>, <span class="string">&quot;blockHandler-sentinelé™æµ,æ— æ­¤æµæ°´: blockException  &quot;</span> + blockException.getMessage(), payment);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨9003ã€9004ã€84å¾®æœåŠ¡ï¼Œè¾“å…¥æµ‹è¯•åœ°å€ï¼ŒæŸ¥çœ‹ç»“æœ</li></ul><blockquote><p>æµ‹è¯•åœ°å€ï¼š<a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/1">http://localhost:84/consumer/fallback/1</a></p><p>å®ç°äº†è´Ÿè½½å‡è¡¡å’Œå¾®æœåŠ¡è°ƒç”¨</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222121549.png" alt="image-20210222121547497"></p><h3 id="5ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»ä¸åšä»»ä½•é…ç½®çš„æƒ…å†µä¸‹"><a href="#5ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»ä¸åšä»»ä½•é…ç½®çš„æƒ…å†µä¸‹" class="headerlink" title="5ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»ä¸åšä»»ä½•é…ç½®çš„æƒ…å†µä¸‹"></a>5ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»ä¸åšä»»ä½•é…ç½®çš„æƒ…å†µä¸‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SentinelResource(value = &quot;fallback&quot;)</span> <span class="comment">//æ²¡æœ‰é…ç½®</span></span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a> ï¼Œé‚£ä¹ˆä¼šæŠ¥éæ³•å‚æ•°å¼‚å¸¸ï¼Œç›´æ¥è¿”å›ä¸€ä¸ªé”™è¯¯é¡µé¢</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222122142.png" alt="image-20210222122142619"></p><blockquote><p>æ­¤æ—¶å¦‚æœè®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/5">http://localhost:84/consumer/fallback/5</a> ï¼Œé‚£ä¹ˆæ±‡æŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œä¹Ÿæ˜¯ç›´æ¥è¿”å›ä¸€ä¸ªé”™è¯¯é¡µé¢</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222122258.png" alt="image-20210222122258779"></p><h3 id="6ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®fallback"><a href="#6ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®fallback" class="headerlink" title="6ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®fallback"></a>6ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®fallback</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fallbackåªè´Ÿè´£ä¸šåŠ¡å¼‚å¸¸</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;fallback&quot;,fallback = &quot;handlerFallback&quot;)</span> </span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a> ï¼Œé‚£ä¹ˆä¼šæŠ¥éæ³•å‚æ•°å¼‚å¸¸ï¼Œæ­¤æ—¶è°ƒç”¨fallbacké…ç½®çš„å…œåº•æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fallback</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult <span class="title">handlerFallback</span><span class="params">(<span class="meta">@PathVariable</span> Long id, Throwable e)</span> </span>&#123;</span><br><span class="line">    Payment payment = <span class="keyword">new</span> Payment(id, <span class="string">&quot;null&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">444</span>, <span class="string">&quot;å…œåº•å¼‚å¸¸handlerFallback,exceptionå†…å®¹  &quot;</span> + e.getMessage(), payment);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222123003.png" alt="image-20210222123003397"></p><blockquote><p>æ­¤æ—¶è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/5">http://localhost:84/consumer/fallback/5</a> ï¼Œé‚£ä¹ˆä¼šæŠ¥ç©ºæŒ‡é’ˆå¼‚å¸¸ï¼Œæ­¤æ—¶è°ƒç”¨fallbacké…ç½®çš„å…œåº•æ–¹æ³•</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222123246.png" alt="image-20210222123246739"></p><h3 id="7ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®blockHandler"><a href="#7ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®blockHandler" class="headerlink" title="7ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®blockHandler"></a>7ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®blockHandler</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//blockHandleråªè´Ÿè´£sentinelæ§åˆ¶å°é…ç½®è¿è§„</span></span><br><span class="line"><span class="meta">@SentinelResource(value = &quot;fallback&quot;,blockHandler = &quot;blockHandler&quot;)</span> </span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶blockHandleré…ç½®çš„å…œåº•æ–¹æ³•åªç®¡sentinelæ§åˆ¶å°è¿è§„é…ç½®ï¼Œä¸ç®¡javaç¨‹åºè¿è¡Œæ—¶å¼‚å¸¸é”™è¯¯ã€‚</p><p>æ­¤æ—¶è®¿é—®<a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/5">http://localhost:84/consumer/fallback/5</a> ï¼Œç”±äºè¾“å…¥çš„idä¸åˆæ³•ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›é”™è¯¯é¡µé¢</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222124841.png" alt="image-20210222124841012"></p><blockquote><p>åœ¨sentinelä¸­æ–°å¢ä¸€ä¸ªé™çº§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222125259.png" alt="image-20210222125258965"></p><blockquote><p>åœ¨çŸ­æ—¶é—´å†…è¿ç»­è®¿é—®ä¸¤æ¬¡ <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a> åï¼Œç”±äºè§¦çŠ¯äº†sentinelé…ç½®çš„é™çº§è§„åˆ™ï¼Œæ‰€ä»¥è¯¥æ–¹æ³•è¢«é™çº§ï¼Œè°ƒç”¨äº†blockHandleré…ç½®çš„é™çº§æ–¹æ³•ã€‚</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222125359.png" alt="image-20210222125359108"></p><h3 id="8ã€84å¾®æœåŠ¡fallbackå’ŒblockHandleréƒ½é…ç½®"><a href="#8ã€84å¾®æœåŠ¡fallbackå’ŒblockHandleréƒ½é…ç½®" class="headerlink" title="8ã€84å¾®æœåŠ¡fallbackå’ŒblockHandleréƒ½é…ç½®"></a>8ã€84å¾®æœåŠ¡fallbackå’ŒblockHandleréƒ½é…ç½®</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handlerFallback&quot;, blockHandler = &quot;blockHandler&quot;)</span></span><br></pre></td></tr></table></figure><blockquote><p>fallbackå’ŒblockHandlerå¯¹åº”çš„å…œåº•æ–¹æ³•å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//fallback</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult <span class="title">handlerFallback</span><span class="params">(<span class="meta">@PathVariable</span> Long id, Throwable e)</span> </span>&#123;</span><br><span class="line">    Payment payment = <span class="keyword">new</span> Payment(id, <span class="string">&quot;null&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">444</span>, <span class="string">&quot;å…œåº•å¼‚å¸¸handlerFallback,exceptionå†…å®¹  &quot;</span> + e.getMessage(), payment);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//blockHandler</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult <span class="title">blockHandler</span><span class="params">(<span class="meta">@PathVariable</span> Long id, BlockException blockException)</span> </span>&#123;</span><br><span class="line">    Payment payment = <span class="keyword">new</span> Payment(id, <span class="string">&quot;null&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">445</span>, <span class="string">&quot;blockHandler-sentinelé™æµ,æ— æ­¤æµæ°´: blockException  &quot;</span> + blockException.getMessage(), payment);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨sentinelæ§åˆ¶å°ä¸­ä¸ºèµ„æºfallbackæ–°å¢ä¸€ä¸ªæµæ§è§„åˆ™</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222130542.png" alt="image-20210222130541531"></p><blockquote><p>åœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/1">http://localhost:84/consumer/fallback/1</a> ï¼Œè¿åsentinelçš„æµæ§è§„åˆ™ï¼Œè§¦å‘blockHandlerä¸­é…ç½®çš„å…œåº•æ–¹æ³•</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222130711.png" alt="image-20210222130711708"></p><blockquote><p>è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a> ï¼Œè§¦å‘fallbackä¸­é…ç½®çš„å…œåº•æ–¹æ³•</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222130912.png" alt="image-20210222130912853"></p><blockquote><p>å¦‚æœåœ¨çŸ­æ—¶é—´å†…å¤šæ¬¡è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a> ï¼Œæ—¢æŠ¥å¼‚å¸¸åˆè¿åsentinelçš„é™æµè§„åˆ™ï¼Œæ­¤æ—¶å½’blockHandleré…ç½®çš„å…œåº•æ–¹æ³•ç®¡</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222131141.png" alt="image-20210222131140908"></p><h3 id="9ã€ç»“è®º"><a href="#9ã€ç»“è®º" class="headerlink" title="9ã€ç»“è®º"></a>9ã€ç»“è®º</h3><blockquote><p>è‹¥ <strong>blockHandler</strong> å’Œ <strong>fallback</strong> éƒ½è¿›è¡Œäº†é…ç½®ï¼Œåˆ™è¢«<strong>é™æµé™çº§</strong>è€ŒæŠ›å‡º <strong>BlockException **æ—¶åªä¼šè¿›å…¥ **blockHandler å¤„ç†é€»è¾‘ã€‚</strong></p></blockquote><h3 id="10ã€å¼‚å¸¸å¿½ç•¥å±æ€§"><a href="#10ã€å¼‚å¸¸å¿½ç•¥å±æ€§" class="headerlink" title="10ã€å¼‚å¸¸å¿½ç•¥å±æ€§"></a>10ã€å¼‚å¸¸å¿½ç•¥å±æ€§</h3><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222132107.png" alt="image-20210222132107534"></p><blockquote><p>åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ é…ç½®å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SentinelResource(value = &quot;fallback&quot;, fallback = &quot;handlerFallback&quot;, blockHandler = &quot;blockHandler&quot;, exceptionsToIgnore = &#123;IllegalArgumentException.class&#125;)</span></span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶å†æ¬¡è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/fallback/4">http://localhost:84/consumer/fallback/4</a></p><p>ç”±äºIllegalArgumentExceptionå¼‚å¸¸è¢«å¿½ç•¥ï¼Œæ‰€ä»¥ç›´æ¥è¿”å›äº†error page</p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222132208.png" alt="image-20210222132208156"></p><h2 id="8-2ã€sentinelæ•´åˆOpenFeign"><a href="#8-2ã€sentinelæ•´åˆOpenFeign" class="headerlink" title="8.2ã€sentinelæ•´åˆOpenFeign"></a>8.2ã€sentinelæ•´åˆOpenFeign</h2><h3 id="1ã€ä¿®æ”¹å¾®æœåŠ¡æ¶ˆè´¹è€…84æ¨¡å—"><a href="#1ã€ä¿®æ”¹å¾®æœåŠ¡æ¶ˆè´¹è€…84æ¨¡å—" class="headerlink" title="1ã€ä¿®æ”¹å¾®æœåŠ¡æ¶ˆè´¹è€…84æ¨¡å—"></a>1ã€ä¿®æ”¹å¾®æœåŠ¡æ¶ˆè´¹è€…84æ¨¡å—</h3><ul><li>ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®ï¼Œ æ¿€æ´»Sentinelå¯¹feignçš„æ”¯æŒ</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ¿€æ´»Sentinelå¯¹feignçš„æ”¯æŒ</span></span><br><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">sentinel:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableFeignClientsæ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableFeignClients</span></span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸€ä¸ªPaymentServiceæ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;nacos-payment-provider&quot;,fallback = PaymentFallbackService.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PaymentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/paymentSQL/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">paymentSQL</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸€ä¸ªPaymentFallbackServiceå®ç°PaymentServiceæ¥å£</li></ul><blockquote><p>è¿™ä¸ªç±»ç”¨äºå¯¹PayServiceæ¥å£ä¸­çš„æ–¹æ³•åšå…œåº•å¤„ç†</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentFallbackService</span> <span class="keyword">implements</span> <span class="title">PaymentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">paymentSQL</span><span class="params">(Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult(<span class="number">44444</span>, <span class="string">&quot;æœåŠ¡é™çº§è¿”å›,---PaymentFallbackService&quot;</span>, <span class="keyword">new</span> Payment(id, <span class="string">&quot;errorSerial&quot;</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ä¿®æ”¹Controllerå±‚"><a href="#2ã€ä¿®æ”¹Controllerå±‚" class="headerlink" title="2ã€ä¿®æ”¹Controllerå±‚"></a>2ã€ä¿®æ”¹Controllerå±‚</h3><blockquote><p>CircleBreakerController</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//===========================OpenFeign</span></span><br><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> PaymentService paymentService;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(value = &quot;/consumer/paymentSQL/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">paymentSQL</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> paymentService.paymentSQL(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€å¯åŠ¨9003ã€9004å’Œ84å¾®æœåŠ¡ï¼Œæµ‹è¯•"><a href="#3ã€å¯åŠ¨9003ã€9004å’Œ84å¾®æœåŠ¡ï¼Œæµ‹è¯•" class="headerlink" title="3ã€å¯åŠ¨9003ã€9004å’Œ84å¾®æœåŠ¡ï¼Œæµ‹è¯•"></a>3ã€å¯åŠ¨9003ã€9004å’Œ84å¾®æœåŠ¡ï¼Œæµ‹è¯•</h3><blockquote><p>è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/paymentSQL/1">http://localhost:84/consumer/paymentSQL/1</a></p></blockquote><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222143053.png" alt="image-20210222143051685"></p><h3 id="4ã€æŸ¥çœ‹é™çº§æ•ˆæœ"><a href="#4ã€æŸ¥çœ‹é™çº§æ•ˆæœ" class="headerlink" title="4ã€æŸ¥çœ‹é™çº§æ•ˆæœ"></a>4ã€æŸ¥çœ‹é™çº§æ•ˆæœ</h3><blockquote><p>æµ‹è¯•84è°ƒç”¨9003ï¼Œæ­¤æ—¶<strong>æ•…æ„å…³é—­9003å¾®æœåŠ¡æä¾›è€…</strong>ï¼Œçœ‹84æ¶ˆè´¹ä¾§è‡ªåŠ¨é™çº§ï¼Œä¸ä¼šè¢«è€—æ­»</p></blockquote><ul><li><p>å…³é—­9003å’Œ9004</p></li><li><p>è®¿é—® <a target="_blank" rel="noopener" href="http://localhost:84/consumer/paymentSQL/1">http://localhost:84/consumer/paymentSQL/1</a></p></li><li><p>æŸ¥çœ‹ç»“æœ</p></li></ul><p><img src="/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210222143834.png" alt="image-20210222143834182"></p></article><div class="post-copyright"><div class="post-copyright__title"><span class="post-copyright-info"><h>Spring-Cloudå­¦ä¹ ï¼ˆå…­ï¼‰-Sentinel</h></span></div><div class="post-copyright__type"><span class="post-copyright-info"><a href="https://sutianxin.top/posts/2120398077.html">https://sutianxin.top/posts/2120398077.html</a></span></div><div class="post-copyright-m"><div class="post-copyright-m-info"><div class="post-copyright-a" style="display:inline-block;width:120px"><h>ä½œè€…</h><div class="post-copyright-cc-info"><h>å¤©æ˜•</h></div></div><div class="post-copyright-c" style="display:inline-block;width:120px"><h>å‘å¸ƒäº</h><div class="post-copyright-cc-info"><h>2021-02-22</h></div></div><div class="post-copyright-u" style="display:inline-block;width:120px"><h>æ›´æ–°äº</h><div class="post-copyright-cc-info"><h>2021-05-04</h></div></div><div class="post-copyright-c" style="display:inline-block;width:120px"><h>è®¸å¯åè®®</h><div class="post-copyright-cc-info"><a class="icon" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a><a rel="noopener" target="_blank" title="CC BY 4.0" href="https://creativecommons.org/licenses/by/4.0/deed.zh">CC BY 4.0</a></div></div></div></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E2%98%95Java/">â˜•Java</a><a class="post-meta__tags" href="/tags/%F0%9F%92%BB%E5%90%8E%E7%AB%AF%E5%AD%A6%E4%B9%A0/">ğŸ’»åç«¯å­¦ä¹ </a><a class="post-meta__tags" href="/tags/%F0%9F%91%A2Spring-Boot/">ğŸ‘¢Spring Boot</a><a class="post-meta__tags" href="/tags/%F0%9F%91%A8%E2%80%8D%E2%9C%88%EF%B8%8FSentinel/">ğŸ‘¨â€âœˆï¸Sentinel</a></div><div class="post_share"><div class="social-share" data-image="https://gitee.com/sutianxin/blogImage/raw/master/20210504192236.jpg" data-sites="wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/3754089101.html"><img class="prev-cover" data-lazy-src="https://gitee.com/sutianxin/blogImage/raw/master/20210504192211.jpg" onerror='onerror=null,src="https://gitee.com/sutianxin/blogImage/raw/master/20210430103138.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">JavaåŸºç¡€ï¼ˆä¸€ï¼‰-Lambdaè¡¨è¾¾å¼å­¦ä¹ </div></div></a></div><div class="next-post pull-right"><a href="/posts/717860798.html"><img class="next-cover" data-lazy-src="https://gitee.com/sutianxin/blogImage/raw/master/20210504192334.jpg" onerror='onerror=null,src="https://gitee.com/sutianxin/blogImage/raw/master/20210430103138.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ï¼ˆå…­ï¼‰-HashMapæºç è§£è¯»</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸å…³æ¨è</span></div><div class="relatedPosts-list"><div><a href="/posts/2938255980.html" title="Javaåº”ç”¨å­¦ä¹ ï¼ˆäºŒï¼‰-Springbootæ•´åˆswagger/swagger-Bootstrap-UIä½¿ç”¨"><img class="cover" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210208120213.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2020-12-12</div><div class="title">Javaåº”ç”¨å­¦ä¹ ï¼ˆäºŒï¼‰-Springbootæ•´åˆswagger/swagger-Bootstrap-UIä½¿ç”¨</div></div></a></div><div><a href="/posts/913123791.html" title="Spring Cloudå­¦ä¹ ï¼ˆä¸ƒï¼‰-Spring Cloud Config"><img class="cover" data-lazy-src="https://gitee.com/sutianxin/blogImage/raw/master/20210516192228.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-05-16</div><div class="title">Spring Cloudå­¦ä¹ ï¼ˆä¸ƒï¼‰-Spring Cloud Config</div></div></a></div><div><a href="/posts/2863462089.html" title="Spring Cloudå­¦ä¹ ï¼ˆäºŒï¼‰-OpenFeignå¾®æœåŠ¡è°ƒç”¨"><img class="cover" data-lazy-src="https://gitee.com/sutianxin/blogImage/raw/master/20210504192527.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-11</div><div class="title">Spring Cloudå­¦ä¹ ï¼ˆäºŒï¼‰-OpenFeignå¾®æœåŠ¡è°ƒç”¨</div></div></a></div><div><a href="/posts/995752607.html" title="Spring Cloudå­¦ä¹ ï¼ˆå››ï¼‰-EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ"><img class="cover" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214225250.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-14</div><div class="title">Spring Cloudå­¦ä¹ ï¼ˆå››ï¼‰-EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ</div></div></a></div><div><a href="/posts/650479038.html" title="åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆäºŒï¼‰-ç”¨æˆ·è®¤è¯"><img class="cover" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205204706.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-05</div><div class="title">åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆäºŒï¼‰-ç”¨æˆ·è®¤è¯</div></div></a></div><div><a href="/posts/4109687940.html" title="åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆå››ï¼‰-ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨å’Œåˆ é™¤åµŒå¥—åˆ—è¡¨"><img class="cover" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210223743.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-02-10</div><div class="title">åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆå››ï¼‰-ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨å’Œåˆ é™¤åµŒå¥—åˆ—è¡¨</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> è¯„è®º</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®å½•</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%80%E3%80%81Sentinel"><span class="toc-text">ä¸€ã€Sentinel</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-1%E3%80%81%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F"><span class="toc-text">1.1ã€æ˜¯ä»€ä¹ˆï¼Ÿ</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-2%E3%80%81%E7%89%B9%E5%BE%81"><span class="toc-text">1.2ã€ç‰¹å¾</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-3%E3%80%81%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86"><span class="toc-text">1.3ã€ç»„æˆéƒ¨åˆ†</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-4%E3%80%81%E4%B8%8EHystrix%E7%9A%84%E5%AF%B9%E6%AF%94"><span class="toc-text">1.4ã€ä¸Hystrixçš„å¯¹æ¯”</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81Hystrix"><span class="toc-text">1ã€Hystrix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81Sentinel"><span class="toc-text">2ã€Sentinel</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%AE%89%E8%A3%85%E4%BD%BF%E7%94%A8"><span class="toc-text">äºŒã€å®‰è£…ä½¿ç”¨</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#2-1%E3%80%81%E4%B8%8B%E8%BD%BDsentinel"><span class="toc-text">2.1ã€ä¸‹è½½sentinel</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-2%E3%80%81%E8%BF%90%E8%A1%8C"><span class="toc-text">2.2ã€è¿è¡Œ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%89%8D%E6%8F%90"><span class="toc-text">1ã€å‰æ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="toc-text">2ã€è¿è¡Œå‘½ä»¤</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E8%AE%BF%E9%97%AE%E7%AE%A1%E7%90%86%E9%A1%B5%E9%9D%A2"><span class="toc-text">3ã€è®¿é—®ç®¡ç†é¡µé¢</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%88%9D%E5%A7%8B%E5%8C%96%E6%BC%94%E7%A4%BA%E5%B7%A5%E7%A8%8B"><span class="toc-text">ä¸‰ã€åˆå§‹åŒ–æ¼”ç¤ºå·¥ç¨‹</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#3-1%E3%80%81%E5%88%9B%E5%BB%BASentinel%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%A8%A1%E5%9D%97"><span class="toc-text">3.1ã€åˆ›å»ºSentinelå¾®æœåŠ¡æ¨¡å—</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%BB%BAmodule"><span class="toc-text">1ã€å»ºmodule</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81POM"><span class="toc-text">2ã€POM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81YML"><span class="toc-text">3ã€YML</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E4%B8%BB%E5%90%AF%E5%8A%A8%E7%B1%BB"><span class="toc-text">4ã€ä¸»å¯åŠ¨ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E4%B8%9A%E5%8A%A1%E7%B1%BB"><span class="toc-text">5ã€ä¸šåŠ¡ç±»</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2%E3%80%81%E5%90%AF%E5%8A%A8sentinel%E5%92%8C8401%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-text">2ã€å¯åŠ¨sentinelå’Œ8401å¾®æœåŠ¡</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E6%B5%81%E6%8E%A7%EF%BC%88%E6%B5%81%E9%87%8F%E6%8E%A7%E5%88%B6%EF%BC%89%E8%A7%84%E5%88%99"><span class="toc-text">å››ã€æµæ§ï¼ˆæµé‡æ§åˆ¶ï¼‰è§„åˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">4.1ã€åŸºæœ¬ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2%E3%80%81%E6%B5%81%E6%8E%A7%E6%A8%A1%E5%BC%8F"><span class="toc-text">4.2ã€æµæ§æ¨¡å¼</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9B%B4%E6%8E%A5%EF%BC%88%E9%BB%98%E8%AE%A4%EF%BC%89"><span class="toc-text">1ã€ç›´æ¥ï¼ˆé»˜è®¤ï¼‰</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%85%B3%E8%81%94"><span class="toc-text">2ã€å…³è”</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E9%93%BE%E8%B7%AF"><span class="toc-text">3ã€é“¾è·¯</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3%E3%80%81%E6%B5%81%E6%8E%A7%E6%95%88%E6%9E%9C"><span class="toc-text">4.3ã€æµæ§æ•ˆæœ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E7%9B%B4%E6%8E%A5-gt-%E5%BF%AB%E9%80%9F%E5%A4%B1%E8%B4%A5"><span class="toc-text">1ã€ç›´æ¥-&gt;å¿«é€Ÿå¤±è´¥</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E9%A2%84%E7%83%AD"><span class="toc-text">2ã€é¢„çƒ­</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%8E%92%E9%98%9F%E7%AD%89%E5%BE%85"><span class="toc-text">3ã€æ’é˜Ÿç­‰å¾…</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4%E3%80%81%E9%99%8D%E7%BA%A7%E8%A7%84%E5%88%99"><span class="toc-text">4.4ã€é™çº§è§„åˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E9%99%8D%E7%BA%A7%E8%A7%84%E5%88%99%E8%AF%B4%E6%98%8E"><span class="toc-text">1ã€é™çº§è§„åˆ™è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%BF%9B%E4%B8%80%E6%AD%A5%E8%AF%B4%E6%98%8E"><span class="toc-text">2ã€è¿›ä¸€æ­¥è¯´æ˜</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81RT"><span class="toc-text">3ã€RT</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%BC%82%E5%B8%B8%E6%AF%94%E4%BE%8B"><span class="toc-text">4ã€å¼‚å¸¸æ¯”ä¾‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E5%BC%82%E5%B8%B8%E6%95%B0"><span class="toc-text">5ã€å¼‚å¸¸æ•°</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E7%83%AD%E7%82%B9key%E9%99%90%E6%B5%81"><span class="toc-text">äº”ã€çƒ­ç‚¹keyé™æµ</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#5-1%E3%80%81%E5%9F%BA%E6%9C%AC%E4%BB%8B%E7%BB%8D"><span class="toc-text">5.1ã€åŸºæœ¬ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-2%E3%80%81%E9%85%8D%E7%BD%AE%E7%83%AD%E7%82%B9%E9%99%90%E6%B5%81"><span class="toc-text">5.2ã€é…ç½®çƒ­ç‚¹é™æµ</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%A4%8D%E4%B9%A0hystrix"><span class="toc-text">1ã€å¤ä¹ hystrix</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%9C%A8%E4%B8%9A%E5%8A%A1%E7%B1%BB%E4%B8%AD%E6%B7%BB%E5%8A%A0%E4%BB%A3%E7%A0%81"><span class="toc-text">2ã€åœ¨ä¸šåŠ¡ç±»ä¸­æ·»åŠ ä»£ç </span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%9C%A8sentinel%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%B8%AD%E6%B7%BB%E5%8A%A0%E7%83%AD%E7%82%B9%E8%A7%84%E5%88%99"><span class="toc-text">3ã€åœ¨sentinelæ§åˆ¶å°ä¸­æ·»åŠ çƒ­ç‚¹è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E5%9C%A8%E6%8E%A7%E5%88%B6%E5%8F%B0%E4%B8%AD%E6%B7%BB%E5%8A%A0%E9%85%8D%E7%BD%AE"><span class="toc-text">4ã€åœ¨æ§åˆ¶å°ä¸­æ·»åŠ é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-text">5ã€æµ‹è¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%81%E7%BB%93%E8%AE%BA"><span class="toc-text">6ã€ç»“è®º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%81%E8%A1%A5%E5%85%85"><span class="toc-text">7ã€è¡¥å……</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-3%E3%80%81%E5%8F%82%E6%95%B0%E4%BE%8B%E5%A4%96%E9%A1%B9"><span class="toc-text">5.3ã€å‚æ•°ä¾‹å¤–é¡¹</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E9%85%8D%E7%BD%AE"><span class="toc-text">1ã€é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E5%89%8D%E6%8F%90%E8%AF%B4%E6%98%8E"><span class="toc-text">2ã€å‰æè¯´æ˜</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E7%B3%BB%E7%BB%9F%E8%A7%84%E5%88%99"><span class="toc-text">å…­ã€ç³»ç»Ÿè§„åˆ™</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#6-1%E3%80%81%E4%BB%8B%E7%BB%8D"><span class="toc-text">6.1ã€ä»‹ç»</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-2%E3%80%81%E6%96%B0%E5%A2%9E%E7%B3%BB%E7%BB%9F%E8%A7%84%E5%88%99"><span class="toc-text">6.2ã€æ–°å¢ç³»ç»Ÿè§„åˆ™</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E4%B8%83%E3%80%81-SentinelResource"><span class="toc-text">ä¸ƒã€@SentinelResource</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#7-1%E3%80%81%E6%8C%89%E8%B5%84%E6%BA%90%E5%90%8D%E7%A7%B0%E9%99%90%E6%B5%81-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86"><span class="toc-text">7.1ã€æŒ‰èµ„æºåç§°é™æµ + åç»­å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%90%AF%E5%8A%A8Nacos%E5%92%8CSentinel"><span class="toc-text">1ã€å¯åŠ¨Nacoså’ŒSentinel</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%BF%AE%E6%94%B98401%E5%BE%AE%E6%9C%8D%E5%8A%A1"><span class="toc-text">2ã€ä¿®æ”¹8401å¾®æœåŠ¡</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E6%8C%89%E8%B5%84%E6%BA%90%E5%90%8D%E8%BF%9B%E8%A1%8C%E9%99%90%E6%B5%81"><span class="toc-text">3ã€æŒ‰èµ„æºåè¿›è¡Œé™æµ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E9%A2%9D%E5%A4%96%E9%97%AE%E9%A2%98"><span class="toc-text">4ã€é¢å¤–é—®é¢˜</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-2%E3%80%81%E6%8C%89%E7%85%A7Url%E5%9C%B0%E5%9D%80%E9%99%90%E6%B5%81-%E5%90%8E%E7%BB%AD%E5%A4%84%E7%90%86"><span class="toc-text">7.2ã€æŒ‰ç…§Urlåœ°å€é™æµ + åç»­å¤„ç†</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%BF%AE%E6%94%B9RateLimitController"><span class="toc-text">1ã€ä¿®æ”¹RateLimitController</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E8%AE%BF%E9%97%AE%E6%96%B0%E5%A2%9E%E7%9A%84%E6%96%B9%E6%B3%95"><span class="toc-text">2ã€è®¿é—®æ–°å¢çš„æ–¹æ³•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%9C%A8Sentinel%E6%8E%A7%E5%88%B6%E5%8F%B0%E8%BF%9B%E8%A1%8C%E9%85%8D%E7%BD%AE"><span class="toc-text">3ã€åœ¨Sentinelæ§åˆ¶å°è¿›è¡Œé…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%B5%8B%E8%AF%95"><span class="toc-text">4ã€æµ‹è¯•</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-3%E3%80%81%E4%B8%8A%E9%9D%A2%E5%85%9C%E5%BA%95%E6%96%B9%E6%A1%88%E9%9D%A2%E4%B8%B4%E7%9A%84%E9%97%AE%E9%A2%98"><span class="toc-text">7.3ã€ä¸Šé¢å…œåº•æ–¹æ¡ˆé¢ä¸´çš„é—®é¢˜</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-4%E3%80%81%E5%AE%A2%E6%88%B7%E8%87%AA%E5%AE%9A%E4%B9%89%E9%99%90%E6%B5%81%E5%A4%84%E7%90%86%E9%80%BB%E8%BE%91"><span class="toc-text">7.4ã€å®¢æˆ·è‡ªå®šä¹‰é™æµå¤„ç†é€»è¾‘</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BACustomerBlockerHandler%E7%B1%BB"><span class="toc-text">1ã€åˆ›å»ºCustomerBlockerHandlerç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%BF%AE%E6%94%B9%E4%B8%9A%E5%8A%A1%E7%B1%BB"><span class="toc-text">2ã€ä¿®æ”¹ä¸šåŠ¡ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E9%87%8D%E5%90%AF%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%B5%8B%E8%AF%95%E6%96%B0%E6%96%B9%E6%B3%95%EF%BC%8C%E6%B7%BB%E5%8A%A0%E6%B5%81%E6%8E%A7%E8%A7%84%E5%88%99"><span class="toc-text">3ã€é‡å¯æœåŠ¡ï¼Œæµ‹è¯•æ–°æ–¹æ³•ï¼Œæ·»åŠ æµæ§è§„åˆ™</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%B5%8B%E8%AF%95%E6%88%91%E4%BB%AC%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E9%99%90%E6%B5%81%E5%A4%84%E7%90%86%E4%B8%9A%E5%8A%A1%E7%B1%BB"><span class="toc-text">4ã€æµ‹è¯•æˆ‘ä»¬è‡ªå®šä¹‰çš„é™æµå¤„ç†ä¸šåŠ¡ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%81Controller%E6%96%B9%E6%B3%95%E4%B8%8E%E8%87%AA%E5%AE%9A%E4%B9%89%E9%99%90%E6%B5%81%E4%B8%9A%E5%8A%A1%E5%A4%84%E7%90%86%E6%96%B9%E6%B3%95%E5%AF%B9%E4%BA%8E%E5%85%B3%E7%B3%BB"><span class="toc-text">5ã€Controlleræ–¹æ³•ä¸è‡ªå®šä¹‰é™æµä¸šåŠ¡å¤„ç†æ–¹æ³•å¯¹äºå…³ç³»</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%85%AB%E3%80%81%E6%9C%8D%E5%8A%A1%E7%86%94%E6%96%AD%E5%8A%9F%E8%83%BD"><span class="toc-text">å…«ã€æœåŠ¡ç†”æ–­åŠŸèƒ½</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#8-1%E3%80%81sentinel%E6%95%B4%E5%90%88Ribbon"><span class="toc-text">8.1ã€sentinelæ•´åˆRibbon</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%859003"><span class="toc-text">1ã€åˆ›å»ºæœåŠ¡æä¾›è€…9003</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E6%A0%B9%E6%8D%AE9003%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1%E6%8F%90%E4%BE%9B%E8%80%859004"><span class="toc-text">2ã€æ ¹æ®9003åˆ›å»ºæœåŠ¡æä¾›è€…9004</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%88%9B%E5%BB%BA%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%80%8584"><span class="toc-text">3ã€åˆ›å»ºæœåŠ¡æ¶ˆè´¹è€…84</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%8184%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%AD%E7%9A%84%E4%B8%9A%E5%8A%A1%E7%B1%BB"><span class="toc-text">4ã€84å¾®æœåŠ¡ä¸­çš„ä¸šåŠ¡ç±»</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5%E3%80%8184%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%9A%E5%8A%A1%E7%B1%BB%E4%B8%8D%E5%81%9A%E4%BB%BB%E4%BD%95%E9%85%8D%E7%BD%AE%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B"><span class="toc-text">5ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»ä¸åšä»»ä½•é…ç½®çš„æƒ…å†µä¸‹</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6%E3%80%8184%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%9A%E5%8A%A1%E7%B1%BB%E5%8F%AA%E9%85%8D%E7%BD%AEfallback"><span class="toc-text">6ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®fallback</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7%E3%80%8184%E5%BE%AE%E6%9C%8D%E5%8A%A1%E4%B8%9A%E5%8A%A1%E7%B1%BB%E5%8F%AA%E9%85%8D%E7%BD%AEblockHandler"><span class="toc-text">7ã€84å¾®æœåŠ¡ä¸šåŠ¡ç±»åªé…ç½®blockHandler</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8%E3%80%8184%E5%BE%AE%E6%9C%8D%E5%8A%A1fallback%E5%92%8CblockHandler%E9%83%BD%E9%85%8D%E7%BD%AE"><span class="toc-text">8ã€84å¾®æœåŠ¡fallbackå’ŒblockHandleréƒ½é…ç½®</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9%E3%80%81%E7%BB%93%E8%AE%BA"><span class="toc-text">9ã€ç»“è®º</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10%E3%80%81%E5%BC%82%E5%B8%B8%E5%BF%BD%E7%95%A5%E5%B1%9E%E6%80%A7"><span class="toc-text">10ã€å¼‚å¸¸å¿½ç•¥å±æ€§</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-2%E3%80%81sentinel%E6%95%B4%E5%90%88OpenFeign"><span class="toc-text">8.2ã€sentinelæ•´åˆOpenFeign</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1%E3%80%81%E4%BF%AE%E6%94%B9%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%B6%88%E8%B4%B9%E8%80%8584%E6%A8%A1%E5%9D%97"><span class="toc-text">1ã€ä¿®æ”¹å¾®æœåŠ¡æ¶ˆè´¹è€…84æ¨¡å—</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2%E3%80%81%E4%BF%AE%E6%94%B9Controller%E5%B1%82"><span class="toc-text">2ã€ä¿®æ”¹Controllerå±‚</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3%E3%80%81%E5%90%AF%E5%8A%A89003%E3%80%819004%E5%92%8C84%E5%BE%AE%E6%9C%8D%E5%8A%A1%EF%BC%8C%E6%B5%8B%E8%AF%95"><span class="toc-text">3ã€å¯åŠ¨9003ã€9004å’Œ84å¾®æœåŠ¡ï¼Œæµ‹è¯•</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4%E3%80%81%E6%9F%A5%E7%9C%8B%E9%99%8D%E7%BA%A7%E6%95%88%E6%9E%9C"><span class="toc-text">4ã€æŸ¥çœ‹é™çº§æ•ˆæœ</span></a></li></ol></li></ol></li></ol></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2021 <i style="color:#ff6a6a;animation:announ_animation .8s linear infinite" class="fa fa-heartbeat"></i> å¤©æ˜•</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¢˜ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div><div class="footer_custom_text">æ¬¢è¿æ¥åˆ°æˆ‘çš„ä¸ªäººåšå®¢!<span id="runtime"></span><br></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px"><img src="https://img.shields.io/badge/Frame-Hexo-blue?style=flat&amp;logo=hexo"></a><a class="github-badge" target="_blank" href="https://butterfly.js.org/" style="margin-inline:5px"><img src="https://img.shields.io/badge/Theme-Butterfly-6513df?style=flat&amp;logo=bitdefender"></a><a class="github-badge" target="_blank" href="https://www.jsdelivr.com/" style="margin-inline:5px"><img src="https://img.shields.io/badge/CDN-jsDelivr-orange?style=flat&amp;logo=jsDelivr"></a><a class="github-badge" target="_blank" href="https://gitee.com/" style="margin-inline:5px"><img src="https://img.shields.io/badge/Picture-Gitee-0cedbe?style=flat&amp;logo=Gitee"></a><a class="github-badge" target="_blank" href="http://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px"><img src="https://img.shields.io/badge/Copyright-BY--NC--SA%204.0-d42328?style=flat&amp;logo=Claris"></a></p><div id="workboard"></div><script async src="/js/runtime.js"></script></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é˜…è¯»æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="ç®€ç¹è½¬æ¢">ç°¡</button><button id="darkmode" type="button" title="æµ…è‰²å’Œæ·±è‰²æ¨¡å¼è½¬æ¢"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å•æ å’ŒåŒæ åˆ‡æ¢"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è®¾ç½®"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®å½•"><i class="fas fa-list-ul"></i></button><a id="to_comment" href="#post-comment" title="ç›´è¾¾è¯„è®º"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="å›åˆ°é¡¶éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div id="local-search"><div class="search-dialog"><div class="search-dialog__title" id="local-search-title">æœ¬åœ°æœç´¢</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="æœç´¢æ–‡ç« " type="text"></div></div></div><hr><div id="local-search-results"></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script>var preloader={endLoading:()=>{document.body.style.overflow="auto",document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.body.style.overflow="",document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",preloader.endLoading())</script><script defer src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script defer src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script defer src="https://cdn.jsdelivr.net/npm/node-snackbar/dist/snackbar.min.js"></script><script defer src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{const t=document.getElementById("twikoo-count"),o=()=>{twikoo.init({el:"#twikoo-wrap",envId:"blogcomments-2gseqioe1aa55c8c",region:"ap-shanghai"})},e=()=>{twikoo.getCommentsCount({envId:"blogcomments-2gseqioe1aa55c8c",region:"ap-shanghai",urls:[window.location.pathname],includeReply:!1}).then(function(o){t.innerText=o[0].count}).catch(function(o){console.error(o)})};var n;n=!0,"object"==typeof twikoo?(o(),n&&t&&setTimeout(e,0)):getScript("https://cdn.jsdelivr.net/npm/twikoo/dist/twikoo.all.min.js").then(()=>{o(),n&&t&&setTimeout(e,0)})})()</script></div><div class="aplayer no-destroy" data-id="6588965546" data-server="netease" data-type="playlist" data-fixed="true" data-mini="true" data-listfolded="false" data-order="random" data-preload="none" data-autoplay="false" data-lrctype="0" muted></div><script defer src="/live2d-widget/autoload.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.11"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/flipcountdown.js"></script><script data-pjax src="/js/runtime.js"></script><script async src="//at.alicdn.com/t/font_2398185_yegv7kt2bj.js"></script><script src="https://apip.weatherdt.com/simple/static/js/weather-simple-common.js?v=2.0"></script><script src="/js/weather.js"></script><script src="/js/custom/runtime.js"></script><script src="https://cdn.jsdelivr.net/gh/weilain/cdn-photo/js/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/gh/zhheo/JS-Heo@main/hidescrollbar/hidescrollbar.js"></script><script async src="//at.alicdn.com/t/font_2398185_lld84dtfbb.js"></script><script src="https://www.luckyclover.top/rain.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!1,POWERMODE.mobile=!1,document.body.addEventListener("input",POWERMODE)</script><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script><script src="https://cdn.jsdelivr.net/gh/metowolf/MetingJS@1.2/dist/Meting.min.js"></script><script src="https://cdn.jsdelivr.net/npm/pjax/pjax.min.js"></script><script>let pjaxSelectors=["title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"]):not([href="/shuoshuo/"]):not([href="/bb/"]):not([href="/contact/"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:complete",function(){window.refreshFn(),document.querySelectorAll("script[data-pjax], .pjax-reload script").forEach(e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach(e=>t.setAttribute(e.name,e.value)),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)}),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof chatBtnFn&&chatBtnFn(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll(),"object"==typeof preloader&&preloader.endLoading()}),document.addEventListener("pjax:send",function(){if("object"==typeof preloader&&preloader.initLoading(),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")}),document.addEventListener("pjax:error",e=>{404===e.request.status&&pjax.loadUrl("/404.html")})</script></div><script data-pjax src="https://cdn.jsdelivr.net/gh/Zfour/hexo-github-calendar@1.10/hexo_githubcalendar.js"></script><script data-pjax>function GithubCalendarConfig(){var e=document.getElementById("recent-posts");e&&e.insertAdjacentHTML("afterbegin",'<div class="recent-post-item" style="width:100%;height:auto;padding:10px;"><div id="github_container"></div></div>'),GithubCalendar("https://python-github-calendar-api.vercel.app/api?sutianxin",["#ebedf0","#f1f8ff","#dbedff","#c8e1ff","#79b8ff","#2188ff","#0366d6","#005cc5","#044289","#032f62","#05264c"],"sutianxin")}document.getElementById("recent-posts")&&GithubCalendarConfig()</script><style>#github_container{min-height:280px}@media screen and (max-width:650px){#github_container{min-height:120px}}</style></body></html>
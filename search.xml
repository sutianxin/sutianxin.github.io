<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ï¼ˆäº”ï¼‰-é›ªèŠ±ç®—æ³•ç”Ÿæˆå”¯ä¸€ID</title>
      <link href="posts/3410178450.html"/>
      <url>posts/3410178450.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>é¢è¯•é¢˜: é›†ç¾¤é«˜å¹¶å‘æƒ…å†µä¸‹å¦‚ä½•ä¿è¯åˆ†å¸ƒå¼å”¯ä¸€å…¨å±€IDç”Ÿæˆ?</p></blockquote><h2 id="1ã€é—®é¢˜"><a href="#1ã€é—®é¢˜" class="headerlink" title="1ã€é—®é¢˜"></a>1ã€é—®é¢˜</h2><h3 id="1-1ã€ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€IDä»¥åŠåˆ†å¸ƒå¼IDçš„ä¸šåŠ¡éœ€æ±‚"><a href="#1-1ã€ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€IDä»¥åŠåˆ†å¸ƒå¼IDçš„ä¸šåŠ¡éœ€æ±‚" class="headerlink" title="1.1ã€ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€IDä»¥åŠåˆ†å¸ƒå¼IDçš„ä¸šåŠ¡éœ€æ±‚"></a>1.1ã€ä¸ºä»€ä¹ˆéœ€è¦åˆ†å¸ƒå¼å…¨å±€å”¯ä¸€IDä»¥åŠåˆ†å¸ƒå¼IDçš„ä¸šåŠ¡éœ€æ±‚</h3><blockquote><p>åœ¨å¤æ‚åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œå¾€å¾€éœ€è¦å¯¹å¤§é‡çš„æ•°æ®å’Œæ¶ˆæ¯è¿›è¡Œå”¯ä¸€æ ‡è¯†ã€‚</p><p>å¦‚åœ¨ç¾å›¢ç‚¹è¯„çš„é‡‘èã€æ”¯ä»˜ã€é¤é¥®ã€é…’åº—ï¼›</p><p>çŒ«çœ¼ç”µå½±ç­‰äº§å“çš„ç³»ç»Ÿä¸­æ•°æ®æ—¥æ¸å¢é•¿ï¼Œå¯¹æ•°æ®åˆ†åº“åˆ†è¡¨åéœ€è¦æœ‰ä¸€ä¸ªå”¯ä¸€IDæ¥è¡¨ç¤ºä¸€æ¡æ•°æ®æˆ–è€…æ¶ˆæ¯ã€‚</p><p>ç‰¹åˆ«ä¸€ç‚¹çš„å¦‚è®¢å•ã€éª‘æ‰‹ã€ä¼˜æƒ åŠµä¹Ÿéƒ½éœ€è¦ä¸€ä¸ªå”¯ä¸€IDåšä¸ºæ ‡è¯†ã€‚</p><p>æ­¤æ—¶ä¸€ä¸ªèƒ½<strong>ç”Ÿæˆå”¯ä¸€IDçš„ç³»ç»Ÿæ˜¯éå¸¸å¿…è¦çš„</strong>ã€‚</p></blockquote><h3 id="1-2ã€IDç”Ÿæˆè§„åˆ™éƒ¨åˆ†ç¡¬æ€§è¦æ±‚"><a href="#1-2ã€IDç”Ÿæˆè§„åˆ™éƒ¨åˆ†ç¡¬æ€§è¦æ±‚" class="headerlink" title="1.2ã€IDç”Ÿæˆè§„åˆ™éƒ¨åˆ†ç¡¬æ€§è¦æ±‚"></a>1.2ã€IDç”Ÿæˆè§„åˆ™éƒ¨åˆ†ç¡¬æ€§è¦æ±‚</h3><ul><li>å…¨å±€å”¯ä¸€</li></ul><blockquote><p>æ—¢ç„¶æ˜¯å”¯ä¸€æ ‡è¯†ï¼Œé‚£ä¹ˆ<strong>å…¨å±€å”¯ä¸€æ˜¯æœ€åŸºæœ¬çš„è¦æ±‚</strong>ã€‚</p></blockquote><ul><li>è¶‹åŠ¿é€’å¢</li></ul><blockquote><p>åœ¨MySQLçš„InnoDBå¼•æ“ä¸­ä½¿ç”¨çš„æ˜¯èšé›†ç´¢å¼•ï¼Œç”±äºå¤šæ•°RDBMSä½¿ç”¨Btreeçš„æ•°æ®ç»“æ„æ¥å­˜å‚¨ç´¢å¼•æ•°æ®ï¼Œåœ¨ä¸»é”®çš„é€‰æ‹©ä¸Šé¢æˆ‘ä»¬åº”è¯¥å°½é‡ä½¿ç”¨æœ‰åºçš„ä¸»é”®æ¥ä¿è¯å†™å…¥æ€§èƒ½ã€‚</p></blockquote><ul><li>å•è°ƒé€’å¢</li></ul><blockquote><p>ä¿è¯ä¸‹ä¸€ä¸ªIDä¸€å®šå¤§äºä¸Šä¸€ä¸ªIDï¼Œä¾‹å¦‚äº‹åŠ¡ç‰ˆæœ¬å·ã€IMå¢é‡æ¶ˆæ¯ã€æ’åºç­‰ç‰¹æ®Šéœ€æ±‚ã€‚</p></blockquote><ul><li>ä¿¡æ¯å®‰å…¨</li></ul><blockquote><p>å¦‚æœIDæ˜¯è¿ç»­çš„ï¼Œé‚£ä¹ˆæ¶æ„ç”¨æˆ·çš„æ‰’å–å·¥ä½œå°±éå¸¸å®¹æ˜“åšäº†ï¼Œç›´æ¥æŒ‰ç…§é¡ºåºä¸‹è½½æŒ‡å®šURLå³å¯ï¼›</p><p>å¦‚æœæ˜¯è®¢å•å·é‚£ä¹ˆæ›´åŠ å±é™©ï¼Œç«äº‰å¯¹æ‰‹å¯ä»¥çŸ¥é“æˆ‘ä»¬ä¸€å¤©çš„å•é‡ã€‚</p><p>æ‰€ä»¥åœ¨ä¸€äº›åº”ç”¨åœºæ™¯ä¸‹ï¼Œéœ€è¦IDæ— è§„åˆ™ä¸è§„åˆ™ï¼Œè®©ç«äº‰å¯¹æ‰‹ä¸å¥½çŒœã€‚</p></blockquote><ul><li>å«æ—¶é—´æˆ³</li></ul><blockquote><p>è¿™æ ·å°±èƒ½åœ¨å¼€å‘ä¸­å¿«é€Ÿäº†è§£è¿™ä¸ªåˆ†å¸ƒå¼IDçš„ç”Ÿæˆæ—¶é—´ã€‚</p></blockquote><h3 id="1-3ã€IDç”Ÿæˆç³»ç»Ÿçš„å¯ç”¨æ€§è¦æ±‚"><a href="#1-3ã€IDç”Ÿæˆç³»ç»Ÿçš„å¯ç”¨æ€§è¦æ±‚" class="headerlink" title="1.3ã€IDç”Ÿæˆç³»ç»Ÿçš„å¯ç”¨æ€§è¦æ±‚"></a>1.3ã€IDç”Ÿæˆç³»ç»Ÿçš„å¯ç”¨æ€§è¦æ±‚</h3><ul><li>é«˜å¯ç”¨</li></ul><blockquote><p>å‘ä¸€ä¸ªè·å–åˆ†å¸ƒå¼IDçš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±è¦ä¿è¯99.999%çš„æƒ…å†µä¸‹ç»™æˆ‘åˆ›å»ºä¸€ä¸ªå”¯ä¸€åˆ†å¸ƒå¼ID</p></blockquote><ul><li>ä½å»¶è¿Ÿ</li></ul><blockquote><p>å‘ä¸€ä¸ªè·å–åˆ†å¸ƒå¼IDçš„è¯·æ±‚ï¼ŒæœåŠ¡å™¨å°±è¦å¿«ï¼Œæé€Ÿ</p></blockquote><ul><li>é«˜QPS</li></ul><blockquote><p>å‡å¦‚å¹¶å‘ä¸€å£æ°”10ä¸‡ä¸ªåˆ›å»ºåˆ†å¸ƒå¼IDè¯·æ±‚åŒæ—¶è¿‡æ¥ï¼ŒæœåŠ¡å™¨éœ€è¦é¡¶å¾—ä½ä¸”æˆåŠŸåˆ›å»º10ä¸‡ä¸ªåˆ†å¸ƒå¼ID</p></blockquote><h2 id="2ã€ä¸€èˆ¬é€šç”¨æ–¹æ¡ˆ"><a href="#2ã€ä¸€èˆ¬é€šç”¨æ–¹æ¡ˆ" class="headerlink" title="2ã€ä¸€èˆ¬é€šç”¨æ–¹æ¡ˆ"></a>2ã€ä¸€èˆ¬é€šç”¨æ–¹æ¡ˆ</h2><h3 id="2-1ã€UUID"><a href="#2-1ã€UUID" class="headerlink" title="2.1ã€UUID"></a>2.1ã€UUID</h3><ul><li>æ˜¯ä»€ä¹ˆï¼Ÿ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    String uuid = UUID.randomUUID().toString();</span><br><span class="line">    System.out.println(uuid);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210217110837.png" alt="image-20210217110837065"></p><blockquote><p>å¦‚æœåªæ˜¯è€ƒè™‘å”¯ä¸€æ€§ï¼Œé‚£ä¹ˆUUIDåŸºæœ¬å¯ä»¥æ»¡è¶³éœ€æ±‚ã€‚</p></blockquote><ul><li>ç¼ºç‚¹ï¼šå…¥æ•°æ®åº“æ€§èƒ½å·®ï¼ŒåŸå› å¦‚ä¸‹</li></ul><blockquote><p>1 æ— åºï¼Œæ— æ³•é¢„æµ‹ä»–çš„ç”Ÿæˆé¡ºåºï¼Œä¸èƒ½ç”Ÿæˆé€’å¢æœ‰åºçš„æ•°å­—</p><p>2 ä¸»é”®ï¼ŒIDä½œä¸ºä¸»é”®æ—¶åœ¨ç‰¹å®šçš„ç¯å¢ƒä¸‹ä¼šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œæ¯”å¦‚åšDBä¸»é”®çš„åœºæ™¯ä¸‹ï¼ŒUUIDéå¸¸ä¸é€‚ç”¨ï¼ŒMySQLå®˜æ–¹æœ‰æ˜ç¡®çš„å»ºè®®ä¸»é”®è¦å°½é‡è¶ŠçŸ­è¶Šå¥½ï¼Œ36ä½çš„UUIDä¸åˆè¦æ±‚ã€‚</p><p>3 ç´¢å¼•ï¼Œä¼šå¯¼è‡´B+æ ‘ç´¢å¼•çš„åˆ†è£‚ã€‚</p></blockquote><h3 id="2-2ã€æ•°æ®åº“è‡ªå¢ä¸»é”®"><a href="#2-2ã€æ•°æ®åº“è‡ªå¢ä¸»é”®" class="headerlink" title="2.2ã€æ•°æ®åº“è‡ªå¢ä¸»é”®"></a>2.2ã€æ•°æ®åº“è‡ªå¢ä¸»é”®</h3><blockquote><p>åœ¨é«˜å¹¶å‘é›†ç¾¤ä¸Šæ­¤ç­–ç•¥ä¸å¯ç”¨ã€‚</p></blockquote><h3 id="2-3ã€åŸºäºRedisç”Ÿæˆå…¨å±€IDç­–ç•¥"><a href="#2-3ã€åŸºäºRedisç”Ÿæˆå…¨å±€IDç­–ç•¥" class="headerlink" title="2.3ã€åŸºäºRedisç”Ÿæˆå…¨å±€IDç­–ç•¥"></a>2.3ã€åŸºäºRedisç”Ÿæˆå…¨å±€IDç­–ç•¥</h3><ul><li>å› ä¸ºRedisæ˜¯å•çº¿ç¨‹ï¼Œå¤©ç”Ÿä¿è¯åŸå­æ€§ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨INCRå’ŒINCRBYæ¥å®ç°ã€‚</li><li>é›†ç¾¤åˆ†å¸ƒå¼</li></ul><blockquote><p>åœ¨Redisé›†ç¾¤ä¸‹ï¼ŒåŒæ ·å’ŒMySQLä¸€æ ·éœ€è¦<strong>è®¾ç½®ä¸åŒçš„å¢é•¿æ­¥æ•°</strong>ï¼ŒåŒæ—¶keyéœ€è¦è®¾ç½®æœ‰æ•ˆæœŸã€‚</p><p>å¯ä»¥ä½¿ç”¨Redisé›†ç¾¤æ¥è·å–æ›´é«˜çš„ååé‡ã€‚</p><p>å‡å¦‚ä¸€ä¸ªé›†ç¾¤ä¸­æœ‰äº”ä¸ªRedisï¼Œé‚£ä¹ˆåˆå§‹åŒ–æ¯å°Redisæ­¥é•¿åˆ†åˆ«æ˜¯1ï¼Œ2ï¼Œ3ï¼Œ4ï¼Œ5ï¼Œç„¶åæ­¥é•¿éƒ½æ˜¯5ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210217113313.png" alt="image-20210217113312811"></p><h2 id="3ã€snowflake"><a href="#3ã€snowflake" class="headerlink" title="3ã€snowflake"></a>3ã€snowflake</h2><h3 id="3-1ã€æ¦‚è¿°"><a href="#3-1ã€æ¦‚è¿°" class="headerlink" title="3.1ã€æ¦‚è¿°"></a>3.1ã€æ¦‚è¿°</h3><ul><li><p>é›ªèŠ±ç®—æ³•æ˜¯æ¨ç‰¹çš„åˆ†å¸ƒå¼å”¯ä¸€IDç”Ÿæˆç®—æ³•ã€‚</p></li><li><p>ç»æµ‹è¯•é›ªèŠ±ç®—æ³•æ¯ç§’é’Ÿå¯ä»¥ç”Ÿäº§26ä¸‡ä¸ªè‡ªå¢å¯æ’åºçš„ID</p></li></ul><blockquote><p>1 æ¨ç‰¹çš„é›ªèŠ±ç®—æ³•ç”ŸæˆIDèƒ½å¤ŸæŒ‰ç…§æ—¶é—´æœ‰åºç”Ÿæˆã€‚</p><p>2 é›ªèŠ±ç®—æ³•ç”ŸæˆIDçš„ç»“æœæ˜¯ä¸€ä¸ª64bitå¤§å°çš„æ•´æ•°ï¼Œä¸ºä¸€ä¸ªLongå‹ï¼ˆè½¬æ¢ä¸ºå­—ç¬¦ä¸²åé•¿åº¦æœ€å¤š19ï¼‰</p><p>3 åˆ†å¸ƒå¼ç³»ç»Ÿå†…ä¸ä¼šäº§ç”ŸIDç¢°æ’ï¼ˆç”±datecenterå’ŒworkerIdä½œåŒºåˆ†ï¼‰ï¼Œå¹¶ä¸”æ•ˆç‡è¾ƒé«˜ã€‚</p></blockquote><ul><li>åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œæœ‰ä¸€äº›éœ€è¦ä½¿ç”¨å…¨å±€å”¯ä¸€IDçš„åœºæ™¯ï¼Œç”ŸæˆIDçš„åŸºæœ¬éœ€æ±‚</li></ul><blockquote><p>1 åˆ†å¸ƒå¼ç¯å¢ƒä¸‹å¿…é¡»å…¨å±€ä¸”å”¯ä¸€ã€‚</p><p>2 ä¸€èˆ¬éƒ½éœ€è¦å•è°ƒé€’å¢ï¼Œå› ä¸ºä¸€èˆ¬å”¯ä¸€IDéƒ½ä¼šå­˜åˆ°æ•°æ®åº“ï¼Œè€Œlnnodbçš„ç‰¹æ€§å°±æ˜¯å°†å†…å®¹å­˜å‚¨åœ¨ä¸»é”®ç´¢å¼•æ ‘ä¸Šçš„å¶å­èŠ‚ç‚¹ï¼Œè€Œä¸”æ˜¯ä»å·¦å¾€å³ï¼Œé€’å¢çš„ï¼Œæ‰€ä»¥è€ƒè™‘åˆ°æ•°æ®åº“æ€§èƒ½ï¼Œä¸€èˆ¬ç”Ÿæˆçš„idä¹Ÿæœ€å¥½æ˜¯å•è°ƒé€’å¢ã€‚ä¸ºäº†é˜²æ­¢IDå†²çªå¯ä»¥ä½¿ç”¨36ä½çš„UUIDï¼Œä½†æ˜¯UUIDæœ‰ä¸€äº›ç¼ºç‚¹ï¼Œé¦–å…ˆä»–ç›¸å¯¹æ¯”è¾ƒé•¿ï¼Œå¦å¤–UUIDèˆ¬æ˜¯æ— åºçš„ã€‚</p><p>3 å¯èƒ½è¿˜ä¼šéœ€è¦æ— è§„åˆ™ï¼Œå› ä¸ºå¦‚æœä½¿ç”¨å”¯ä¸€lDä½œä¸ºè®¢å•å·è¿™ç§ï¼Œä¸ºäº†ä¸ç„¶åˆ«äººçŸ¥é“ä¸€å¤©çš„è®¢å•é‡æ˜¯å¤šå°‘ï¼Œå°±éœ€è¦è¿™ä¸ªè§„åˆ™ã€‚</p></blockquote><h3 id="3-2ã€ç»“æ„"><a href="#3-2ã€ç»“æ„" class="headerlink" title="3.2ã€ç»“æ„"></a>3.2ã€ç»“æ„</h3><blockquote><p>é›ªèŠ±ç®—æ³•çš„å‡ ä¸ªæ ¸å¿ƒç»„æˆéƒ¨åˆ†</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210217114752.png" alt="image-20210217114752319"></p><blockquote><p>å·æ®µè§£æ</p></blockquote><ul><li><p>1bitç¬¦å·ä½ï¼šä¸ç”¨ï¼Œå› ä¸ºäºŒè¿›åˆ¶æœ€é«˜ä½æ˜¯ç¬¦å·ä½ï¼Œ1è¡¨ç¤ºè´Ÿæ•°ï¼Œ0è¡¨ç¤ºæ­£æ•°ï¼Œç”Ÿæˆçš„idä¸€èˆ¬éƒ½æ˜¯ç”¨æ­£æ•°ï¼Œæ‰€ä»¥æœ€é«˜ä½å›ºå®šä½0</p></li><li><p>41bitæ—¶é—´æˆ³ï¼Œç”¨äºè®°å½•æ—¶é—´æˆ³ï¼Œæ¯«ç§’çº§</p><ul><li>41ä½å¯ä»¥è¡¨ç¤º2^41 - 1ä¸ªæ•°å­—</li><li>å¦‚æœåªç”¨æ¥è¡¨ç¤ºæ­£æ•´æ•°ï¼ˆè®¡ç®—æœºæ­£æ•°åŒ…å«0ï¼‰ï¼Œå¯ä»¥è¡¨ç¤ºçš„æ•°å€¼èŒƒå›´æ˜¯0-2^41 - 1ï¼Œ<strong>å‡ä¸€æ˜¯å› ä¸ºå¯è¡¨ç¤ºçš„æ•°å€¼èŒƒå›´æ˜¯ä»0å¼€å§‹ç®—çš„ï¼Œè€Œä¸æ˜¯1</strong></li><li>ä¹Ÿå°±æ˜¯è¯´41ä½å¯ä»¥è¡¨ç¤º2^41 - 1ä¸ªæ¯«ç§’çš„å€¼ï¼Œè½¬æ¢ä¸ºå•ä½å¹´åˆ™æ˜¯69å¹´ã€‚</li></ul></li><li><p>10bitå·¥ä½œè¿›ç¨‹ä½ï¼Œç”¨äºè®°å½•å·¥ä½œæœºå™¨id</p><ul><li>å¯ä»¥éƒ¨ç½²åœ¨2^10 = 1024ä¸ªèŠ‚ç‚¹ï¼ŒåŒ…æ‹¬äº”ä½datacenterIdå’Œäº”ä½workerId</li><li>äº”ä½å¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ•´æ•°ä½2^5 - 1 = 31ï¼Œå³å¯ä»¥ä½¿ç”¨0ï¼Œ1ï¼Œ2â€¦31è¿™32ä¸ªæ•°å­—æ¥è¡¨ç¤ºä¸åŒçš„datacenterIdå’ŒworkerId</li></ul></li><li><p>12bitåºåˆ—å·ï¼Œåºåˆ—å·ï¼Œç”¨æ¥è®°å½•åŒ<strong>æ¯«ç§’å†…</strong> äº§ç”Ÿçš„ä¸åŒçš„ID</p><ul><li>12bitå¯ä»¥è¡¨ç¤ºçš„æœ€å¤§æ­£æ•´æ•°ä½2^12 - 1 = 4095ï¼Œå³å¯ä»¥è¡¨ç¤º0ï¼Œ1â€¦.4094è¿™4095ä¸ªæ•°å­—</li><li>è¡¨ç¤ºåŒä¸€æœºå™¨åŒä¸€æ—¶é—´æˆ³ï¼ˆæ¯«ç§’ï¼‰ä¸­äº§ç”Ÿçš„4095ä¸ªIDåºå·</li></ul></li></ul><blockquote><p>é›ªèŠ±ç®—æ³•å¯ä»¥ä¿è¯</p></blockquote><ul><li>æ‰€æœ‰ç”Ÿæˆçš„idæŒ‰æ—¶é—´è¶‹åŠ¿é€’å¢</li><li>æ•´ä¸ªåˆ†å¸ƒå¼å†…ä¸ä¼šäº§ç”Ÿé‡å¤idï¼Œå› ä¸ºæœ‰datacenterIdå’ŒworkerIdæ¥åšåŒºåˆ†ã€‚</li></ul><h3 id="3-3ã€æºç "><a href="#3-3ã€æºç " class="headerlink" title="3.3ã€æºç "></a>3.3ã€æºç </h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * twitterçš„snowflakeç®—æ³• -- javaå®ç°</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> beyond</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2016/11/26</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SnowFlake</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * èµ·å§‹çš„æ—¶é—´æˆ³</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> START_STMP = <span class="number">1480166465631L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯ä¸€éƒ¨åˆ†å ç”¨çš„ä½æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> SEQUENCE_BIT = <span class="number">12</span>; <span class="comment">//åºåˆ—å·å ç”¨çš„ä½æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MACHINE_BIT = <span class="number">5</span>;   <span class="comment">//æœºå™¨æ ‡è¯†å ç”¨çš„ä½æ•°</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> DATACENTER_BIT = <span class="number">5</span>;<span class="comment">//æ•°æ®ä¸­å¿ƒå ç”¨çš„ä½æ•°</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯ä¸€éƒ¨åˆ†çš„æœ€å¤§å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MAX_DATACENTER_NUM = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; DATACENTER_BIT);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MAX_MACHINE_NUM = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; MACHINE_BIT);</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MAX_SEQUENCE = -<span class="number">1L</span> ^ (-<span class="number">1L</span> &lt;&lt; SEQUENCE_BIT);</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯ä¸€éƒ¨åˆ†å‘å·¦çš„ä½ç§»</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> MACHINE_LEFT = SEQUENCE_BIT;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> DATACENTER_LEFT = SEQUENCE_BIT + MACHINE_BIT;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keyword">long</span> TIMESTMP_LEFT = DATACENTER_LEFT + DATACENTER_BIT;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> datacenterId;  <span class="comment">//æ•°æ®ä¸­å¿ƒ</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> machineId;     <span class="comment">//æœºå™¨æ ‡è¯†</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> sequence = <span class="number">0L</span>; <span class="comment">//åºåˆ—å·</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> lastStmp = -<span class="number">1L</span>;<span class="comment">//ä¸Šä¸€æ¬¡æ—¶é—´æˆ³</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SnowFlake</span><span class="params">(<span class="keyword">long</span> datacenterId, <span class="keyword">long</span> machineId)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (datacenterId &gt; MAX_DATACENTER_NUM || datacenterId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;datacenterId can&#x27;t be greater than MAX_DATACENTER_NUM or less than 0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (machineId &gt; MAX_MACHINE_NUM || machineId &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="string">&quot;machineId can&#x27;t be greater than MAX_MACHINE_NUM or less than 0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">this</span>.datacenterId = datacenterId;</span><br><span class="line">        <span class="keyword">this</span>.machineId = machineId;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * äº§ç”Ÿä¸‹ä¸€ä¸ªID</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">synchronized</span> <span class="keyword">long</span> <span class="title">nextId</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> currStmp = getNewstmp();</span><br><span class="line">        <span class="keyword">if</span> (currStmp &lt; lastStmp) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;Clock moved backwards.  Refusing to generate id&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (currStmp == lastStmp) &#123;</span><br><span class="line">            <span class="comment">//ç›¸åŒæ¯«ç§’å†…ï¼Œåºåˆ—å·è‡ªå¢</span></span><br><span class="line">            sequence = (sequence + <span class="number">1</span>) &amp; MAX_SEQUENCE;</span><br><span class="line">            <span class="comment">//åŒä¸€æ¯«ç§’çš„åºåˆ—æ•°å·²ç»è¾¾åˆ°æœ€å¤§</span></span><br><span class="line">            <span class="keyword">if</span> (sequence == <span class="number">0L</span>) &#123;</span><br><span class="line">                currStmp = getNextMill();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">//ä¸åŒæ¯«ç§’å†…ï¼Œåºåˆ—å·ç½®ä¸º0</span></span><br><span class="line">            sequence = <span class="number">0L</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        lastStmp = currStmp;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> (currStmp - START_STMP) &lt;&lt; TIMESTMP_LEFT <span class="comment">//æ—¶é—´æˆ³éƒ¨åˆ†</span></span><br><span class="line">                | datacenterId &lt;&lt; DATACENTER_LEFT       <span class="comment">//æ•°æ®ä¸­å¿ƒéƒ¨åˆ†</span></span><br><span class="line">                | machineId &lt;&lt; MACHINE_LEFT             <span class="comment">//æœºå™¨æ ‡è¯†éƒ¨åˆ†</span></span><br><span class="line">                | sequence;                             <span class="comment">//åºåˆ—å·éƒ¨åˆ†</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getNextMill</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">long</span> mill = getNewstmp();</span><br><span class="line">        <span class="keyword">while</span> (mill &lt;= lastStmp) &#123;</span><br><span class="line">            mill = getNewstmp();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> mill;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getNewstmp</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> System.currentTimeMillis();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SnowFlake snowFlake = <span class="keyword">new</span> SnowFlake(<span class="number">2</span>, <span class="number">3</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; (<span class="number">1</span> &lt;&lt; <span class="number">12</span>); i++) &#123;</span><br><span class="line">            System.out.println(snowFlake.nextId());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ï¼Œä½¿ç”¨é›ªèŠ±ç®—æ³•ç”Ÿæˆid</p></blockquote><ul><li>æ„é€ SnowFlakeå¯¹è±¡ï¼Œæ„é€ æ–¹æ³•ä¸­ä¼ å…¥ä¸€ä¸ªdatacenterIdå’ŒworkerId</li><li>ä½¿ç”¨SnowFlakeå¯¹è±¡çš„nextIdæ–¹æ³•ç”Ÿæˆå”¯ä¸€Id</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æµ‹è¯•ä½¿ç”¨é›ªèŠ±ç®—æ³•ç”ŸæˆID</span></span><br><span class="line"><span class="comment">//æ„é€ å‡½æ•°ä¸­ä¼ å…¥datacenterIdå’ŒworkerId</span></span><br><span class="line">SnowFlake snowFlake = <span class="keyword">new</span> SnowFlake(<span class="number">1</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">long</span> id = snowFlake.nextId();</span><br><span class="line">    System.out.println(<span class="string">&quot;idï¼š&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + String.valueOf(id).length() + <span class="string">&quot;ä½&quot;</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;------------------------------------------&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210217143342.png" alt="image-20210217143341390"></p><h3 id="3-4ã€Spring-Bootæ•´åˆé›ªèŠ±ç®—æ³•"><a href="#3-4ã€Spring-Bootæ•´åˆé›ªèŠ±ç®—æ³•" class="headerlink" title="3.4ã€Spring Bootæ•´åˆé›ªèŠ±ç®—æ³•"></a>3.4ã€Spring Bootæ•´åˆé›ªèŠ±ç®—æ³•</h3><blockquote><p>å¼•å…¥<strong>hutool-all</strong>ï¼Œmavenä¾èµ–å¼•å…¥å¦‚ä¸‹</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>cn.hutool<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>hutool-all<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>5.4.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2.1.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ä½¿ç”¨SnowFlakeå¯¹è±¡çš„nextIdæ–¹æ³•å³å¯ç”Ÿæˆå”¯ä¸€ID</p></blockquote><ul><li>åˆ›å»ºä¸€ä¸ªSnowFlakeé…ç½®ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SnowFlakeConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;application.datacenterId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long datacenterId;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;application.workerId&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long workerId;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ³¨å…¥ä¸€ä¸ªç”Ÿæˆé›ªèŠ±IDçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Snowflake <span class="title">snowflake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Snowflake(workerId,datacenterId);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ymlé…ç½®æ–‡ä»¶</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">application:</span></span><br><span class="line">  <span class="attr">datacenterId:</span> <span class="number">2</span></span><br><span class="line">  <span class="attr">workerId:</span> <span class="number">1</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7777</span></span><br></pre></td></tr></table></figure><ul><li>Serviceå±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> Snowflake snowflake;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getIdBySnowFlake</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> String.valueOf(snowflake.nextId());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Controllerå±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OrderService orderService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/snowflake&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">index</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> orderService.getIdBySnowFlake();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨ä¸»å¯åŠ¨ç±»ï¼Œè®¿é—®<a href="http://localhost:7777/snowflake">http://localhost:7777/snowflake</a></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210217151414.png" alt="image-20210217151414112"></p><h3 id="3-4ã€ä¼˜ç‚¹"><a href="#3-4ã€ä¼˜ç‚¹" class="headerlink" title="3.4ã€ä¼˜ç‚¹"></a>3.4ã€ä¼˜ç‚¹</h3><blockquote><ul><li>æ¯«ç§’æ•°åœ¨é«˜ä½ï¼Œè‡ªå¢åºåˆ—åœ¨ä½ä½ï¼Œæ•´ä¸ªIDéƒ½æ˜¯è¶‹åŠ¿é€’å¢çš„</li><li>ä¸ä¾èµ–æ•°æ®åº“ã€redisç­‰ç¬¬ä¸‰æ–¹ç³»ç»Ÿï¼Œä»¥æœåŠ¡çš„æ–¹å¼éƒ¨ç½²ï¼Œç¨³å®šæ€§æ›´é«˜ï¼Œç”ŸæˆIDçš„æ€§èƒ½ä¹Ÿæ˜¯éå¸¸é«˜çš„ã€‚</li><li>å¯ä»¥æ ¹æ®è‡ªèº«ä¸šåŠ¡åˆ†é…bitä½ï¼Œéå¸¸çµæ´»ã€‚</li></ul></blockquote><h3 id="3-5ã€ç¼ºç‚¹"><a href="#3-5ã€ç¼ºç‚¹" class="headerlink" title="3.5ã€ç¼ºç‚¹"></a>3.5ã€ç¼ºç‚¹</h3><blockquote><ul><li><strong>ä¾èµ–æœºå™¨æ—¶é’Ÿï¼Œå¦‚æœæœºå™¨æ—¶é’Ÿå›é€€ï¼Œä¼šå¯¼è‡´é‡å¤IDç”Ÿæˆ</strong></li><li>åœ¨å•æœºä¸Šæ˜¯é€’å¢çš„ï¼Œä½†æ˜¯ç”±äºè®¾è®¡åˆ°åˆ†å¸ƒå¼ç¯å¢ƒï¼Œæ¯å°æœºå™¨ä¸Šçš„æ—¶é’Ÿä¸å¯èƒ½å®Œå…¨åŒæ­¥ï¼Œæœ‰æ—¶å€™ä¼šå‡ºç°ä¸æ˜¯å…¨å±€é€’å¢çš„æƒ…å†µã€‚ï¼ˆæ­¤ç¼ºç‚¹å¯ä»¥è®¤ä¸ºèŠœé”èƒƒï¼Œä¸€èˆ¬åˆ†å¸ƒå¼IDåªè¦æ±‚è¶‹åŠ¿é€’å¢ï¼Œå¹¶ä¸ä¼šä¸¥æ ¼è¦æ±‚é€’å¢ï¼Œ90%çš„éœ€æ±‚éƒ½åªéœ€è¦è¶‹åŠ¿é€’å¢ï¼‰</li></ul></blockquote><h2 id="4ã€å…¶ä»–è¡¥å……"><a href="#4ã€å…¶ä»–è¡¥å……" class="headerlink" title="4ã€å…¶ä»–è¡¥å……"></a>4ã€å…¶ä»–è¡¥å……</h2><blockquote><p>é›ªèŠ±ç®—æ³•çš„æ”¹è¿›æ–¹æ¡ˆï¼š</p></blockquote><ul><li>ç™¾åº¦å¼€æºçš„åˆ†å¸ƒå¼å”¯ä¸€IDç”Ÿæˆå™¨UidGenerator</li><li>Leafâ€“ç¾å›¢ç‚¹è¯„åˆ†å¸ƒå¼IDç”Ÿæˆç³»ç»Ÿ</li></ul>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> â„é›ªèŠ±ç®—æ³• </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudå­¦ä¹ ï¼ˆäº”ï¼‰-NacosæœåŠ¡æ³¨å†Œä¸é…ç½®ä¸­å¿ƒ</title>
      <link href="posts/87309235.html"/>
      <url>posts/87309235.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€Nacosç®€ä»‹"><a href="#ä¸€ã€Nacosç®€ä»‹" class="headerlink" title="ä¸€ã€Nacosç®€ä»‹"></a>ä¸€ã€Nacosç®€ä»‹</h1><h2 id="1-1ã€ä¸ºä»€ä¹ˆå«Nacosï¼Ÿ"><a href="#1-1ã€ä¸ºä»€ä¹ˆå«Nacosï¼Ÿ" class="headerlink" title="1.1ã€ä¸ºä»€ä¹ˆå«Nacosï¼Ÿ"></a>1.1ã€ä¸ºä»€ä¹ˆå«Nacosï¼Ÿ</h2><blockquote><p>å‰å››ä¸ªå­—æ¯åˆ†åˆ«ä¸ºNamingå’ŒConfigurationçš„å‰ä¸¤ä¸ªå­—æ¯ï¼Œæœ€åçš„sä¸ºServiceã€‚</p></blockquote><h2 id="1-2ã€æ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-2ã€æ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.2ã€æ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.2ã€æ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><p>ä¸€ä¸ªæ›´æ˜“äºæ„å»ºäº‘åŸç”Ÿåº”ç”¨çš„åŠ¨æ€æœåŠ¡å‘ç°ï¼Œé…ç½®ç®¡ç†å’ŒæœåŠ¡ç®¡ç†ä¸­å¿ƒ</p><p><strong>Nacos</strong>å°±æ˜¯<strong>æ³¨å†Œä¸­å¿ƒ</strong>+<strong>é…ç½®ä¸­å¿ƒ</strong>çš„ç»„åˆ</p></blockquote><h2 id="1-3ã€èƒ½å¹²å˜›ï¼Ÿ"><a href="#1-3ã€èƒ½å¹²å˜›ï¼Ÿ" class="headerlink" title="1.3ã€èƒ½å¹²å˜›ï¼Ÿ"></a>1.3ã€èƒ½å¹²å˜›ï¼Ÿ</h2><blockquote><p>æ›¿ä»£EurekaåšæœåŠ¡æ³¨å†Œä¸­å¿ƒ</p><p>æ›¿ä»£Configåšå¾®æœåŠ¡é…ç½®ä¸­å¿ƒ</p></blockquote><h1 id="äºŒã€å®‰è£…å¹¶è¿è¡ŒNacos"><a href="#äºŒã€å®‰è£…å¹¶è¿è¡ŒNacos" class="headerlink" title="äºŒã€å®‰è£…å¹¶è¿è¡ŒNacos"></a>äºŒã€å®‰è£…å¹¶è¿è¡ŒNacos</h1><blockquote><p>è¿›å…¥Nacosçš„å®˜ç½‘ä¸‹è½½ï¼Œåœ°å€ï¼š<a href="http://nacos.io/">http://nacos.io</a></p></blockquote><ul><li>å¯åŠ¨ï¼Œæ‰“å¼€nacos/binï¼Œwindowsç¯å¢ƒä¸‹ç‚¹å‡»startup.cmdå¯åŠ¨nacos</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215154748.png" alt="image-20210215154741130"></p><ul><li>å¯åŠ¨åè®¿é—®localhost:8848/nacoså¯åŠ¨nacos</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215154854.png" alt="image-20210215154854073"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215154937.png" alt="image-20210215154937350"></p><ul><li>ç™»å½•åé¡µé¢å¦‚ä¸‹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215155000.png" alt="image-20210215155000197"></p><h1 id="ä¸‰ã€Nacosä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒæ¼”ç¤º"><a href="#ä¸‰ã€Nacosä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒæ¼”ç¤º" class="headerlink" title="ä¸‰ã€Nacosä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒæ¼”ç¤º"></a>ä¸‰ã€Nacosä½œä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒæ¼”ç¤º</h1><h2 id="3-1ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æä¾›è€…"><a href="#3-1ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æä¾›è€…" class="headerlink" title="3.1ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æä¾›è€…"></a>3.1ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æä¾›è€…</h2><h3 id="1ã€æ–°å»ºModule"><a href="#1ã€æ–°å»ºModule" class="headerlink" title="1ã€æ–°å»ºModule"></a>1ã€æ–°å»ºModule</h3><blockquote><p>æ–°å»ºcloudalibaba-provider-payment9001</p></blockquote><h3 id="2ã€å¼•å…¥ä¾èµ–"><a href="#2ã€å¼•å…¥ä¾èµ–" class="headerlink" title="2ã€å¼•å…¥ä¾èµ–"></a>2ã€å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.0.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.62<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"><a href="#3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶" class="headerlink" title="3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"></a>3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9001</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-payment-provider</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span> <span class="comment">#é…ç½®Nacosåœ°å€</span></span><br><span class="line"><span class="attr">management:</span></span><br><span class="line">  <span class="attr">endpoints:</span></span><br><span class="line">    <span class="attr">web:</span></span><br><span class="line">      <span class="attr">exposure:</span></span><br><span class="line">        <span class="attr">include:</span> <span class="string">&#x27;*&#x27;</span></span><br></pre></td></tr></table></figure><h3 id="4ã€ä¸»å¯åŠ¨ç±»"><a href="#4ã€ä¸»å¯åŠ¨ç±»" class="headerlink" title="4ã€ä¸»å¯åŠ¨ç±»"></a>4ã€ä¸»å¯åŠ¨ç±»</h3><blockquote><p>åœ¨éœ€è¦æ³¨å†Œå…¥æ³¨å†Œä¸­å¿ƒçš„æ¨¡å—ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableDiscoveryClientæ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentMain9001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(PaymentMain9001.class,args);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost:8848/nacos&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€ä¸šåŠ¡ç±»"><a href="#5ã€ä¸šåŠ¡ç±»" class="headerlink" title="5ã€ä¸šåŠ¡ç±»"></a>5ã€ä¸šåŠ¡ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/payment/nacos/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getPayment</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;nacos registry, serverPort: &quot;</span>+ serverPort+<span class="string">&quot;\t id&quot;</span>+id;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€å¯åŠ¨9001å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°"><a href="#6ã€å¯åŠ¨9001å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°" class="headerlink" title="6ã€å¯åŠ¨9001å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°"></a>6ã€å¯åŠ¨9001å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215161607.png" alt="image-20210215161605817"></p><h3 id="7ã€ä»¿ç…§9001åˆ›å»º9002å¾®æœåŠ¡ï¼Œå¯åŠ¨æŸ¥çœ‹ç»“æœ"><a href="#7ã€ä»¿ç…§9001åˆ›å»º9002å¾®æœåŠ¡ï¼Œå¯åŠ¨æŸ¥çœ‹ç»“æœ" class="headerlink" title="7ã€ä»¿ç…§9001åˆ›å»º9002å¾®æœåŠ¡ï¼Œå¯åŠ¨æŸ¥çœ‹ç»“æœ"></a>7ã€ä»¿ç…§9001åˆ›å»º9002å¾®æœåŠ¡ï¼Œå¯åŠ¨æŸ¥çœ‹ç»“æœ</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215162714.png" alt="image-20210215162714116"></p><h2 id="3-2ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…"><a href="#3-2ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…" class="headerlink" title="3.2ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…"></a>3.2ã€åˆ›å»ºåŸºäºNacosçš„æœåŠ¡æ¶ˆè´¹è€…</h2><h3 id="1ã€æ–°å»ºModule-1"><a href="#1ã€æ–°å»ºModule-1" class="headerlink" title="1ã€æ–°å»ºModule"></a>1ã€æ–°å»ºModule</h3><blockquote><p>æ–°å»ºcloudalibaba-consumer-nacos-order83</p></blockquote><h3 id="2ã€å¼•å…¥ä¾èµ–-1"><a href="#2ã€å¼•å…¥ä¾èµ–-1" class="headerlink" title="2ã€å¼•å…¥ä¾èµ–"></a>2ã€å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--SpringCloud ailibaba nacos --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºä»€ä¹ˆNacosæ”¯æŒè´Ÿè½½å‡è¡¡?</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215164039.png" alt="image-20210215164039536"></p><h3 id="3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶-1"><a href="#3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶-1" class="headerlink" title="3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"></a>3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">83</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-order-consumer</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line"><span class="comment"># æ¶ˆè´¹è€…è¦è®¿é—®çš„æœåŠ¡æä¾›è€…ã€‚</span></span><br><span class="line"><span class="attr">service-url:</span></span><br><span class="line">  <span class="attr">nacos-user-service:</span> <span class="string">http://nacos-payment-provider</span></span><br></pre></td></tr></table></figure><h3 id="4ã€ä¸»å¯åŠ¨ç±»-1"><a href="#4ã€ä¸»å¯åŠ¨ç±»-1" class="headerlink" title="4ã€ä¸»å¯åŠ¨ç±»"></a>4ã€ä¸»å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderNacosMain83</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(OrderNacosMain83.class,args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€ä¸šåŠ¡ç±»-1"><a href="#5ã€ä¸šåŠ¡ç±»-1" class="headerlink" title="5ã€ä¸šåŠ¡ç±»"></a>5ã€ä¸šåŠ¡ç±»</h3><blockquote><p>OrderNacosController</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderNacosController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> RestTemplate restTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;service-url.nacos-user-service&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverURL;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(value = &quot;/consumer/payment/nacos/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> restTemplate.getForObject(serverURL+<span class="string">&quot;/payment/nacos/&quot;</span>+id,String.class);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ApplicationContextConfig</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApplicationContextConfig</span></span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@LoadBalanced</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RestTemplate <span class="title">getRestTemplate</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> RestTemplate();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€å¯åŠ¨83å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°"><a href="#6ã€å¯åŠ¨83å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°" class="headerlink" title="6ã€å¯åŠ¨83å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°"></a>6ã€å¯åŠ¨83å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹nacosæ§åˆ¶å°</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215165717.png" alt="image-20210215165716365"></p><h3 id="7ã€ä½¿ç”¨83æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›æ–¹"><a href="#7ã€ä½¿ç”¨83æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›æ–¹" class="headerlink" title="7ã€ä½¿ç”¨83æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›æ–¹"></a>7ã€ä½¿ç”¨83æ¶ˆè´¹è€…è°ƒç”¨æœåŠ¡æä¾›æ–¹</h3><blockquote><p>è®¿é—®<a href="http://localhost:83/consumer/payment/nacos/13">http://localhost:83/consumer/payment/nacos/13</a></p></blockquote><ul><li>ç¬¬ä¸€æ¬¡</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215165922.png" alt="image-20210215165922630"></p><ul><li>ç¬¬äºŒæ¬¡</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215165950.png" alt="image-20210215165950241"></p><blockquote><p>è¿™æ ·å°±å®ç°äº†è´Ÿè½½å‡è¡¡å’Œè¿œç¨‹è°ƒç”¨</p></blockquote><h2 id="3-3ã€å„ç§æœåŠ¡æ³¨å†Œä¸­å¿ƒå¯¹æ¯”"><a href="#3-3ã€å„ç§æœåŠ¡æ³¨å†Œä¸­å¿ƒå¯¹æ¯”" class="headerlink" title="3.3ã€å„ç§æœåŠ¡æ³¨å†Œä¸­å¿ƒå¯¹æ¯”"></a>3.3ã€å„ç§æœåŠ¡æ³¨å†Œä¸­å¿ƒå¯¹æ¯”</h2><h3 id="1ã€Nacoså…¨æ™¯å›¾"><a href="#1ã€Nacoså…¨æ™¯å›¾" class="headerlink" title="1ã€Nacoså…¨æ™¯å›¾"></a>1ã€Nacoså…¨æ™¯å›¾</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215171620.png" alt="img"></p><h3 id="2ã€Nacoså’ŒCAP"><a href="#2ã€Nacoså’ŒCAP" class="headerlink" title="2ã€Nacoså’ŒCAP"></a>2ã€Nacoså’ŒCAP</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215171729.png" alt="image-20210215171729262"></p><h1 id="å››ã€Nacosä½œä¸ºæœåŠ¡é…ç½®ä¸­å¿ƒæ¼”ç¤º"><a href="#å››ã€Nacosä½œä¸ºæœåŠ¡é…ç½®ä¸­å¿ƒæ¼”ç¤º" class="headerlink" title="å››ã€Nacosä½œä¸ºæœåŠ¡é…ç½®ä¸­å¿ƒæ¼”ç¤º"></a>å››ã€Nacosä½œä¸ºæœåŠ¡é…ç½®ä¸­å¿ƒæ¼”ç¤º</h1><h2 id="4-1ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åŸºç¡€é…ç½®"><a href="#4-1ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åŸºç¡€é…ç½®" class="headerlink" title="4.1ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åŸºç¡€é…ç½®"></a>4.1ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åŸºç¡€é…ç½®</h2><h3 id="1ã€æ–°å»ºModule-2"><a href="#1ã€æ–°å»ºModule-2" class="headerlink" title="1ã€æ–°å»ºModule"></a>1ã€æ–°å»ºModule</h3><blockquote><p>åˆ›å»ºå¾®æœåŠ¡æ¨¡å—ï¼šcloudalibaba-config-nacos-client3377</p></blockquote><h3 id="2ã€å¼•å…¥ä¾èµ–-2"><a href="#2ã€å¼•å…¥ä¾èµ–-2" class="headerlink" title="2ã€å¼•å…¥ä¾èµ–"></a>2ã€å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-config<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-devtools --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.projectlombok/lombok --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-test --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶-2"><a href="#3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶-2" class="headerlink" title="3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"></a>3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶</h3><blockquote><p>bootstrap.yml</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># nacosé…ç½®</span></span><br><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">3377</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">nacos-config-client</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="comment"># NacosæœåŠ¡æ³¨å†Œä¸­å¿ƒåœ°å€</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">        <span class="comment"># æŒ‡å®šNacosé…ç½®ä¸­å¿ƒçš„åœ°å€</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">server-addr:</span> <span class="string">localhost:8848</span></span><br><span class="line">        <span class="attr">file-extension:</span> <span class="string">yaml</span> <span class="comment"># æŒ‡å®šyamlæ ¼å¼çš„é…ç½®</span></span><br></pre></td></tr></table></figure><blockquote><p>application.yml</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºå¼€å‘ç¯å¢ƒ</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸ºä½•ç¼–å†™ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼Ÿ</p><p>NacosåŒSpring Cloud Configä¸€è‡´ï¼Œåœ¨é¡¹ç›®åˆå§‹åŒ–æ—¶ï¼Œè¦ä¿è¯å…ˆä»é…ç½®ä¸­å¿ƒè¿›è¡Œé…ç½®æ‹‰å–ï¼Œæ‹‰å–é…ç½®åï¼Œæ‰èƒ½ä¿è¯é¡¹ç›®çš„æ­£å¸¸å¯åŠ¨ã€‚</p><p>Spring Bootä¸­é…ç½®æ–‡ä»¶çš„åŠ è½½æ˜¯å­˜åœ¨ä¼˜å…ˆçº§é¡ºåºçš„ï¼Œ<strong>bootstrapï¼ˆå…¨å±€ï¼‰ä¼˜å…ˆçº§é«˜äºapplicationï¼ˆè‡ªå®šä¹‰ï¼‰</strong></p></blockquote><h3 id="4ã€ä¸»å¯åŠ¨ç±»-2"><a href="#4ã€ä¸»å¯åŠ¨ç±»-2" class="headerlink" title="4ã€ä¸»å¯åŠ¨ç±»"></a>4ã€ä¸»å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">NacosConfigClientMain3377</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(NacosConfigClientMain3377.class, args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€ä¸šåŠ¡ç±»-2"><a href="#5ã€ä¸šåŠ¡ç±»-2" class="headerlink" title="5ã€ä¸šåŠ¡ç±»"></a>5ã€ä¸šåŠ¡ç±»</h3><blockquote><p>@RefreshScopeæ³¨è§£ç”¨äºåŠ¨æ€åˆ·æ–°ï¼Œä½œç”¨åœ¨Controllerå±‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Value;</span><br><span class="line"><span class="keyword">import</span> org.springframework.cloud.context.config.annotation.RefreshScope;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.GetMapping;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.RestController;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RefreshScope</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConfigClientController</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line"><span class="meta">@Value(&quot;$&#123;config.info&#125;&quot;)</span></span><br><span class="line"><span class="keyword">private</span> String configInfo;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/config/info&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getConfigInfo</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> configInfo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€Nacosçš„é…ç½®è§„åˆ™"><a href="#6ã€Nacosçš„é…ç½®è§„åˆ™" class="headerlink" title="6ã€Nacosçš„é…ç½®è§„åˆ™"></a>6ã€Nacosçš„é…ç½®è§„åˆ™</h3><ul><li>ç†è®ºï¼šNacosä¸­çš„dataidçš„ç»„æˆæ ¼å¼ä¸SpringBooté…ç½®æ–‡ä»¶ä¸­çš„åŒ¹é…è§„åˆ™</li></ul><blockquote><p>è¯´æ˜ï¼šä¹‹æ‰€ä»¥è¦é…ç½®<em>spring.application.name</em> ï¼Œç¤ºéŸ³ä¸ºå®ƒæ˜¯æ„æˆNacosé…ç½®ç®¡ç†<em>dataId</em>å­—æ®µçš„ä¸€éƒ¨åˆ†ã€‚</p><p>åœ¨Nacos Spring Cloudä¸­ï¼ŒdataIdçš„å®Œæ•´æ ¼å¼å¦‚ä¸‹</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;prefix&#125;-$&#123;spring.profile.active&#125;.$&#123;file-extension&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>prefix</strong> é»˜è®¤ä¸º <strong>spring.application.name</strong> çš„å€¼ï¼Œä¹Ÿå¯ä»¥é€šè¿‡é…ç½®é¡¹ <strong>spring.cloud.nacos.config.prefix</strong> æ¥é…ç½®ã€‚</li><li><strong>spring.profile.active</strong> å³ä¸ºå½“å‰ç¯å¢ƒå¯¹äºçš„profileï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒ <a href="https://www.docs4dev.com/docs/zh/spring-boot/2.1.1.RELEASE/reference">Spring Bootæ–‡æ¡£</a> æ³¨æ„ï¼šå½“<strong>spring.profile.active</strong> ä¸ºç©ºæ—¶ï¼Œå¯¹åº”çš„ <strong>-</strong> ä¹Ÿå°†ä¸å­˜åœ¨ï¼Œæ­¤æ—¶dataIdçš„æ‹¼æ¥æ ¼å¼å˜ä¸º <strong>${prefix}-${file-extension}</strong> ï¼Œ<strong>file-extension</strong> ä¸ºé…ç½®å†…å®¹çš„æ•°æ®æ ¼å¼ï¼Œå¯ä»¥é€šè¿‡é…ç½®é¡¹ <strong>spring.cloud.nacos.config.file-extension</strong> æ¥é…ç½®ï¼Œç›®å‰åªæ”¯æŒ<strong>properties</strong>  å’Œ <strong>yaml</strong> ç±»å‹ã€‚</li><li>é€šè¿‡Spring CloudåŸç”Ÿæ³¨è§£ <strong>@RefreshScope</strong> å®ç°é…ç½®è‡ªåŠ¨æ›´æ–°ã€‚</li></ul><blockquote><p>æœ€åå…¬å¼ä¸ºï¼š</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;spring.application.name&#125;-$&#123;spring.profile.active&#125;.$&#123;file-extension&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ ¹æ®ä¸Šé¢çš„å…¬å¼ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°cloudalibaba-config-nacos-client3377å¾®æœåŠ¡é…ç½®çš„dataIdä¸ºï¼š<strong>nacos-config-client-dev.yaml</strong></p></blockquote><h3 id="7ã€å®æ“"><a href="#7ã€å®æ“" class="headerlink" title="7ã€å®æ“"></a>7ã€å®æ“</h3><blockquote><p>åœ¨nacosæ§åˆ¶å°ä¸­é€‰æ‹©<strong>é…ç½®ç®¡ç†</strong>-<strong>é…ç½®åˆ—è¡¨</strong>ï¼Œç‚¹å‡»â€œ+â€å·æ·»åŠ é…ç½®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215203233.png" alt="image-20210215203231682"></p><blockquote><p>æ·»åŠ çš„é…ç½®å¦‚ä¸‹ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215203636.png" alt="image-20210215203636355"></p><h3 id="8ã€æµ‹è¯•"><a href="#8ã€æµ‹è¯•" class="headerlink" title="8ã€æµ‹è¯•"></a>8ã€æµ‹è¯•</h3><blockquote><p>è¿è¡Œcloudalibaba-config-nacos-client3377å¾®æœåŠ¡ï¼Œè°ƒç”¨æ¥å£æŸ¥çœ‹é…ç½®ä¿¡æ¯ï¼Œæ¥å£åœ°å€ä¸ºï¼š<a href="http://localhost:3377/config/info">http://localhost:3377/config/info</a></p></blockquote><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215205027.png" alt="image-20210215205027075"></p><h3 id="9ã€é…ç½®çš„åŠ¨æ€åˆ·æ–°"><a href="#9ã€é…ç½®çš„åŠ¨æ€åˆ·æ–°" class="headerlink" title="9ã€é…ç½®çš„åŠ¨æ€åˆ·æ–°"></a>9ã€é…ç½®çš„åŠ¨æ€åˆ·æ–°</h3><blockquote><p>ä¿®æ”¹ä¸‹Nacosä¸­çš„yamlé…ç½®æ–‡ä»¶ï¼Œå†æ¬¡è°ƒç”¨æŸ¥çœ‹é…ç½®çš„ç«¯å£ï¼Œå°±ä¼šå‘ç°é…ç½®å·²ç»åˆ·æ–°ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215210048.png" alt="image-20210215210048752"></p><blockquote><p>é‡æ–°è°ƒç”¨æŸ¥çœ‹é…ç½®çš„æ¥å£ï¼ŒæŸ¥çœ‹é…ç½®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215210140.png" alt="image-20210215210140349"></p><h2 id="4-2ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åˆ†ç±»é…ç½®"><a href="#4-2ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åˆ†ç±»é…ç½®" class="headerlink" title="4.2ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åˆ†ç±»é…ç½®"></a>4.2ã€Nacosä½œä¸ºé…ç½®ä¸­å¿ƒâ€“åˆ†ç±»é…ç½®</h2><h3 id="1ã€é—®é¢˜ä¸€"><a href="#1ã€é—®é¢˜ä¸€" class="headerlink" title="1ã€é—®é¢˜ä¸€"></a>1ã€é—®é¢˜ä¸€</h3><blockquote><p>å®é™…å¼€å‘ä¸­ï¼Œé€šå¸¸ä¸€ä¸ªç³»ç»Ÿä¼šå‡†å¤‡</p><ul><li>devå¼€å‘ç¯å¢ƒ</li><li>testæµ‹è¯•ç¯å¢ƒ</li><li>prodç”Ÿäº§ç¯å¢ƒ</li></ul><p>å¦‚ä½•ä¿è¯æŒ‡å®šç¯å¢ƒå¯åŠ¨æ—¶æœåŠ¡èƒ½æ­£ç¡®è¯»å–åˆ°Nacosä¸Šç›¸åº”ç¯å¢ƒçš„é…ç½®æ–‡ä»¶å‘¢ï¼Ÿ</p></blockquote><h3 id="2ã€é—®é¢˜äºŒ"><a href="#2ã€é—®é¢˜äºŒ" class="headerlink" title="2ã€é—®é¢˜äºŒ"></a>2ã€é—®é¢˜äºŒ</h3><blockquote><p>ä¸€ä¸ªå¤§å‹åˆ†å¸ƒå¼å¾®æœåŠ¡ç³»ç»Ÿä¼šæœ‰å¾ˆå¤šä¸ªå¾®æœåŠ¡å­é¡¹ç›®</p><p>æ¯ä¸ªå¾®æœåŠ¡åˆæœ‰å¯¹åº”çš„å¼€å‘ç¯å¢ƒã€é¢„å‘ç¯å¢ƒã€æµ‹è¯•ç¯å¢ƒã€æ­£å¼ç¯å¢ƒâ€¦</p><p>é‚£ä¹ˆåˆæ€ä¹ˆå¯¹è¿™äº›é…ç½®è¿›è¡Œå¤„ç†å‘¢ï¼Ÿ</p></blockquote><h3 id="3ã€ä»€ä¹ˆæ˜¯åˆ†ç±»é…ç½®ï¼Ÿ"><a href="#3ã€ä»€ä¹ˆæ˜¯åˆ†ç±»é…ç½®ï¼Ÿ" class="headerlink" title="3ã€ä»€ä¹ˆæ˜¯åˆ†ç±»é…ç½®ï¼Ÿ"></a>3ã€ä»€ä¹ˆæ˜¯åˆ†ç±»é…ç½®ï¼Ÿ</h3><blockquote><p>ç±»ä¼¼Javaä¸­çš„package + ç±»å</p><p>æœ€å¤–å±‚çš„namespaceç”¨äºåŒºåˆ«éƒ¨ç½²ç¯å¢ƒï¼ŒGroupå’ŒDataIdä»é€»è¾‘ä¸ŠåŒºåˆ†ä¸¤ä¸ªå¯¹è±¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215212745.png" alt="image-20210215212745121"></p><blockquote><p>é»˜è®¤æƒ…å†µä¸‹</p></blockquote><ul><li>Namespace=public</li><li>Group=DEFAULT_GROUP</li></ul><blockquote><p>Nacosé»˜è®¤çš„å‘½åç©ºé—´ä¸ºpublicï¼ŒNamespaceä¸»è¦ç”¨æ¥éš”ç¦»ï¼Œæ¯”å¦‚è¯´æˆ‘ä»¬æœ‰ä¸‰ä¸ªï¼ˆç”Ÿäº§ã€å¼€å‘ã€æµ‹è¯•ï¼‰ç¯å¢ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºä¸‰ä¸ªNamespaceï¼Œä¸åŒçš„Namespaceä¹‹é—´æ˜¯éš”ç¦»çš„ã€‚</p><p>Groupé»˜è®¤æ˜¯DEFAULT_GROUPï¼ŒGroupå¯ä»¥æŠŠä¸åŒå¾®æœåŠ¡åˆ’åˆ†åˆ°ä¸€ä¸ªåˆ†ç»„ä¸­ã€‚</p><p>Serviceå°±æ˜¯å¾®æœåŠ¡ï¼Œä¸€ä¸ªServiceå¯ä»¥åŒ…æ‹¬å¤šä¸ªClusterï¼ˆé›†ç¾¤ï¼‰ï¼ŒNacosé»˜è®¤Clusteræ˜¯Defaultï¼ŒClusteræ˜¯å¯¹æŒ‡å®šå¾®æœåŠ¡çš„ä¸€ä¸ªè™šæ‹Ÿåˆ’åˆ†ã€‚</p><p>æ¯”å¦‚è¯´ä¸ºäº†å®¹ç¾ï¼Œå°†Serviceå¾®æœåŠ¡åˆ†åˆ«éƒ¨ç½²åœ¨äº†æ­å·æœºæˆ¿å’Œå¹¿å·æœºæˆ¿ï¼Œè¿™ä¸ªæ—¶å€™ç»™æ­å·æœºæˆ¿çš„Serviceå¾®æœåŠ¡èµ·ä¸€ä¸ªé›†ç¾¤åç§°ï¼ˆHZï¼‰ï¼Œç»™å¹¿å·è®¡æ–¹çš„Serviceå¾®æœåŠ¡èµ·ä¸€ä¸ªé›†ç¾¤åç§°ï¼ˆGZï¼‰ï¼Œè¿˜å¯ä»¥å°½é‡è®©åŒä¸€ä¸ªæœºæˆ¿ä¸­çš„å¾®æœåŠ¡ç›¸äº’è°ƒç”¨ï¼Œæå‡æ€§èƒ½ã€‚</p><p>Instanceï¼šå¾®æœåŠ¡å®ä¾‹</p></blockquote><h3 id="4ã€é€šè¿‡DataIdè¯»å–ä¸åŒé…ç½®"><a href="#4ã€é€šè¿‡DataIdè¯»å–ä¸åŒé…ç½®" class="headerlink" title="4ã€é€šè¿‡DataIdè¯»å–ä¸åŒé…ç½®"></a>4ã€é€šè¿‡DataIdè¯»å–ä¸åŒé…ç½®</h3><blockquote><p>é»˜è®¤ç©ºé—´+é»˜è®¤åˆ†ç»„+æ–°å»ºdevå’Œtestä¸¤ä¸ªDataId</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215233720.png" alt="image-20210215233719100"></p><ul><li>ä¿®æ”¹3377å¾®æœåŠ¡çš„application.ymlé…ç½®æ–‡ä»¶ï¼ŒæŒ‡å®šè®°è½½ç¯å¢ƒ</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="comment"># é…ç½®ä»€ä¹ˆç¯å¢ƒå°±åŠ è½½ä»€ä¹ˆé…ç½®</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">test</span></span><br><span class="line">  <span class="comment"># è¡¨ç¤ºå¼€å‘ç¯å¢ƒ</span></span><br><span class="line">    <span class="comment"># active: dev</span></span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶è¯»å–çš„é…ç½®çš„DataIdä¸º <strong>nacos-config-client-test.yaml</strong> ï¼Œé…ç½®ä¸º</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215234528.png" alt="image-20210215234528455"></p><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215234506.png" alt="image-20210215234506773"></p><h3 id="5ã€é€šè¿‡Groupè¯»å–ä¸åŒé…ç½®"><a href="#5ã€é€šè¿‡Groupè¯»å–ä¸åŒé…ç½®" class="headerlink" title="5ã€é€šè¿‡Groupè¯»å–ä¸åŒé…ç½®"></a>5ã€é€šè¿‡Groupè¯»å–ä¸åŒé…ç½®</h3><blockquote><p>æ–°å»ºä¸€ä¸ªå¼€å‘ç»„DEV_GROUP</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210215235657.png" alt="image-20210215235657328"></p><blockquote><p>æ–°å»ºä¸€ä¸ªæµ‹è¯•ç»„TEST_GROUP</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216000114.png" alt="image-20210216000114864"></p><blockquote><p>æ­¤æ—¶é…ç½®åˆ—è¡¨å¦‚ä¸‹ï¼Œä¸¤ä¸ªä¸åŒç»„æœ‰ç›¸åŒDataIdçš„é…ç½®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216000529.png" alt="image-20210216000529294"></p><blockquote><p>åœ¨bootstrap.ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ ä¸€æ¡é…ç½®ï¼ŒæŒ‡å®šè¦åŠ è½½çš„é…ç½®ç»„</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment"># é…ç½®å“ªä¸ªç»„å°±åŠ è½½å“ªä¸ªç»„</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">TEST_GROUP</span></span><br></pre></td></tr></table></figure><blockquote><p>åŒæ—¶ä¿®æ”¹application.ymlé…ç½®æ–‡ä»¶ä¸­å¯åŠ¨çš„ç¯å¢ƒ</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="comment"># é…ç½®ä»€ä¹ˆç¯å¢ƒå°±åŠ è½½ä»€ä¹ˆé…ç½®</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">info</span></span><br><span class="line">  <span class="comment"># è¡¨ç¤ºå¼€å‘ç¯å¢ƒ</span></span><br><span class="line">    <span class="comment"># active: dev</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯3377ï¼Œè®¿é—®<a href="http://localhost:3377/config/info">http://localhost:3377/config/info</a> ï¼Œç»“æœå¦‚ä¸‹</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216001128.png" alt="image-20210216001128542"></p><blockquote><p>ä¿®æ”¹bootstrap.ymlé…ç½®æ–‡ä»¶ï¼Œé‡å¯</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="comment"># é…ç½®å“ªä¸ªç»„å°±åŠ è½½å“ªä¸ªç»„</span></span><br><span class="line">        <span class="attr">group:</span> <span class="string">DEV_GROUP</span></span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœä¸ºï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216001326.png" alt="image-20210216001326298"></p><h3 id="6ã€é€šè¿‡Namespaceè¯»å–ä¸åŒé…ç½®"><a href="#6ã€é€šè¿‡Namespaceè¯»å–ä¸åŒé…ç½®" class="headerlink" title="6ã€é€šè¿‡Namespaceè¯»å–ä¸åŒé…ç½®"></a>6ã€é€šè¿‡Namespaceè¯»å–ä¸åŒé…ç½®</h3><blockquote><p>é»˜è®¤çš„namespaceä¸èƒ½åˆ é™¤ï¼Œæ–°å»ºDEV/TESTå‘½åç©ºé—´</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216001648.png" alt="image-20210216001648259"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216001734.png" alt="image-20210216001734240"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216002033.png" alt="image-20210216002033214"></p><blockquote><p>åˆ‡æ¢åˆ°dev namespaceï¼Œæ–°å»ºä¸‰ä¸ªåˆ†ç»„ï¼Œåˆ†ç»„ä¸­é…ç½®DataIdä¸€è‡´ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216002615.png" alt="image-20210216002615825"></p><blockquote><p>åˆ‡æ¢namespaceï¼Œåœ¨bootstrap.ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ å¦‚ä¸‹é…ç½®ï¼ŒåŒæ—¶ä¿®æ”¹application.ymlä¸­é…ç½®ç¯å¢ƒä¸ºdevï¼š</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">nacos:</span></span><br><span class="line">      <span class="attr">config:</span></span><br><span class="line">        <span class="attr">namespace:</span> <span class="string">a9ec0b1e-e254-4b99-84ec-fa4ca62bf5a6</span></span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216003211.png" alt="image-20210216003211534"></p><h1 id="äº”ã€Nacosé›†ç¾¤å’ŒæŒä¹…åŒ–é…ç½®ï¼ˆé‡è¦ï¼‰"><a href="#äº”ã€Nacosé›†ç¾¤å’ŒæŒä¹…åŒ–é…ç½®ï¼ˆé‡è¦ï¼‰" class="headerlink" title="äº”ã€Nacosé›†ç¾¤å’ŒæŒä¹…åŒ–é…ç½®ï¼ˆé‡è¦ï¼‰"></a>äº”ã€Nacosé›†ç¾¤å’ŒæŒä¹…åŒ–é…ç½®ï¼ˆé‡è¦ï¼‰</h1><h2 id="5-1ã€å®˜ç½‘è¯´æ˜"><a href="#5-1ã€å®˜ç½‘è¯´æ˜" class="headerlink" title="5.1ã€å®˜ç½‘è¯´æ˜"></a>5.1ã€å®˜ç½‘è¯´æ˜</h2><h3 id="1ã€å®˜ç½‘æ–‡æ¡£"><a href="#1ã€å®˜ç½‘æ–‡æ¡£" class="headerlink" title="1ã€å®˜ç½‘æ–‡æ¡£"></a>1ã€å®˜ç½‘æ–‡æ¡£</h3><blockquote><p><a href="https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html">https://nacos.io/zh-cn/docs/cluster-mode-quick-start.html</a></p></blockquote><h3 id="2ã€å®˜ç½‘æ¶æ„å›¾"><a href="#2ã€å®˜ç½‘æ¶æ„å›¾" class="headerlink" title="2ã€å®˜ç½‘æ¶æ„å›¾"></a>2ã€å®˜ç½‘æ¶æ„å›¾</h3><blockquote><p>VIPï¼švirtual IPï¼Œè™šæ‹ŸIPï¼Œä¹Ÿå°±æ˜¯nginx</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216111649.png" alt="img"></p><h3 id="3ã€æ ¹æ®å®˜ç½‘ç¿»è¯‘ï¼Œæˆ‘ä»¬å¯å¾—ä»¥ä¸‹æ¶æ„å›¾"><a href="#3ã€æ ¹æ®å®˜ç½‘ç¿»è¯‘ï¼Œæˆ‘ä»¬å¯å¾—ä»¥ä¸‹æ¶æ„å›¾" class="headerlink" title="3ã€æ ¹æ®å®˜ç½‘ç¿»è¯‘ï¼Œæˆ‘ä»¬å¯å¾—ä»¥ä¸‹æ¶æ„å›¾"></a>3ã€æ ¹æ®å®˜ç½‘ç¿»è¯‘ï¼Œæˆ‘ä»¬å¯å¾—ä»¥ä¸‹æ¶æ„å›¾</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216112702.jpg" alt="æœªå‘½åæ–‡ä»¶ (1)"></p><h3 id="4ã€è¯´æ˜"><a href="#4ã€è¯´æ˜" class="headerlink" title="4ã€è¯´æ˜"></a>4ã€è¯´æ˜</h3><blockquote><p>æŒ‰ç…§ä¸Šé¢çš„æ¶æ„å›¾ï¼Œæˆ‘ä»¬éœ€è¦Mysqlæ•°æ®åº“ï¼›</p><p>é»˜è®¤Nacosä½¿ç”¨åµŒå…¥å¼æ•°æ®åº“å®ç°äº†æ•°æ®çš„å­˜å‚¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœå¯åŠ¨å¤šä¸ªé»˜è®¤é…ç½®çš„NacosèŠ‚ç‚¹ï¼Œæ•°æ®å­˜å‚¨æ˜¯å­˜åœ¨ä¸€è‡´æ€§é—®é¢˜çš„ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒNacosé‡‡ç”¨äº†<strong>é›†ä¸­å¼å­˜å‚¨çš„æ–¹å¼æ”¯æŒé›†ç¾¤ä½“éƒ¨ç½²ï¼Œç›®å‰åªæ”¯æŒMySQLçš„å­˜å‚¨ã€‚</strong></p></blockquote><h2 id="5-2ã€NacosæŒä¹…åŒ–é…ç½®è§£é‡Š"><a href="#5-2ã€NacosæŒä¹…åŒ–é…ç½®è§£é‡Š" class="headerlink" title="5.2ã€NacosæŒä¹…åŒ–é…ç½®è§£é‡Š"></a>5.2ã€NacosæŒä¹…åŒ–é…ç½®è§£é‡Š</h2><h3 id="1ã€Nacosè‡ªå¸¦äº†åµŒå…¥å¼æ•°æ®åº“"><a href="#1ã€Nacosè‡ªå¸¦äº†åµŒå…¥å¼æ•°æ®åº“" class="headerlink" title="1ã€Nacosè‡ªå¸¦äº†åµŒå…¥å¼æ•°æ®åº“"></a>1ã€Nacosè‡ªå¸¦äº†åµŒå…¥å¼æ•°æ®åº“</h3><blockquote><p>Nacosé»˜è®¤è‡ªå¸¦<strong>åµŒå…¥å¼æ•°æ®åº“derby</strong>ï¼Œæ‰“å¼€Nacosçš„ä¾èµ–åæ ‡ï¼š<a href="https://github.com/alibaba/nacos/blob/develop/config/pom.xml">https://github.com/alibaba/nacos/blob/develop/config/pom.xml</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216114401.png" alt="image-20210216114401758"></p><blockquote><p>ä½†å½“æˆ‘ä»¬åšNacosé›†ç¾¤æ—¶ï¼Œæ¯ä¸ªNacoséƒ½å„è‡ªå¸¦ç€ä¸€ä¸ªderbyåµŒå…¥å¼æ•°æ®åº“ï¼Œæ­¤æ—¶ä¼šå‡ºç°æŒä¹…åŒ–æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜ï¼Œæ­¤æ—¶æˆ‘ä»¬å¼•å…¥å¤–éƒ¨çš„MySQLæ•°æ®åº“ï¼Œå°†é…ç½®æ•°æ®æŒä¹…åŒ–åˆ°MySQLä¸­ã€‚ </p></blockquote><h3 id="2ã€derbyåˆ°MySQLåˆ‡æ¢é…ç½®æ­¥éª¤"><a href="#2ã€derbyåˆ°MySQLåˆ‡æ¢é…ç½®æ­¥éª¤" class="headerlink" title="2ã€derbyåˆ°MySQLåˆ‡æ¢é…ç½®æ­¥éª¤"></a>2ã€derbyåˆ°MySQLåˆ‡æ¢é…ç½®æ­¥éª¤</h3><blockquote><p>åœ¨<strong>nacos-server-1.1.4\nacos\conf</strong>ç›®å½•ä¸‹æ‰¾åˆ°å¹¶æ‰§è¡Œ <strong>nacos-mysql.sql</strong> è„šæœ¬</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210216115406.png" alt="image-20210216115406872"></p><blockquote><p>åœ¨<strong>nacos-server-1.1.4\nacos\conf</strong>ç›®å½•ä¸‹æ‰¾åˆ°<strong>application.properties</strong>ï¼Œå¢åŠ æ”¯æŒmysqlæ•°æ®æºé…ç½®ï¼Œæ·»åŠ mysqlæ•°æ®åº“çš„urlã€ç”¨æˆ·åå’Œå¯†ç </p><p>æ³¨ï¼šnacosé»˜è®¤ä¸æ”¯æŒmysql8.0ï¼Œå¦‚éœ€æ”¯æŒ8.0ï¼Œéœ€è¦ä¸‹è½½mysql8.0é©±åŠ¨è¿›è¡Œæ›´æ¢ã€‚</p></blockquote><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å°†æŒä¹…åŒ–é…ç½®ä»derbyè¿ç§»åˆ°mysqlé…ç½®</span></span><br><span class="line"><span class="meta">spring.datasource.platform</span>=<span class="string">mysql</span></span><br><span class="line"></span><br><span class="line"><span class="meta">db.num</span>=<span class="string">1</span></span><br><span class="line"><span class="meta">db.url.0</span>=<span class="string">jdbc:mysql://localhost:3306/nacos_config?&amp;connectTimeout=10000&amp;socketTimeout=30000&amp;serverTimezone=GMT%2B8</span></span><br><span class="line"><span class="meta">db.user</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">db.password</span>=<span class="string">tianxin1230.</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯Nacosï¼Œå¯ä»¥çœ‹åˆ°æ˜¯ä¸ªå…¨æ–°çš„ç©ºè®°å½•é¡µé¢</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudå­¦ä¹ ï¼ˆå››ï¼‰-EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒ</title>
      <link href="posts/995752607.html"/>
      <url>posts/995752607.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€EurekaåŸºç¡€çŸ¥è¯†"><a href="#ä¸€ã€EurekaåŸºç¡€çŸ¥è¯†" class="headerlink" title="ä¸€ã€EurekaåŸºç¡€çŸ¥è¯†"></a>ä¸€ã€EurekaåŸºç¡€çŸ¥è¯†</h1><h2 id="1-1ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ²»ç†"><a href="#1-1ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ²»ç†" class="headerlink" title="1.1ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ²»ç†"></a>1.1ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ²»ç†</h2><blockquote><p>Spring Cloud å°è£…äº†Netflixå…¬å¸å¼€å‘çš„Eurekaæ¨¡å—æ¥å®ç°æœåŠ¡æ²»ç†</p><p>åœ¨ä¼ ç»Ÿçš„rpcè¿œç¨‹è°ƒç”¨æ¡†æ¶ä¸­ï¼Œç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´ä¾èµ–å…³ç³»æ¯”è¾ƒå¤æ‚ï¼Œç®¡ç†æ¯”è¾ƒå¤æ‚ï¼Œæ‰€ä»¥éœ€è¦ä½¿ç”¨æœåŠ¡æ²»ç†ï¼Œç®¡ç†æœåŠ¡äºæœåŠ¡ä¹‹é—´ä¾èµ–å…³ç³»ï¼Œå¯ä»¥å®ç°æœåŠ¡è°ƒç”¨ã€è´Ÿè½½å‡è¡¡ã€å®¹é”™ç­‰ï¼Œå®ç°æœåŠ¡å‘ç°ä¸æ³¨å†Œã€‚</p></blockquote><h2 id="1-2ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œ"><a href="#1-2ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œ" class="headerlink" title="1.2ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œ"></a>1.2ã€ä»€ä¹ˆæ˜¯æœåŠ¡æ³¨å†Œ</h2><blockquote><p>â€‹        Eurekaé‡‡ç”¨äº†CSçš„è®¾è®¡æ¶æ„ï¼ŒEureka Serverä½œä¸ºæœåŠ¡æ³¨å†ŒåŠŸèƒ½çš„æœåŠ¡å™¨ï¼Œå®ƒæ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚è€Œç³»ç»Ÿä¸­çš„å…¶ä»–å¾®æœåŠ¡ï¼Œä½¿ç”¨Eurekaçš„å®¢æˆ·ç«¯è¿æ¥åˆ°Eureka Serverå¹¶ç»´æŒå¿ƒè·³è¿æ¥ã€‚è¿™æ ·ç³»ç»Ÿçš„ç»´æŠ¤äººå‘˜å°±å¯ä»¥é€šè¿‡Eureka Serveræ¥ç›‘æ§ç³»ç»Ÿä¸­å„ä¸ªå¾®æœåŠ¡æ˜¯å¦æ­£å¸¸è¿è¡Œã€‚</p><p>â€‹        åœ¨æœåŠ¡æ³¨å†Œä¸å‘ç°ä¸­ï¼Œæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒã€‚å½“æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™ï¼Œä¼šæŠŠå½“å‰è‡ªå·±æœåŠ¡å™¨çš„ä¿¡æ¯æ¯”å¦‚æœåŠ¡åœ°å€é€šè®¯åœ°å€ç­‰ä»¥åˆ«åæ–¹å¼æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒä¸Šã€‚å¦ä¸€æ–¹ï¼ˆæ¶ˆè´¹è€…æœåŠ¡æä¾›è€…ï¼‰ï¼Œä»¥è¯¥åˆ«åçš„æ–¹å¼å»æ³¨å†Œä¸­å¿ƒä¸Šè·å–åˆ°å®é™…çš„æœåŠ¡é€šè®¯åœ°å€ï¼Œç„¶åå†å®ç°æœ¬åœ°RPCè°ƒç”¨RPCè¿œç¨‹è°ƒç”¨æ¡†æ¶æ ¸å¿ƒè®¾è®¡æ€æƒ³ï¼šåœ¨äºæ³¨å†Œä¸­å¿ƒï¼Œå› ä¸ºä½¿ç”¨æ³¨å†Œä¸­å¿ƒç®¡ç†æ¯ä¸ªæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„ä¸€ä¸ªä¾èµ–å…³ç³»ï¼ˆæœåŠ¡æ²»ç†æ¦‚å¿µï¼‰ã€‚åœ¨ä»»ä½•rpcè¿œç¨‹æ¡†æ¶ä¸­ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒï¼ˆå­˜æ”¾æœåŠ¡åœ°å€ç›¸å…³ä¿¡æ¯ï¼ˆæ¥å£åœ°å€ï¼‰ï¼‰</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214161851.png" alt="img"></p><h2 id="1-3ã€Eurekaä¸¤ç»„ä»¶"><a href="#1-3ã€Eurekaä¸¤ç»„ä»¶" class="headerlink" title="1.3ã€Eurekaä¸¤ç»„ä»¶"></a>1.3ã€Eurekaä¸¤ç»„ä»¶</h2><blockquote><p>EurekaåŒ…æ‹¬ä¸¤ä¸ªç»„ä»¶ï¼šEureka Serverå’ŒEureka Clientï¼Œå…¶ä¸­</p></blockquote><ul><li><strong>Eureka Serveræä¾›æœåŠ¡æ³¨å†ŒæœåŠ¡</strong>ï¼Œå„ä¸ªå¾®æœåŠ¡èŠ‚ç‚¹é€šè¿‡é…ç½®å¯åŠ¨åï¼Œä¼šåœ¨Eureka Serverä¸­è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·Eureka Serverä¸­çš„æœåŠ¡æ³¨å†Œè¡¨å°†ä¼šå­˜å‚¨æ‰€æœ‰å¯ç”¨æœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯ï¼ŒæœåŠ¡èŠ‚ç‚¹çš„ä¿¡æ¯å¯ä»¥åœ¨ç•Œé¢ä¸­ç›´è§‚çœ‹åˆ°ã€‚</li><li><strong>Eureka Clienté€šè¿‡æœåŠ¡æ³¨å†Œä¸­å¿ƒè®¿é—®</strong>ï¼Œæ˜¯ä¸€ä¸ªJavaå®¢æˆ·ç«¯ï¼Œç”¨äºç®€åŒ–Eureka Serverçš„äº¤äº’ï¼Œå®¢æˆ·ç«¯åŒæ—¶ä¹Ÿå…·å¤‡ä¸€ä¸ªå†…ç½®çš„ã€ä½¿ç”¨è½®è¯¢ï¼ˆRound-robinï¼‰è´Ÿè½½ç®—æ³•çš„è´Ÿè½½å‡è¡¡å™¨ã€‚åœ¨åº”ç”¨å¯åŠ¨åï¼Œå°†ä¼šå‘Eureka Serverå‘é€å¿ƒè·³ï¼ˆé»˜è®¤æ—¶é—´å‘¨æœŸä¸º30sï¼‰ã€‚å¦‚æœEureka Serveråœ¨å¤šä¸ªå¿ƒè·³å‘¨æœŸå†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªèŠ‚ç‚¹çš„å¿ƒè·³ï¼ŒEureka Serverå°†ä¼šä»æ³¨å†ŒæœåŠ¡è¡¨ä¸­æŠŠè¿™ä¸ªæœåŠ¡èŠ‚ç‚¹ç§»é™¤ï¼ˆé»˜è®¤ä¸º90sï¼‰ã€‚</li></ul><h1 id="äºŒã€å•å‡»Eurekaæ„å»ºæ­¥éª¤"><a href="#äºŒã€å•å‡»Eurekaæ„å»ºæ­¥éª¤" class="headerlink" title="äºŒã€å•å‡»Eurekaæ„å»ºæ­¥éª¤"></a>äºŒã€å•å‡»Eurekaæ„å»ºæ­¥éª¤</h1><h2 id="2-1ã€åˆ›å»ºcloud-eureka-server-7001"><a href="#2-1ã€åˆ›å»ºcloud-eureka-server-7001" class="headerlink" title="2.1ã€åˆ›å»ºcloud-eureka-server-7001"></a>2.1ã€åˆ›å»ºcloud-eureka-server-7001</h2><blockquote><p>è¿™ä¸ªå¾®æœåŠ¡å°±æ˜¯eureka ServeræœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œä¸ºå…¶ä»–å¾®æœåŠ¡æä¾›æœåŠ¡æ³¨å†Œã€‚</p></blockquote><h2 id="2-2ã€å¼•å…¥ä¾èµ–"><a href="#2-2ã€å¼•å…¥ä¾èµ–" class="headerlink" title="2.2ã€å¼•å…¥ä¾èµ–"></a>2.2ã€å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.cloud/spring-cloud-starter-eureka-server --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-web  --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-devtools --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- https://mvnrepository.com/artifact/org.springframework.boot/spring-boot-starter-test --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>Eureka 1.xå’ŒEureka 2.xçš„åŒºåˆ«</p></blockquote><ul><li>Eureka 1.x è€ç‰ˆæœ¬ï¼Œä¾èµ–ä¸­ä¸åˆ†æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-eureka<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Eureka 2.x æ–°ç‰ˆæœ¬</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-server<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"><a href="#2-3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶" class="headerlink" title="2.3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"></a>2.3ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">erver:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7001</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7001.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">  <span class="comment"># è¡¨ç¤ºä¸å‘æœåŠ¡æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="comment"># è¡¨ç¤ºè‡ªå·±å°±æ˜¯æœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://$&#123;eureka.instance.hostname&#125;:$&#123;server.port&#125;/eureka/</span></span><br></pre></td></tr></table></figure><h2 id="2-4ã€ä¸»å¯åŠ¨ç±»"><a href="#2-4ã€ä¸»å¯åŠ¨ç±»" class="headerlink" title="2.4ã€ä¸»å¯åŠ¨ç±»"></a>2.4ã€ä¸»å¯åŠ¨ç±»</h2><blockquote><p>åœ¨ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableEurekaServeræ³¨è§£ï¼Œè¡¨ç¤ºè¿™ä¸ªå¾®æœåŠ¡ä¸ºæœåŠ¡æ³¨å†Œä¸­å¿ƒã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaServer</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">EurekaServer7001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(EurekaServer7001.class,args);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost:7001&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-5ã€å¯åŠ¨eureka7001"><a href="#2-5ã€å¯åŠ¨eureka7001" class="headerlink" title="2.5ã€å¯åŠ¨eureka7001"></a>2.5ã€å¯åŠ¨eureka7001</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214171752.png" alt="image-20210214171751846"></p><h2 id="2-6ã€ä¿®æ”¹payment8001å’Œorder80"><a href="#2-6ã€ä¿®æ”¹payment8001å’Œorder80" class="headerlink" title="2.6ã€ä¿®æ”¹payment8001å’Œorder80"></a>2.6ã€ä¿®æ”¹payment8001å’Œorder80</h2><blockquote><p>å¼•å…¥eureka Clientä¾èµ–</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://localhost:7001/eureka</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨payment8001ã€order80ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaClient</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯åŠ¨payment8001ã€order80</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214173444.png" alt="image-20210214173444635"></p><blockquote><p>Eureka Serveråˆ—è¡¨ä¸­ä¼šæ˜¾ç¤ºå·²ç»æ³¨å†Œå…¥æ³¨å†Œä¸­å¿ƒçš„å¾®æœåŠ¡çš„spring.application.name</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214173637.png" alt="image-20210214173637695"></p><h1 id="ä¸‰ã€é›†ç¾¤Eurekaæ„å»ºæ­¥éª¤"><a href="#ä¸‰ã€é›†ç¾¤Eurekaæ„å»ºæ­¥éª¤" class="headerlink" title="ä¸‰ã€é›†ç¾¤Eurekaæ„å»ºæ­¥éª¤"></a>ä¸‰ã€é›†ç¾¤Eurekaæ„å»ºæ­¥éª¤</h1><h2 id="3-1ã€å•æœºeurekaå­˜åœ¨çš„é—®é¢˜"><a href="#3-1ã€å•æœºeurekaå­˜åœ¨çš„é—®é¢˜" class="headerlink" title="3.1ã€å•æœºeurekaå­˜åœ¨çš„é—®é¢˜"></a>3.1ã€å•æœºeurekaå­˜åœ¨çš„é—®é¢˜</h2><blockquote><p><strong>å¾®æœåŠ¡RPCè¿œç¨‹æœåŠ¡è°ƒç”¨æœ€æ ¸å¿ƒçš„æ˜¯ä»€ä¹ˆï¼Ÿ</strong></p><ul><li>é«˜å¯ç”¨ï¼Œå¦‚æœæ³¨å†Œä¸­å¿ƒä¸ºå•æœºï¼Œé‚£ä¹ˆä¸€æ—¦å®ƒå‡ºç°æ•…éšœï¼Œå°±ä¼šå¯¼è‡´æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨ã€‚</li></ul><p><strong>è§£å†³æ–¹æ³•</strong></p><ul><li>æ­å»ºEurekaæ³¨å†Œä¸­å¿ƒé›†ç¾¤ï¼Œå®ç°è´Ÿè½½å‡è¡¡+æ•…éšœå®¹é”™</li></ul></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214181019.png" alt="img"></p><h2 id="3-2ã€eurekaé›†ç¾¤çš„å®è´¨"><a href="#3-2ã€eurekaé›†ç¾¤çš„å®è´¨" class="headerlink" title="3.2ã€eurekaé›†ç¾¤çš„å®è´¨"></a>3.2ã€eurekaé›†ç¾¤çš„å®è´¨</h2><blockquote><p>äº’ç›¸æ³¨å†Œï¼Œç›¸äº’å®ˆæœ›ã€‚</p><p>é›†ç¾¤ä¸­çš„æ¯ä¸€å°eureka Serverè¦æœ‰<strong>é™¤è‡ªå·±ä¹‹å¤–çš„æ‰€æœ‰eureka server</strong>çš„ä¿¡æ¯ã€‚</p></blockquote><h2 id="3-3ã€æ–°å»ºEureka-7002å¾®æœåŠ¡"><a href="#3-3ã€æ–°å»ºEureka-7002å¾®æœåŠ¡" class="headerlink" title="3.3ã€æ–°å»ºEureka 7002å¾®æœåŠ¡"></a>3.3ã€æ–°å»ºEureka 7002å¾®æœåŠ¡</h2><blockquote><p>ä¿®æ”¹æœ¬åœ°hostsæ–‡ä»¶ï¼Œæ·»åŠ åŸŸåå’Œipæ˜ å°„</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"># My hosts</span><br><span class="line">127.0.0.1 eureka7001.com</span><br><span class="line">127.0.0.1 eureka7002.com</span><br></pre></td></tr></table></figure><blockquote><p>ç”±äºä¾èµ–ã€ä¸»å¯åŠ¨ç±»ä¸7001ç±»ä¼¼ï¼Œæ‰€ä»¥è¿™é‡Œåªç»™å‡ºymlé…ç½®æ–‡ä»¶</p><p>æ­¤æ—¶éœ€è¦ä¿®æ”¹ä¸€ä¸‹7001çš„é…ç½®æ–‡ä»¶</p></blockquote><ul><li>7001</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7001</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7001.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="comment">#é›†ç¾¤æ—¶7001éœ€è¦æ³¨å†Œåˆ°7002</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7002.com:7002/eureka/</span></span><br></pre></td></tr></table></figure><ul><li>7002</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">7002</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">eureka7002.com</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/</span>     <span class="comment">#è®¾ç½®ä¸eureka serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€</span></span><br></pre></td></tr></table></figure><h2 id="3-4ã€å¯åŠ¨7001å’Œ7002ï¼Œæµ‹è¯•"><a href="#3-4ã€å¯åŠ¨7001å’Œ7002ï¼Œæµ‹è¯•" class="headerlink" title="3.4ã€å¯åŠ¨7001å’Œ7002ï¼Œæµ‹è¯•"></a>3.4ã€å¯åŠ¨7001å’Œ7002ï¼Œæµ‹è¯•</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214201207.png" alt="image-20210214201206201"></p><h2 id="3-5ã€å°†payment8001å’Œorder80æ³¨å†Œåˆ°eurekaé›†ç¾¤"><a href="#3-5ã€å°†payment8001å’Œorder80æ³¨å†Œåˆ°eurekaé›†ç¾¤" class="headerlink" title="3.5ã€å°†payment8001å’Œorder80æ³¨å†Œåˆ°eurekaé›†ç¾¤"></a>3.5ã€å°†payment8001å’Œorder80æ³¨å†Œåˆ°eurekaé›†ç¾¤</h2><blockquote><p>ä¿®æ”¹payment8001å’Œorder80çš„ymlæ–‡ä»¶</p></blockquote><ul><li>payment8001</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span>    <span class="comment">#è¡¨è¯†ä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span>   <span class="comment">#è¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka,http://eureka7002.com:7002/eureka</span>    <span class="comment">#è®¾ç½®ä¸eureka serveräº¤äº’çš„åœ°å€æŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-provider-hystrix-payment</span></span><br></pre></td></tr></table></figure><ul><li>order80</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/,http://eureka7002.com:7002/eureka/</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-order-service</span></span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214210220.png" alt="image-20210214210219113"></p><h1 id="å››ã€actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„"><a href="#å››ã€actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„" class="headerlink" title="å››ã€actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„"></a>å››ã€actuatorå¾®æœåŠ¡ä¿¡æ¯å®Œå–„</h1><h2 id="4-1ã€ä¸»æœºåï¼ŒæœåŠ¡åç§°ä¿®æ”¹"><a href="#4-1ã€ä¸»æœºåï¼ŒæœåŠ¡åç§°ä¿®æ”¹" class="headerlink" title="4.1ã€ä¸»æœºåï¼ŒæœåŠ¡åç§°ä¿®æ”¹"></a>4.1ã€ä¸»æœºåï¼ŒæœåŠ¡åç§°ä¿®æ”¹</h2><h3 id="1ã€å½“å‰é—®é¢˜"><a href="#1ã€å½“å‰é—®é¢˜" class="headerlink" title="1ã€å½“å‰é—®é¢˜"></a>1ã€å½“å‰é—®é¢˜</h3><blockquote><p>eurekaæ³¨å†Œè¡¨ä¸­å«æœ‰ä¸»æœºåç§°</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214211411.png" alt="image-20210214211411127"></p><h3 id="2ã€ä¿®æ”¹payment8001"><a href="#2ã€ä¿®æ”¹payment8001" class="headerlink" title="2ã€ä¿®æ”¹payment8001"></a>2ã€ä¿®æ”¹payment8001</h3><blockquote><p>ä¿®æ”¹payment8001å¾®æœåŠ¡çš„ymlé…ç½®æ–‡ä»¶ï¼Œæ·»åŠ é…ç½®å¦‚ä¸‹</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">instance-id:</span> <span class="string">payment8001</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯ï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214212223.png" alt="image-20210214212222852"></p><h2 id="4-2ã€è®¿é—®ä¿¡æ¯æœ‰IPä¿¡æ¯æç¤º"><a href="#4-2ã€è®¿é—®ä¿¡æ¯æœ‰IPä¿¡æ¯æç¤º" class="headerlink" title="4.2ã€è®¿é—®ä¿¡æ¯æœ‰IPä¿¡æ¯æç¤º"></a>4.2ã€è®¿é—®ä¿¡æ¯æœ‰IPä¿¡æ¯æç¤º</h2><h3 id="1ã€é‡åˆ°çš„é—®é¢˜"><a href="#1ã€é‡åˆ°çš„é—®é¢˜" class="headerlink" title="1ã€é‡åˆ°çš„é—®é¢˜"></a>1ã€é‡åˆ°çš„é—®é¢˜</h3><blockquote><p>åœ¨eurekaç‚¹å‡»å¾®æœåŠ¡æ—¶æ²¡æœ‰ipæç¤º</p></blockquote><h3 id="2ã€æ·»åŠ é…ç½®"><a href="#2ã€æ·»åŠ é…ç½®" class="headerlink" title="2ã€æ·»åŠ é…ç½®"></a>2ã€æ·»åŠ é…ç½®</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h3 id="3ã€æµ‹è¯•"><a href="#3ã€æµ‹è¯•" class="headerlink" title="3ã€æµ‹è¯•"></a>3ã€æµ‹è¯•</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214212622.png" alt="image-20210214212622010"></p><h2 id="4-3ã€æ€»ç»“"><a href="#4-3ã€æ€»ç»“" class="headerlink" title="4.3ã€æ€»ç»“"></a>4.3ã€æ€»ç»“</h2><blockquote><p>ä¿®æ”¹ä¸»æœºåã€æ·»åŠ IPä¿¡æ¯æç¤ºçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p></blockquote><h3 id="1ã€å¼•å…¥ä¾èµ–"><a href="#1ã€å¼•å…¥ä¾èµ–" class="headerlink" title="1ã€å¼•å…¥ä¾èµ–"></a>1ã€å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€ymlæ–‡ä»¶æ·»åŠ é…ç½®"><a href="#2ã€ymlæ–‡ä»¶æ·»åŠ é…ç½®" class="headerlink" title="2ã€ymlæ–‡ä»¶æ·»åŠ é…ç½®"></a>2ã€ymlæ–‡ä»¶æ·»åŠ é…ç½®</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">instance-id:</span> <span class="string">æœåŠ¡åç§°</span></span><br><span class="line">    <span class="comment"># å¼€å¯IPä¿¡æ¯æç¤º</span></span><br><span class="line">    <span class="attr">prefer-ip-address:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h1 id="äº”ã€æœåŠ¡å‘ç°Discovery"><a href="#äº”ã€æœåŠ¡å‘ç°Discovery" class="headerlink" title="äº”ã€æœåŠ¡å‘ç°Discovery"></a>äº”ã€æœåŠ¡å‘ç°Discovery</h1><h2 id="5-1ã€æ¦‚è¿°"><a href="#5-1ã€æ¦‚è¿°" class="headerlink" title="5.1ã€æ¦‚è¿°"></a>5.1ã€æ¦‚è¿°</h2><blockquote><p>å¯¹äºæ³¨å†Œå…¥Eurekaä¸­çš„å¾®æœåŠ¡ï¼Œå¯ä»¥é€šè¿‡æœåŠ¡å‘ç°æ¥è·å¾—è¯¥æœåŠ¡çš„ä¿¡æ¯ã€‚</p></blockquote><h2 id="5-2ã€ä½¿ç”¨"><a href="#5-2ã€ä½¿ç”¨" class="headerlink" title="5.2ã€ä½¿ç”¨"></a>5.2ã€ä½¿ç”¨</h2><blockquote><p>è¿™é‡Œä»¥payment8001ä¸ºä¾‹</p></blockquote><h3 id="1ã€ä¿®æ”¹payment8001çš„Controller"><a href="#1ã€ä¿®æ”¹payment8001çš„Controller" class="headerlink" title="1ã€ä¿®æ”¹payment8001çš„Controller"></a>1ã€ä¿®æ”¹payment8001çš„Controller</h3><blockquote><p>æ³¨å…¥ä¸€ä¸ªDiscoveryClientå¯¹è±¡</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Autowired</span></span><br><span class="line"><span class="keyword">private</span> DiscoveryClient discoveryClient;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨Controllerä¸­æ·»åŠ ä¸€ä¸ªæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨æˆ·è·å–å¾®æœåŠ¡çš„ä¿¡æ¯</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/payment/discovery&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">discovery</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;String&gt; services = discoveryClient.getServices();</span><br><span class="line">    services.stream().forEach(service -&gt; &#123;</span><br><span class="line">        log.info(<span class="string">&quot;-----------element:&quot;</span> + service);</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//åœ¨getInstancesæ–¹æ³•ä¸­è¾“å…¥æ³¨å†Œåˆ°eurekaä¸­çš„å¾®æœåŠ¡åç§°</span></span><br><span class="line">    List&lt;ServiceInstance&gt; instances = discoveryClient.getInstances(<span class="string">&quot;CLOUD-PAYMENT-SERVICE&quot;</span>);</span><br><span class="line">    instances.stream().forEach(instance -&gt; &#123;</span><br><span class="line">        log.info(instance.getServiceId() + <span class="string">&quot;\t&quot;</span> + instance.getHost() + <span class="string">&quot;\t&quot;</span> + instance.getPort() + <span class="string">&quot;\t&quot;</span> + instance.getUri());</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.discoveryClient;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€åœ¨payment8001ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£"><a href="#2ã€åœ¨payment8001ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£" class="headerlink" title="2ã€åœ¨payment8001ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£"></a>2ã€åœ¨payment8001ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ æ³¨è§£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br></pre></td></tr></table></figure><h3 id="3ã€é‡å¯payment8001"><a href="#3ã€é‡å¯payment8001" class="headerlink" title="3ã€é‡å¯payment8001"></a>3ã€é‡å¯payment8001</h3><blockquote><p>è®¿é—® <a href="http://localhost:8001/payment/discovery">http://localhost:8001/payment/discovery</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214214947.png" alt="image-20210214214946293"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214215325.png" alt="image-20210214215324991"></p><h1 id="å…­ã€Eurekaè‡ªæˆ‘ä¿æŠ¤"><a href="#å…­ã€Eurekaè‡ªæˆ‘ä¿æŠ¤" class="headerlink" title="å…­ã€Eurekaè‡ªæˆ‘ä¿æŠ¤"></a>å…­ã€Eurekaè‡ªæˆ‘ä¿æŠ¤</h1><h2 id="6-1ã€æ¦‚è¿°"><a href="#6-1ã€æ¦‚è¿°" class="headerlink" title="6.1ã€æ¦‚è¿°"></a>6.1ã€æ¦‚è¿°</h2><blockquote><p>ä¿æŠ¤æ¨¡å¼ä¸»è¦ç”¨äºä¸€ç»„å®¢æˆ·ç«¯å’ŒEureka Serverä¹‹é—´å­˜åœ¨ç½‘ç»œåˆ†åŒºåœºæ™¯ã€‚ä¸€æ—¦è¿›å…¥ä¿æŠ¤æ¨¡å¼ï¼Œ<strong>Eureka Serverå°†ä¼šå°è¯•ä¿æŠ¤å…¶æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæ³¨é”€ä»»ä½•æœåŠ¡</strong>ã€‚</p><p>å³ï¼šæŸæ—¶åˆ»æŸä¸€ä¸ªå¾®æœåŠ¡ä¸å¯ç”¨äº†ï¼ŒEurekaä¸ä¼šç«‹å³æ¸…ç†ï¼Œä¾æ—§ä¼šå¯¹è¯¥å¾®æœåŠ¡çš„ä¿¡æ¯è¿›è¡Œä¿å­˜ã€‚</p></blockquote><ul><li>å¦‚æœåœ¨Eureka Serveré¦–é¡µä¸­çœ‹åˆ°ä»¥ä¸‹è¿™æ®µæç¤ºï¼Œåˆ™è¯´æ˜Eurekaè¿›å…¥äº†ä¿æŠ¤æ¨¡å¼</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214220119.png" alt="image-20210214220118806"></p><h2 id="6-2ã€å¯¼è‡´åŸå› "><a href="#6-2ã€å¯¼è‡´åŸå› " class="headerlink" title="6.2ã€å¯¼è‡´åŸå› "></a>6.2ã€å¯¼è‡´åŸå› </h2><h3 id="1ã€ä¸ºä»€ä¹ˆä¼šäº§ç”ŸEurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Ÿ"><a href="#1ã€ä¸ºä»€ä¹ˆä¼šäº§ç”ŸEurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Ÿ" class="headerlink" title="1ã€ä¸ºä»€ä¹ˆä¼šäº§ç”ŸEurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Ÿ"></a>1ã€ä¸ºä»€ä¹ˆä¼šäº§ç”ŸEurekaè‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Ÿ</h3><blockquote><p>ä¸ºäº†é˜²æ­¢EurekaClientå¯ä»¥æ­£å¸¸è¿è¡Œï¼Œä½†æ˜¯ä¸EurekaServerç½‘ç»œä¸é€šæƒ…å†µä¸‹ï¼ŒEurekaserverä¸ä¼šç«‹åˆ»å°†EurekaClientæœåŠ¡å‰”é™¤</p></blockquote><h3 id="2ã€ä»€ä¹ˆæ˜¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼"><a href="#2ã€ä»€ä¹ˆæ˜¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼" class="headerlink" title="2ã€ä»€ä¹ˆæ˜¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼"></a>2ã€ä»€ä¹ˆæ˜¯è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼</h3><blockquote><p>â€‹    é»˜è®¤æƒ…å†µä¸‹ï¼Œå¦‚æœEurekaServeråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°æŸä¸ªå¾®æœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼ŒEurekaServerå°†ä¼šæ³¨é”€è¯¥å®ä¾‹ï¼ˆé»˜è®¤90ç§’ï¼‰ã€‚ä½†å½“ç½‘ç»œåˆ†åŒºæ•…éšœå‘ç”Ÿï¼ˆå»¶æ—¶ã€å¡é¡¿ã€æ‹¥æŒ¤ï¼‰æ—¶ï¼Œå¾®æœåŠ¡ä¸EurekaServerä¹‹é—´æ— æ³•æ­£å¸¸é€šä¿¡ï¼Œä»¥ä¸Šè¡Œä¸ºå¯èƒ½å˜å¾—éå¸¸å±é™©äº†â€”â€”å› ä¸ºå¾®åŠ¡æœ¬èº«å…¶å®æ˜¯å¥åº·çš„ï¼Œæ­¤æ—¶æœ¬ä¸åº”è¯¥æ³¨é”€è¿™ä¸ªå¾®æœåŠ¡ã€‚Eurekaé€šè¿‡â€œè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼â€æ¥è§£å†³è¿™ä¸ªé—®é¢˜â€”â€”å½“EurekaServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±è¿‡å¤šå®¢æˆ·ç«¯æ—¶ï¼ˆå¯èƒ½å‘ç”Ÿäº†ç½‘ç»œåˆ†åŒºæ•…éšœï¼‰ï¼Œé‚£ä¹ˆè¿™ä¸ªèŠ‚ç‚¹å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214221434.png" alt="img"></p><h2 id="6-3ã€ç¦æ­¢è‡ªæˆ‘ä¿æŠ¤"><a href="#6-3ã€ç¦æ­¢è‡ªæˆ‘ä¿æŠ¤" class="headerlink" title="6.3ã€ç¦æ­¢è‡ªæˆ‘ä¿æŠ¤"></a>6.3ã€ç¦æ­¢è‡ªæˆ‘ä¿æŠ¤</h2><blockquote><p>ä»¥eureka7001å’Œpayment8001ä¸¾ä¾‹è¯´æ˜</p></blockquote><h3 id="1ã€ä¿®æ”¹eureka7001çš„é…ç½®æ–‡ä»¶"><a href="#1ã€ä¿®æ”¹eureka7001çš„é…ç½®æ–‡ä»¶" class="headerlink" title="1ã€ä¿®æ”¹eureka7001çš„é…ç½®æ–‡ä»¶"></a>1ã€ä¿®æ”¹eureka7001çš„é…ç½®æ–‡ä»¶</h3><blockquote><p>ç¦ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="comment"># å…³é—­è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</span></span><br><span class="line">  <span class="attr">server:</span></span><br><span class="line">    <span class="attr">enable-self-preservation:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯7001ï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214222939.png" alt="image-20210214222939563"></p><h3 id="2ã€ä¿®æ”¹payment8001çš„é…ç½®æ–‡ä»¶"><a href="#2ã€ä¿®æ”¹payment8001çš„é…ç½®æ–‡ä»¶" class="headerlink" title="2ã€ä¿®æ”¹payment8001çš„é…ç½®æ–‡ä»¶"></a>2ã€ä¿®æ”¹payment8001çš„é…ç½®æ–‡ä»¶</h3><blockquote><p>è®¾ç½®eurekaå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¿ƒè·³çš„æ—¶é—´é—´éš”</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="comment">#Eurekaå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€å¿ƒè·³çš„æ—¶é—´é—´éš”ï¼Œå•ä½ä¸ºç§’ï¼ˆé»˜è®¤ä¸º10sï¼‰</span></span><br><span class="line">    <span class="attr">lease-renewal-interval-in-seconds:</span> <span class="number">1</span></span><br><span class="line">    <span class="comment">#EurekaæœåŠ¡ç«¯åœ¨æ”¶åˆ°æœ€åä¸€æ¬¡å¿ƒè·³åç­‰å¾…æ—¶é—´ä¸Šé™ï¼Œå•ä½ä¸ºsï¼Œè¶…æ—¶ç›´æ¥å‰”é™¤æœåŠ¡</span></span><br><span class="line">    <span class="attr">lease-expiration-duration-in-seconds:</span> <span class="number">2</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯payment8001ï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214223337.png" alt="image-20210214223337465"></p><blockquote><p>å…³é—­payment8001ï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210214223531.png" alt="image-20210214223531487"></p><blockquote><p>å¯ä»¥çœ‹åˆ°ï¼Œåœ¨ç¦ç”¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼çš„æƒ…å†µä¸‹ï¼Œå…³é—­payment8001åæœåŠ¡è¢«å‰”é™¤</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudå­¦ä¹ ï¼ˆä¸‰ï¼‰-Hystrixçš„ä½¿ç”¨</title>
      <link href="posts/4157920692.html"/>
      <url>posts/4157920692.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€æ¦‚è¿°"><a href="#ä¸€ã€æ¦‚è¿°" class="headerlink" title="ä¸€ã€æ¦‚è¿°"></a>ä¸€ã€æ¦‚è¿°</h1><h2 id="1-1ã€åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"><a href="#1-1ã€åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜" class="headerlink" title="1.1ã€åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜"></a>1.1ã€åˆ†å¸ƒå¼ç³»ç»Ÿé¢ä¸´çš„é—®é¢˜</h2><blockquote><p><strong>å¤æ‚åˆ†å¸ƒå¼ä½“ç³»ç»“æ„ä¸­çš„åº”ç”¨ç¨‹åºæœ‰æ•°åä¸ªä¾èµ–å…³ç³»ï¼Œæ¯ä¸ªä¾èµ–å…³ç³»åœ¨æŸäº›æ—¶å€™å°†ä¸å¯é¿å…çš„å¤±è´¥ã€‚</strong></p><p>å¾®æœåŠ¡ä¹‹é—´è°ƒç”¨å…³ç³»é”™ç»¼å¤æ‚ï¼Œä¸€ä¸ªè¯·æ±‚ï¼Œå¯èƒ½éœ€è¦è°ƒç”¨å¤šä¸ªå¾®æœåŠ¡æ¥å£æ‰èƒ½å®ç°ï¼Œä¼šå½¢æˆéå¸¸å¤æ‚çš„è°ƒç”¨é“¾è·¯ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212114450.png" alt="img"></p><h2 id="1-2ã€æœåŠ¡é›ªå´©"><a href="#1-2ã€æœåŠ¡é›ªå´©" class="headerlink" title="1.2ã€æœåŠ¡é›ªå´©"></a>1.2ã€æœåŠ¡é›ªå´©</h2><blockquote><p>å¤šä¸ªå¾®æœåŠ¡ä¹‹é—´è°ƒç”¨çš„æ—¶å€™ï¼Œå‡è®¾å¾®æœåŠ¡Aè°ƒç”¨å¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cï¼Œå¾®æœåŠ¡Bå’Œå¾®æœåŠ¡Cåˆè°ƒç”¨å…¶å®ƒçš„å¾®æœåŠ¡ï¼Œè¿™å°±æ˜¯æ‰€è°“çš„**â€œæ‰‡å‡ºâ€**ã€‚å¦‚æœæ‰‡å‡ºçš„é“¾è·¯ä¸ŠæŸä¸ªå¾®æœåŠ¡çš„è°ƒç”¨å“åº”æ—¶é—´è¿‡é•¿æˆ–è€…ä¸å¯ç”¨ï¼Œå¯¹å¾®æœåŠ¡Açš„è°ƒç”¨å°±ä¼šå ç”¨è¶Šæ¥è¶Šå¤šçš„ç³»ç»Ÿèµ„æºï¼Œè¿›è€Œå¼•èµ·ç³»ç»Ÿå´©æºƒï¼Œæ‰€è°“çš„â€œé›ªå´©æ•ˆåº”â€ã€‚</p><p>å¯¹äºé«˜æµé‡çš„åº”ç”¨æ¥è¯´ï¼Œå•ä¸€çš„åç«¯ä¾èµ–å¯èƒ½ä¼šå¯¼è‡´æ‰€æœ‰æœåŠ¡å™¨ä¸Šçš„æ‰€æœ‰èµ„æºéƒ½åœ¨å‡ ç§’é’Ÿå†…é¥±å’Œã€‚æ¯”å¤±è´¥æ›´ç³Ÿç³•çš„æ˜¯ï¼Œè¿™äº›åº”ç”¨ç¨‹åºè¿˜å¯èƒ½å¯¼è‡´æœåŠ¡ä¹‹é—´çš„å»¶è¿Ÿå¢åŠ ï¼Œå¤‡ä»½é˜Ÿåˆ—ï¼Œçº¿ç¨‹å’Œå…¶ä»–ç³»ç»Ÿèµ„æºç´§å¼ ï¼Œå¯¼è‡´æ•´ä¸ªç³»ç»Ÿå‘ç”Ÿæ›´å¤šçš„çº§è”æ•…éšœã€‚è¿™äº›éƒ½è¡¨ç¤ºéœ€è¦å¯¹æ•…éšœå’Œå»¶è¿Ÿè¿›è¡Œéš”ç¦»å’Œç®¡ç†ï¼Œä»¥ä¾¿å•ä¸ªä¾èµ–å…³ç³»çš„å¤±è´¥ï¼Œä¸èƒ½å–æ¶ˆæ•´ä¸ªåº”ç”¨ç¨‹åºæˆ–ç³»ç»Ÿã€‚</p><p>æ‰€ä»¥ï¼Œé€šå¸¸å½“ä½ å‘ç°ä¸€ä¸ªæ¨¡å—ä¸‹çš„æŸä¸ªå®ä¾‹å¤±è´¥åï¼Œè¿™æ—¶å€™è¿™ä¸ªæ¨¡å—ä¾ç„¶è¿˜ä¼šæ¥æ”¶æµé‡ï¼Œç„¶åè¿™ä¸ªæœ‰é—®é¢˜çš„æ¨¡å—è¿˜è°ƒç”¨äº†å…¶ä»–çš„æ¨¡å—ï¼Œè¿™æ ·å°±ä¼šå‘ç”Ÿ<strong>çº§è”æ•…éšœ</strong>ï¼Œæˆ–è€…å«<strong>é›ªå´©</strong>ã€‚</p></blockquote><p>å¦‚å›¾ï¼Œä¸€æ¬¡ä¸šåŠ¡è¯·æ±‚ï¼Œéœ€è¦è°ƒç”¨Aã€Pã€Hã€Iå››ä¸ªæœåŠ¡ï¼Œè¿™å››ä¸ªæœåŠ¡åˆå¯èƒ½è°ƒç”¨å…¶å®ƒæœåŠ¡ã€‚</p><p>å¦‚æœæ­¤æ—¶ï¼ŒæŸä¸ªæœåŠ¡å‡ºç°å¼‚å¸¸ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212115722.png" alt="image-20210212115722168"></p><p>ä¾‹å¦‚å¾®æœåŠ¡Iå‘ç”Ÿå¼‚å¸¸ï¼Œè¯·æ±‚é˜»å¡ï¼Œç”¨æˆ·ä¸ä¼šå¾—åˆ°å“åº”ï¼Œåˆ™tomcatçš„è¿™ä¸ªçº¿ç¨‹ä¸ä¼šé‡Šæ”¾ï¼Œäºæ˜¯è¶Šæ¥è¶Šå¤šçš„ç”¨æˆ·è¯·æ±‚åˆ°æ¥ï¼Œè¶Šæ¥è¶Šå¤šçš„çº¿ç¨‹ä¼šé˜»å¡ï¼š</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212115754.png" alt="image-20210212115754001"></p><p><strong>æœåŠ¡å™¨æ”¯æŒçš„çº¿ç¨‹å’Œå¹¶å‘æ•°æœ‰é™ï¼Œè¯·æ±‚ä¸€ç›´é˜»å¡ï¼Œä¼šå¯¼è‡´æœåŠ¡å™¨èµ„æºè€—å°½ï¼Œä»è€Œå¯¼è‡´æ‰€æœ‰å…¶å®ƒæœåŠ¡éƒ½ä¸å¯ç”¨ï¼Œå½¢æˆé›ªå´©æ•ˆåº”ã€‚</strong></p><p>è¿™å°±å¥½æ¯”ï¼Œä¸€ä¸ªæ±½è½¦ç”Ÿäº§çº¿ï¼Œç”Ÿäº§ä¸åŒçš„æ±½è½¦ï¼Œéœ€è¦ä½¿ç”¨ä¸åŒçš„é›¶ä»¶ï¼Œå¦‚æœæŸä¸ªé›¶ä»¶å› ä¸ºç§ç§åŸå› æ— æ³•ä½¿ç”¨ï¼Œé‚£ä¹ˆå°±ä¼šé€ æˆæ•´å°è½¦æ— æ³•è£…é…ï¼Œé™·å…¥ç­‰å¾…é›¶ä»¶çš„çŠ¶æ€ï¼Œç›´åˆ°é›¶ä»¶åˆ°ä½ï¼Œæ‰èƒ½ç»§ç»­ç»„è£…ã€‚Â  æ­¤æ—¶å¦‚æœæœ‰å¾ˆå¤šä¸ªè½¦å‹éƒ½éœ€è¦è¿™ä¸ªé›¶ä»¶ï¼Œé‚£ä¹ˆæ•´ä¸ªå·¥å‚éƒ½å°†é™·å…¥ç­‰å¾…çš„çŠ¶æ€ï¼Œå¯¼è‡´æ‰€æœ‰ç”Ÿäº§éƒ½é™·å…¥ç˜«ç—ªã€‚ä¸€ä¸ªé›¶ä»¶çš„æ³¢åŠèŒƒå›´ä¸æ–­æ‰©å¤§ã€‚ </p><blockquote><p>Hystixè§£å†³é›ªå´©é—®é¢˜çš„æ‰‹æ®µæœ‰ä¸¤ä¸ªï¼š</p></blockquote><ul><li>çº¿ç¨‹éš”ç¦»</li><li>æœåŠ¡ç†”æ–­</li></ul><h2 id="1-3ã€Hystrixæ˜¯ä»€ä¹ˆï¼Ÿ"><a href="#1-3ã€Hystrixæ˜¯ä»€ä¹ˆï¼Ÿ" class="headerlink" title="1.3ã€Hystrixæ˜¯ä»€ä¹ˆï¼Ÿ"></a>1.3ã€Hystrixæ˜¯ä»€ä¹ˆï¼Ÿ</h2><blockquote><p>â€‹    Hystrixæ˜¯ä¸€ä¸ªç”¨äºå¤„ç†åˆ†å¸ƒå¼ç³»ç»Ÿçš„<strong>å»¶è¿Ÿ</strong>å’Œ<strong>å®¹é”™</strong>çš„å¼€æºåº“ï¼Œåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿé‡Œï¼Œè®¸å¤šä¾èµ–ä¸å¯é¿å…çš„ä¼šè°ƒç”¨å¤±è´¥ï¼Œæ¯”å¦‚è¶…æ—¶ã€å¼‚å¸¸ç­‰ï¼ŒHystrixèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªä¾èµ–å‡ºé—®é¢˜çš„æƒ…å†µä¸‹ï¼Œ<strong>ä¸ä¼šå¯¼è‡´æ•´ä½“æœåŠ¡å¤±è´¥ï¼Œé¿å…çº§è”æ•…éšœï¼Œä»¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ã€‚</strong><br>â€‹    â€œæ–­è·¯å™¨â€æœ¬èº«æ˜¯ä¸€ç§å¼€å…³è£…ç½®ï¼Œå½“æŸä¸ªæœåŠ¡å•å…ƒå‘ç”Ÿæ•…éšœä¹‹åï¼Œé€šè¿‡æ–­è·¯å™¨çš„æ•…éšœç›‘æ§ï¼ˆç±»ä¼¼ç†”æ–­ä¿é™©ä¸ï¼‰ï¼Œ<strong>å‘è°ƒç”¨æ–¹è¿”å›ä¸€ä¸ªç¬¦åˆé¢„æœŸçš„ã€å¯å¤„ç†çš„å¤‡é€‰å“åº”ï¼ˆFallBack)**ï¼Œè€Œ</strong>ä¸æ˜¯é•¿æ—¶é—´çš„ç­‰å¾…æˆ–è€…æŠ›å‡ºè°ƒç”¨æ–¹æ— æ³•å¤„ç†çš„å¼‚å¸¸**ï¼Œè¿™æ ·å°±ä¿è¯äº†æœåŠ¡è°ƒç”¨æ–¹çš„çº¿ç¨‹ä¸ä¼šè¢«é•¿æ—¶é—´ã€ä¸å¿…è¦åœ°å ç”¨ï¼Œä»è€Œé¿å…äº†æ•…éšœåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„è”“å»¶ï¼Œä¹ƒè‡³é›ªå´©ã€‚</p></blockquote><h1 id="äºŒã€Hystrixé‡è¦æ¦‚å¿µ"><a href="#äºŒã€Hystrixé‡è¦æ¦‚å¿µ" class="headerlink" title="äºŒã€Hystrixé‡è¦æ¦‚å¿µ"></a>äºŒã€Hystrixé‡è¦æ¦‚å¿µ</h1><h2 id="2-1ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰"><a href="#2-1ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰" class="headerlink" title="2.1ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰"></a>2.1ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰</h2><h3 id="1ã€ä»‹ç»"><a href="#1ã€ä»‹ç»" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h3><blockquote><p>å‡è®¾è¦è°ƒç”¨çš„å¾®æœåŠ¡/ç³»ç»Ÿ<strong>å‡ºç°æ•…éšœä¸å¯ç”¨</strong>äº†ï¼Œæ­¤æ—¶ä¸è®©å®¢æˆ·ç«¯<strong>ç­‰å¾…</strong>å¹¶<strong>ç«‹åˆ»è¿”å›ä¸€ä¸ªå‹å¥½æç¤º</strong>ï¼Œfallback</p></blockquote><h3 id="2ã€ä¼šè§¦å‘æœåŠ¡é™çº§çš„æƒ…å†µ"><a href="#2ã€ä¼šè§¦å‘æœåŠ¡é™çº§çš„æƒ…å†µ" class="headerlink" title="2ã€ä¼šè§¦å‘æœåŠ¡é™çº§çš„æƒ…å†µ"></a>2ã€ä¼šè§¦å‘æœåŠ¡é™çº§çš„æƒ…å†µ</h3><ul><li>ç¨‹åºè¿è¡Œå¼‚å¸¸</li><li>è¶…æ—¶</li><li>æœåŠ¡ç†”æ–­è§¦å‘æœåŠ¡é™çº§</li><li>çº¿ç¨‹æ± /ä¿¡å·é‡æ‰“æ»¡ä¹Ÿä¼šè§¦å‘æœåŠ¡é™çº§ã€‚</li></ul><h2 id="2-2ã€æœåŠ¡ç†”æ–­ï¼ˆbreakï¼‰"><a href="#2-2ã€æœåŠ¡ç†”æ–­ï¼ˆbreakï¼‰" class="headerlink" title="2.2ã€æœåŠ¡ç†”æ–­ï¼ˆbreakï¼‰"></a>2.2ã€æœåŠ¡ç†”æ–­ï¼ˆbreakï¼‰</h2><h3 id="1ã€ä»‹ç»-1"><a href="#1ã€ä»‹ç»-1" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h3><blockquote><p>ç±»æ¯”ä¿é™©ä¸ï¼Œå½“ç”µå™¨æ€»åŠŸç‡è¾¾åˆ°ä¸€å®šé™åº¦åç›´æ¥ç†”æ–­ï¼Œä¸è®©ç”µå™¨ç»§ç»­å·¥ä½œã€‚å³<strong>æœåŠ¡è¾¾åˆ°æœ€å¤§è®¿é—®é‡åç›´æ¥æ‹’ç»è®¿é—®</strong>ï¼Œæ‹‰é—¸é™ç”µï¼Œç„¶å<strong>è°ƒç”¨æœåŠ¡é™çº§çš„æ–¹æ³•å¹¶è¿”å›å‹å¥½æç¤º</strong>ï¼Œè¿™æ ·å¯ä»¥æ”¾ç½®æ•´ä¸ªç³»ç»Ÿè¢«æ‹–å®ã€‚</p><p>æ•…æœåŠ¡ç†”æ–­ä¼š<strong>è§¦å‘</strong>æœåŠ¡é™çº§ã€‚</p></blockquote><p>æœåŠ¡ç†”æ–­å°±æ˜¯ä¿é™©ä¸ï¼š<strong>æœåŠ¡çš„é™çº§</strong>-&gt;<strong>è¿›è€Œç†”æ–­</strong>-&gt;<strong>æ¢å¤è°ƒç”¨é“¾è·¯</strong></p><h3 id="2ã€Hystrixçš„å¼¹æ€§å®¹é”™"><a href="#2ã€Hystrixçš„å¼¹æ€§å®¹é”™" class="headerlink" title="2ã€Hystrixçš„å¼¹æ€§å®¹é”™"></a>2ã€Hystrixçš„å¼¹æ€§å®¹é”™</h3><blockquote><p>â€‹    ä¸åŒäºç”µè·¯ç†”æ–­åªèƒ½æ–­ä¸èƒ½è‡ªåŠ¨é‡è¿ï¼ŒHystrixå¯ä»¥å®ç°å¼¹æ€§å®¹é”™ï¼Œå½“æƒ…å†µå¥½è½¬ä¹‹åï¼Œå¯ä»¥è‡ªåŠ¨é‡è¿ã€‚è¿™å°±å¥½æ¯”é­”æœ¯å¸ˆæŠŠé¸½å­å˜æ²¡äº†å®¹æ˜“ï¼Œä½†æ˜¯çœŸæ­£è€ƒéªŒæŠ€æœ¯çš„æ˜¯å¦‚ä½•æŠŠæ¶ˆå¤±çš„é¸½å­å†å˜å›æ¥ã€‚<br>â€‹    é€šè¿‡æ–­è·¯çš„æ–¹å¼ï¼Œå¯ä»¥å°†åç»­è¯·æ±‚ç›´æ¥æ‹’ç»æ‰ï¼Œä¸€æ®µæ—¶é—´ä¹‹åå…è®¸éƒ¨åˆ†è¯·æ±‚é€šè¿‡ï¼Œå¦‚æœè°ƒç”¨æˆåŠŸåˆ™å›åˆ°ç”µè·¯é—­åˆçŠ¶æ€ï¼Œå¦åˆ™ç»§ç»­æ–­å¼€ã€‚</p></blockquote><h3 id="3ã€Hystrixç†”æ–­çŠ¶æ€æœºçš„ä¸‰ä¸ªçŠ¶æ€"><a href="#3ã€Hystrixç†”æ–­çŠ¶æ€æœºçš„ä¸‰ä¸ªçŠ¶æ€" class="headerlink" title="3ã€Hystrixç†”æ–­çŠ¶æ€æœºçš„ä¸‰ä¸ªçŠ¶æ€"></a>3ã€Hystrixç†”æ–­çŠ¶æ€æœºçš„ä¸‰ä¸ªçŠ¶æ€</h3><ul><li>Closedï¼šå…³é—­çŠ¶æ€ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½æ­£å¸¸è®¿é—®ã€‚</li><li>Openï¼šæ‰“å¼€çŠ¶æ€ï¼Œæ‰€æœ‰è¯·æ±‚éƒ½ä¼šè¢«é™çº§ã€‚Hystixä¼šå¯¹è¯·æ±‚æƒ…å†µè®¡æ•°ï¼Œå½“ä¸€å®šæ—¶é—´å†…å¤±è´¥è¯·æ±‚ç™¾åˆ†æ¯”è¾¾åˆ°é˜ˆå€¼ï¼Œåˆ™è§¦å‘ç†”æ–­ï¼Œæ–­è·¯å™¨ä¼šå®Œå…¨æ‰“å¼€ã€‚é»˜è®¤å¤±è´¥æ¯”ä¾‹çš„é˜ˆå€¼æ˜¯50%ï¼Œè¯·æ±‚æ¬¡æ•°æœ€å°‘ä¸ä½äº20æ¬¡ã€‚</li><li>Half Openï¼šåŠå¼€çŠ¶æ€ï¼ŒopençŠ¶æ€ä¸æ˜¯æ°¸ä¹…çš„ï¼Œæ‰“å¼€åä¼šè¿›å…¥ä¼‘çœ æ—¶é—´ï¼ˆé»˜è®¤æ˜¯5Sï¼‰ã€‚éšåæ–­è·¯å™¨ä¼šè‡ªåŠ¨è¿›å…¥åŠå¼€çŠ¶æ€ã€‚æ­¤æ—¶ä¼šé‡Šæ”¾éƒ¨åˆ†è¯·æ±‚é€šè¿‡ï¼Œè‹¥è¿™äº›è¯·æ±‚éƒ½æ˜¯å¥åº·çš„ï¼Œåˆ™ä¼šå®Œå…¨å…³é—­æ–­è·¯å™¨ï¼Œå¦åˆ™ç»§ç»­ä¿æŒæ‰“å¼€ï¼Œå†æ¬¡è¿›è¡Œä¼‘çœ è®¡æ—¶</li></ul><h2 id="2-3ã€æœåŠ¡é™æµï¼ˆfloat-limitedï¼‰"><a href="#2-3ã€æœåŠ¡é™æµï¼ˆfloat-limitedï¼‰" class="headerlink" title="2.3ã€æœåŠ¡é™æµï¼ˆfloat limitedï¼‰"></a>2.3ã€æœåŠ¡é™æµï¼ˆfloat limitedï¼‰</h2><blockquote><p>ç§’æ€é«˜å¹¶å‘ç­‰æ“ä½œä¸­ï¼Œä¸¥ç¦è¯·æ±‚ä¸€çªèœ‚åœ°è¿‡æ¥æ‹¥æŒ¤ï¼Œéœ€è¦ä½¿è¯·æ±‚æ’é˜Ÿï¼Œä¸€ç§’é’ŸNä¸ªï¼Œæœ‰åºè¿›è¡Œã€‚</p></blockquote><h1 id="ä¸‰ã€Hystrixæ¡ˆä¾‹"><a href="#ä¸‰ã€Hystrixæ¡ˆä¾‹" class="headerlink" title="ä¸‰ã€Hystrixæ¡ˆä¾‹"></a>ä¸‰ã€Hystrixæ¡ˆä¾‹</h1><h2 id="3-1ã€æ„å»ºåŸºç¡€é¡¹ç›®"><a href="#3-1ã€æ„å»ºåŸºç¡€é¡¹ç›®" class="headerlink" title="3.1ã€æ„å»ºåŸºç¡€é¡¹ç›®"></a>3.1ã€æ„å»ºåŸºç¡€é¡¹ç›®</h2><blockquote><p>æ–°å»ºcloud-provider-hystrix-payment8001å¾®æœåŠ¡</p></blockquote><h3 id="1ã€POM"><a href="#1ã€POM" class="headerlink" title="1ã€POM"></a>1ã€POM</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–°å¢hystrix--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€YML"><a href="#2ã€YML" class="headerlink" title="2ã€YML"></a>2ã€YML</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">8001</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-provider-hystrix-payment</span>  </span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span>    <span class="comment">#è¡¨è¯†ä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span>   <span class="comment">#è¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/</span></span><br></pre></td></tr></table></figure><h3 id="3ã€ä¸»å¯åŠ¨ç±»"><a href="#3ã€ä¸»å¯åŠ¨ç±»" class="headerlink" title="3ã€ä¸»å¯åŠ¨ç±»"></a>3ã€ä¸»å¯åŠ¨ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentHystrixMain8001</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(PaymentHystrixMain8001.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€ä¸šåŠ¡ç±»"><a href="#4ã€ä¸šåŠ¡ç±»" class="headerlink" title="4ã€ä¸šåŠ¡ç±»"></a>4ã€ä¸šåŠ¡ç±»</h3><blockquote><p>åœ¨serviceå±‚ä¸­ç¼–å†™ä¸€ä¸ªæ­£å¸¸è®¿é—®å’Œä¸€ä¸ªè¶…æ—¶çš„æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentServiceImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çº¿ç¨‹æ± ï¼š&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;paymentInfo_OK,id:&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;ğŸ˜„&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOut</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> timeOut = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(timeOut);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException interruptedException) &#123;</span><br><span class="line">            interruptedException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çº¿ç¨‹æ± ï¼š&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;paymentInfo_TimeOut,id:&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;ğŸ˜¢è€—æ—¶(S):&quot;</span> + timeOut;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€Controllerå±‚"><a href="#5ã€Controllerå±‚" class="headerlink" title="5ã€Controllerå±‚"></a>5ã€Controllerå±‚</h3><blockquote><p>ç¼–å†™ä¸€ä¸ªæ­£å¸¸è®¿é—®æ¥å£å’Œä¸€ä¸ªè¶…æ—¶æ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PaymentServiceImpl paymentService;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/payment/hystrix/ok/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_Ok</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">        String result = paymentService.paymentInfo_OK(id);</span><br><span class="line">        log.info(<span class="string">&quot;*********result:&quot;</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/payment/hystrix/timeout/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOut</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">        String result = paymentService.paymentInfo_TimeOut(id);</span><br><span class="line">        log.info(<span class="string">&quot;*********result:&quot;</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€æµ‹è¯•"><a href="#6ã€æµ‹è¯•" class="headerlink" title="6ã€æµ‹è¯•"></a>6ã€æµ‹è¯•</h3><blockquote><p>æ‰“å¼€eureka7001ã€hystrix-payment8001ï¼Œæµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212132513.png" alt="image-20210212132512369"></p><blockquote><p>è°ƒç”¨æˆåŠŸçš„æ–¹æ³•ï¼š<a href="http://localhost:8001/payment/hystrix/ok/31">http://localhost:8001/payment/hystrix/ok/31</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212132619.png" alt="image-20210212132619143"></p><blockquote><p>è°ƒç”¨è¶…æ—¶æ–¹æ³•ï¼š<a href="http://localhost:8001/payment/hystrix/timeout/31">http://localhost:8001/payment/hystrix/timeout/31</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212132704.png" alt="image-20210212132704481"></p><h2 id="3-2ã€é«˜å¹¶å‘æµ‹è¯•"><a href="#3-2ã€é«˜å¹¶å‘æµ‹è¯•" class="headerlink" title="3.2ã€é«˜å¹¶å‘æµ‹è¯•"></a>3.2ã€é«˜å¹¶å‘æµ‹è¯•</h2><blockquote><p>ä»¥ä¸Šé¢çš„é¡¹ç›®ä¸ºæ ¹åŸº</p></blockquote><h3 id="1ã€ä½¿ç”¨JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•"><a href="#1ã€ä½¿ç”¨JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•" class="headerlink" title="1ã€ä½¿ç”¨JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•"></a>1ã€ä½¿ç”¨JMeterè¿›è¡Œå‹åŠ›æµ‹è¯•</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212133943.png" alt="image-20210212133943440"></p><blockquote><p>å¯åŠ¨Jmeteråå†æ¬¡è®¿é—®<a href="http://localhost:8001/payment/hystrix/ok/31%E6%8E%A5%E5%8F%A3%EF%BC%8C%E5%8F%91%E7%8E%B0%E5%93%8D%E5%BA%94%E6%98%8E%E6%98%BE%E5%8F%98%E6%85%A2%EF%BC%8C%E5%8D%B3http://localhost:8001/payment/hystrix/timeout/31%E6%8E%A5%E5%8F%A3%E8%A2%AB%E6%8C%A4%E7%88%86%E5%90%8E%EF%BC%8Chttp://localhost:8001/payment/hystrix/ok/31%E6%8E%A5%E5%8F%A3%E4%B9%9F%E4%BC%9A%E8%A2%AB%E6%8B%96%E7%B4%AF%E3%80%82">http://localhost:8001/payment/hystrix/ok/31æ¥å£ï¼Œå‘ç°å“åº”æ˜æ˜¾å˜æ…¢ï¼Œå³http://localhost:8001/payment/hystrix/timeout/31æ¥å£è¢«æŒ¤çˆ†åï¼Œhttp://localhost:8001/payment/hystrix/ok/31æ¥å£ä¹Ÿä¼šè¢«æ‹–ç´¯ã€‚</a></p></blockquote><h3 id="2ã€ä½¿ç”¨æ¶ˆè´¹è€…è°ƒç”¨Payment8001"><a href="#2ã€ä½¿ç”¨æ¶ˆè´¹è€…è°ƒç”¨Payment8001" class="headerlink" title="2ã€ä½¿ç”¨æ¶ˆè´¹è€…è°ƒç”¨Payment8001"></a>2ã€ä½¿ç”¨æ¶ˆè´¹è€…è°ƒç”¨Payment8001</h3><blockquote><p>æ–°å»ºä¸€ä¸ªcloud-consumer-feign-hystrix-order80å¾®æœåŠ¡</p></blockquote><blockquote><p>å¼•å…¥ä¾èµ–</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–°å¢hystrix--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¼–å†™ymlæ–‡ä»¶</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">true</span>    <span class="comment">#è¡¨è¯†ä¸å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±</span></span><br><span class="line">    <span class="attr">fetch-registry:</span> <span class="literal">true</span>   <span class="comment">#è¡¨ç¤ºè‡ªå·±å°±æ˜¯æ³¨å†Œä¸­å¿ƒï¼ŒèŒè´£æ˜¯ç»´æŠ¤æœåŠ¡å®ä¾‹ï¼Œå¹¶ä¸éœ€è¦å»æ£€ç´¢æœåŠ¡</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka/</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-provider-hystrix-order</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸»å¯åŠ¨ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.hzx.springcloud&quot;,&quot;com.hzx.common&quot;&#125;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHystrixMain80</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(OrderHystrixMain80.class,args);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost/swagger-ui.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸šåŠ¡ç±»ï¼šservice</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;cloud-provider-hystrix-payment&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PaymentHystrixService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/payment/hystrix/ok/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/payment/hystrix/timeout/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOut</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ä¸šåŠ¡ç±»ï¼šController</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderHystrixController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PaymentHystrixService paymentHystrixService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/consumer/payment/hystrix/ok/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">        String result = paymentHystrixService.paymentInfo_OK(id);</span><br><span class="line">        log.info(<span class="string">&quot;ç»“æœä¸ºï¼š&quot;</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/consumer/payment/hystrix/timeout/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TIMEOUT</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">        String result = paymentHystrixService.paymentInfo_TimeOut(id);</span><br><span class="line">        log.info(<span class="string">&quot;ç»“æœä¸ºï¼š&quot;</span> + result);</span><br><span class="line">        <span class="keyword">return</span> result;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ•…éšœåŸå› ï¼š</p><p>8001åŒä¸€å±‚æ¬¡çš„å…¶ä»–æ¥å£æœåŠ¡è¢«å›°æ­»ï¼Œå› ä¸ºtomcatçº¿ç¨‹é‡Œé¢çš„å·¥ä½œçº¿ç¨‹å·²ç»è¢«æŒ¤å å®Œæ¯•</p><p>80æ­¤æ—¶è°ƒç”¨8001ï¼Œå®¢æˆ·ç«¯è®¿é—®å“åº”ç¼“æ…¢ï¼Œè½¬åœˆåœˆ</p></blockquote><h2 id="3-3ã€è§£å†³æ–¹æ¡ˆ"><a href="#3-3ã€è§£å†³æ–¹æ¡ˆ" class="headerlink" title="3.3ã€è§£å†³æ–¹æ¡ˆ"></a>3.3ã€è§£å†³æ–¹æ¡ˆ</h2><h3 id="1ã€é—®é¢˜1"><a href="#1ã€é—®é¢˜1" class="headerlink" title="1ã€é—®é¢˜1"></a>1ã€é—®é¢˜1</h3><blockquote><p>è¶…æ—¶å¯¼è‡´æœåŠ¡å™¨å˜æ…¢ï¼ˆè½¬åœˆï¼‰</p></blockquote><p>è¶…æ—¶ä¸å†ç­‰å¾…</p><h3 id="2ã€é—®é¢˜2"><a href="#2ã€é—®é¢˜2" class="headerlink" title="2ã€é—®é¢˜2"></a>2ã€é—®é¢˜2</h3><blockquote><p>å‡ºé”™ï¼ˆæœåŠ¡å™¨å®•æœºæˆ–è€…ç¨‹åºè¿è¡Œé”™è¯¯ï¼‰</p></blockquote><p>å‡ºé”™è¦æœ‰å…œåº•æ–¹æ¡ˆ</p><h3 id="3ã€è§£å†³"><a href="#3ã€è§£å†³" class="headerlink" title="3ã€è§£å†³"></a>3ã€è§£å†³</h3><blockquote><p>å¯¹æ–¹æœåŠ¡ï¼ˆ8001ï¼‰è¶…æ—¶äº†ï¼Œè°ƒç”¨è€…ï¼ˆ80ï¼‰ä¸èƒ½ä¸€ç›´å¡æ­»ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§</p><p>å¯¹æ–¹æœåŠ¡ï¼ˆ8001ï¼‰downæœºäº†ï¼Œè°ƒç”¨è€…ï¼ˆ80ï¼‰ä¸èƒ½ä¸€ç›´å¡æ­»ç­‰å¾…ï¼Œå¿…é¡»æœ‰æœåŠ¡é™çº§</p><p>å¯¹æ–¹æœåŠ¡ï¼ˆ8001ï¼‰OKï¼Œè°ƒç”¨è€…ï¼ˆ80ï¼‰è‡ªå·±å‡ºæ•…éšœæˆ–æœ‰è‡ªæˆ‘è¦æ±‚ï¼ˆè‡ªå·±çš„ç­‰å¾…æ—¶é—´å°äºæœåŠ¡æä¾›è€…ï¼‰ï¼Œè‡ªå·±å¤„ç†é™çº§</p></blockquote><h2 id="3-4ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰"><a href="#3-4ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰" class="headerlink" title="3.4ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰"></a>3.4ã€æœåŠ¡é™çº§ï¼ˆfallbackï¼‰</h2><h3 id="1ã€å¯¹è‡ªèº«è¿›è¡Œé™çº§é…ç½®"><a href="#1ã€å¯¹è‡ªèº«è¿›è¡Œé™çº§é…ç½®" class="headerlink" title="1ã€å¯¹è‡ªèº«è¿›è¡Œé™çº§é…ç½®"></a>1ã€å¯¹è‡ªèº«è¿›è¡Œé™çº§é…ç½®</h3><blockquote><p>å…ˆä»8001è‡ªèº«æ‰¾é—®é¢˜ï¼šéœ€è¦è®¾ç½®è‡ªèº«è°ƒç”¨è¶…æ—¶æ—¶é—´çš„å³°å€¼ï¼Œåœ¨å³°å€¼æ—¶é—´å†…å¯ä»¥æ­£å¸¸è¿è¡Œï¼Œè¶…è¿‡å³°å€¼åéœ€è¦æœ‰å…œåº•çš„æ–¹æ³•å¤„ç†ï¼Œåšé™çº§å¤„ç†ã€‚</p><p>ä½¿ç”¨æ­¥éª¤å¦‚ä¸‹</p></blockquote><ul><li>åœ¨ä¸šåŠ¡ç±»ä¸­å¯ç”¨@HystrixCommandæ³¨è§£</li><li>ä½¿ç”¨@HystrixCommandæ³¨è§£çš„fallbackMethodå±æ€§æŒ‡å®šå…œåº•æ–¹æ³•</li><li>ä½¿ç”¨@HystrixCommandæ³¨è§£çš„commandPropertieså±æ€§æŒ‡å®šè‡ªèº«è°ƒç”¨è¶…æ—¶æ—¶é—´çš„å³°å€¼ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HystrixCommand(fallbackMethod = &quot;paymentInfo_TimeOutHandler&quot;,commandProperties = &#123;</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;,value = &quot;3000&quot;)  //3ç§’é’Ÿä»¥å†…å°±æ˜¯æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br></pre></td></tr></table></figure><ul><li>è‹¥ä¸šåŠ¡æ—¶é—´åœ¨è¶…æ—¶æ—¶é—´å³°å€¼ä¹‹å†…ï¼Œé‚£ä¹ˆèµ°æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘ï¼Œè¶…è¿‡å³°å€¼åç›´æ¥è°ƒç”¨å…œåº•æ–¹æ³•ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentServiceImpl</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çº¿ç¨‹æ± ï¼š&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;paymentInfo_OK,id:&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;ğŸ˜„&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@HystrixCommand(fallbackMethod = &quot;paymentInfo_TimeOutHandler&quot;,commandProperties = &#123;</span></span><br><span class="line"><span class="meta">            @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;,value = &quot;3000&quot;)  //3ç§’é’Ÿä»¥å†…å°±æ˜¯æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="meta">    &#125;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOut</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> timeOut = <span class="number">5</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            TimeUnit.SECONDS.sleep(timeOut);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (InterruptedException interruptedException) &#123;</span><br><span class="line">            interruptedException.printStackTrace();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çº¿ç¨‹æ± ï¼š&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;paymentInfo_TimeOut,id:&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;ğŸ˜¢è€—æ—¶(S):&quot;</span> + timeOut;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOutHandler</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;çº¿ç¨‹æ± ï¼š&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;paymentInfo_TimeOutHandler,id:&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;ğŸ˜“&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableCircuitBreakeræ³¨è§£æ¿€æ´»æœåŠ¡é™çº§</li><li>æµ‹è¯•ï¼Œç”±äºæˆ‘ä»¬è®¾ç½®äº†å³°å€¼æ—¶é—´ä¸º3sï¼Œè€Œæˆ‘ä»¬åœ¨ä¸šåŠ¡ä¸­ä¼‘çœ äº†5sï¼Œæ‰€ä»¥ä¼šè§¦å‘æœåŠ¡é™çº§</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212153100.png" alt="image-20210212153058330"></p><blockquote><p>é™¤è¶…å¸‚å¤–ï¼Œç³»ç»Ÿå‡ºç°å¼‚å¸¸æ—¶ä¹Ÿä¼šè°ƒç”¨å…œåº•æ–¹æ¡ˆ</p></blockquote><h3 id="2ã€å¯¹æ¶ˆè´¹ç«¯è¿›è¡Œé™çº§é…ç½®"><a href="#2ã€å¯¹æ¶ˆè´¹ç«¯è¿›è¡Œé™çº§é…ç½®" class="headerlink" title="2ã€å¯¹æ¶ˆè´¹ç«¯è¿›è¡Œé™çº§é…ç½®"></a>2ã€å¯¹æ¶ˆè´¹ç«¯è¿›è¡Œé™çº§é…ç½®</h3><blockquote><p>å¯¹äºéœ€è¦<strong>è¿œç¨‹è°ƒç”¨payment8001çš„è®¢å•å¾®æœåŠ¡80</strong>ï¼Œå®ƒä¹Ÿå¯ä»¥æ›´å¥½åœ°ä¿æŠ¤è‡ªå·±ï¼Œ<strong>å¯¹è‡ªå·±è¿›è¡Œå®¢æˆ·ç«¯é™çº§ä¿æŠ¤</strong>ã€‚</p><p>hystrixçš„æœåŠ¡é™çº§æ—¢å¯ä»¥åšåœ¨æ¶ˆè´¹ï¼ˆè°ƒç”¨æœåŠ¡ï¼‰ç«¯ï¼Œä¹Ÿå¯ä»¥åšåœ¨æœåŠ¡ï¼ˆæä¾›æœåŠ¡ï¼‰ç«¯ï¼Œä½†æœåŠ¡é™çº§ä¸€èˆ¬åšåœ¨æ¶ˆè´¹ç«¯</p></blockquote><ul><li>åœ¨80è®¢å•å¾®æœåŠ¡çš„ymlæ–‡ä»¶ä¸­æ·»åŠ é…ç½®</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">feign:</span></span><br><span class="line">  <span class="attr">hystrix:</span></span><br><span class="line">    <span class="attr">enabled:</span> <span class="literal">true</span> <span class="comment">#å¦‚æœå¤„ç†è‡ªèº«çš„å®¹é”™å°±å¼€å¯ã€‚å¼€å¯æ–¹å¼ä¸ç”Ÿäº§ç«¯ä¸ä¸€æ ·ã€‚</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨80è®¢å•å¾®æœåŠ¡çš„ä¸»å¯åŠ¨ç±»ä¸Šæ·»åŠ @EnableHystrixæ³¨è§£æ¿€æ´»Hystrix</li><li>ä¿®æ”¹ä¸šåŠ¡ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/consumer/payment/hystrix/timeout/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@HystrixCommand(fallbackMethod = &quot;paymentTimeOutFallbackMethod&quot;,commandProperties = &#123;</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;,value = &quot;1500&quot;)</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TIMEOUT</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">    String result = paymentHystrixService.paymentInfo_TimeOut(id);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentTimeOutFallbackMethod</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;æˆ‘æ˜¯æ¶ˆè´¹è€…80ï¼Œå¯¹ä»˜æ”¯ä»˜ç³»ç»Ÿç¹å¿™è¯·10ç§’é’Ÿåå†è¯•æˆ–è€…è‡ªå·±è¿è¡Œå‡ºé”™è¯·æ£€æŸ¥è‡ªå·±,(â”¬ï¼¿â”¬)&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>æµ‹è¯•</p><ul><li>ä¿®æ”¹paymentHystrix8001ä¸­çš„ä¸šåŠ¡ç±»ï¼Œç¡®ä¿8001ä¸­çš„æ–¹æ³•å¯ä»¥æ­£å¸¸è¿è¡Œ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HystrixCommand(fallbackMethod = &quot;paymentInfo_TimeOutHandler&quot;,commandProperties = &#123;</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;execution.isolation.thread.timeoutInMilliseconds&quot;,value = &quot;5000&quot;)  //3ç§’é’Ÿä»¥å†…å°±æ˜¯æ­£å¸¸çš„ä¸šåŠ¡é€»è¾‘</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOut</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> timeOut = <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(timeOut);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException interruptedException) &#123;</span><br><span class="line">        interruptedException.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;çº¿ç¨‹æ± ï¼š&quot;</span> + Thread.currentThread().getName() + <span class="string">&quot;paymentInfo_TimeOut,id:&quot;</span> + id + <span class="string">&quot;\t&quot;</span> + <span class="string">&quot;ğŸ˜¢è€—æ—¶(S):&quot;</span> + timeOut;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨å¾®æœåŠ¡ï¼Œæ­¤æ—¶ç”±äº80è®¢å•ä¸­å¾®æœåŠ¡çš„è¶…æ—¶æ—¶é—´å³°å€¼ä¸º1.5sï¼Œè€Œ8001ä¼‘çœ äº†3sï¼Œæ‰€ä»¥80ä¼šè°ƒç”¨å¤±è´¥ï¼Œæ­¤æ—¶ä¼šè°ƒç”¨è‡ªèº«çš„å…œåº•æ–¹æ³•</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213205233.png"></p></li></ul><blockquote><p>å¦‚æœ80å¾®æœåŠ¡ç«¯å‘ç”Ÿè¿è¡Œæ—¶å¼‚å¸¸ï¼Œé‚£ä¹ˆä¹Ÿä¼šç›´æ¥æ‰§è¡Œå…œåº•æ–¹æ¡ˆã€‚</p></blockquote><h3 id="3ã€ä»¥ä¸Šé…ç½®å­˜åœ¨çš„é—®é¢˜"><a href="#3ã€ä»¥ä¸Šé…ç½®å­˜åœ¨çš„é—®é¢˜" class="headerlink" title="3ã€ä»¥ä¸Šé…ç½®å­˜åœ¨çš„é—®é¢˜"></a>3ã€ä»¥ä¸Šé…ç½®å­˜åœ¨çš„é—®é¢˜</h3><ul><li>æ¯ä¸ªä¸šåŠ¡æ–¹æ³•å¯¹åº”ä¸€ä¸ªå…œåº•çš„æ–¹æ³•ï¼Œä»£ç è†¨èƒ€</li><li>ä¸šåŠ¡é€»è¾‘å’Œå…œåº•æ–¹æ³•æ··æ‚åœ¨ä¸€èµ·ï¼Œä»£ç æ··ä¹±ã€‚</li><li>å…¨å±€å…œåº•æ–¹æ³•å’Œè‡ªå®šä¹‰å…œåº•æ–¹æ³•åˆ†å¼€</li></ul><blockquote><p>é…ç½®ä¸€ä¸ªå…¨å±€å…œåº•æ–¹æ³•ï¼Œä½¿ç”¨@DefaultProperties(defaultFallback = â€œå…¨å±€å…œåº•æ–¹æ³•åâ€) æ¥æŒ‡å®šå…¨å±€å…œåº•æ–¹æ³•ã€‚</p><p>åŠ å…¥å…¨å±€å…œåº•æ–¹æ³•åï¼Œä»£ç ç»“æ„å¯å˜ä¸º</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213210443.png" alt="img"></p><blockquote><p>1å¯¹Nï¼Œé™¤äº†ä¸ªåˆ«é‡è¦æ ¸å¿ƒä¸šåŠ¡æœ‰ä¸“å±å…œåº•æ–¹æ³•ï¼Œå…¶ä½™æ™®é€šçš„æ–¹æ³•éƒ½å¯ä»¥é€šè¿‡å…¨å±€å…œåº•æ–¹æ³•ç»Ÿä¸€å…œåº•ã€‚</p><p>ä¿®æ”¹80è®¢å•å¾®æœåŠ¡çš„Controllerå±‚</p></blockquote><ul><li>æ·»åŠ ä¸€ä¸ªå…¨å±€å…œåº•æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * ä¸‹é¢æ˜¯å…¨å±€fallbackæ–¹æ³•</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">payment_Global_FallbackMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;Globalå¼‚å¸¸å¤„ç†ä¿¡æ¯ï¼Œè¯·ç¨åå†è¯•...ğŸ˜“&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨æ§åˆ¶å™¨ä¸Šæ·»åŠ æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DefaultProperties(defaultFallback = &quot;payment_Global_FallbackMethod&quot;)</span></span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹ä¸šåŠ¡ç±»ï¼Œä½¿ç”¨å…¨å±€å…œåº•æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/consumer/payment/hystrix/timeout/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@HystrixCommand</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TIMEOUT</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span> </span>&#123;</span><br><span class="line">    String result = paymentHystrixService.paymentInfo_TimeOut(id);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€ä¸ºè¿œç¨‹è°ƒç”¨æ¥å£æ·»åŠ ä¸€ä¸ªç»Ÿä¸€é™çº§ç±»"><a href="#4ã€ä¸ºè¿œç¨‹è°ƒç”¨æ¥å£æ·»åŠ ä¸€ä¸ªç»Ÿä¸€é™çº§ç±»" class="headerlink" title="4ã€ä¸ºè¿œç¨‹è°ƒç”¨æ¥å£æ·»åŠ ä¸€ä¸ªç»Ÿä¸€é™çº§ç±»"></a>4ã€ä¸ºè¿œç¨‹è°ƒç”¨æ¥å£æ·»åŠ ä¸€ä¸ªç»Ÿä¸€é™çº§ç±»</h3><blockquote><p>æœåŠ¡é™çº§ï¼Œå®¢æˆ·ç«¯å»è°ƒç”¨æœåŠ¡ç«¯ï¼Œç¢°ä¸ŠæœåŠ¡ç«¯å®•æœºæˆ–å…³é—­ã€‚</p><p>ä¿®æ”¹order80è®¢å•å¾®æœåŠ¡ï¼Œæ ¹æ®order80è®¢å•å¾®æœåŠ¡å·²ç»æœ‰çš„PaymentHystrixServiceæ¥å£ï¼Œé‡æ–°æ–°å»ºä¸€ä¸ªç±»ï¼ˆPaymentFallbackServiceï¼‰å®ç°è¯¥æ¥å£ï¼Œç»Ÿä¸€ä¸ºæ¥å£é‡Œé¢çš„æ–¹æ³•è¿›è¡Œå¼‚å¸¸å¤„ç†ã€‚</p><p>ç¼–å†™ä¸€ä¸ªç±»ï¼Œå®ç°PaymentHystrixServiceæ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentFallbackService</span> <span class="keyword">implements</span> <span class="title">PaymentHystrixService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_OK</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;----PaymentFallbackService fall back-payment_OKï¼ŒğŸ˜‚&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">paymentInfo_TimeOut</span><span class="params">(Integer id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;----PaymentFallbackService fall back-paymentInfo_TimeOutï¼ŒğŸ˜‚&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ­¤æ—¶æ²¡æœ‰é…ç½®ä»»ä½•å…œåº•æ–¹æ³•çš„paymentInfo_OKæ–¹æ³•ç”±PaymentFallbackServiceç±»ä¸­çš„å®ç°æ–¹æ³•å…œåº•</p><p>æµ‹è¯•</p></blockquote><ul><li>æ­£å¸¸æµ‹è¯•ï¼Œè®¿é—®ï¼š<a href="http://localhost/consumer/payment/hystrix/ok/31">http://localhost/consumer/payment/hystrix/ok/31</a></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213214055.png" alt="image-20210213214054384"></p><ul><li>å…³é—­payment8001ï¼Œæ¨¡æ‹ŸæœåŠ¡ç«¯å®•æœºï¼Œé‡æ–°è®¿é—®ï¼š<a href="http://localhost/consumer/payment/hystrix/ok/31">http://localhost/consumer/payment/hystrix/ok/31</a> ï¼Œæ­¤æ—¶å¯ä»¥çœ‹åˆ°è°ƒç”¨äº†PaymentFallbackServiceç±»ä¸­çš„å®ç°æ–¹æ³•å…œåº•ã€‚</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213214153.png" alt="image-20210213214152979"></p><blockquote><p>æ­¤æ—¶æœåŠ¡ç«¯providerå·²ç»downäº†ï¼Œä½†æ˜¯æˆ‘ä»¬åšäº†æœåŠ¡é™çº§å¤„ç†ï¼Œè®©å®¢æˆ·ç«¯åœ¨æœåŠ¡ç«¯ä¸å¯ç”¨æ—¶ä¹Ÿä¼šè·å¾—æç¤ºä¿¡æ¯è€Œä¸ä¼šæŒ‚èµ·è€—æ­»æœåŠ¡å™¨</p></blockquote><h2 id="3-5ã€æœåŠ¡ç†”æ–­"><a href="#3-5ã€æœåŠ¡ç†”æ–­" class="headerlink" title="3.5ã€æœåŠ¡ç†”æ–­"></a>3.5ã€æœåŠ¡ç†”æ–­</h2><h3 id="1ã€ä¿®æ”¹cloud-provider-hystrix-payment8001"><a href="#1ã€ä¿®æ”¹cloud-provider-hystrix-payment8001" class="headerlink" title="1ã€ä¿®æ”¹cloud-provider-hystrix-payment8001"></a>1ã€ä¿®æ”¹cloud-provider-hystrix-payment8001</h3><ul><li>ä¿®æ”¹PaymentService</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@HystrixCommand(fallbackMethod = &quot;paymentCircuitBreaker_fallback&quot;,commandProperties = &#123;</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;circuitBreaker.enabled&quot;,value = &quot;true&quot;),  //æ˜¯å¦å¼€å¯æ–­è·¯å™¨</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;circuitBreaker.requestVolumeThreshold&quot;,value = &quot;10&quot;),   //è¯·æ±‚æ¬¡æ•°</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;circuitBreaker.sleepWindowInMilliseconds&quot;,value = &quot;10000&quot;),  //æ—¶é—´èŒƒå›´</span></span><br><span class="line"><span class="meta">        @HystrixProperty(name = &quot;circuitBreaker.errorThresholdPercentage&quot;,value = &quot;60&quot;), //å¤±è´¥ç‡è¾¾åˆ°å¤šå°‘åè·³é—¸</span></span><br><span class="line"><span class="meta">&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentCircuitBreaker</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (id &lt; <span class="number">0</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;*****id ä¸èƒ½è´Ÿæ•°&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    String serialNumber = IdUtil.simpleUUID();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Thread.currentThread().getName()+<span class="string">&quot;\t&quot;</span>+<span class="string">&quot;è°ƒç”¨æˆåŠŸ,æµæ°´å·ï¼š&quot;</span>+serialNumber;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//å…œåº•æ–¹æ³•</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentCircuitBreaker_fallback</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;id ä¸èƒ½è´Ÿæ•°ï¼Œè¯·ç¨å€™å†è¯•,(â”¬ï¼¿â”¬)/~~     id: &quot;</span> +id;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><table><thead><tr><th>å±æ€§</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>@HystrixProperty(name = â€œcircuitBreaker.enabledâ€,value = â€œtrueâ€)</td><td>æ˜¯å¦å¼€å¯æ–­è·¯å™¨</td></tr><tr><td>@HystrixProperty(name = â€œcircuitBreaker.requestVolumeThresholdâ€,value = â€œ10â€)</td><td>è¯·æ±‚æ¬¡æ•°</td></tr><tr><td>@HystrixProperty(name = â€œcircuitBreaker.sleepWindowInMillisecondsâ€,value = â€œ10000â€)</td><td>æ—¶é—´çª—å£æœŸ/æ—¶é—´èŒƒå›´</td></tr><tr><td>@HystrixProperty(name = â€œcircuitBreaker.errorThresholdPercentageâ€,value = â€œ60â€)</td><td>å¤±è´¥ç‡åˆ°è¾¾å¤šå°‘åè·³é—¸</td></tr></tbody></table><blockquote><p>ä¸Šé¢è®¾ç½®çš„æ„æ€æ—¶ï¼Œå¦‚æœ10ç§’å†…10æ¬¡è¯·æ±‚ä¸­æœ‰60ä»¥ä¸Šå¤±è´¥ï¼Œå°±ç›´æ¥è·³é—¸</p></blockquote><ul><li>Controllerå±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//===æœåŠ¡ç†”æ–­</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;/payment/circuit/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentCircuitBreaker</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Integer id)</span></span>&#123;</span><br><span class="line">    String result = paymentService.paymentCircuitBreaker(id);</span><br><span class="line">    log.info(<span class="string">&quot;*******result:&quot;</span>+result);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€æµ‹è¯•ç¬¦åˆæ¡ä»¶çš„å‚æ•°"><a href="#2ã€æµ‹è¯•ç¬¦åˆæ¡ä»¶çš„å‚æ•°" class="headerlink" title="2ã€æµ‹è¯•ç¬¦åˆæ¡ä»¶çš„å‚æ•°"></a>2ã€æµ‹è¯•ç¬¦åˆæ¡ä»¶çš„å‚æ•°</h3><ul><li>è®¿é—® <a href="http://localhost:8001/payment/circuit/31">http://localhost:8001/payment/circuit/31</a> ï¼Œç”±äºidä¸ºæ­£æ•°ï¼Œæ‰€ä»¥æµ‹è¯•é€šè¿‡ã€‚</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213220833.png" alt="image-20210213220832634"></p><h3 id="3ã€æ¼”ç¤ºæœåŠ¡ç†”æ–­"><a href="#3ã€æ¼”ç¤ºæœåŠ¡ç†”æ–­" class="headerlink" title="3ã€æ¼”ç¤ºæœåŠ¡ç†”æ–­"></a>3ã€æ¼”ç¤ºæœåŠ¡ç†”æ–­</h3><ul><li>æ¼”ç¤ºæœåŠ¡ç†”æ–­ï¼Œåœ¨çŸ­æ—¶é—´å†…è¿ç»­å¤šæ¬¡è¾“å…¥å°äº0çš„idå·ï¼Œç„¶åå†è¾“å…¥æ­£ç¡®çš„idï¼ŒæŸ¥çœ‹ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213221321.png" alt="image-20210213221321526"></p><blockquote><p>ä¸€æ®µæ—¶é—´ä¹‹åï¼ˆé»˜è®¤æ˜¯5ç§’ï¼‰ï¼Œè¿™ä¸ªæ—¶å€™æ–­è·¯å™¨æ˜¯åŠå¼€çŠ¶æ€ï¼Œä¼šè®©å…¶ä¸­ä¸€ä¸ªè¯·æ±‚è¿›è¡Œè½¬å‘ã€‚å¦‚æœæˆåŠŸï¼Œæ–­è·¯å™¨ä¼šå…³é—­ï¼Œè‹¥å¤±è´¥ï¼Œç»§ç»­å¼€å¯ã€‚</p></blockquote><h3 id="4ã€ç»“è®º"><a href="#4ã€ç»“è®º" class="headerlink" title="4ã€ç»“è®º"></a>4ã€ç»“è®º</h3><blockquote><p>ç†”æ–­ç±»å‹</p><ul><li>ç†”æ–­æ‰“å¼€ï¼šè¯·æ±‚ä¸å†è¿›è¡Œè°ƒç”¨å½“å‰æœåŠ¡ï¼Œå†…éƒ¨è®¾ç½®æ—¶é’Ÿä¸€èˆ¬ä¸ºMTTR(å¹³å‡æ•…éšœå¤„ç†æ—¶é—´)ï¼Œå½“æ‰“å¼€æ—¶é•¿è¾¾åˆ°æ‰€è®¾æ—¶é’Ÿåˆ™è¿›å…¥ç†”æ–­çŠ¶æ€</li><li>ç†”æ–­å…³é—­ï¼šç†”æ–­å…³é—­ä¸ä¼šå¯¹æœåŠ¡è¿›è¡Œç†”æ–­</li><li>ç†”æ–­åŠå¼€ï¼šéƒ¨åˆ†è¯·æ±‚æ ¹æ®è§„åˆ™è°ƒç”¨å½“å‰æœåŠ¡ï¼Œå¦‚æœè¯·æ±‚æˆåŠŸä¸”ç¬¦åˆè§„åˆ™åˆ™è®¤ä¸ºå½“å‰æœåŠ¡æ¢å¤æ­£å¸¸ï¼Œå…³é—­ç†”æ–­</li></ul><p>ç†”æ–­å™¨å¼€å¯ã€åŠå¼€ã€å…³é—­çš„è½¬åŒ–å…³ç³»å¤§è‡´å¦‚ä¸‹</p><ul><li>å½“è¯·æ±‚é”™è¯¯æ¬¡æ•°åœ¨ä¸€å®šæ—¶é—´å†…æ²¡è¾¾åˆ°å³°å€¼æˆ–è€…è¯·æ±‚æˆåŠŸçš„æƒ…å†µä¸‹ï¼Œç†”æ–­å™¨å…³é—­ã€‚</li><li>å½“è¯·æ±‚é”™è¯¯æ¬¡æ•°åœ¨ä¸€å®šæ—¶é—´å†…è¾¾åˆ°å³°å€¼æ—¶ï¼Œç†”æ–­å™¨æ‰“å¼€ï¼Œæ­¤æ—¶è¿›å…¥æœåŠ¡ç†”æ–­çŠ¶æ€ï¼Œé€šè¿‡æœåŠ¡é™çº§å¯¹ä»»ä½•è¯·æ±‚è¿”å›æç¤ºã€‚</li><li>å½“ç†”æ–­ä¸€å®šæ—¶é—´åï¼Œç†”æ–­å™¨ä¼šè¿›å…¥åŠå¼€çŠ¶æ€ï¼Œæ­¤æ—¶å®ƒä¼šè¯•ç€é€šè¿‡ä¸€äº›è¯·æ±‚ï¼Œå¦‚æœè¯·æ±‚é€šè¿‡ï¼Œé‚£ä¹ˆå®ƒä¼šä»åŠå¼€çŠ¶æ€è½¬æ¢ä¸ºå…³é—­çŠ¶æ€ï¼Œæ­¤æ—¶æœåŠ¡æ¢å¤ï¼Œå¦åˆ™ä»ç„¶è¿›å…¥æ‰“å¼€çŠ¶æ€ï¼ŒæœåŠ¡ç»§ç»­ç†”æ–­ã€‚</li></ul></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213222919.png" alt="image-20210213222918954"></p><h3 id="5ã€æ–­è·¯å™¨çš„ä¸‰ä¸ªé‡è¦å‚æ•°"><a href="#5ã€æ–­è·¯å™¨çš„ä¸‰ä¸ªé‡è¦å‚æ•°" class="headerlink" title="5ã€æ–­è·¯å™¨çš„ä¸‰ä¸ªé‡è¦å‚æ•°"></a>5ã€æ–­è·¯å™¨çš„ä¸‰ä¸ªé‡è¦å‚æ•°</h3><blockquote><p>åˆ†åˆ«æ˜¯<strong>å¿«ç…§æ—¶é—´çª—</strong>ã€<strong>è¯·æ±‚æ€»æ•°é˜ˆå€¼</strong>å’Œ<strong>é”™è¯¯ç™¾åˆ†æ¯”é˜ˆå€¼</strong></p></blockquote><ul><li>å¿«ç…§æ—¶é—´çª—ï¼šæ–­è·¯å™¨ç¡®å®šæ˜¯å¦æ‰“å¼€éœ€è¦ç»Ÿè®¡ä¸€äº›è¯·æ±‚å’Œé”™è¯¯æ•°æ®ï¼Œè€Œç»Ÿè®¡çš„æ—¶é—´èŒƒå›´å°±æ˜¯å¿«ç…§æ—¶é—´çª—ï¼Œé»˜è®¤ä¸ºæœ€è¿‘çš„10ç§’ã€‚</li><li>è¯·æ±‚æ€»æ•°é˜€å€¼ï¼šåœ¨å¿«ç…§æ—¶é—´çª—å†…ï¼Œå¿…é¡»æ»¡è¶³è¯·æ±‚æ€»æ•°é˜€å€¼æ‰æœ‰èµ„æ ¼ç†”æ–­ã€‚é»˜è®¤ä¸º20ï¼Œæ„å‘³ç€åœ¨10ç§’å†…ï¼Œå¦‚æœè¯¥hystrixå‘½ä»¤çš„è°ƒç”¨æ¬¡æ•°ä¸è¶³20æ¬¡ï¼Œå³ä½¿æ‰€æœ‰çš„è¯·æ±‚éƒ½è¶…æ—¶æˆ–å…¶ä»–åŸå› å¤±è´¥ï¼Œæ–­è·¯å™¨éƒ½ä¸ä¼šæ‰“å¼€ã€‚</li><li>é”™è¯¯ç™¾åˆ†æ¯”é˜€å€¼ï¼šå½“è¯·æ±‚æ€»æ•°åœ¨å¿«ç…§æ—¶é—´çª—å†…è¶…è¿‡äº†é˜€å€¼ï¼Œæ¯”å¦‚å‘ç”Ÿäº†30æ¬¡è°ƒç”¨ï¼Œå¦‚æœåœ¨è¿™30æ¬¡è°ƒç”¨ä¸­ï¼Œæœ‰15æ¬¡å‘ç”Ÿäº†è¶…æ—¶å¼‚å¸¸ï¼Œä¹Ÿå°±æ˜¯è¶…è¿‡50%çš„é”™è¯¯ç™¾åˆ†æ¯”ï¼Œåœ¨é»˜è®¤è®¾å®š50%é˜€å€¼æƒ…å†µä¸‹ï¼Œè¿™æ—¶å€™å°±ä¼šå°†æ–­è·¯å™¨æ‰“å¼€ã€‚</li></ul><h3 id="6ã€Hystrixå¦‚ä½•è‡ªåŠ¨æ¢å¤ï¼Ÿ"><a href="#6ã€Hystrixå¦‚ä½•è‡ªåŠ¨æ¢å¤ï¼Ÿ" class="headerlink" title="6ã€Hystrixå¦‚ä½•è‡ªåŠ¨æ¢å¤ï¼Ÿ"></a>6ã€Hystrixå¦‚ä½•è‡ªåŠ¨æ¢å¤ï¼Ÿ</h3><blockquote><p>å¯¹äºè¿™ä¸€é—®é¢˜ï¼Œhystrixä¹Ÿä¸ºæˆ‘ä»¬å®ç°äº†è‡ªåŠ¨æ¢å¤åŠŸèƒ½ã€‚<br>å½“æ–­è·¯å™¨æ‰“å¼€ï¼Œå¯¹ä¸»é€»è¾‘è¿›è¡Œç†”æ–­ä¹‹åï¼Œhystrixä¼šå¯åŠ¨ä¸€ä¸ª<strong>ä¼‘çœ æ—¶é—´çª—</strong>ï¼Œåœ¨è¿™ä¸ªæ—¶é—´çª—å†…ï¼Œé™çº§é€»è¾‘æ˜¯ä¸´æ—¶çš„æˆä¸ºä¸»é€»è¾‘ï¼Œå½“ä¼‘çœ æ—¶é—´çª—åˆ°æœŸï¼Œæ–­è·¯å™¨å°†è¿›å…¥åŠå¼€çŠ¶æ€ï¼Œé‡Šæ”¾ä¸€æ¬¡è¯·æ±‚åˆ°åŸæ¥çš„ä¸»é€»è¾‘ä¸Šï¼Œå¦‚æœæ­¤æ¬¡è¯·æ±‚æ­£å¸¸è¿”å›ï¼Œé‚£ä¹ˆæ–­è·¯å™¨å°†ç»§ç»­é—­åˆï¼Œä¸»é€»è¾‘æ¢å¤ï¼Œå¦‚æœè¿™æ¬¡è¯·æ±‚ä¾ç„¶æœ‰é—®é¢˜ï¼Œæ–­è·¯å™¨ç»§ç»­è¿›å…¥æ‰“å¼€çŠ¶æ€ï¼Œä¼‘çœ æ—¶é—´çª—é‡æ–°è®¡æ—¶ã€‚</p></blockquote><h2 id="3-6ã€æœåŠ¡é™æµ"><a href="#3-6ã€æœåŠ¡é™æµ" class="headerlink" title="3.6ã€æœåŠ¡é™æµ"></a>3.6ã€æœåŠ¡é™æµ</h2><blockquote><p>æš‚æ—¶ç•™ç©º</p></blockquote><h1 id="å››ã€Hystrixå·¥ä½œæµç¨‹"><a href="#å››ã€Hystrixå·¥ä½œæµç¨‹" class="headerlink" title="å››ã€Hystrixå·¥ä½œæµç¨‹"></a>å››ã€Hystrixå·¥ä½œæµç¨‹</h1><h2 id="4-1ã€æµç¨‹å›¾"><a href="#4-1ã€æµç¨‹å›¾" class="headerlink" title="4.1ã€æµç¨‹å›¾"></a>4.1ã€æµç¨‹å›¾</h2><p><img src= "/img/loading.gif" data-lazy-src="https://github.com/Netflix/Hystrix/wiki/images/hystrix-command-flow-chart-640.png" alt="img"></p><h2 id="4-2ã€æ­¥éª¤è¯´æ˜"><a href="#4-2ã€æ­¥éª¤è¯´æ˜" class="headerlink" title="4.2ã€æ­¥éª¤è¯´æ˜"></a>4.2ã€æ­¥éª¤è¯´æ˜</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210213225605.png" alt="img"></p>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸ·Hystrix </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆäº”ï¼‰-ç»Ÿä¸€è¿”å›ç»“æœã€åˆ†é¡µæ¡ä»¶æŸ¥è¯¢ã€è®¢å•æ“ä½œå’Œå®šæ—¶ä»»åŠ¡</title>
      <link href="posts/1717741625.html"/>
      <url>posts/1717741625.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1ã€ç»Ÿä¸€è¿”å›æ ¼å¼"><a href="#1ã€ç»Ÿä¸€è¿”å›æ ¼å¼" class="headerlink" title="1ã€ç»Ÿä¸€è¿”å›æ ¼å¼"></a>1ã€ç»Ÿä¸€è¿”å›æ ¼å¼</h2><blockquote><p>åœ¨å‰åç«¯æ¥å£äº¤äº’ä¸­ï¼Œå‰ç«¯æŒ‰ç…§çº¦å®šè¯·æ±‚URLè·¯å¾„ï¼Œå¹¶ä¼ å…¥ç›¸å…³å‚æ•°ï¼Œåç«¯æœåŠ¡å™¨æ¥æ”¶è¯·æ±‚ï¼Œè¿›è¡Œä¸šåŠ¡å¤„ç†ï¼Œè¿”å›æ•°æ®ç»™å‰ç«¯ã€‚åœ¨å‰åç«¯åˆ†ç¦»çš„é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€ä¼šå°†åç«¯çš„ç»“æœ<strong>å°è£…ä¸ºJSONæ•°æ®</strong>è¿”å›ï¼Œç»Ÿä¸€çš„æ•°æ®æ ¼å¼ä¼šä½¿å‰ç«¯å¯¹æ•°æ®çš„æ“ä½œæ›´ä¸€è‡´ã€è½»æ¾ã€‚</p><p>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç»Ÿä¸€è¿”å›æ•°æ®æ ¼å¼æ²¡æœ‰å›ºå®šçš„æ ¼å¼ï¼Œåªè¦èƒ½æè¿°æ¸…æ¥šè¿”å›çš„æ•°æ®çŠ¶æ€ä»¥åŠè¦è¿”å›çš„å…·ä½“æ•°æ®å°±å¯ä»¥ã€‚ä½†æ˜¯ä¸€èˆ¬ä¼šåŒ…å«<strong>çŠ¶æ€ç </strong>ã€<strong>è¿”å›æ¶ˆæ¯</strong>ã€<strong>æ•°æ®</strong>è¿™å‡ éƒ¨åˆ†å†…å®¹</p></blockquote><p>ä¾‹å¦‚ï¼Œæˆ‘ä»¬çš„ç³»ç»Ÿè¦æ±‚è¿”å›çš„åŸºæœ¬æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼š</p><ul><li><strong>åˆ—è¡¨ï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;success&quot;</span>: <span class="keyword">true</span>,</span><br><span class="line">  <span class="string">&quot;code&quot;</span>: <span class="number">20000</span>,</span><br><span class="line">  <span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;items&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;åˆ˜å¾·å&quot;</span>,</span><br><span class="line">        <span class="string">&quot;intro&quot;</span>: <span class="string">&quot;æ¯•ä¸šäºå¸ˆèŒƒå¤§å­¦æ•°å­¦ç³»ï¼Œçƒ­çˆ±æ•™è‚²äº‹ä¸šï¼Œæ‰§æ•™æ•°å­¦æ€ç»´6å¹´æœ‰ä½™&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>åˆ†é¡µï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;success&quot;</span>: <span class="keyword">true</span>,</span><br><span class="line">  <span class="string">&quot;code&quot;</span>: <span class="number">20000</span>,</span><br><span class="line">  <span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="string">&quot;total&quot;</span>: <span class="number">17</span>,</span><br><span class="line">    <span class="string">&quot;rows&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="string">&quot;id&quot;</span>: <span class="string">&quot;1&quot;</span>,</span><br><span class="line">        <span class="string">&quot;name&quot;</span>: <span class="string">&quot;åˆ˜å¾·å&quot;</span>,</span><br><span class="line">        <span class="string">&quot;intro&quot;</span>: <span class="string">&quot;æ¯•ä¸šäºå¸ˆèŒƒå¤§å­¦æ•°å­¦ç³»ï¼Œçƒ­çˆ±æ•™è‚²äº‹ä¸šï¼Œæ‰§æ•™æ•°å­¦æ€ç»´6å¹´æœ‰ä½™&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>æ²¡æœ‰è¿”å›æ•°æ®ï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;success&quot;</span>: <span class="keyword">true</span>,</span><br><span class="line">  <span class="string">&quot;code&quot;</span>: <span class="number">20000</span>,</span><br><span class="line">  <span class="string">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><strong>å¤±è´¥ï¼š</strong></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;success&quot;</span>: <span class="keyword">false</span>,</span><br><span class="line">  <span class="string">&quot;code&quot;</span>: <span class="number">20001</span>,</span><br><span class="line">  <span class="string">&quot;message&quot;</span>: <span class="string">&quot;å¤±è´¥&quot;</span>,</span><br><span class="line">  <span class="string">&quot;data&quot;</span>: &#123;&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æˆ‘ä»¬å®šä¹‰ç»Ÿä¸€è¿”å›æ ¼å¼ä¸ºï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="string">&quot;success&quot;</span>: å¸ƒå°”, <span class="comment">//å“åº”æ˜¯å¦æˆåŠŸ</span></span><br><span class="line">  <span class="string">&quot;code&quot;</span>: æ•°å­—, <span class="comment">//å“åº”ç </span></span><br><span class="line">  <span class="string">&quot;message&quot;</span>: å­—ç¬¦ä¸², <span class="comment">//è¿”å›æ¶ˆæ¯</span></span><br><span class="line">  <span class="string">&quot;data&quot;</span>: HashMap <span class="comment">//è¿”å›æ•°æ®ï¼Œæ”¾åœ¨é”®å€¼å¯¹ä¸­</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2ã€å®šä¹‰ç»Ÿä¸€è¿”å›ç»“æœ"><a href="#2ã€å®šä¹‰ç»Ÿä¸€è¿”å›ç»“æœ" class="headerlink" title="2ã€å®šä¹‰ç»Ÿä¸€è¿”å›ç»“æœ"></a>2ã€å®šä¹‰ç»Ÿä¸€è¿”å›ç»“æœ</h2><h3 id="2-1ã€åˆ›å»ºè¿”å›ç å®šä¹‰æšä¸¾ç±»"><a href="#2-1ã€åˆ›å»ºè¿”å›ç å®šä¹‰æšä¸¾ç±»" class="headerlink" title="2.1ã€åˆ›å»ºè¿”å›ç å®šä¹‰æšä¸¾ç±»"></a>2.1ã€åˆ›å»ºè¿”å›ç å®šä¹‰æšä¸¾ç±»</h3><blockquote><p>çŠ¶æ€ç å®šä¹‰æšä¸¾ç±»å¯¹äºç‰¹æ®Šå“åº”æƒ…å†µåšäº†å®šä¹‰ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Getter</span></span><br><span class="line"><span class="meta">@ToString</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">ResultCodeEnum</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    SUCCESS(<span class="keyword">true</span>, <span class="number">20000</span>,<span class="string">&quot;æˆåŠŸ&quot;</span>),</span><br><span class="line">    UNKNOWN_REASON(<span class="keyword">false</span>, <span class="number">20001</span>, <span class="string">&quot;æœªçŸ¥é”™è¯¯&quot;</span>),</span><br><span class="line"></span><br><span class="line">    BAD_SQL_GRAMMAR(<span class="keyword">false</span>, <span class="number">21001</span>, <span class="string">&quot;sqlè¯­æ³•é”™è¯¯&quot;</span>),</span><br><span class="line">    JSON_PARSE_ERROR(<span class="keyword">false</span>, <span class="number">21002</span>, <span class="string">&quot;jsonè§£æå¼‚å¸¸&quot;</span>),</span><br><span class="line">    PARAM_ERROR(<span class="keyword">false</span>, <span class="number">21003</span>, <span class="string">&quot;å‚æ•°ä¸æ­£ç¡®&quot;</span>),</span><br><span class="line"></span><br><span class="line">    FILE_UPLOAD_ERROR(<span class="keyword">false</span>, <span class="number">21004</span>, <span class="string">&quot;æ–‡ä»¶ä¸Šä¼ é”™è¯¯&quot;</span>),</span><br><span class="line">    FILE_DELETE_ERROR(<span class="keyword">false</span>, <span class="number">21005</span>, <span class="string">&quot;æ–‡ä»¶åˆªé™¤é”™è¯¯&quot;</span>),</span><br><span class="line">    EXCEL_DATA_IMPORT_ERROR(<span class="keyword">false</span>, <span class="number">21006</span>, <span class="string">&quot;Excelæ•°æ®å¯¼å…¥é”™è¯¯&quot;</span>),</span><br><span class="line"></span><br><span class="line">    VIDEO_UPLOAD_ALIYUN_ERROR(<span class="keyword">false</span>, <span class="number">22001</span>, <span class="string">&quot;è§†é¢‘ä¸Šä¼ è‡³é˜¿é‡Œäº‘å¤±è´¥&quot;</span>),</span><br><span class="line">    VIDEO_UPLOAD_TOMCAT_ERROR(<span class="keyword">false</span>, <span class="number">22002</span>, <span class="string">&quot;è§†é¢‘ä¸Šä¼ è‡³ä¸šåŠ¡æœåŠ¡å™¨å¤±è´¥&quot;</span>),</span><br><span class="line">    VIDEO_DELETE_ALIYUN_ERROR(<span class="keyword">false</span>, <span class="number">22003</span>, <span class="string">&quot;é˜¿é‡Œäº‘è§†é¢‘æ–‡ä»¶åˆ é™¤å¤±è´¥&quot;</span>),</span><br><span class="line">    FETCH_VIDEO_UPLOADAUTH_ERROR(<span class="keyword">false</span>, <span class="number">22004</span>, <span class="string">&quot;è·å–ä¸Šä¼ åœ°å€å’Œå‡­è¯å¤±è´¥&quot;</span>),</span><br><span class="line">    REFRESH_VIDEO_UPLOADAUTH_ERROR(<span class="keyword">false</span>, <span class="number">22005</span>, <span class="string">&quot;åˆ·æ–°ä¸Šä¼ åœ°å€å’Œå‡­è¯å¤±è´¥&quot;</span>),</span><br><span class="line">    FETCH_PLAYAUTH_ERROR(<span class="keyword">false</span>, <span class="number">22006</span>, <span class="string">&quot;è·å–æ’­æ”¾å‡­è¯å¤±è´¥&quot;</span>),</span><br><span class="line"></span><br><span class="line">    URL_ENCODE_ERROR(<span class="keyword">false</span>, <span class="number">23001</span>, <span class="string">&quot;URLç¼–ç å¤±è´¥&quot;</span>),</span><br><span class="line">    ILLEGAL_CALLBACK_REQUEST_ERROR(<span class="keyword">false</span>, <span class="number">23002</span>, <span class="string">&quot;éæ³•å›è°ƒè¯·æ±‚&quot;</span>),</span><br><span class="line">    FETCH_ACCESSTOKEN_FAILD(<span class="keyword">false</span>, <span class="number">23003</span>, <span class="string">&quot;è·å–accessTokenå¤±è´¥&quot;</span>),</span><br><span class="line">    FETCH_USERINFO_ERROR(<span class="keyword">false</span>, <span class="number">23004</span>, <span class="string">&quot;è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥&quot;</span>),</span><br><span class="line">    LOGIN_ERROR(<span class="keyword">false</span>, <span class="number">23005</span>, <span class="string">&quot;ç™»å½•å¤±è´¥&quot;</span>),</span><br><span class="line"></span><br><span class="line">    COMMENT_EMPTY(<span class="keyword">false</span>, <span class="number">24006</span>, <span class="string">&quot;è¯„è®ºå†…å®¹å¿…é¡»å¡«å†™&quot;</span>),</span><br><span class="line"></span><br><span class="line">    PAY_RUN(<span class="keyword">false</span>, <span class="number">25000</span>, <span class="string">&quot;æ”¯ä»˜ä¸­&quot;</span>),</span><br><span class="line">    PAY_UNIFIEDORDER_ERROR(<span class="keyword">false</span>, <span class="number">25001</span>, <span class="string">&quot;ç»Ÿä¸€ä¸‹å•é”™è¯¯&quot;</span>),</span><br><span class="line">    PAY_ORDERQUERY_ERROR(<span class="keyword">false</span>, <span class="number">25002</span>, <span class="string">&quot;æŸ¥è¯¢æ”¯ä»˜ç»“æœé”™è¯¯&quot;</span>),</span><br><span class="line"></span><br><span class="line">    ORDER_EXIST_ERROR(<span class="keyword">false</span>, <span class="number">25003</span>, <span class="string">&quot;è¯¾ç¨‹å·²è´­ä¹°&quot;</span>),</span><br><span class="line"></span><br><span class="line">    GATEWAY_ERROR(<span class="keyword">false</span>, <span class="number">26000</span>, <span class="string">&quot;æœåŠ¡ä¸èƒ½è®¿é—®&quot;</span>),</span><br><span class="line"></span><br><span class="line">    CODE_ERROR(<span class="keyword">false</span>, <span class="number">28000</span>, <span class="string">&quot;éªŒè¯ç é”™è¯¯&quot;</span>),</span><br><span class="line"></span><br><span class="line">    LOGIN_PHONE_ERROR(<span class="keyword">false</span>, <span class="number">28009</span>, <span class="string">&quot;æ‰‹æœºå·ç ä¸æ­£ç¡®&quot;</span>),</span><br><span class="line">    LOGIN_MOBILE_ERROR(<span class="keyword">false</span>, <span class="number">28001</span>, <span class="string">&quot;è´¦å·ä¸æ­£ç¡®&quot;</span>),</span><br><span class="line">    LOGIN_PASSWORD_ERROR(<span class="keyword">false</span>, <span class="number">28008</span>, <span class="string">&quot;å¯†ç ä¸æ­£ç¡®&quot;</span>),</span><br><span class="line">    LOGIN_DISABLED_ERROR(<span class="keyword">false</span>, <span class="number">28002</span>, <span class="string">&quot;è¯¥ç”¨æˆ·å·²è¢«ç¦ç”¨&quot;</span>),</span><br><span class="line">    REGISTER_MOBLE_ERROR(<span class="keyword">false</span>, <span class="number">28003</span>, <span class="string">&quot;æ‰‹æœºå·å·²è¢«æ³¨å†Œ&quot;</span>),</span><br><span class="line">    LOGIN_AUTH(<span class="keyword">false</span>, <span class="number">28004</span>, <span class="string">&quot;éœ€è¦ç™»å½•&quot;</span>),</span><br><span class="line">    LOGIN_ACL(<span class="keyword">false</span>, <span class="number">28005</span>, <span class="string">&quot;æ²¡æœ‰æƒé™&quot;</span>),</span><br><span class="line">    SMS_SEND_ERROR(<span class="keyword">false</span>, <span class="number">28006</span>, <span class="string">&quot;çŸ­ä¿¡å‘é€å¤±è´¥&quot;</span>),</span><br><span class="line">    SMS_SEND_ERROR_BUSINESS_LIMIT_CONTROL(<span class="keyword">false</span>, <span class="number">28007</span>, <span class="string">&quot;çŸ­ä¿¡å‘é€è¿‡äºé¢‘ç¹&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Boolean success;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    ResultCodeEnum(Boolean success, Integer code, String message) &#123;</span><br><span class="line">        <span class="keyword">this</span>.success = success;</span><br><span class="line">        <span class="keyword">this</span>.code = code;</span><br><span class="line">        <span class="keyword">this</span>.message = message;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2ã€åˆ›å»ºç»“æœç±»"><a href="#2-2ã€åˆ›å»ºç»“æœç±»" class="headerlink" title="2.2ã€åˆ›å»ºç»“æœç±»"></a>2.2ã€åˆ›å»ºç»“æœç±»</h3><blockquote><p>å¯¹äºè¿”å›æ•°æ®æœ‰ä¸¤ç§èµ‹å€¼æ–¹æ³•ï¼Œä¸€æ˜¯ä¼ å…¥ä¸€ä¸ªMapå¯¹è±¡ï¼ŒäºŒæ˜¯ä¼ å…¥ä¸€ä¸ªKeyå’Œä¸€ä¸ªValueã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@ApiModel(value = &quot;å…¨å±€ç»Ÿä¸€è¿”å›ç»“æœ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">R</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ˜¯å¦æˆåŠŸ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Boolean success;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¿”å›ç &quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer code;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¿”å›æ¶ˆæ¯&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String message;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¿”å›æ•°æ®&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Map&lt;String, Object&gt; data = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">R</span><span class="params">()</span></span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> R <span class="title">ok</span><span class="params">()</span></span>&#123;</span><br><span class="line">        R r = <span class="keyword">new</span> R();</span><br><span class="line">        r.setSuccess(ResultCodeEnum.SUCCESS.getSuccess());</span><br><span class="line">        r.setCode(ResultCodeEnum.SUCCESS.getCode());</span><br><span class="line">        r.setMessage(ResultCodeEnum.SUCCESS.getMessage());</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> R <span class="title">error</span><span class="params">()</span></span>&#123;</span><br><span class="line">        R r = <span class="keyword">new</span> R();</span><br><span class="line">        r.setSuccess(ResultCodeEnum.UNKNOWN_REASON.getSuccess());</span><br><span class="line">        r.setCode(ResultCodeEnum.UNKNOWN_REASON.getCode());</span><br><span class="line">        r.setMessage(ResultCodeEnum.UNKNOWN_REASON.getMessage());</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> R <span class="title">setResult</span><span class="params">(ResultCodeEnum resultCodeEnum)</span></span>&#123;</span><br><span class="line">        R r = <span class="keyword">new</span> R();</span><br><span class="line">        r.setSuccess(resultCodeEnum.getSuccess());</span><br><span class="line">        r.setCode(resultCodeEnum.getCode());</span><br><span class="line">        r.setMessage(resultCodeEnum.getMessage());</span><br><span class="line">        <span class="keyword">return</span> r;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">success</span><span class="params">(Boolean success)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setSuccess(success);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">message</span><span class="params">(String message)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setMessage(message);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">code</span><span class="params">(Integer code)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setCode(code);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">data</span><span class="params">(String key, Object value)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data.put(key, value);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">data</span><span class="params">(Map&lt;String, Object&gt; map)</span></span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setData(map);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3ã€åˆ†é¡µæ¡ä»¶æŸ¥è¯¢"><a href="#3ã€åˆ†é¡µæ¡ä»¶æŸ¥è¯¢" class="headerlink" title="3ã€åˆ†é¡µæ¡ä»¶æŸ¥è¯¢"></a>3ã€åˆ†é¡µæ¡ä»¶æŸ¥è¯¢</h2><h3 id="3-1ã€éœ€æ±‚è¯´æ˜"><a href="#3-1ã€éœ€æ±‚è¯´æ˜" class="headerlink" title="3.1ã€éœ€æ±‚è¯´æ˜"></a>3.1ã€éœ€æ±‚è¯´æ˜</h3><blockquote><p>åœ¨è®²å¸ˆåˆ†é¡µåˆ—è¡¨ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ ¹æ®è®²å¸ˆåè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼Œæ ¹æ®è®²å¸ˆå¤´è¡”ã€è®²å¸ˆå…¥é©»æ—¶é—´è¿›è¡ŒæŸ¥è¯¢ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212210910.png" alt="image-20210212210909529"></p><h3 id="3-2ã€åˆ›å»ºæŸ¥è¯¢å¯¹è±¡"><a href="#3-2ã€åˆ›å»ºæŸ¥è¯¢å¯¹è±¡" class="headerlink" title="3.2ã€åˆ›å»ºæŸ¥è¯¢å¯¹è±¡"></a>3.2ã€åˆ›å»ºæŸ¥è¯¢å¯¹è±¡</h3><blockquote><p>åˆ›å»ºè®²å¸ˆæ¡ä»¶æŸ¥è¯¢ç±»TeacherQueryVoï¼Œè¯¥ç±»å®šä¹‰äº†3.1ä¸­çš„å››ä¸ªæ¡ä»¶å±æ€§ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherQueryVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer level;</span><br><span class="line">    <span class="keyword">private</span> String joinDateBegin;</span><br><span class="line">    <span class="keyword">private</span> String joinDateEnd;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-3ã€åœ¨TeacherControllerä¸­ç¼–å†™ä¸€ä¸ªåˆ†é¡µæ¡ä»¶æŸ¥è¯¢æ¥å£"><a href="#3-3ã€åœ¨TeacherControllerä¸­ç¼–å†™ä¸€ä¸ªåˆ†é¡µæ¡ä»¶æŸ¥è¯¢æ¥å£" class="headerlink" title="3.3ã€åœ¨TeacherControllerä¸­ç¼–å†™ä¸€ä¸ªåˆ†é¡µæ¡ä»¶æŸ¥è¯¢æ¥å£"></a>3.3ã€åœ¨TeacherControllerä¸­ç¼–å†™ä¸€ä¸ªåˆ†é¡µæ¡ä»¶æŸ¥è¯¢æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * å®ç°æ¡ä»¶æŸ¥è¯¢å¸¦åˆ†é¡µæŸ¥è¯¢çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> page å½“å‰é¡µ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> limit æ¯é¡µè®°å½•æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> queryVo æ¡ä»¶å°è£…æˆçš„æŸ¥è¯¢å¯¹è±¡</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> æ€»è®°å½•æ•°åŠè®²å¸ˆåˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@GetMapping(&quot;list/&#123;page&#125;/&#123;limit&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å®ç°æ¡ä»¶æŸ¥è¯¢å¸¦åˆ†é¡µ&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">listPage</span><span class="params">(<span class="meta">@ApiParam(value = &quot;å½“å‰é¡µ&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;page&quot;)</span> Long page,</span></span></span><br><span class="line"><span class="function"><span class="params">                  <span class="meta">@ApiParam(value = &quot;æ¯é¡µè®°å½•æ•°&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;limit&quot;)</span> Long limit,</span></span></span><br><span class="line"><span class="function"><span class="params">                  TeacherQueryVo queryVo)</span> </span>&#123;</span><br><span class="line">    Page&lt;Teacher&gt; pageParam = <span class="keyword">new</span> Page&lt;&gt;(page, limit);</span><br><span class="line">    IPage&lt;Teacher&gt; pageModel = teacherService.selectPage(pageParam, queryVo);</span><br><span class="line">    List&lt;Teacher&gt; records = pageModel.getRecords();</span><br><span class="line">    <span class="keyword">long</span> total = pageModel.getTotal();</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;total&quot;</span>, total).data(<span class="string">&quot;rows&quot;</span>, records);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-4ã€åœ¨Serviceå±‚å®ç°selectPageæ–¹æ³•"><a href="#3-4ã€åœ¨Serviceå±‚å®ç°selectPageæ–¹æ³•" class="headerlink" title="3.4ã€åœ¨Serviceå±‚å®ç°selectPageæ–¹æ³•"></a>3.4ã€åœ¨Serviceå±‚å®ç°selectPageæ–¹æ³•</h3><blockquote><p>è¿™ä¸ªæ–¹æ³•æ¥æ”¶ä¼ å…¥çš„åˆ†é¡µå¯¹è±¡å’Œæ¡ä»¶æŸ¥è¯¢å¯¹è±¡ï¼Œé¦–å…ˆå¯¹ä¼ å…¥çš„æ¡ä»¶å¯¹è±¡è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ¡ä»¶å¯¹è±¡ä¸ºç©ºï¼Œé‚£ä¹ˆç›´æ¥è¿›è¡Œä¸€æ¬¡æ™®é€šçš„åˆ†é¡µæŸ¥è¯¢;</p><p>å¦‚æœæ¡ä»¶å¯¹è±¡ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆåˆ†åˆ«å–å‡ºå…¶ä¸­çš„å››ä¸ªå±æ€§ï¼Œæ ¹æ®å±æ€§ç±»å‹ä½¿ç”¨QueryWrapperæ‹¼æ¥ä¸ä¸ºç©ºçš„æ¡ä»¶å±æ€§ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> IPage&lt;Teacher&gt; <span class="title">selectPage</span><span class="params">(Page&lt;Teacher&gt; pageParam, TeacherQueryVo teacherQueryVo)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ˜¾ç¤ºåˆ†é¡µæŸ¥è¯¢åˆ—è¡¨</span></span><br><span class="line"><span class="comment">//        1ã€æ’åºï¼šæŒ‰ç…§sortå­—æ®µæ’åº</span></span><br><span class="line">    QueryWrapper&lt;Teacher&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.orderByAsc(<span class="string">&quot;sort&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">//        2ã€åˆ†é¡µæŸ¥è¯¢</span></span><br><span class="line">    <span class="keyword">if</span>(teacherQueryVo == <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">return</span> baseMapper.selectPage(pageParam, queryWrapper);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//        3ã€æ¡ä»¶æŸ¥è¯¢</span></span><br><span class="line">    String name = teacherQueryVo.getName();</span><br><span class="line">    Integer level = teacherQueryVo.getLevel();</span><br><span class="line">    String joinDateBegin = teacherQueryVo.getJoinDateBegin();</span><br><span class="line">    String joinDateEnd = teacherQueryVo.getJoinDateEnd();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.isEmpty(name))&#123;</span><br><span class="line">        queryWrapper.likeRight(<span class="string">&quot;name&quot;</span>, name);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(level != <span class="keyword">null</span>)&#123;</span><br><span class="line">        queryWrapper.eq(<span class="string">&quot;level&quot;</span>, level);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.isEmpty(joinDateBegin))&#123;</span><br><span class="line">        queryWrapper.ge(<span class="string">&quot;join_date&quot;</span>, joinDateBegin);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(!StringUtils.isEmpty(joinDateEnd))&#123;</span><br><span class="line">        queryWrapper.le(<span class="string">&quot;join_date&quot;</span>, joinDateEnd);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> baseMapper.selectPage(pageParam, queryWrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-5ã€æµ‹è¯•"><a href="#3-5ã€æµ‹è¯•" class="headerlink" title="3.5ã€æµ‹è¯•"></a>3.5ã€æµ‹è¯•</h3><blockquote><p>æ‰“å¼€swaggerï¼Œè¿›è¡Œæµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212213414.png" alt="image-20210212213413862"></p><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212213429.png" alt="image-20210212213429863"></p><h2 id="4ã€è®¢å•æ“ä½œ"><a href="#4ã€è®¢å•æ“ä½œ" class="headerlink" title="4ã€è®¢å•æ“ä½œ"></a>4ã€è®¢å•æ“ä½œ</h2><blockquote><p>ç”±äºåªæœ‰ç™»å½•åçš„ç”¨æˆ·æ‰å¯ä»¥ä¸‹è®¢å•ï¼Œè€Œä¸”è®¢å•é™¤äº†å¿…éœ€çš„å•†å“å·å¤–ï¼Œè¿˜å¿…é¡»æœ‰ç”¨æˆ·å·ï¼Œåœ¨åˆæ³•ç”¨æˆ·ç™»å½•åï¼Œæˆ‘ä»¬ä¼šä¸‹å‘ç»™ç”¨æˆ·ä¸€ä¸ªtokenï¼Œåœ¨ä¹‹åçš„è®¢å•æ“ä½œä¸­ï¼Œç”¨æˆ·éœ€è¦åœ¨å‘èµ·è¯·æ±‚çš„æ—¶å€™åœ¨è¯·æ±‚å¤´ä¸­å¸¦ä¸Šè¿™ä¸ªtokenï¼ŒæœåŠ¡å™¨è§£æè¯·æ±‚å¤´ä¸­çš„tokenåå³å¯è·å–ç”¨æˆ·idã€‚</p></blockquote><h3 id="4-1ã€åˆ›å»ºJWTUtils"><a href="#4-1ã€åˆ›å»ºJWTUtils" class="headerlink" title="4.1ã€åˆ›å»ºJWTUtils"></a>4.1ã€åˆ›å»ºJWTUtils</h3><blockquote><p>è¿™ä¸ªå·¥å…·ç±»å°è£…äº†ä¸€ç³»åˆ—æœ‰å…³tokençš„æ–¹æ³•ï¼ŒåŒ…æ‹¬æ ¹æ®å¯†é’¥ç”Ÿæˆtokenï¼Œé‰´å®štokenæ˜¯å¦åˆæ³•ï¼Œä»è¯·æ±‚ä¸­çš„tokenè§£æå‡ºç”¨æˆ·ä¿¡æ¯ç­‰ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String APP_SECRET = <span class="string">&quot;ukc8BDbRigUDaY6pZFfWus2jZWLPHO&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Key <span class="title">getKeyInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SignatureAlgorithm signatureAlgorithm = SignatureAlgorithm.HS256;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = DatatypeConverter.parseBase64Binary(APP_SECRET);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SecretKeySpec(bytes,signatureAlgorithm.getJcaName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJwtToken</span><span class="params">(JwtInfo jwtInfo, <span class="keyword">int</span> expire)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String JwtToken = Jwts.builder()</span><br><span class="line">                .setHeaderParam(<span class="string">&quot;typ&quot;</span>, <span class="string">&quot;JWT&quot;</span>)</span><br><span class="line">                .setHeaderParam(<span class="string">&quot;alg&quot;</span>, <span class="string">&quot;HS256&quot;</span>)</span><br><span class="line">                .setSubject(<span class="string">&quot;guli-user&quot;</span>)<span class="comment">//ä¸»é¢˜</span></span><br><span class="line">                .setIssuedAt(<span class="keyword">new</span> Date())<span class="comment">//é¢å‘æ—¶é—´</span></span><br><span class="line">                .setExpiration(DateTime.now().plusSeconds(expire).toDate())<span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line">                .claim(<span class="string">&quot;id&quot;</span>, jwtInfo.getId())<span class="comment">//ç”¨æˆ·id</span></span><br><span class="line">                .claim(<span class="string">&quot;nickname&quot;</span>, jwtInfo.getNickname())<span class="comment">//ç”¨æˆ·æ˜µç§°</span></span><br><span class="line">                .claim(<span class="string">&quot;avatar&quot;</span>, jwtInfo.getAvatar())<span class="comment">//ç”¨æˆ·å¤´åƒ</span></span><br><span class="line">                .signWith(SignatureAlgorithm.HS256, getKeyInstance())</span><br><span class="line">                .compact();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JwtToken;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jwtToken</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkJwtTToken</span><span class="params">(String jwtToken)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(jwtToken)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkJwtTToken</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String jwtToken = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(StringUtils.isEmpty(jwtToken)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®tokenè·å–ä¼šå‘˜id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JwtInfo <span class="title">getMemberIdByJwtToken</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String jwtToken = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(jwtToken)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Jws&lt;Claims&gt; claimsJws = Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);</span><br><span class="line">        Claims claims = claimsJws.getBody();</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> JwtInfo(claims.get(<span class="string">&quot;id&quot;</span>).toString(), claims.get(<span class="string">&quot;nickname&quot;</span>).toString(), claims.get(<span class="string">&quot;avatar&quot;</span>).toString());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-2ã€æ–°å¢è®¢å•â€“Controllerå±‚"><a href="#4-2ã€æ–°å¢è®¢å•â€“Controllerå±‚" class="headerlink" title="4.2ã€æ–°å¢è®¢å•â€“Controllerå±‚"></a>4.2ã€æ–°å¢è®¢å•â€“Controllerå±‚</h3><blockquote><p>è¿™ä¸ªæ–¹æ³•é™¤äº†æ¥æ”¶è¯¾ç¨‹Idå¤–ï¼Œè¿˜éœ€è¦æ¥æ”¶ä¸€ä¸ªHttpServletRequestå¯¹è±¡ï¼Œæˆ‘ä»¬éœ€è¦ä»è¿™ä¸ªrequestå¯¹è±¡ä¸­è·å–ç”¨æˆ·ä¿¡æ¯ï¼ˆç”¨æˆ·idï¼‰</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(&quot;æ–°å¢è®¢å•&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;auth/save/&#123;courseId&#125;&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">save</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="meta">@ApiParam(value = &quot;è¯¾ç¨‹Id&quot;,required = true)</span></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="meta">@PathVariable</span> String courseId, HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">    JwtInfo jwtInfo = JwtUtils.getMemberIdByJwtToken(request);</span><br><span class="line">    <span class="comment">// è°ƒç”¨serviceå±‚æ·»åŠ è®¢å•çš„æ–¹æ³•ï¼Œéœ€è¦ä¼ å…¥è¯¾ç¨‹idå’Œç”¨æˆ·id</span></span><br><span class="line">    <span class="comment">// è¿™ä¸ªæ–¹æ³•å°†è¿”å›æ–°å¢çš„è®¢å•id</span></span><br><span class="line">    String orderId = orderService.saveOrder(courseId,jwtInfo.getId());</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;orderId&quot;</span>,orderId);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4-3ã€æ–°å¢è®¢å•â€“Serviceå±‚"><a href="#4-3ã€æ–°å¢è®¢å•â€“Serviceå±‚" class="headerlink" title="4.3ã€æ–°å¢è®¢å•â€“Serviceå±‚"></a>4.3ã€æ–°å¢è®¢å•â€“Serviceå±‚</h3><blockquote><p>Serviceå±‚ä¸­æ–°å¢è®¢å•çš„æµç¨‹å¦‚ä¸‹ï¼š</p></blockquote><ul><li>æ ¹æ®ä¼ å…¥çš„memberIdå’ŒcourseIdä½œä¸ºæ¡ä»¶ï¼Œä½¿ç”¨QueryWrapperæŸ¥è¯¢è¯¥ç”¨æˆ·æ˜¯å¦å·²ç»å­˜åœ¨å½“å‰è¯¾ç¨‹çš„è®¢å•<ul><li>å¦‚æœå·²å­˜åœ¨ï¼Œç›´æ¥è¿”å›å·²å­˜åœ¨çš„è®¢å•å·å³å¯</li></ul></li><li>æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯å’Œç”¨æˆ·ä¿¡æ¯æ˜¯å¦å­˜åœ¨</li><li>åˆ›å»ºè®¢å•ï¼Œä½¿ç”¨ä¸€ä¸ªå·¥å…·ç±»ç”Ÿæˆè®¢å•å·ï¼Œç„¶åå°†ä¸Šé¢æ ¹æ®è¯¾ç¨‹å·æŸ¥è¯¢åˆ°çš„è¯¾ç¨‹ä¿¡æ¯ï¼Œæ ¹æ®ç”¨æˆ·idæŸ¥è¯¢åˆ°çš„ç”¨æˆ·ä¿¡æ¯å¡«å…¥è®¢å•å¯¹è±¡ä¸­ã€‚</li><li>å‘æ•°æ®åº“ä¸­æ’å…¥è¯¥å¯¹è±¡ï¼Œæ ¹æ®Mybatis-Plusçš„idè‡ªåŠ¨å›å¡«åŠŸèƒ½å°†è®¢å•å¯¹è±¡Idè¿”å›ã€‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">saveOrder</span><span class="params">(String courseId, String memberId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1 æŸ¥è¯¢å½“å‰ç”¨æˆ·æ˜¯å¦å·²ç»å­˜åœ¨å½“å‰è¯¾ç¨‹çš„è®¢å•</span></span><br><span class="line">    QueryWrapper&lt;Order&gt; orderQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    orderQueryWrapper.eq(<span class="string">&quot;course_id&quot;</span>,courseId);</span><br><span class="line">    orderQueryWrapper.eq(<span class="string">&quot;member_id&quot;</span>,memberId);</span><br><span class="line">    Order orderExist = baseMapper.selectOne(orderQueryWrapper);</span><br><span class="line">    <span class="comment">//å¦‚æœå·²ç»å­˜åœ¨è®¢å•ï¼Œç›´æ¥è¿”å›æŸ¥æ‰¾åˆ°çš„è®¢å•idå³å¯</span></span><br><span class="line">    <span class="keyword">if</span>(orderExist != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> orderExist.getId();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//2 æŸ¥è¯¢è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line">    CourseDto courseDto = eduCourseService.getCourseDtoById(courseId);</span><br><span class="line">    <span class="keyword">if</span>(courseDto == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæŸ¥è¯¢courseDtoä¸ºç©ºï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.PARAM_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//3 æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯</span></span><br><span class="line">    MemberDto memberDto = eduMemberService.getMemberDtoByMemberId(memberId);</span><br><span class="line">    <span class="keyword">if</span>(memberDto == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">// å¦‚æœæŸ¥è¯¢memberDtoä¸ºç©ºï¼Œç›´æ¥æŠ›å‡ºå¼‚å¸¸</span></span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.PARAM_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//4 åˆ›å»ºè®¢å•</span></span><br><span class="line">    Order order = <span class="keyword">new</span> Order();</span><br><span class="line">    order.setOrderNo(OrderNoUtils.getOrderNo());</span><br><span class="line">    order.setCourseId(courseId);</span><br><span class="line">    order.setCourseTitle(courseDto.getTitle());</span><br><span class="line">    order.setCourseCover(courseDto.getCover());</span><br><span class="line">    order.setTeacherName(courseDto.getTeacherName());</span><br><span class="line">    <span class="comment">//åˆ†</span></span><br><span class="line">    order.setTotalFee(courseDto.getPrice().multiply(<span class="keyword">new</span> BigDecimal(<span class="number">100</span>)));</span><br><span class="line">    order.setMemberId(memberId);</span><br><span class="line">    order.setMobile(memberDto.getMobile());</span><br><span class="line">    order.setNickname(memberDto.getNickname());</span><br><span class="line">    <span class="comment">//æœªæ”¯ä»˜</span></span><br><span class="line">    order.setStatus(<span class="number">0</span>);</span><br><span class="line">    <span class="comment">//å¾®ä¿¡æ”¯ä»˜</span></span><br><span class="line">    order.setPayType(<span class="number">1</span>);</span><br><span class="line">    baseMapper.insert(order);</span><br><span class="line">    <span class="keyword">return</span> order.getId();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5ã€å®šæ—¶ä»»åŠ¡"><a href="#5ã€å®šæ—¶ä»»åŠ¡" class="headerlink" title="5ã€å®šæ—¶ä»»åŠ¡"></a>5ã€å®šæ—¶ä»»åŠ¡</h2><h3 id="5-1ã€å®šæ—¶ä»»åŠ¡å®ç°æ–¹å¼"><a href="#5-1ã€å®šæ—¶ä»»åŠ¡å®ç°æ–¹å¼" class="headerlink" title="5.1ã€å®šæ—¶ä»»åŠ¡å®ç°æ–¹å¼"></a>5.1ã€å®šæ—¶ä»»åŠ¡å®ç°æ–¹å¼</h3><blockquote><p>Timer</p></blockquote><p>ä½¿ç”¨jdkçš„Timerå’ŒTimerTaskå¯ä»¥å®ç°ç®€å•çš„é—´éš”æ‰§è¡Œä»»åŠ¡ï¼Œæ— æ³•å®ç°æŒ‰æ—¥å†å»è°ƒåº¦æ‰§è¡Œä»»åŠ¡</p><blockquote><p>ScheduledThreadPoolçº¿ç¨‹æ± </p></blockquote><p>åˆ›å»ºå¯ä»¥å»¶è¿Ÿæˆ–å®šæ—¶æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ï¼Œæ— æ³•å®ç°æŒ‰æ—¥å†å»è°ƒåº¦æ‰§è¡Œä»»åŠ¡</p><blockquote><p>quartz</p></blockquote><p>ä½¿ç”¨Quartzå®ç° Quartz æ˜¯ä¸€ä¸ªå¼‚æ­¥ä»»åŠ¡è°ƒåº¦æ¡†æ¶ï¼ŒåŠŸèƒ½ä¸°å¯Œï¼Œå¯ä»¥å®ç°æŒ‰æ—¥å†è°ƒåº¦</p><blockquote><p>Spring Task</p></blockquote><p>Spring 3.0åæä¾›Spring Taskå®ç°ä»»åŠ¡è°ƒåº¦ï¼Œæ”¯æŒæŒ‰æ—¥å†è°ƒåº¦ï¼Œç›¸æ¯”QuartzåŠŸèƒ½ç¨ç®€å•ï¼Œä½†æ˜¯å¼€å‘åŸºæœ¬å¤Ÿç”¨ï¼Œæ”¯æŒæ³¨è§£ç¼–ç¨‹æ–¹å¼</p><h3 id="5-2ã€é›†æˆSpring-Task"><a href="#5-2ã€é›†æˆSpring-Task" class="headerlink" title="5.2ã€é›†æˆSpring Task"></a>5.2ã€é›†æˆSpring Task</h3><blockquote><p>åœ¨å¯åŠ¨ç±»ä¸­æ·»åŠ æ³¨è§£@EnableScheduling</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableScheduling</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="meta">@ComponentScan(&#123;&quot;com.hzx.grain&quot;&#125;)</span></span><br><span class="line"><span class="meta">@EnableDiscoveryClient</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ServiceStatisticsApplication</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(ServiceStatisticsApplication.class, args);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost:8180/doc.html&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost:8180/swagger-ui.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-3ã€åˆ›å»ºå®šæ—¶ä»»åŠ¡ç±»"><a href="#5-3ã€åˆ›å»ºå®šæ—¶ä»»åŠ¡ç±»" class="headerlink" title="5.3ã€åˆ›å»ºå®šæ—¶ä»»åŠ¡ç±»"></a>5.3ã€åˆ›å»ºå®šæ—¶ä»»åŠ¡ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ScheduledTask</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DailyService dailyService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æµ‹è¯•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Scheduled(cron=&quot;0/3 * * * * *&quot;)</span> <span class="comment">// æ¯éš”3ç§’æ‰§è¡Œä¸€æ¬¡</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">task1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;task1 æ‰§è¡Œ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5-4ã€æµ‹è¯•"><a href="#5-4ã€æµ‹è¯•" class="headerlink" title="5.4ã€æµ‹è¯•"></a>5.4ã€æµ‹è¯•</h3><blockquote><p>æŸ¥çœ‹æ§åˆ¶å°ï¼Œå¯ä»¥å‘ç°æ§åˆ¶å°å®šæ—¶è¾“å‡ºæ—¥å¿—</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212215219.png" alt="image-20210212215219245"></p><h3 id="5-5ã€åœ¨çº¿ç”Ÿæˆcronè¡¨è¾¾å¼"><a href="#5-5ã€åœ¨çº¿ç”Ÿæˆcronè¡¨è¾¾å¼" class="headerlink" title="5.5ã€åœ¨çº¿ç”Ÿæˆcronè¡¨è¾¾å¼"></a>5.5ã€åœ¨çº¿ç”Ÿæˆcronè¡¨è¾¾å¼</h3><blockquote><p><a href="http://cron.qqe2.com/">http://cron.qqe2.com/</a></p></blockquote><blockquote><p>å‚è€ƒæ•™ç¨‹å¦‚ä¸‹ï¼š</p></blockquote><ul><li>[1]  <a href="https://www.bilibili.com/video/BV1fi4y1x7on">å°šç¡…è°·åœ¨çº¿æ•™è‚²é¡¹ç›®</a></li></ul>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸ†”JWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ï¼ˆå››ï¼‰-äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</title>
      <link href="posts/1801475703.html"/>
      <url>posts/1801475703.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•"><a href="#1ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•" class="headerlink" title="1ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•"></a>1ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</h2><blockquote><p>äºŒåˆ†æŸ¥æ‰¾ï¼ˆBinary Searchï¼‰ä¹Ÿå«ä½œæŠ˜åŠæŸ¥æ‰¾ã€‚äºŒåˆ†æŸ¥æ‰¾æœ‰ä¸¤ä¸ªè¦æ±‚ï¼Œä¸€ä¸ªæ˜¯æ•°åˆ—æœ‰åºï¼Œå¦ä¸€ä¸ªæ˜¯æ•°åˆ—ä½¿ç”¨é¡ºåºå­˜å‚¨ç»“æ„ï¼ˆæ¯”å¦‚æ•°ç»„ï¼‰ã€‚</p></blockquote><h2 id="2ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„æ€è·¯åˆ†æ"><a href="#2ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„æ€è·¯åˆ†æ" class="headerlink" title="2ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„æ€è·¯åˆ†æ"></a>2ã€äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„æ€è·¯åˆ†æ</h2><blockquote><p>è¿™é‡Œä»¥æ•°ç»„[1,8,10,89,1000,1234]ä¸ºä¾‹</p></blockquote><ul><li>é¦–å…ˆç¡®å®šè¯¥æ•°ç»„ä¸­é—´å…ƒç´ çš„ä¸‹æ ‡mid</li></ul><blockquote><p>mid = [left+right] / 2</p></blockquote><ul><li>è®©éœ€è¦æŸ¥æ‰¾çš„æ•°findValå’Œarr[mid]æ¯”è¾ƒï¼Œæ­¤æ—¶ä¼šå‡ºç°ä»¥ä¸‹å‡ ç§æƒ…å†µ<ul><li>findVal&gt;arr[mid]ï¼Œè¯´æ˜è¦æŸ¥æ‰¾çš„æ•°åœ¨midçš„å³è¾¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€’å½’å‘å³æŸ¥æ‰¾</li><li>findVal&lt;arr[mid]ï¼Œè¯´æ˜è¦æŸ¥æ‰¾çš„æ•°åœ¨midçš„å·¦è¾¹ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦é€’å½’å‘å·¦æŸ¥æ‰¾</li><li>findVal=arr[mid]ï¼Œè¯´æ˜arr[mid]å°±æ˜¯æˆ‘ä»¬è¦å¯»æ‰¾çš„å€¼ï¼Œç›´æ¥è¿”å›mid</li></ul></li><li>ç»“æŸé€’å½’çš„æ¡ä»¶æœ‰<ul><li>æ‰¾åˆ°ç›®æ ‡å€¼ç»“æŸé€’å½’ã€‚</li><li>é€’å½’å®Œæ•´ä¸ªæ•°ç»„ä»ç„¶æ²¡æœ‰æ‰¾åˆ°findValï¼Œä¹Ÿéœ€è¦ç»“æŸé€’å½’ã€‚å³å½“left&gt;rightæ—¶ç»“æŸé€’å½’ã€‚</li></ul></li></ul><h2 id="3ã€é€’å½’äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„ä»£ç å®ç°"><a href="#3ã€é€’å½’äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„ä»£ç å®ç°" class="headerlink" title="3ã€é€’å½’äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„ä»£ç å®ç°"></a>3ã€é€’å½’äºŒåˆ†æŸ¥æ‰¾ç®—æ³•çš„ä»£ç å®ç°</h2><blockquote><p>é€’å½’é€€å‡ºæ¡ä»¶1ï¼šå¯»æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œæ­¤æ—¶è¿”å›mid</p><p>é€’å½’é€€å‡ºæ¡ä»¶2ï¼šé€’å½’å®Œæ•´ä¸ªæ•°ç»„æ²¡æœ‰æ‰¾åˆ°ç›®æ ‡å€¼ï¼Œæ­¤æ—¶left &gt; rightï¼Œè¿”å›-1</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arr è¦æŸ¥æ‰¾çš„ç›®æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> left æœ¬æ¬¡æŸ¥æ‰¾çš„å·¦è¾¹ç•Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> right æœ¬æ¬¡æŸ¥æ‰¾çš„å³è¾¹ç•Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> findVal è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> findValåœ¨arrä¸­çš„ä¸‹æ ‡ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¿”å›-1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] arr,<span class="keyword">int</span> left,<span class="keyword">int</span> right,<span class="keyword">int</span> findVal)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left &gt; right) &#123;</span><br><span class="line">        <span class="comment">//å¦‚æœå‘ç°leftå€¼å¤§äºrightå€¼ï¼Œé‚£ä¹ˆè¯æ˜æ­¤æ—¶æ•°ç»„å·²ç»é€’å½’å®Œæ¯•ä¸”æ•°ç»„ä¸­æ²¡æœ‰è¦å¯»æ‰¾çš„å€¼</span></span><br><span class="line">        <span class="comment">//æ­¤æ—¶éœ€è¦è¿”å›-1</span></span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> midVal = arr[mid];</span><br><span class="line">    <span class="comment">//å¦‚æœè¦å¯»æ‰¾çš„å€¼å°äºå½“å‰çš„midVal</span></span><br><span class="line">    <span class="keyword">if</span>(findVal &gt; midVal) &#123;</span><br><span class="line">        <span class="comment">//å‘å³é€’å½’</span></span><br><span class="line">        <span class="keyword">return</span> binarySearch(arr,mid + <span class="number">1</span>,right,findVal);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(findVal &lt; midVal) &#123;</span><br><span class="line">        <span class="comment">//å‘å·¦é€’å½’</span></span><br><span class="line">        <span class="keyword">return</span> binarySearch(arr,left,mid - <span class="number">1</span>,findVal);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> mid;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4ã€æµ‹è¯•"><a href="#4ã€æµ‹è¯•" class="headerlink" title="4ã€æµ‹è¯•"></a>4ã€æµ‹è¯•</h2><blockquote><p>æµ‹è¯•æ‰¾ä¸åˆ°çš„æƒ…å†µ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] arr = &#123;<span class="number">1</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">89</span>,<span class="number">1000</span>,<span class="number">1234</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> resultIndex = binarySearch(arr,<span class="number">0</span>, arr.length - <span class="number">1</span>,<span class="number">10000</span>);</span><br><span class="line">    System.out.println(resultIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212170117.png" alt="image-20210212170116299"></p><blockquote><p>æµ‹è¯•æ‰¾å¾—åˆ°çš„æƒ…å†µ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] arr = &#123;<span class="number">1</span>,<span class="number">8</span>,<span class="number">10</span>,<span class="number">89</span>,<span class="number">1000</span>,<span class="number">1234</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> resultIndex = binarySearch(arr,<span class="number">0</span>, arr.length - <span class="number">1</span>,<span class="number">8</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;resultIndex:&quot;</span> + resultIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212170225.png" alt="image-20210212170225794"></p><h2 id="5ã€æ”¹è¿›äºŒåˆ†æŸ¥æ‰¾ç®—æ³•"><a href="#5ã€æ”¹è¿›äºŒåˆ†æŸ¥æ‰¾ç®—æ³•" class="headerlink" title="5ã€æ”¹è¿›äºŒåˆ†æŸ¥æ‰¾ç®—æ³•"></a>5ã€æ”¹è¿›äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</h2><blockquote><p>åœ¨ä¸€ä¸ªæ•°ç»„ä¸­ï¼Œå¦‚æœæœ‰å¤šä¸ªå€¼ä¸findValå€¼ç›¸åŒæ—¶ï¼Œè¦æ±‚å°†è¿™äº›å€¼çš„ä¸‹æ ‡éƒ½æ‰¾åˆ°</p><p>æ€è·¯åˆ†æå¦‚ä¸‹:</p></blockquote><ul><li><p>åœ¨æ‰¾åˆ°midç´¢å¼•å€¼æ—¶ï¼Œä¸è¦é©¬ä¸Šè¿”å›</p></li><li><p>å‘midç´¢å¼•å€¼çš„å·¦è¾¹æ‰«æï¼Œå°†æ‰€æœ‰ç­‰äºfindValçš„å…ƒç´ ä¸‹æ ‡è¿›å…¥åˆ°ä¸€ä¸ªé›†åˆä¸­</p></li><li><p>å‘midç´¢å¼•å€¼çš„å³è¾¹æ‰«æï¼Œå°†æ‰€æœ‰ç­‰äºfindValçš„å…ƒç´ ä¸‹æ ‡è¿›å…¥åˆ°ä¸€ä¸ªé›†åˆä¸­</p></li><li><p>è¿”å›ä¸‹æ ‡é›†åˆ</p></li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> arr è¦æŸ¥æ‰¾çš„ç›®æ ‡æ•°ç»„</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> left æœ¬æ¬¡æŸ¥æ‰¾çš„å·¦è¾¹ç•Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> right æœ¬æ¬¡æŸ¥æ‰¾çš„å³è¾¹ç•Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> findVal è¦æŸ¥æ‰¾çš„å€¼</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> findValåœ¨arrä¸­çš„ä¸‹æ ‡ï¼Œå¦‚æœæ‰¾ä¸åˆ°è¿”å›-1</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> List&lt;Integer&gt; <span class="title">binarySearchAllElements</span><span class="params">(<span class="keyword">int</span>[] arr,<span class="keyword">int</span> left,<span class="keyword">int</span> right,<span class="keyword">int</span> findVal)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(left &gt; right) &#123;</span><br><span class="line">        <span class="comment">//å¦‚æœå‘ç°leftå€¼å¤§äºrightå€¼ï¼Œé‚£ä¹ˆè¯æ˜æ­¤æ—¶æ•°ç»„å·²ç»é€’å½’å®Œæ¯•ä¸”æ•°ç»„ä¸­æ²¡æœ‰è¦å¯»æ‰¾çš„å€¼</span></span><br><span class="line">        <span class="comment">//æ­¤æ—¶éœ€è¦è¿”å›null</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">    <span class="keyword">int</span> midVal = arr[mid];</span><br><span class="line">    <span class="comment">//å¦‚æœè¦å¯»æ‰¾çš„å€¼å°äºå½“å‰çš„midVal</span></span><br><span class="line">    <span class="keyword">if</span>(findVal &gt; midVal) &#123;</span><br><span class="line">        <span class="comment">//å‘å³é€’å½’</span></span><br><span class="line">        <span class="keyword">return</span> binarySearchAllElements(arr,mid + <span class="number">1</span>,right,findVal);</span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(findVal &lt; midVal) &#123;</span><br><span class="line">        <span class="comment">//å‘å·¦é€’å½’</span></span><br><span class="line">        <span class="keyword">return</span> binarySearchAllElements(arr,left,mid - <span class="number">1</span>,findVal);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        List&lt;Integer&gt; resIndexList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//å®ç°å‘å·¦è¾¹æ‰«æ</span></span><br><span class="line">        <span class="keyword">int</span> temp = mid - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæ•°ç»„ä¸‹æ ‡è¶Šç•Œæˆ–è€…å·¦è¾¹å·²ç»æ²¡æœ‰ä¸findValç›¸ç­‰çš„å€¼</span></span><br><span class="line">            <span class="keyword">if</span>(temp &lt; <span class="number">0</span> || arr[temp] != findVal) &#123;</span><br><span class="line">                <span class="comment">//é€€å‡º</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            resIndexList.add(temp);</span><br><span class="line">            temp -= <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å°†midåŠ å…¥åˆ°é›†åˆä¸­</span></span><br><span class="line">        resIndexList.add(mid);</span><br><span class="line">        <span class="comment">//å‘å³è¾¹æ‰«æ</span></span><br><span class="line">        temp = mid + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(temp &gt; arr.length - <span class="number">1</span> || arr[temp] != findVal) &#123;</span><br><span class="line">                <span class="comment">//é€€å‡º</span></span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            resIndexList.add(temp);</span><br><span class="line">            temp += <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> resIndexList;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] arr = &#123;<span class="number">1</span>,<span class="number">5</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">1000</span>,<span class="number">1234</span>,<span class="number">1999</span>&#125;;</span><br><span class="line">    List&lt;Integer&gt; result = binarySearchAllElements(arr,<span class="number">0</span>, arr.length - <span class="number">1</span>,<span class="number">1000</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;ç»“æœä¸‹æ ‡ä¸ºï¼š&quot;</span> + result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212171648.png" alt="image-20210212171648097"></p><h2 id="6ã€éé€’å½’å®ç°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•"><a href="#6ã€éé€’å½’å®ç°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•" class="headerlink" title="6ã€éé€’å½’å®ç°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•"></a>6ã€éé€’å½’å®ç°äºŒåˆ†æŸ¥æ‰¾ç®—æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">binarySearch</span><span class="params">(<span class="keyword">int</span>[] arr,<span class="keyword">int</span> findVal)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//å¦‚æœæ•°ç»„ä¸ºç©ºç›´æ¥return -1</span></span><br><span class="line">    <span class="keyword">if</span>(arr == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">int</span> right = arr.length - <span class="number">1</span>;</span><br><span class="line">    <span class="comment">//åœ¨leftå°äºrightçš„æƒ…å†µä¸‹è¿›è¡Œå¾ªç¯</span></span><br><span class="line">    <span class="keyword">while</span>(left &lt;= right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right) / <span class="number">2</span>;</span><br><span class="line">        <span class="keyword">if</span>(findVal &lt; arr[mid]) &#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ­¤æ—¶éœ€è¦å‘å·¦è¿›è¡ŒæŸ¥æ‰¾</span></span><br><span class="line">            right = mid - <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(findVal &gt; arr[mid]) &#123;</span><br><span class="line">            <span class="comment">//è¯´æ˜æ­¤æ—¶éœ€è¦å‘å³è¿›è¡ŒæŸ¥æ‰¾</span></span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¦‚æœä¸Šé¢æ²¡æœ‰è¿”å›ï¼Œè¯æ˜æ•°ç»„ä¸­æ²¡æœ‰findValï¼Œç›´æ¥è¿”å›-1</span></span><br><span class="line">    <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] arr = &#123;<span class="number">1</span>,<span class="number">5</span>,<span class="number">888</span>,<span class="number">1000</span>,<span class="number">1111</span>,<span class="number">1234</span>,<span class="number">1999</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span> resIndex = binarySearch(arr,<span class="number">5</span>);</span><br><span class="line">    System.out.println(<span class="string">&quot;resIndexçš„å€¼ä¸º:&quot;</span> + resIndex);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210212172431.png" alt="image-20210212172431234"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudå­¦ä¹ ï¼ˆäºŒï¼‰-OpenFeignå¾®æœåŠ¡è°ƒç”¨</title>
      <link href="posts/2863462089.html"/>
      <url>posts/2863462089.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€OpenFeign"><a href="#ä¸€ã€OpenFeign" class="headerlink" title="ä¸€ã€OpenFeign"></a>ä¸€ã€OpenFeign</h1><blockquote><p>OpenFeignæ˜¯Spring Cloudæä¾›çš„ä¸€ä¸ªå£°æ˜å¼çš„ä¼ªHttpå®¢æˆ·ç«¯ï¼Œ å®ƒä½¿å¾—è°ƒç”¨è¿œç¨‹æœåŠ¡å°±åƒè°ƒç”¨æœ¬åœ°æœåŠ¡ä¸€æ ·ç®€å•ï¼Œ åªéœ€è¦<strong>åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶æ·»åŠ ä¸€ä¸ªæ³¨è§£</strong>å³å¯ã€‚</p><p>Nacoså¾ˆå¥½çš„å…¼å®¹äº†OpenFeignï¼Œ OpenFeigné»˜è®¤<strong>é›†æˆäº† Ribbon</strong>ï¼Œ æ‰€ä»¥åœ¨Nacosä¸‹ä½¿ç”¨OpenFeigné»˜è®¤å°±å®ç°äº†è´Ÿè½½å‡è¡¡çš„æ•ˆæœã€‚</p><p>Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„webæœåŠ¡å®¢æˆ·ç«¯ï¼Œè®©ç¼–å†™webæœåŠ¡å®¢æˆ·ç«¯å˜å¾—éå¸¸å®¹æ˜“ï¼Œåªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶åœ¨æ¥å£ä¸Šæ·»åŠ æ³¨è§£å³å¯</p></blockquote><h2 id="1-1ã€ä½œç”¨"><a href="#1-1ã€ä½œç”¨" class="headerlink" title="1.1ã€ä½œç”¨"></a>1.1ã€ä½œç”¨</h2><ul><li>Feignä½¿å¾—ç¼–å†™Java Httpå®¢æˆ·ç«¯å˜å¾—æ›´åŠ å®¹æ˜“ã€‚</li><li>åœ¨Feignçš„å®ç°ä¸‹ï¼Œæˆ‘ä»¬åªéœ€åˆ›å»ºä¸€ä¸ªæ¥å£å¹¶ä½¿ç”¨æ³¨è§£çš„æ–¹å¼æ¥é…ç½®å®ƒï¼ˆä»¥å‰æ˜¯Daoæ¥å£ä¸Šé¢æ ‡æ³¨Mapperæ³¨è§£ï¼Œç°åœ¨æ˜¯ä¸€ä¸ªå¾®æœåŠ¡æ¥å£ä¸Šé¢æ ‡æ³¨ä¸€ä¸ªFeignæ³¨è§£å³å¯ï¼‰ï¼Œå³å¯å®Œæˆå¯¹æœåŠ¡æä¾›æ–¹çš„æ¥å£ç»‘å®šï¼Œç®€åŒ–äº†ä½¿ç”¨Spring cloud Ribbonæ—¶ï¼Œè‡ªåŠ¨å°è£…æœåŠ¡è°ƒç”¨å®¢æˆ·ç«¯çš„å¼€å‘é‡ã€‚</li><li>Feigné›†æˆäº†Ribbonåˆ©ç”¨Ribbonç»´æŠ¤äº†Paymentçš„æœåŠ¡åˆ—è¡¨ä¿¡æ¯ï¼Œå¹¶ä¸”é€šè¿‡è½®è¯¢å®ç°äº†å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ã€‚è€Œä¸Ribbonä¸åŒçš„æ˜¯ï¼Œé€šè¿‡feignåªéœ€è¦å®šä¹‰æœåŠ¡ç»‘å®šæ¥å£ç›®ä»¥å£°æ˜å¼çš„æ–¹æ³•ï¼Œä¼˜é›…è€Œç®€å•çš„å®ç°äº†æœåŠ¡è°ƒç”¨ã€‚</li></ul><h2 id="1-2ã€Feignå’ŒOpenFeign"><a href="#1-2ã€Feignå’ŒOpenFeign" class="headerlink" title="1.2ã€Feignå’ŒOpenFeign"></a>1.2ã€Feignå’ŒOpenFeign</h2><table><thead><tr><th>Feign</th><th>OpenFeign</th></tr></thead><tbody><tr><td>Feignæ˜¯Spring Cloudç»„ä»¶ä¸­çš„ä¸€ä¸ªè½»é‡çº§RESTfulçš„HTTPæœåŠ¡å®¢æˆ·ç«¯Feignå†…ç½®äº†Ribbonï¼Œç”¨æ¥åšå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡ï¼Œå»è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡ã€‚Feignçš„ä½¿ç”¨æ–¹å¼æ˜¯ï¼šä½¿ç”¨Feignçš„æ³¨è§£å®šä¹‰æ¥å£ï¼Œè°ƒç”¨è¿™ä¸ªæ¥å£ï¼Œå°±å¯ä»¥è°ƒç”¨æœåŠ¡æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡ã€‚</td><td>OpenFeignæ˜¯Spring Cloud åœ¨Feignçš„åŸºç¡€ä¸Šæ”¯æŒäº†Spring MVCçš„æ³¨è§£ï¼Œå¦‚@RequesMappingç­‰ç­‰ã€‚OpenFeignçš„@FeignClientå¯ä»¥è§£æSpring MVCçš„@RequestMappingæ³¨è§£ä¸‹çš„æ¥å£ï¼Œå¹¶é€šè¿‡åŠ¨æ€ä»£ç†çš„æ–¹å¼äº§ç”Ÿå®ç°ç±»ï¼Œå®ç°ç±»ä¸­åšè´Ÿè½½å‡è¡¡å¹¶è°ƒç”¨å…¶ä»–æœåŠ¡ã€‚</td></tr></tbody></table><h2 id="1-3ã€OpenFeignä½¿ç”¨æ­¥éª¤"><a href="#1-3ã€OpenFeignä½¿ç”¨æ­¥éª¤" class="headerlink" title="1.3ã€OpenFeignä½¿ç”¨æ­¥éª¤"></a>1.3ã€OpenFeignä½¿ç”¨æ­¥éª¤</h2><h3 id="1ã€åˆ›å»ºå¾®æœåŠ¡æä¾›è€…é›†ç¾¤"><a href="#1ã€åˆ›å»ºå¾®æœåŠ¡æä¾›è€…é›†ç¾¤" class="headerlink" title="1ã€åˆ›å»ºå¾®æœåŠ¡æä¾›è€…é›†ç¾¤"></a>1ã€åˆ›å»ºå¾®æœåŠ¡æä¾›è€…é›†ç¾¤</h3><blockquote><p>åˆ›å»ºå¾®æœåŠ¡æ¨¡å—cloud-provider-payment8001å’Œcloud-provider-payment8002ï¼Œpaymentå¾®æœåŠ¡çš„æ§åˆ¶å™¨ä¸ºï¼š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;æ”¯ä»˜åŠŸèƒ½æ§åˆ¶å™¨&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PaymentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Resource</span></span><br><span class="line">    <span class="keyword">private</span> PaymentService paymentService;</span><br><span class="line">    <span class="meta">@Value(&quot;$&#123;server.port&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String serverPort;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@GetMapping(&quot;/payment/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®idæŸ¥è¯¢è®¢å•&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">getPaymentById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        Payment result = paymentService.getPaymentById(id);</span><br><span class="line">        <span class="keyword">if</span>(result == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> CommonResult&lt;&gt;(<span class="number">404</span>,<span class="string">&quot;æ•°æ®åº“ä¸­æ²¡æœ‰è¯¥è®¢å•ï¼ç«¯å£ä¸ºï¼š&quot;</span> + serverPort,<span class="keyword">null</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult&lt;&gt;(<span class="number">200</span>,<span class="string">&quot;æˆåŠŸï¼ç«¯å£ä¸ºï¼š&quot;</span> + serverPort,result);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€åˆ›å»ºOpenFeignå®¢æˆ·ç«¯"><a href="#2ã€åˆ›å»ºOpenFeignå®¢æˆ·ç«¯" class="headerlink" title="2ã€åˆ›å»ºOpenFeignå®¢æˆ·ç«¯"></a>2ã€åˆ›å»ºOpenFeignå®¢æˆ·ç«¯</h3><blockquote><p>åˆ›å»ºå¾®æœåŠ¡æ¨¡å—cloud-consumer-feign-order80ï¼Œè¿™ä¸ªå¾®æœåŠ¡éœ€è¦è°ƒç”¨paymentå¾®æœåŠ¡ä¸­çš„æ¥å£ã€‚</p><p>æ³¨ï¼šOpenFeignæ˜¯åœ¨<strong>æ¶ˆè´¹ç«¯ï¼ˆå¾®æœåŠ¡è°ƒç”¨è€…ç«¯ï¼‰</strong>ä½¿ç”¨çš„ã€‚</p></blockquote><h3 id="3ã€å¼•å…¥ä¾èµ–"><a href="#3ã€å¼•å…¥ä¾èµ–" class="headerlink" title="3ã€å¼•å…¥ä¾èµ–"></a>3ã€å¼•å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--openfeign--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-openfeign<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-actuator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>OpenFeignä¸­è‡ªåŠ¨é›†æˆäº†Ribbonï¼Œå®ç°äº†è´Ÿè½½å‡è¡¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211214254.png" alt="image-20210211214254211"></p><h3 id="4ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"><a href="#4ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶" class="headerlink" title="4ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶"></a>4ã€ç¼–å†™ymlé…ç½®æ–‡ä»¶</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">80</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="comment"># ä¸æ³¨å†Œå…¥eureka</span></span><br><span class="line">    <span class="attr">register-with-eureka:</span> <span class="literal">false</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka,</span> <span class="string">http://eureka7002.com:7002/eureka</span></span><br></pre></td></tr></table></figure><h3 id="5ã€ç¼–å†™å¯åŠ¨ç±»ï¼Œæ·»åŠ -EnableFeignClientsæ³¨è§£æ¿€æ´»OpenFeign"><a href="#5ã€ç¼–å†™å¯åŠ¨ç±»ï¼Œæ·»åŠ -EnableFeignClientsæ³¨è§£æ¿€æ´»OpenFeign" class="headerlink" title="5ã€ç¼–å†™å¯åŠ¨ç±»ï¼Œæ·»åŠ @EnableFeignClientsæ³¨è§£æ¿€æ´»OpenFeign"></a>5ã€ç¼–å†™å¯åŠ¨ç±»ï¼Œæ·»åŠ @EnableFeignClientsæ³¨è§£æ¿€æ´»OpenFeign</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//æ¿€æ´»å¹¶å¼€å¯OpenFeign</span></span><br><span class="line"><span class="meta">@EnableFeignClients</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderFeignMain80</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(OrderFeignMain80.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€ç¼–å†™ä¸€ä¸ªServiceæ¥å£ï¼Œç”¨äºè¿œç¨‹è°ƒç”¨paymentå¾®æœåŠ¡"><a href="#6ã€ç¼–å†™ä¸€ä¸ªServiceæ¥å£ï¼Œç”¨äºè¿œç¨‹è°ƒç”¨paymentå¾®æœåŠ¡" class="headerlink" title="6ã€ç¼–å†™ä¸€ä¸ªServiceæ¥å£ï¼Œç”¨äºè¿œç¨‹è°ƒç”¨paymentå¾®æœåŠ¡"></a>6ã€ç¼–å†™ä¸€ä¸ªServiceæ¥å£ï¼Œç”¨äºè¿œç¨‹è°ƒç”¨paymentå¾®æœåŠ¡</h3><blockquote><p>æ³¨æ„ç‚¹ï¼š</p><ul><li>åœ¨Serviceæ¥å£ä¸Šæ·»åŠ ä¸€ä¸ª@FeignClientæ³¨è§£ï¼Œvalueå€¼ä¸ºè¦è°ƒç”¨çš„å¾®æœåŠ¡åœ¨æ³¨å†Œä¸­å¿ƒä¸­æ³¨å†Œçš„æœåŠ¡åï¼›</li><li>éœ€è¦å®Œæ•´æ·»åŠ è¿œç¨‹è°ƒç”¨æ¥å£çš„å…¨è·¯å¾„</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@FeignClient(value = &quot;cloud-payment-service&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">PaymentFeignService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@GetMapping(&quot;/payment/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function">CommonResult&lt;Payment&gt; <span class="title">getPaymentById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="7ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­ç¼–å†™Controller"><a href="#7ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­ç¼–å†™Controller" class="headerlink" title="7ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­ç¼–å†™Controller"></a>7ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­ç¼–å†™Controller</h3><blockquote><p>è¿™ä¸ªControllerè°ƒç”¨ä¸Šé¢å†™çš„OpenFeignæœåŠ¡æ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">OrderFeignController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> PaymentFeignService paymentFeignService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/consumer/payment/get/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">getPaymentById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> paymentFeignService.getPaymentById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="8ã€æµ‹è¯•"><a href="#8ã€æµ‹è¯•" class="headerlink" title="8ã€æµ‹è¯•"></a>8ã€æµ‹è¯•</h3><blockquote><p>å¯åŠ¨eureka7001ã€payment8001ã€payment8002é›†ç¾¤å’Œopenfeignå¾®æœåŠ¡ã€‚</p></blockquote><ul><li>ç”±äºopenfeignå¾®æœåŠ¡æ²¡æœ‰è¢«æˆ‘ä»¬æ³¨å†Œå…¥eurekaï¼Œæ‰€ä»¥eurekaæ³¨å†Œä¸­å¿ƒæ˜¾ç¤ºå¦‚ä¸‹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211220835.png" alt="image-20210211220835349"></p><ul><li>ä½¿ç”¨openfeignå¾®æœåŠ¡è¿œç¨‹è°ƒç”¨paymentå¾®æœåŠ¡ä¸­çš„æ–¹æ³•</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211221340.png" alt="image-20210211221340700"></p><h2 id="1-4ã€OpenFeignè¶…æ—¶æ§åˆ¶"><a href="#1-4ã€OpenFeignè¶…æ—¶æ§åˆ¶" class="headerlink" title="1.4ã€OpenFeignè¶…æ—¶æ§åˆ¶"></a>1.4ã€OpenFeignè¶…æ—¶æ§åˆ¶</h2><h3 id="1ã€OpenFeigné»˜è®¤ç­‰å¾…æ—¶é—´"><a href="#1ã€OpenFeigné»˜è®¤ç­‰å¾…æ—¶é—´" class="headerlink" title="1ã€OpenFeigné»˜è®¤ç­‰å¾…æ—¶é—´"></a>1ã€OpenFeigné»˜è®¤ç­‰å¾…æ—¶é—´</h3><blockquote><p>OpenFeigné»˜è®¤ç­‰å¾…æ—¶é—´ä¸º1ç§’é’Ÿï¼Œè‹¥æœåŠ¡æä¾›æ–¹è¶…è¿‡è¿™ä¸ªæ—¶é—´åˆ™ç›´æ¥æŠ¥é”™ã€‚</p></blockquote><h3 id="2ã€æ¼”ç¤ºè¶…æ—¶å‡ºé”™æƒ…å†µ"><a href="#2ã€æ¼”ç¤ºè¶…æ—¶å‡ºé”™æƒ…å†µ" class="headerlink" title="2ã€æ¼”ç¤ºè¶…æ—¶å‡ºé”™æƒ…å†µ"></a>2ã€æ¼”ç¤ºè¶…æ—¶å‡ºé”™æƒ…å†µ</h3><blockquote><p>åœ¨æœåŠ¡æä¾›æ–¹paymentå¾®æœåŠ¡ä¸­æ–°æ·»ä¸€ä¸ªæ¥å£ï¼Œåœ¨æ¥å£ä¸­æ¨¡æ‹Ÿè¶…æ—¶æƒ…å†µ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/payment/feign/timeout&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">paymentFeignTimeOut</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åœ¨è¢«è°ƒç”¨çš„æœåŠ¡æä¾›æ–¹ä¸­ä¼‘çœ ä¸‰ç§’</span></span><br><span class="line">    <span class="comment">//ç”¨äºæ¨¡æ‹Ÿé•¿æµç¨‹è°ƒç”¨</span></span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        TimeUnit.SECONDS.sleep(<span class="number">3</span>);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (InterruptedException interruptedException) &#123;</span><br><span class="line">        interruptedException.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> serverPort;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­æ·»åŠ è¿œç¨‹è°ƒç”¨æ¥å£"><a href="#3ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­æ·»åŠ è¿œç¨‹è°ƒç”¨æ¥å£" class="headerlink" title="3ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­æ·»åŠ è¿œç¨‹è°ƒç”¨æ¥å£"></a>3ã€åœ¨OpenFeignå¾®æœåŠ¡ä¸­æ·»åŠ è¿œç¨‹è°ƒç”¨æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/payment/feign/timeout&quot;)</span></span><br><span class="line">   <span class="function">String <span class="title">paymentFeignTimeOut</span><span class="params">()</span></span>;</span><br></pre></td></tr></table></figure><h3 id="4ã€åœ¨OpenFeignå¾®æœåŠ¡æ§åˆ¶å™¨ä¸­æ·»åŠ æ¥å£"><a href="#4ã€åœ¨OpenFeignå¾®æœåŠ¡æ§åˆ¶å™¨ä¸­æ·»åŠ æ¥å£" class="headerlink" title="4ã€åœ¨OpenFeignå¾®æœåŠ¡æ§åˆ¶å™¨ä¸­æ·»åŠ æ¥å£"></a>4ã€åœ¨OpenFeignå¾®æœåŠ¡æ§åˆ¶å™¨ä¸­æ·»åŠ æ¥å£</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(value = &quot;/consumer/feign/timeout&quot;)</span></span><br><span class="line"> <span class="function"><span class="keyword">public</span> String <span class="title">paymentFeignTimeOut</span><span class="params">()</span> </span>&#123;</span><br><span class="line">     <span class="keyword">return</span> paymentFeignService.paymentFeignTimeOut();</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€æµ‹è¯•"><a href="#5ã€æµ‹è¯•" class="headerlink" title="5ã€æµ‹è¯•"></a>5ã€æµ‹è¯•</h3><blockquote><p>å…ˆè®¿é—®paymentå¾®æœåŠ¡ä¸­æ–°å¢çš„æ¥å£</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211222304.png" alt="image-20210211222304721"></p><blockquote><p>æµ‹è¯•è¿œç¨‹è°ƒç”¨paymentå¾®æœåŠ¡çš„è¶…æ—¶æ¥å£</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211222545.png" alt="image-20210211222545603"></p><h3 id="6ã€è®¾ç½®OpenFeignçš„è¶…æ—¶æ—¶é—´"><a href="#6ã€è®¾ç½®OpenFeignçš„è¶…æ—¶æ—¶é—´" class="headerlink" title="6ã€è®¾ç½®OpenFeignçš„è¶…æ—¶æ—¶é—´"></a>6ã€è®¾ç½®OpenFeignçš„è¶…æ—¶æ—¶é—´</h3><blockquote><p>ä¿®æ”¹ymlé…ç½®æ–‡ä»¶</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># è®¾ç½®Feignå®¢æˆ·ç«¯çš„è¶…æ—¶æ—¶é—´(OpenFeigné»˜è®¤æ”¯æŒRibbon)</span></span><br><span class="line"><span class="attr">ribbon:</span></span><br><span class="line">  <span class="comment">#æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥åä»æœåŠ¡å™¨è¯»å–åˆ°å¯ç”¨èµ„æºæ‰€ç”¨çš„æ—¶é—´</span></span><br><span class="line">  <span class="attr">ReadTimeout:</span> <span class="number">5000</span></span><br><span class="line">  <span class="comment">#æŒ‡çš„æ˜¯å»ºç«‹è¿æ¥æ‰€ç”¨çš„æ—¶é—´ï¼Œé€‚ç”¨äºç½‘ç»œæ­£å¸¸çš„æƒ…å†µä¸‹</span></span><br><span class="line">  <span class="attr">ConnectTimeout:</span> <span class="number">5000</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡å¯OpenFeignå¾®æœåŠ¡ï¼Œæµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211222811.png" alt="image-20210211222811217"></p><h2 id="1-5ã€OpenFeignçš„æ—¥å¿—æ‰“å°åŠŸèƒ½"><a href="#1-5ã€OpenFeignçš„æ—¥å¿—æ‰“å°åŠŸèƒ½" class="headerlink" title="1.5ã€OpenFeignçš„æ—¥å¿—æ‰“å°åŠŸèƒ½"></a>1.5ã€OpenFeignçš„æ—¥å¿—æ‰“å°åŠŸèƒ½</h2><h3 id="1ã€æ¦‚è¿°"><a href="#1ã€æ¦‚è¿°" class="headerlink" title="1ã€æ¦‚è¿°"></a>1ã€æ¦‚è¿°</h3><blockquote><p>Feign æä¾›äº†æ—¥å¿—æ‰“å°åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡é…ç½®æ¥è°ƒæ•´æ—¥å¿—çº§åˆ«ï¼Œä»è€Œäº†è§£ Feignä¸­Httpè¯·æ±‚çš„ç»†èŠ‚ã€‚<br>è¯´ç™½äº†å°±æ˜¯å¯¹Feignæ¥å£çš„è°ƒç”¨æƒ…å†µè¿›è¡Œç›‘æ§å’Œè¾“å‡º</p></blockquote><h3 id="2ã€çº§åˆ«è¯´æ˜"><a href="#2ã€çº§åˆ«è¯´æ˜" class="headerlink" title="2ã€çº§åˆ«è¯´æ˜"></a>2ã€çº§åˆ«è¯´æ˜</h3><ul><li>NONE:é»˜è®¤çš„ï¼Œä¸æ˜¾ç¤ºä»»ä½•æ—¥å¿—ï¼›</li><li>BASICï¼šä»…è®°å½•è¯·æ±‚æ–¹æ³•ã€URLã€å“åº”çŠ¶æ€ç åŠæ‰§è¡Œæ—¶é—´ï¼›</li><li>HEADERS:é™¤äº†BASICä¸­å®šä¹‰çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰è¯·æ±‚å’Œå“åº”çš„å¤´ä¿¡æ¯ï¼›</li><li>FULL:é™¤äº†HEADERSä¸­å®šä¹‰çš„ä¿¡æ¯ä¹‹å¤–ï¼Œè¿˜æœ‰è¯·æ±‚å’Œå“åº”çš„æ­£æ–‡åŠå…ƒæ•°æ®ã€‚</li></ul><h3 id="3ã€ç¼–å†™é…ç½®ç±»ï¼Œé…ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«"><a href="#3ã€ç¼–å†™é…ç½®ç±»ï¼Œé…ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«" class="headerlink" title="3ã€ç¼–å†™é…ç½®ç±»ï¼Œé…ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«"></a>3ã€ç¼–å†™é…ç½®ç±»ï¼Œé…ç½®æ—¥å¿—è¾“å‡ºçº§åˆ«</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FeignLogConfig</span> </span>&#123;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * å¼€å¯è¯¦ç»†æ—¥å¿—</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    Logger.<span class="function">Level <span class="title">feignLoggerLevel</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> Logger.Level.FULL;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€åœ¨ymlæ–‡ä»¶ä¸­å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯"><a href="#4ã€åœ¨ymlæ–‡ä»¶ä¸­å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯" class="headerlink" title="4ã€åœ¨ymlæ–‡ä»¶ä¸­å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯"></a>4ã€åœ¨ymlæ–‡ä»¶ä¸­å¼€å¯æ—¥å¿—çš„Feignå®¢æˆ·ç«¯</h3><blockquote><p>æŒ‡å®šFeignä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">logging:</span></span><br><span class="line">  <span class="attr">level:</span></span><br><span class="line">    <span class="comment"># feignæ—¥å¿—ä»¥ä»€ä¹ˆçº§åˆ«ç›‘æ§å“ªä¸ªæ¥å£</span></span><br><span class="line">    <span class="attr">com.hzx.springcloud.service.PaymentFeignService:</span> <span class="string">debug</span></span><br></pre></td></tr></table></figure><h3 id="5ã€å†æ¬¡æµ‹è¯•ï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º"><a href="#5ã€å†æ¬¡æµ‹è¯•ï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º" class="headerlink" title="5ã€å†æ¬¡æµ‹è¯•ï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º"></a>5ã€å†æ¬¡æµ‹è¯•ï¼ŒæŸ¥çœ‹æ—¥å¿—è¾“å‡º</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211223406.png" alt="image-20210211223406662"></p><blockquote><p>æ—¥å¿—è¾“å‡ºæƒ…å†µ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211223450.png" alt="image-20210211223450652"></p><h1 id="äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆOpenFeign"><a href="#äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆOpenFeign" class="headerlink" title="äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆOpenFeign"></a>äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆOpenFeign</h1><blockquote><p>åœ¨çº¿æ•™è‚²ä¸­ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸¤ä¸ªç”¨äºä¸é˜¿é‡Œäº‘äº¤äº’çš„å¾®æœåŠ¡ï¼Œåˆ†åˆ«ä¸ºç”¨äºæ–‡ä»¶ä¸Šä¼ çš„osså¾®æœåŠ¡å’Œç”¨äºè§†é¢‘ç‚¹æ’­çš„vodå¾®æœåŠ¡ï¼Œåœ¨å…¶ä»–å¾®æœåŠ¡ä¸­ï¼Œæˆ‘ä»¬éœ€è¦è¿œç¨‹è°ƒç”¨è¿™ä¸¤ä¸ªå¾®æœåŠ¡ä¸­çš„æ¥å£æ¥å®Œæˆä¸šåŠ¡éœ€æ±‚ã€‚</p></blockquote><h2 id="2-1ã€è¿œç¨‹è°ƒç”¨OSSå¾®æœåŠ¡"><a href="#2-1ã€è¿œç¨‹è°ƒç”¨OSSå¾®æœåŠ¡" class="headerlink" title="2.1ã€è¿œç¨‹è°ƒç”¨OSSå¾®æœåŠ¡"></a>2.1ã€è¿œç¨‹è°ƒç”¨OSSå¾®æœåŠ¡</h2><blockquote><p>åœ¨åˆ é™¤è®²å¸ˆä¿¡æ¯æ—¶ï¼Œæˆ‘ä»¬å¸Œæœ›ä¸€åŒåˆ é™¤è¯¥è®²å¸ˆä¸Šä¼ è‡³é˜¿é‡Œäº‘ä¸­çš„å¤´åƒæ–‡ä»¶ï¼Œè¯¥è¿‡ç¨‹ä¸­éœ€è¦è¿œç¨‹è°ƒç”¨osså¾®æœåŠ¡ä¸­çš„æ–‡ä»¶åˆ é™¤æ¥å£</p></blockquote><h3 id="1ã€Osså¾®æœåŠ¡ä¸­çš„æ–‡ä»¶åˆ é™¤æ¥å£"><a href="#1ã€Osså¾®æœåŠ¡ä¸­çš„æ–‡ä»¶åˆ é™¤æ¥å£" class="headerlink" title="1ã€Osså¾®æœåŠ¡ä¸­çš„æ–‡ä»¶åˆ é™¤æ¥å£"></a>1ã€Osså¾®æœåŠ¡ä¸­çš„æ–‡ä»¶åˆ é™¤æ¥å£</h3><ul><li>Controllerå±‚</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;remove&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;å›¾ç‰‡æ–‡ä»¶åˆ é™¤&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">removeFile</span><span class="params">(<span class="meta">@RequestBody</span> String url)</span> </span>&#123;</span><br><span class="line">    fileService.removeFile(url);</span><br><span class="line">    <span class="keyword">return</span> R.ok().message(<span class="string">&quot;æ–‡ä»¶åˆ é™¤æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>Serviceå®ç°ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">removeFile</span><span class="params">(String url)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¯»å–é…ç½®ä¿¡æ¯</span></span><br><span class="line">    String endpoint = ossProperties.getEndpoint();</span><br><span class="line">    String keyid = ossProperties.getKeyid();</span><br><span class="line">    String keysecret = ossProperties.getKeysecret();</span><br><span class="line">    String bucketname = ossProperties.getBucketname();</span><br><span class="line">    <span class="comment">//åˆ›å»ºOSSClientå®ä¾‹</span></span><br><span class="line">    OSS ossClient = <span class="keyword">new</span> OSSClientBuilder().build(endpoint,keyid,keysecret);</span><br><span class="line">    <span class="comment">//è·å–è¦åˆ é™¤çš„æ–‡ä»¶åï¼Œæ ¹æ®urlè·å–</span></span><br><span class="line">    <span class="comment">//ä¸»æœºå</span></span><br><span class="line">    String host = <span class="string">&quot;https://&quot;</span> + bucketname + <span class="string">&quot;.&quot;</span> + endpoint + <span class="string">&quot;/&quot;</span>;</span><br><span class="line">    <span class="comment">//ä»ä¸»æœºåé•¿åº¦çš„ä¸‹æ ‡å¼€å§‹æˆªå–ï¼Œå°±å¯ä»¥è·å–æ–‡ä»¶å</span></span><br><span class="line">    String objectName = url.substring(host.length());</span><br><span class="line">    System.out.println(objectName);</span><br><span class="line">    ossClient.deleteObject(bucketname,objectName);</span><br><span class="line">    <span class="comment">//å…³é—­OSSClient</span></span><br><span class="line">    ossClient.shutdown();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€åœ¨eduå¾®æœåŠ¡ä¸­è¿œç¨‹è°ƒç”¨Osså¾®æœåŠ¡"><a href="#2ã€åœ¨eduå¾®æœåŠ¡ä¸­è¿œç¨‹è°ƒç”¨Osså¾®æœåŠ¡" class="headerlink" title="2ã€åœ¨eduå¾®æœåŠ¡ä¸­è¿œç¨‹è°ƒç”¨Osså¾®æœåŠ¡"></a>2ã€åœ¨eduå¾®æœåŠ¡ä¸­è¿œç¨‹è°ƒç”¨Osså¾®æœåŠ¡</h3><blockquote><p>åœ¨eduå¾®æœåŠ¡ä¸­åˆ›å»ºä¸€ä¸ªfeignåŒ…ï¼ŒåŒ…ä¸‹å­˜æ”¾è¿œç¨‹è°ƒç”¨æ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="meta">@FeignClient(value = &quot;service-oss&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">OssFileService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * è¿œç¨‹è°ƒç”¨OSSå¾®æœåŠ¡ä¸­çš„æ§åˆ¶å™¨æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> url</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/admin/oss/file/remove&quot;)</span></span><br><span class="line">    <span class="function">R <span class="title">removeFile</span><span class="params">(<span class="meta">@RequestBody</span> String url)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨eduå¾®æœåŠ¡ä¸­è°ƒç”¨feignæ¥å£åˆ é™¤è®²å¸ˆå¤´åƒ</p><p>teacherService.removeAvatarById(id);</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æ ¹æ®idåˆ é™¤è®²å¸ˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id è¦åˆ é™¤çš„è®²å¸ˆid</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> åˆ é™¤ç»“æœåŠæç¤ºä¿¡æ¯</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@DeleteMapping(&quot;remove/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(value = &quot;æ ¹æ®IDåˆ é™¤è®²å¸ˆ&quot;, notes = &quot;æ ¹æ®IDåˆ é™¤è®²å¸ˆ&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">removeById</span><span class="params">(<span class="meta">@ApiParam(value = &quot;è®²å¸ˆid&quot;,required = true)</span> <span class="meta">@PathVariable(&quot;id&quot;)</span> String id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åˆ é™¤è®²å¸ˆå‰å…ˆåˆ é™¤è®²å¸ˆå¤´åƒ</span></span><br><span class="line">    teacherService.removeAvatarById(id);</span><br><span class="line">    <span class="keyword">boolean</span> flag = teacherService.removeById(id);</span><br><span class="line">    <span class="keyword">return</span> flag ? R.ok().message(<span class="string">&quot;åˆ é™¤æˆåŠŸï¼&quot;</span>) : R.error().message(<span class="string">&quot;åˆ é™¤å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>removeAvatarById(id)æ–¹æ³•å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TeacherServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">TeacherMapper</span>, <span class="title">Teacher</span>&gt; <span class="keyword">implements</span> <span class="title">TeacherService</span> </span>&#123;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ³¨å…¥è¿œç¨‹è°ƒç”¨æ¥å£</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> OssFileService ossFileService;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">removeAvatarById</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1 æ ¹æ®idè·å–è®²å¸ˆavatarçš„url</span></span><br><span class="line">        Teacher teacher = baseMapper.selectById(id);</span><br><span class="line">        <span class="keyword">if</span>(teacher != <span class="keyword">null</span>) &#123;</span><br><span class="line">            String avatarUrl = teacher.getAvatar();</span><br><span class="line">            <span class="keyword">if</span>(StringUtils.isNotBlank(avatarUrl)) &#123;</span><br><span class="line">                <span class="comment">//å¤´åƒä¸ä¸ºç©ºæ‰è¿›è¡Œè¿œç¨‹è°ƒç”¨</span></span><br><span class="line">                R r = ossFileService.removeFile(avatarUrl);</span><br><span class="line">                <span class="keyword">return</span> r.getSuccess();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸ‘¥OpenFeign </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Spring Cloudå­¦ä¹ ï¼ˆä¸€ï¼‰-GateWayç½‘å…³</title>
      <link href="posts/337037609.html"/>
      <url>posts/337037609.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€ç½‘å…³åŸºæœ¬æ¦‚å¿µ"><a href="#ä¸€ã€ç½‘å…³åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="ä¸€ã€ç½‘å…³åŸºæœ¬æ¦‚å¿µ"></a>ä¸€ã€ç½‘å…³åŸºæœ¬æ¦‚å¿µ</h1><h2 id="1-1ã€APIç½‘å…³ä»‹ç»"><a href="#1-1ã€APIç½‘å…³ä»‹ç»" class="headerlink" title="1.1ã€APIç½‘å…³ä»‹ç»"></a>1.1ã€APIç½‘å…³ä»‹ç»</h2><blockquote><p>API ç½‘å…³å‡ºç°çš„åŸå› æ˜¯å¾®æœåŠ¡æ¶æ„çš„å‡ºç°ï¼Œä¸åŒçš„å¾®æœåŠ¡ä¸€èˆ¬ä¼šæœ‰ä¸åŒçš„ç½‘ç»œåœ°å€ï¼Œè€Œå¤–éƒ¨å®¢æˆ·ç«¯å¯èƒ½éœ€è¦è°ƒç”¨å¤šä¸ªæœåŠ¡çš„æ¥å£æ‰èƒ½å®Œæˆä¸€ä¸ªä¸šåŠ¡éœ€æ±‚ï¼Œå¦‚æœè®©å®¢æˆ·ç«¯ç›´æ¥ä¸å„ä¸ªå¾®æœåŠ¡é€šä¿¡ï¼Œä¼šæœ‰ä»¥ä¸‹çš„é—®é¢˜ï¼š</p></blockquote><ul><li><p>å®¢æˆ·ç«¯ä¼šå¤šæ¬¡è¯·æ±‚ä¸åŒçš„å¾®æœåŠ¡ï¼Œå¢åŠ äº†å®¢æˆ·ç«¯çš„å¤æ‚æ€§ã€‚</p></li><li><p>å­˜åœ¨è·¨åŸŸè¯·æ±‚ï¼Œåœ¨ä¸€å®šåœºæ™¯ä¸‹å¤„ç†ç›¸å¯¹å¤æ‚ã€‚</p></li><li><p>è®¤è¯å¤æ‚ï¼Œæ¯ä¸ªæœåŠ¡éƒ½éœ€è¦ç‹¬ç«‹è®¤è¯ã€‚</p></li><li><p>éš¾ä»¥é‡æ„ï¼Œéšç€é¡¹ç›®çš„è¿­ä»£ï¼Œå¯èƒ½éœ€è¦é‡æ–°åˆ’åˆ†å¾®æœåŠ¡ã€‚ä¾‹å¦‚ï¼Œå¯èƒ½å°†å¤šä¸ªæœåŠ¡åˆå¹¶æˆä¸€ä¸ªæˆ–è€…å°†ä¸€ä¸ªæœåŠ¡æ‹†åˆ†æˆå¤šä¸ªã€‚å¦‚æœå®¢æˆ·ç«¯ç›´æ¥ä¸å¾®æœåŠ¡é€šä¿¡ï¼Œé‚£ä¹ˆé‡æ„å°†ä¼šå¾ˆéš¾å®æ–½ã€‚</p></li></ul><p>ä»¥ä¸Šè¿™äº›é—®é¢˜å¯ä»¥å€ŸåŠ© API ç½‘å…³è§£å†³ã€‚API ç½‘å…³æ˜¯ä»‹äºå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯ä¹‹é—´çš„ä¸­é—´å±‚ï¼Œæ‰€æœ‰çš„å¤–éƒ¨è¯·æ±‚éƒ½ä¼šå…ˆç»è¿‡ API ç½‘å…³è¿™ä¸€å±‚ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼ŒAPI çš„å®ç°æ–¹é¢æ›´å¤šçš„è€ƒè™‘ä¸šåŠ¡é€»è¾‘ï¼Œè€Œå®‰å…¨ã€æ€§èƒ½ã€ç›‘æ§å¯ä»¥äº¤ç”± API ç½‘å…³æ¥åšï¼Œè¿™æ ·æ—¢æé«˜ä¸šåŠ¡çµæ´»æ€§åˆä¸ç¼ºå®‰å…¨æ€§</p><blockquote><p>å‡è®¾ä¸€ä¸ªç”µå•†é¡¹ç›®ï¼Œè´­ä¹°ä¸€ä»¶å•†å“éœ€è¦è°ƒç”¨å¤šä¸ªå¾®æœåŠ¡æ¥å£ï¼Œæ‰èƒ½å®Œæˆä¸‹å•æ“ä½œï¼Œåœ¨æ²¡æœ‰ä½¿ç”¨ç½‘å…³ä¹‹å‰ï¼Œç”¨æˆ·çš„æ“ä½œæµç¨‹å›¾æ˜¯è¿™æ ·çš„ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211121506.png" alt="image-20210211121505821"></p><blockquote><p>åœ¨å¼•å…¥ç½‘å…³åï¼Œæ¶æ„å¯ä»¥æ¼”å˜ä¸ºä¸‹å›¾</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211121759.png" alt="image-20210211121759523"></p><blockquote><p>å¾®æœåŠ¡ç½‘å…³æ˜¯ç¨‹åºçš„å¤§é—¨ï¼Œå°è£…äº†åº”ç”¨ç¨‹åºçš„å†…éƒ¨ç»“æ„ï¼Œç”¨æˆ·åªéœ€è¦è·Ÿç½‘å…³äº¤äº’ï¼Œæ— éœ€è°ƒç”¨ç‰¹å®šå¾®æœåŠ¡æ¥å£ã€‚</p><p>è¿™æ ·ï¼Œå¼€å‘å°±å¯ä»¥å¾—åˆ°ç®€åŒ–ã€‚ä¸ä»…å¦‚æ­¤ï¼Œä½¿ç”¨å¾®æœåŠ¡ç½‘å…³è¿˜æœ‰ä»¥ä¸‹ä¼˜ç‚¹ï¼š</p></blockquote><ul><li>æ˜“äºç›‘æ§ã€‚å¯åœ¨å¾®æœåŠ¡ç½‘å…³æ”¶é›†ç›‘æ§æ•°æ®å¹¶å°†å…¶æ¨é€åˆ°å¤–éƒ¨ç³»ç»Ÿè¿›è¡Œåˆ†æã€‚</li><li>æ˜“äºè®¤è¯ã€‚å¯åœ¨å¾®æœåŠ¡ç½‘å…³ä¸Šè¿›è¡Œè®¤è¯ï¼Œç„¶åå†å°†è¯·æ±‚è½¬å‘åˆ°åç«¯çš„å¾®æœåŠ¡ï¼Œè€Œæ— é¡»åœ¨æ¯ä¸ªå¾®æœåŠ¡ä¸­è¿›è¡Œè®¤è¯ã€‚</li><li>å‡å°‘äº†å®¢æˆ·ç«¯ä¸å„ä¸ªå¾®æœåŠ¡ä¹‹é—´çš„äº¤äº’æ¬¡æ•°ã€‚</li></ul><h2 id="1-2ã€Spring-Cloud-GateWay"><a href="#1-2ã€Spring-Cloud-GateWay" class="headerlink" title="1.2ã€Spring Cloud GateWay"></a>1.2ã€Spring Cloud GateWay</h2><h3 id="1ã€æ¦‚è¿°"><a href="#1ã€æ¦‚è¿°" class="headerlink" title="1ã€æ¦‚è¿°"></a>1ã€æ¦‚è¿°</h3><blockquote><p><strong>Spring cloud gateway</strong>æ˜¯springå®˜æ–¹åŸºäºSpring 5.0ã€Spring Boot2.0å’ŒProject Reactorç­‰æŠ€æœ¯å¼€å‘çš„ç½‘å…³ï¼ŒSpring Cloud Gatewayæ—¨åœ¨ä¸ºå¾®æœåŠ¡æ¶æ„æä¾›ç®€å•ã€æœ‰æ•ˆå’Œç»Ÿä¸€çš„APIè·¯ç”±ç®¡ç†æ–¹å¼ï¼ŒSpring Cloud Gatewayä½œä¸ºSpring Cloudç”Ÿæ€ç³»ç»Ÿä¸­çš„ç½‘å…³ï¼Œç›®æ ‡æ˜¯æ›¿ä»£Netflix Zuulï¼Œå…¶ä¸ä»…æä¾›ç»Ÿä¸€çš„è·¯ç”±æ–¹å¼ï¼Œå¹¶ä¸”è¿˜åŸºäºFileré“¾çš„æ–¹å¼æä¾›äº†ç½‘å…³åŸºæœ¬çš„åŠŸèƒ½ï¼Œä¾‹å¦‚ï¼šå®‰å…¨ã€ç›‘æ§/åŸ‹ç‚¹ã€é™æµç­‰ã€‚</p><p>Spring Cloud Gatewayä½œä¸ºSpring Cloudç”Ÿæ€ç³»ç»Ÿä¸­çš„ç½‘å…³ï¼Œç›®çš„æ˜¯ä¸ºäº†æ›¿ä»£Zuulï¼Œåœ¨Spring Cloud2.0ä»¥ä¸Šç‰ˆæœ¬ä¸­ï¼Œæ²¡æœ‰å¯¹æ–°ç‰ˆæœ¬çš„Zuul 2.0ä»¥ä¸Šçš„æ–°é«˜ç‰ˆæœ¬è¿›è¡Œé›†æˆï¼Œä»ç„¶è¿˜æ˜¯ä½¿ç”¨Zuul 1.xéReactoræ¨¡å¼çš„è€ç‰ˆæœ¬ã€‚Gatewayæ˜¯<strong>åŸºäºwebFluxæ¡†æ¶å®ç°çš„</strong>ï¼Œ<strong>WebFluxæ¡†æ¶åº•å±‚</strong>ä½¿ç”¨äº†<strong>é«˜æ€§èƒ½</strong>çš„Reactoræ¨¡å¼é€šä¿¡æ¡†æ¶<strong>Netty</strong>ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211130506.png" alt="img"></p><blockquote><p>ä½œç”¨ï¼š</p></blockquote><ul><li>åå‘ä»£ç†</li><li>ç»Ÿä¸€é‰´æƒ</li><li>æµé‡æ§åˆ¶</li><li>ç†”æ–­</li><li>æ—¥å¿—ç›‘æ§</li></ul><blockquote><p>æ‰€å¤„ä½ç½®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211130628.png" alt="img"></p><h3 id="2ã€æ ¸å¿ƒæ¦‚å¿µ"><a href="#2ã€æ ¸å¿ƒæ¦‚å¿µ" class="headerlink" title="2ã€æ ¸å¿ƒæ¦‚å¿µ"></a>2ã€æ ¸å¿ƒæ¦‚å¿µ</h3><ul><li><p><strong>è·¯ç”±</strong>ï¼šè·¯ç”±æ˜¯ç½‘å…³æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œè·¯ç”±ä¿¡æ¯æœ‰ä¸€ä¸ªIDã€ä¸€ä¸ªç›®çš„URLã€ä¸€ç»„æ–­è¨€å’Œä¸€ç»„Filterç»„æˆã€‚å¦‚æœæ–­è¨€è·¯ç”±ä¸ºçœŸï¼Œåˆ™è¯´æ˜è¯·æ±‚çš„URLå’Œé…ç½®åŒ¹é…</p><ul><li>idï¼šè·¯ç”±idï¼Œæ²¡æœ‰èµ·åè§„åˆ™ï¼Œä½†è¦æ±‚å”¯ä¸€</li><li>uriï¼šåŒ¹é…è·¯ç”±çš„è½¬å‘åœ°å€</li><li>predicatesï¼šé…ç½®è¯¥è·¯ç”±çš„æ–­è¨€ï¼Œè‹¥ç¬¦åˆè¯¥æ–­è¨€åˆ™ä¼šè½¬å‘åˆ°åŒ¹é…çš„åœ°å€</li><li>orderï¼šè·¯ç”±çš„ä¼˜å…ˆçº§ï¼Œæ•°å­—è¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</li></ul></li><li><p><strong>æ–­è¨€</strong>ï¼šJava8ä¸­çš„æ–­è¨€å‡½æ•°ã€‚Spring Cloud Gatewayä¸­çš„æ–­è¨€å‡½æ•°å…è®¸å¼€å‘è€…å»å®šä¹‰åŒ¹é…æ¥è‡ªäºhttp requestä¸­çš„ä»»ä½•ä¿¡æ¯ï¼Œæ¯”å¦‚è¯·æ±‚å¤´å’Œå‚æ•°ç­‰ã€‚</p></li><li><p><strong>è¿‡æ»¤å™¨</strong>ï¼šä¸€ä¸ªæ ‡å‡†çš„Spring webFilterã€‚Spring cloud gatewayä¸­çš„filteråˆ†ä¸ºä¸¤ç§ç±»å‹çš„Filterï¼Œåˆ†åˆ«æ˜¯Gateway Filterå’ŒGlobal Filterã€‚è¿‡æ»¤å™¨Filterå°†ä¼šå¯¹è¯·æ±‚å’Œå“åº”è¿›è¡Œä¿®æ”¹å¤„ç†ã€‚</p></li></ul><h3 id="3ã€æ‰§è¡Œæµç¨‹"><a href="#3ã€æ‰§è¡Œæµç¨‹" class="headerlink" title="3ã€æ‰§è¡Œæµç¨‹"></a>3ã€æ‰§è¡Œæµç¨‹</h3><blockquote><p>å¦‚ä¸‹å›¾æ‰€ç¤ºï¼ŒSpring cloud Gatewayå‘å‡ºè¯·æ±‚ã€‚ç„¶åå†ç”±Gateway Handler Mappingä¸­æ‰¾åˆ°ä¸è¯·æ±‚ç›¸åŒ¹é…çš„è·¯ç”±ï¼Œå°†å…¶å‘é€åˆ°Gateway web handlerã€‚Handlerå†é€šè¿‡æŒ‡å®šçš„è¿‡æ»¤å™¨é“¾å°†è¯·æ±‚å‘é€åˆ°æˆ‘ä»¬å®é™…çš„æœåŠ¡æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼Œç„¶åè¿”å›ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211130419.png" alt="image-20210211130417182"></p><ul><li>Filterä¸­ï¼Œâ€preâ€ç±»å‹çš„è¿‡æ»¤å™¨å¯ä»¥åšå‚æ•°æ ¡éªŒã€æƒé™æ ¡éªŒã€æµé‡æ§åˆ¶ã€æ—¥å¿—è¾“å‡ºå’Œåè®®è½¬æ¢ç­‰ã€‚â€postâ€ç±»å‹çš„è¿‡æ»¤å™¨å¯ä»¥åšç›¸åº”å†…å®¹ã€å“åº”å¤´çš„ä¿®æ”¹ã€æ—¥å¿—çš„è¾“å‡ºã€æµé‡ç›‘æ§ã€‚</li><li>æ ¸å¿ƒé€»è¾‘ï¼šè·¯ç”±è½¬å‘+æ‰§è¡Œè¿‡æ»¤å™¨é“¾ã€‚</li></ul><h3 id="4ã€ç‰¹ç‚¹"><a href="#4ã€ç‰¹ç‚¹" class="headerlink" title="4ã€ç‰¹ç‚¹"></a>4ã€ç‰¹ç‚¹</h3><p>ä¼˜ç‚¹ï¼š</p><ul><li>æ€§èƒ½å¼ºåŠ²ï¼šæ˜¯ç¬¬ä¸€ä»£ç½‘å…³Zuulçš„1.6å€</li><li>åŠŸèƒ½å¼ºå¤§ï¼šå†…ç½®äº†å¾ˆå¤šå®ç”¨çš„åŠŸèƒ½ï¼Œä¾‹å¦‚è½¬å‘ã€ç›‘æ§ã€é™æµç­‰</li><li>è®¾è®¡ä¼˜é›…ï¼Œå®¹æ˜“æ‰©å±•</li></ul><p>ç¼ºç‚¹ï¼š</p><ul><li>å…¶å®ç°ä¾èµ–Nettyä¸WebFluxï¼Œä¸æ˜¯ä¼ ç»Ÿçš„Servletç¼–ç¨‹æ¨¡å‹ï¼Œå­¦ä¹ æˆæœ¬é«˜</li><li>ä¸èƒ½å°†å…¶éƒ¨ç½²åœ¨Tomcatã€Jettyç­‰Servletå®¹å™¨é‡Œï¼Œåªèƒ½æ‰“æˆjaråŒ…æ‰§è¡Œ</li><li>éœ€è¦Spring Boot 2.0åŠä»¥ä¸Šçš„ç‰ˆæœ¬ï¼Œæ‰æ”¯æŒ</li></ul><h1 id="äºŒã€ç½‘å…³ä½¿ç”¨"><a href="#äºŒã€ç½‘å…³ä½¿ç”¨" class="headerlink" title="äºŒã€ç½‘å…³ä½¿ç”¨"></a>äºŒã€ç½‘å…³ä½¿ç”¨</h1><h2 id="2-1ã€åˆ›å»ºç½‘å…³å¾®æœåŠ¡cloud-gateway-9527"><a href="#2-1ã€åˆ›å»ºç½‘å…³å¾®æœåŠ¡cloud-gateway-9527" class="headerlink" title="2.1ã€åˆ›å»ºç½‘å…³å¾®æœåŠ¡cloud-gateway-9527"></a>2.1ã€åˆ›å»ºç½‘å…³å¾®æœåŠ¡cloud-gateway-9527</h2><blockquote><p>pom.xml</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–°å¢gateway--&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-gateway<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-hystrix<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.cloud<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-cloud-starter-netflix-eureka-client<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-devtools<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>runtime<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">optional</span>&gt;</span>true<span class="tag">&lt;/<span class="name">optional</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.cloudstudy<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>common<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0-SNAPSHOT<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>application.ymlé…ç½®æ–‡ä»¶</p></blockquote><p>application.ymlæ–‡ä»¶ä¸­æ·»åŠ è·¯ç”±é…ç½®</p><ul><li>-ï¼šè¡¨ç¤ºæ•°ç»„å…ƒç´ ï¼Œå¯ä»¥é…ç½®å¤šä¸ªèŠ‚ç‚¹</li><li>idï¼šé…ç½®çš„å”¯ä¸€æ ‡è¯†ï¼Œå¯ä»¥å’Œå¾®æœåŠ¡åŒåï¼Œä¹Ÿå¯ä»¥èµ·åˆ«çš„åå­—ï¼ŒåŒºåˆ«äºå…¶ä»– Routeã€‚</li><li>uriï¼šè·¯ç”±æŒ‡å‘çš„ç›®çš„åœ° uriï¼Œå³å®¢æˆ·ç«¯è¯·æ±‚æœ€ç»ˆè¢«è½¬å‘åˆ°çš„å¾®æœåŠ¡ã€‚</li><li>predicatesï¼šæ–­è¨€çš„ä½œç”¨æ˜¯è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œåªæœ‰æ–­è¨€éƒ½è¿”å›çœŸï¼Œæ‰ä¼šçœŸæ­£çš„æ‰§è¡Œè·¯ç”±ã€‚</li><li>Pathï¼šè·¯å¾„å½¢å¼çš„æ–­è¨€ã€‚å½“åŒ¹é…è¿™ä¸ªè·¯å¾„æ—¶ï¼Œæ–­è¨€æ¡ä»¶æˆç«‹</li><li>/**ï¼šä¸€ä¸ªæˆ–å¤šä¸ªå±‚æ¬¡çš„è·¯å¾„</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#æ³¨å†Œåˆ°eurekaä¸­çš„åº”ç”¨å</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh</span> <span class="comment">#è·¯ç”±idï¼Œæ²¡æœ‰å‘½åè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8001</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/payment/get/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">http://localhost:8001</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">cloud-gateway-service</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¸»å¯åŠ¨ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@EnableEurekaClient</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayMain9527</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(GatewayMain9527.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2ã€Payment8001"><a href="#2-2ã€Payment8001" class="headerlink" title="2.2ã€Payment8001"></a>2.2ã€Payment8001</h2><blockquote><p>åœ¨paymentå¾®æœåŠ¡ä¸­æœ‰ä¸¤ä¸ªé‡è¦æ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/get/&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®idæŸ¥è¯¢è®¢å•&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> CommonResult&lt;Payment&gt; <span class="title">getPaymentById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">    Payment result = paymentService.getPaymentById(id);</span><br><span class="line">    <span class="keyword">if</span>(result == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CommonResult&lt;&gt;(<span class="number">404</span>,<span class="string">&quot;æ•°æ®åº“ä¸­æ²¡æœ‰è¯¥è®¢å•ï¼ç«¯å£ä¸ºï¼š&quot;</span> + serverPort,<span class="keyword">null</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> CommonResult&lt;&gt;(<span class="number">200</span>,<span class="string">&quot;æˆåŠŸï¼ç«¯å£ä¸ºï¼š&quot;</span> + serverPort,result);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@GetMapping(&quot;/lb&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">getPaymentLB</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> serverPort;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æˆ‘ä»¬å¸Œæœ›é€šè¿‡ç½‘å…³åœ¨paymentæœåŠ¡çš„8001ç«¯å£å¤–å†åŒ…è£¹ä¸€å±‚9527ç«¯å£ï¼Œè®©ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—®8001ç«¯å£ã€‚</p></blockquote><h2 id="2-3ã€å¯åŠ¨å¾®æœåŠ¡ï¼Œè¿›è¡Œæµ‹è¯•"><a href="#2-3ã€å¯åŠ¨å¾®æœåŠ¡ï¼Œè¿›è¡Œæµ‹è¯•" class="headerlink" title="2.3ã€å¯åŠ¨å¾®æœåŠ¡ï¼Œè¿›è¡Œæµ‹è¯•"></a>2.3ã€å¯åŠ¨å¾®æœåŠ¡ï¼Œè¿›è¡Œæµ‹è¯•</h2><blockquote><p>å¯åŠ¨eureka7001ã€payment8001å’Œgateway9527</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211132551.png" alt="image-20210211132551232"></p><blockquote><p>é€šè¿‡localhost:8001/payment/lbè®¿é—®paymentå¾®æœåŠ¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211132713.png" alt="image-20210211132713170"></p><blockquote><p>é€šè¿‡ç½‘å…³ï¼Œå³9527ç«¯å£è®¿é—®paymentå¾®æœåŠ¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211133144.png" alt="image-20210211133144911"></p><blockquote><p>è®¿é—®è¯´æ˜</p></blockquote><ul><li>paymentå¾®æœåŠ¡æ§åˆ¶å™¨çš„è®¿é—®è·¯å¾„</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211133943.png" alt="image-20210211133942958"></p><ul><li>å¦‚æœè®¿é—®è·¯å¾„åŒ¹é…è·¯ç”±æ–­è¨€ï¼Œåˆ™è½¬å‘åˆ°æŒ‡å®šuri</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211134300.png" alt="image-20210211134259898"></p><h2 id="2-4ã€é…ç½®è·¯ç”±çš„å¦ä¸€ç§æ–¹å¼"><a href="#2-4ã€é…ç½®è·¯ç”±çš„å¦ä¸€ç§æ–¹å¼" class="headerlink" title="2.4ã€é…ç½®è·¯ç”±çš„å¦ä¸€ç§æ–¹å¼"></a>2.4ã€é…ç½®è·¯ç”±çš„å¦ä¸€ç§æ–¹å¼</h2><blockquote><p>ä½¿ç”¨ç½‘å…³ï¼Œè®©ç½‘å…³å¸®æˆ‘ä»¬è·³è½¬åˆ°ç™¾åº¦æ–°é—»é¡µé¢</p></blockquote><ul><li>å¦‚æœè®¿é—®è·¯å¾„åŒ¹é…è·¯ç”±æ–­è¨€/guojiï¼Œåˆ™å¸®æˆ‘ä»¬è·³è½¬åˆ°<a href="http://news.baidu.com/guoji">http://news.baidu.com/guoji</a></li><li>å¦‚æœè®¿é—®è·¯å¾„åŒ¹é…è·¯ç”±æ–­è¨€/guoneiï¼Œåˆ™å¸®æˆ‘ä»¬è·³è½¬åˆ°<a href="http://news.baidu.com/guonei">http://news.baidu.com/guonei</a></li></ul><h3 id="1ã€åˆ›å»ºä¸€ä¸ªGateWayConfigé…ç½®ç±»"><a href="#1ã€åˆ›å»ºä¸€ä¸ªGateWayConfigé…ç½®ç±»" class="headerlink" title="1ã€åˆ›å»ºä¸€ä¸ªGateWayConfigé…ç½®ç±»"></a>1ã€åˆ›å»ºä¸€ä¸ªGateWayConfigé…ç½®ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">GatewayConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RouteLocator <span class="title">customRouteLocator</span><span class="params">(RouteLocatorBuilder routeLocatorBuilder)</span> </span>&#123;</span><br><span class="line">        RouteLocatorBuilder.Builder routes = routeLocatorBuilder.routes();</span><br><span class="line">        routes.route(<span class="string">&quot;path_route_wuhu&quot;</span>,</span><br><span class="line">                r -&gt; r.path(<span class="string">&quot;/guonei&quot;</span>).uri(<span class="string">&quot;http://news.baidu.com/guonei&quot;</span>));</span><br><span class="line">        routes.route(<span class="string">&quot;path_route_qifei&quot;</span>,</span><br><span class="line">                r -&gt; r.path(<span class="string">&quot;/guoji&quot;</span>).uri(<span class="string">&quot;http://news.baidu.com/guoji&quot;</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> routes.build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨routeså¯¹è±¡çš„routeæ–¹æ³•æ¥é…ç½®è·¯ç”±æ–­è¨€åŠè¦è½¬å‘çš„uri</li><li>å…¶ä¸­routeæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªä¸ºè·¯ç”±idï¼Œå¦ä¸€ä¸ªä¸ºjdk8æ–°æ·»åŠ çš„Functionæ¥å£å¯¹è±¡</li><li>å¦‚æœè®¿é—®è·¯å¾„ä¸­æœ‰/guoneiï¼Œé‚£ä¹ˆç½‘å…³ä¼šå¸®æˆ‘ä»¬è·³è½¬åˆ°<a href="http://news.baidu.com/guonei%EF%BC%9B%E5%A6%82%E6%9E%9C%E8%AE%BF%E9%97%AE%E8%B7%AF%E5%BE%84%E4%B8%AD%E6%9C%89/guoji%EF%BC%8C%E9%82%A3%E4%B9%88%E7%BD%91%E5%85%B3%E4%BC%9A%E5%B8%AE%E6%88%91%E4%BB%AC%E8%B7%B3%E8%BD%AC%E5%88%B0http://news.baidu.com/guoji">http://news.baidu.com/guoneiï¼›å¦‚æœè®¿é—®è·¯å¾„ä¸­æœ‰/guojiï¼Œé‚£ä¹ˆç½‘å…³ä¼šå¸®æˆ‘ä»¬è·³è½¬åˆ°http://news.baidu.com/guoji</a></li></ul><h3 id="2ã€æµ‹è¯•"><a href="#2ã€æµ‹è¯•" class="headerlink" title="2ã€æµ‹è¯•"></a>2ã€æµ‹è¯•</h3><blockquote><p>è®¿é—®<a href="http://localhost:9527/guoji">http://localhost:9527/guoji</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211135216.png" alt="image-20210211135215779"></p><blockquote><p>åŒç†è®¿é—®<a href="http://localhost:9527/guonei">http://localhost:9527/guonei</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211135303.png" alt="image-20210211135303881"></p><h2 id="2-5ã€é…åˆæ³¨å†Œä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±"><a href="#2-5ã€é…åˆæ³¨å†Œä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±" class="headerlink" title="2.5ã€é…åˆæ³¨å†Œä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±"></a>2.5ã€é…åˆæ³¨å†Œä¸­å¿ƒå®ç°åŠ¨æ€è·¯ç”±</h2><blockquote><p>é»˜è®¤æƒ…å†µä¸‹Gatewayä¼šæ ¹æ®æ³¨å†Œä¸­å¿ƒçš„æœåŠ¡åˆ—è¡¨ï¼Œä»¥æ³¨å†Œä¸­å¿ƒä¸Šå¾®æœåŠ¡åä¸ºè·¯å¾„åˆ›å»ºåŠ¨æ€è·¯ç”±è¿›è¡Œè½¬å‘ï¼Œä»è€Œå®ç°åŠ¨æ€è·¯ç”±çš„åŠŸèƒ½</p></blockquote><h3 id="1ã€å¯åŠ¨"><a href="#1ã€å¯åŠ¨" class="headerlink" title="1ã€å¯åŠ¨"></a>1ã€å¯åŠ¨</h3><blockquote><p>æ ¹æ®payment8001å¾®æœåŠ¡å¤åˆ»å‡ºå¦ä¸€ä¸ªç±»ä¼¼çš„paymentå¾®æœåŠ¡ï¼Œç«¯å£å·ä¸º8002</p><p>å¯åŠ¨eureka7001+payment8001+payment8002</p></blockquote><h3 id="2ã€ä¿®æ”¹ç½‘å…³å¾®æœåŠ¡é…ç½®æ–‡ä»¶"><a href="#2ã€ä¿®æ”¹ç½‘å…³å¾®æœåŠ¡é…ç½®æ–‡ä»¶" class="headerlink" title="2ã€ä¿®æ”¹ç½‘å…³å¾®æœåŠ¡é…ç½®æ–‡ä»¶"></a>2ã€ä¿®æ”¹ç½‘å…³å¾®æœåŠ¡é…ç½®æ–‡ä»¶</h3><blockquote><p>åœ¨è·¯ç”±çš„uriä¸­ä½¿ç”¨lb://å¾®æœåŠ¡åç§°çš„æ–¹æ³•æ¥åŠ¨æ€é…ç½®è·¯ç”±ï¼Œå¹¶å®ç°è´Ÿè½½å‡è¡¡ï¼Œä½¿ç”¨æ­¥éª¤å¦‚ä¸‹</p></blockquote><ul><li>åœ¨é…ç½®æ–‡ä»¶ä¸­å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œä½¿ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="comment"># å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œä½¿ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">locator:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨é…ç½®æ–‡ä»¶ä¸­å°†è·¯ç”±uriä¿®æ”¹ä¸ºlb://å¾®æœåŠ¡åæ¥æŒ‡å®šè·³è½¬åœ°å€ï¼Œå¹¶å®ç°è´Ÿè½½å‡è¡¡ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯uriçš„åè®®ä¸ºlbï¼Œè¡¨ç¤ºå¯ç”¨Gatewayçš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh</span> <span class="comment">#è·¯ç”±idï¼Œæ²¡æœ‰å‘½åè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">    <span class="comment"># ä½¿ç”¨æ³¨å†Œä¸­å¿ƒä¸­æ³¨å†Œçš„å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±</span></span><br><span class="line">    <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">    <span class="attr">predicates:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">Path=/payment/get/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">    <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">    <span class="attr">predicates:</span></span><br><span class="line">      <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><ul><li>ç½‘å…³å¾®æœåŠ¡å®Œæ•´é…ç½®æ–‡ä»¶å¦‚ä¸‹</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">server:</span></span><br><span class="line">  <span class="attr">port:</span> <span class="number">9527</span></span><br><span class="line"></span><br><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">application:</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">cloud-gateway</span> <span class="comment">#æ³¨å†Œåˆ°eurekaä¸­çš„åº”ç”¨å</span></span><br><span class="line">  <span class="attr">cloud:</span></span><br><span class="line">    <span class="attr">gateway:</span></span><br><span class="line">      <span class="comment"># å¼€å¯ä»æ³¨å†Œä¸­å¿ƒåŠ¨æ€åˆ›å»ºè·¯ç”±çš„åŠŸèƒ½ï¼Œä½¿ç”¨å¾®æœåŠ¡åè¿›è¡Œè·¯ç”±</span></span><br><span class="line">      <span class="attr">discovery:</span></span><br><span class="line">        <span class="attr">locator:</span></span><br><span class="line">          <span class="attr">enabled:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">routes:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh</span> <span class="comment">#è·¯ç”±idï¼Œæ²¡æœ‰å‘½åè§„åˆ™ä½†è¦æ±‚å”¯ä¸€ï¼Œå»ºè®®é…åˆæœåŠ¡å</span></span><br><span class="line">          <span class="comment"># ä½¿ç”¨æ³¨å†Œä¸­å¿ƒä¸­æ³¨å†Œçš„å¾®æœåŠ¡åå®ç°åŠ¨æ€è·¯ç”±</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/payment/get/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">          <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">          <span class="attr">predicates:</span></span><br><span class="line">            <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line"></span><br><span class="line"><span class="attr">eureka:</span></span><br><span class="line">  <span class="attr">instance:</span></span><br><span class="line">    <span class="attr">hostname:</span> <span class="string">cloud-gateway-service</span></span><br><span class="line">  <span class="attr">client:</span></span><br><span class="line">    <span class="attr">service-url:</span></span><br><span class="line">      <span class="attr">register-with-eureka:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">fetch-registry:</span> <span class="literal">true</span></span><br><span class="line">      <span class="attr">defaultZone:</span> <span class="string">http://eureka7001.com:7001/eureka</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3ã€æµ‹è¯•"><a href="#3ã€æµ‹è¯•" class="headerlink" title="3ã€æµ‹è¯•"></a>3ã€æµ‹è¯•</h3><blockquote><p>å¯åŠ¨ç½‘å…³å¾®æœåŠ¡ï¼ŒæŸ¥çœ‹eurekaæ³¨å†Œä¸­å¿ƒæƒ…å†µ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211144519.png" alt="image-20210211144518120"></p><blockquote><p>æµ‹è¯•ï¼Œè®¿é—®paymentå¾®æœåŠ¡çš„lbæ–¹æ³•ï¼ŒæŸ¥çœ‹è°ƒç”¨ç«¯å£æƒ…å†µ</p></blockquote><ul><li>ç¬¬ä¸€æ¬¡</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211144610.png" alt="image-20210211144610176"></p><ul><li>ç¬¬äºŒæ¬¡</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211144625.png" alt="image-20210211144625837"></p><blockquote><p>è¿™æ ·å°±å®ç°äº†åŠ¨æ€è·¯ç”±å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</p></blockquote><h2 id="2-6ã€Predicateçš„ä½¿ç”¨"><a href="#2-6ã€Predicateçš„ä½¿ç”¨" class="headerlink" title="2.6ã€Predicateçš„ä½¿ç”¨"></a>2.6ã€Predicateçš„ä½¿ç”¨</h2><blockquote><p>Spring Cloud Gatewayå†…ç½®æ–­è¨€å·¥å‚ï¼Œç”¨äºè¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œåªæœ‰æ–­è¨€éƒ½è¿”å›çœŸï¼Œæ‰ä¼šçœŸæ­£æ‰§è¡Œè·¯ç”±ã€‚</p><p>å†…ç½®çš„æ–­è¨€å·¥å‚å…·ä½“å¦‚ä¸‹</p></blockquote><h3 id="1ã€åŸºäºDateTime"><a href="#1ã€åŸºäºDateTime" class="headerlink" title="1ã€åŸºäºDateTime"></a>1ã€åŸºäºDateTime</h3><blockquote><p>æ­¤ç±»å‹çš„æ–­è¨€æ ¹æ®æ—¶é—´åšåˆ¤æ–­ï¼Œä¸»è¦æœ‰ä¸‰ä¸ªï¼š</p></blockquote><ul><li>AfterRoutePredicateFactoryï¼š æ¥æ”¶ä¸€ä¸ªæ—¥æœŸå‚æ•°ï¼Œåˆ¤æ–­è¯·æ±‚æ—¥æœŸæ˜¯å¦æ™šäºæŒ‡å®šæ—¥æœŸ</li><li>BeforeRoutePredicateFactoryï¼š æ¥æ”¶ä¸€ä¸ªæ—¥æœŸå‚æ•°ï¼Œåˆ¤æ–­è¯·æ±‚æ—¥æœŸæ˜¯å¦æ—©äºæŒ‡å®šæ—¥æœŸ</li><li>BetweenRoutePredicateFactoryï¼š æ¥æ”¶ä¸¤ä¸ªæ—¥æœŸå‚æ•°ï¼Œåˆ¤æ–­è¯·æ±‚æ—¥æœŸæ˜¯å¦åœ¨æŒ‡å®šæ—¶é—´æ®µå†…</li></ul><blockquote><p>è¿™é‡Œçš„æ—¶é—´æ ¼å¼å¯ä»¥ç”±JDK8è‡ªå¸¦çš„ZoneDateTimeç”Ÿæˆ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">    ZonedDateTime dateTime = ZonedDateTime.now();</span><br><span class="line">    System.out.println(dateTime);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211153541.png" alt="image-20210211153541725"></p><blockquote><p>AfterRoutePredicateFactory</p></blockquote><ul><li>åœ¨ymlé…ç½®æ–‡ä»¶ä¸­æ·»åŠ é…ç½®å¦‚ä¸‹ï¼Œè¿™é‡Œå°†afteråé¢çš„æ—¶é—´è®¾ç½®ä¸ºæˆ‘å½“å‰æ—¶é—´çš„ä¸€ä¸ªç¬‘æ˜¯å</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">After=2021-02-11T16:37:54.926+08:00[Asia/Shanghai]</span></span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211153734.png" alt="image-20210211153734924"></p><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211153920.png" alt="image-20210211153920543"></p><ul><li>ä¿®æ”¹ymlé…ç½®æ–‡ä»¶ï¼Œå°†æ—¶é—´æ”¹ä¸ºå½“å‰æ—¶é—´ä¸€ä¸ªå°æ—¶å‰ï¼Œé‡å¯å¾®æœåŠ¡</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">After=2021-02-11T14:37:54.926+08:00[Asia/Shanghai]</span></span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211154031.png" alt="image-20210211154031133"></p><blockquote><p>åŒç†ï¼ŒBeforeæ–­è¨€å’ŒBetweenæ–­è¨€ä¸Afterçš„ä½¿ç”¨æ–¹å¼ç±»å‹ï¼Œåªæ˜¯Betweenæ–­è¨€éœ€è¦ä¼ å…¥ä¸¤ä¸ªæ—¶é—´ï¼Œå¦‚</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Between=2020-03-08T10:59:34.102+08:00[Asia/Shanghai]</span> <span class="string">,</span>  <span class="number">2020-03-08T10:59:34.102+08:00</span>[<span class="string">Asia/Shanghai</span>]</span><br></pre></td></tr></table></figure><h3 id="2ã€åŸºäºè¿œç¨‹åœ°å€"><a href="#2ã€åŸºäºè¿œç¨‹åœ°å€" class="headerlink" title="2ã€åŸºäºè¿œç¨‹åœ°å€"></a>2ã€åŸºäºè¿œç¨‹åœ°å€</h3><blockquote><p>RemoteAddrRoutePredicateFactoryï¼šæ¥æ”¶ä¸€ä¸ªIPåœ°å€æ®µï¼Œåˆ¤æ–­è¯·æ±‚ä¸»æœºåœ°å€æ˜¯å¦åœ¨åœ°å€æ®µä¸­</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">RemoteAddr=192.168.1.1/24</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹ymlé…ç½®æ–‡ä»¶ï¼Œè¿›è¡Œæµ‹è¯•</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">    <span class="comment">#- After=2021-02-11T14:37:54.926+08:00[Asia/Shanghai]</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">RemoteAddr=192.168.1.1/24</span></span><br></pre></td></tr></table></figure><ul><li>ç»“æœï¼šç”±äºæœ¬æœºåœ°å€ä¸åœ¨é…ç½®çš„åœ°å€å†…ï¼Œæ‰€ä»¥æŠ¥é”™</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211155533.png" alt="image-20210211155532617"></p><h3 id="3ã€åŸºäºCookie"><a href="#3ã€åŸºäºCookie" class="headerlink" title="3ã€åŸºäºCookie"></a>3ã€åŸºäºCookie</h3><blockquote><p>CookieRoutePredicateFactoryï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œcookie åå­—å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ã€‚ åˆ¤æ–­è¯·æ±‚cookieæ˜¯å¦å…·æœ‰ç»™å®šåç§°ä¸”å€¼ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Cookie=chocolate,</span> <span class="string">ch.</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼Œè®¾ç½®è®¿é—®æ—¶éœ€è¦å¸¦ä¸Šçš„Cookie</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Cookie=wuhu,qifei</span></span><br></pre></td></tr></table></figure><blockquote><p>æ‰“å¼€å‘½ä»¤è¡Œï¼Œä½¿ç”¨curlè¿›è¡Œè®¿é—®</p></blockquote><ul><li>ä¸å¸¦Cookieæ—¶ï¼šcurl <a href="http://localhost:9527/payment/lb">http://localhost:9527/payment/lb</a></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211155943.png" alt="image-20210211155943876"></p><ul><li>å¸¦ä¸ŠCookieæ—¶ï¼šcurl <a href="http://localhost:9527/payment/lb">http://localhost:9527/payment/lb</a> â€“cookie â€œwuhu=qifeiâ€</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211160356.png" alt="image-20210211160356405"></p><h3 id="4ã€åŸºäºè¯·æ±‚å¤´Header"><a href="#4ã€åŸºäºè¯·æ±‚å¤´Header" class="headerlink" title="4ã€åŸºäºè¯·æ±‚å¤´Header"></a>4ã€åŸºäºè¯·æ±‚å¤´Header</h3><blockquote><p>HeaderRoutePredicateFactoryï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œæ ‡é¢˜åç§°å’Œæ­£åˆ™è¡¨è¾¾å¼ã€‚ åˆ¤æ–­è¯·æ±‚Headeræ˜¯å¦å…·æœ‰ç»™å®šåç§°ä¸”å€¼ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚</p></blockquote><ul><li>ä¸¤ä¸ªå‚æ•°ï¼Œä¸€ä¸ªå±æ€§åç§°å’Œä¸€ä¸ªæ­£åˆ™è¡¨è¾¾å¼ï¼Œå½“å±æ€§å€¼ä¸æ­£åˆ™è¡¨è¾¾å¼ç›¸åŒ¹é…æ—¶æ‰§è¡Œ</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Header=X-Request-Id,</span> <span class="string">\d+</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹ymlæ–‡ä»¶</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">    <span class="comment"># è¯·æ±‚å¤´ä¸­éœ€è¦å«æœ‰X-Request-Idå±æ€§ï¼Œä¸”X-Request-Idå±æ€§å€¼éœ€è¦ä¸ºæ­£æ•´æ•°</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Header=X-Request-Id,</span> <span class="string">\d+</span></span><br></pre></td></tr></table></figure><ul><li>ä½¿ç”¨curlè¿›è¡Œæµ‹è¯•</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> http://localhost:<span class="number">9527</span>/payment/lb <span class="literal">-H</span> <span class="string">&quot;X-Request-Id:123&quot;</span></span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211161019.png" alt="image-20210211161019074"></p><ul><li>ä½¿ç”¨curlè¿›è¡Œé”™è¯¯ç¤ºèŒƒ</li></ul><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">curl</span> http://localhost:<span class="number">9527</span>/payment/lb <span class="literal">-H</span> <span class="string">&quot;X-Request-Id:-123&quot;</span></span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211161133.png" alt="image-20210211161133476"></p><h3 id="5ã€åŸºäºMethodè¯·æ±‚æ–¹æ³•"><a href="#5ã€åŸºäºMethodè¯·æ±‚æ–¹æ³•" class="headerlink" title="5ã€åŸºäºMethodè¯·æ±‚æ–¹æ³•"></a>5ã€åŸºäºMethodè¯·æ±‚æ–¹æ³•</h3><blockquote><p>MethodRoutePredicateFactoryï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåˆ¤æ–­è¯·æ±‚ç±»å‹æ˜¯å¦è·ŸæŒ‡å®šçš„ç±»å‹åŒ¹é…ã€‚</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Method=GET</span></span><br></pre></td></tr></table></figure><h3 id="6ã€åŸºäºPathè¯·æ±‚è·¯å¾„"><a href="#6ã€åŸºäºPathè¯·æ±‚è·¯å¾„" class="headerlink" title="6ã€åŸºäºPathè¯·æ±‚è·¯å¾„"></a>6ã€åŸºäºPathè¯·æ±‚è·¯å¾„</h3><blockquote><p>PathRoutePredicateFactoryï¼šæ¥æ”¶ä¸€ä¸ªå‚æ•°ï¼Œåˆ¤æ–­è¯·æ±‚çš„URIéƒ¨åˆ†æ˜¯å¦æ»¡è¶³è·¯å¾„è§„åˆ™ã€‚</p><p>æœ€å¸¸è§çš„ä¸€ç§æ–­è¨€</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Path=/foo/**</span></span><br></pre></td></tr></table></figure><h3 id="7ã€åŸºäºQueryè¯·æ±‚å‚æ•°"><a href="#7ã€åŸºäºQueryè¯·æ±‚å‚æ•°" class="headerlink" title="7ã€åŸºäºQueryè¯·æ±‚å‚æ•°"></a>7ã€åŸºäºQueryè¯·æ±‚å‚æ•°</h3><blockquote><p>QueryRoutePredicateFactory ï¼šæ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œè¯·æ±‚paramå’Œæ­£åˆ™è¡¨è¾¾å¼ï¼Œ åˆ¤æ–­è¯·æ±‚å‚æ•°æ˜¯å¦å…·æœ‰ç»™å®šåç§°ä¸”å€¼ä¸æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…ã€‚</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="string">Query=baz,</span> <span class="string">ba.</span></span><br></pre></td></tr></table></figure><blockquote><p>ä¿®æ”¹é…ç½®æ–‡ä»¶</p></blockquote><ul><li>Query=uname, wuhuæ–­è¨€è¦æ±‚è¯·æ±‚ä¸­å¿…é¡»æœ‰unameå‚æ•°ï¼Œä¸”å‚æ•°å€¼å¿…é¡»ä¸ºwuhu</li></ul><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">payment_routh2</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">lb://cloud-payment-service</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Path=/payment/lb/**</span>  <span class="comment">#æ–­è¨€ï¼Œè·¯å¾„ç›¸åŒ¹é…çš„è¿›è¡Œè·¯ç”±</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Query=uname,</span> <span class="string">wuhu</span></span><br></pre></td></tr></table></figure><ul><li>è¿›è¡Œæµ‹è¯•ï¼Œè®¿é—®<a href="http://localhost:9527/payment/lb%EF%BC%8C%E6%9F%A5%E7%9C%8B%E7%BB%93%E6%9E%9C">http://localhost:9527/payment/lbï¼ŒæŸ¥çœ‹ç»“æœ</a></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211162140.png" alt="image-20210211162139906"></p><ul><li>æ‰“å¼€æµè§ˆå™¨ï¼Œè®¿é—®<a href="http://localhost:9527/payment/lb?uname=wuhu">http://localhost:9527/payment/lb?uname=wuhu</a></li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211162254.png" alt="image-20210211162254068"></p><h1 id="ä¸‰ã€è¿‡æ»¤å™¨"><a href="#ä¸‰ã€è¿‡æ»¤å™¨" class="headerlink" title="ä¸‰ã€è¿‡æ»¤å™¨"></a>ä¸‰ã€è¿‡æ»¤å™¨</h1><h2 id="3-1ã€è¿‡æ»¤å™¨åŸºæœ¬æ¦‚å¿µ"><a href="#3-1ã€è¿‡æ»¤å™¨åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="3.1ã€è¿‡æ»¤å™¨åŸºæœ¬æ¦‚å¿µ"></a>3.1ã€è¿‡æ»¤å™¨åŸºæœ¬æ¦‚å¿µ</h2><h3 id="1ã€ä½œç”¨"><a href="#1ã€ä½œç”¨" class="headerlink" title="1ã€ä½œç”¨"></a>1ã€ä½œç”¨</h3><p>è¿‡æ»¤å™¨å°±æ˜¯åœ¨è¯·æ±‚çš„ä¼ é€’è¿‡ç¨‹ä¸­ï¼Œå¯¹è¯·æ±‚å’Œå“åº”åšä¸€äº›ä¿®æ”¹</p><h3 id="2ã€ç”Ÿå‘½å‘¨æœŸ"><a href="#2ã€ç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="2ã€ç”Ÿå‘½å‘¨æœŸ"></a>2ã€ç”Ÿå‘½å‘¨æœŸ</h3><p>å®¢æˆ·ç«¯çš„è¯·æ±‚å…ˆç»è¿‡â€œpreâ€ç±»å‹çš„filterï¼Œç„¶åå°†è¯·æ±‚è½¬å‘åˆ°å…·ä½“çš„ä¸šåŠ¡æœåŠ¡ï¼Œæ”¶åˆ°ä¸šåŠ¡æœåŠ¡çš„å“åº”ä¹‹åï¼Œå†ç»è¿‡â€œpostâ€ç±»å‹çš„filterå¤„ç†ï¼Œæœ€åè¿”å›å“åº”åˆ°å®¢æˆ·ç«¯ã€‚</p><p>preï¼š è¿™ç§è¿‡æ»¤å™¨åœ¨è¯·æ±‚è¢«è·¯ç”±ä¹‹å‰è°ƒç”¨ã€‚æˆ‘ä»¬å¯åˆ©ç”¨è¿™ç§è¿‡æ»¤å™¨å®ç°å‚æ•°æ ¡éªŒã€æƒé™æ ¡éªŒã€æµé‡ç›‘æ§ã€æ—¥å¿—è¾“å‡ºã€åè®®è½¬æ¢ç­‰ï¼›</p><p>postï¼šè¿™ç§è¿‡æ»¤å™¨åœ¨è·¯ç”±åˆ°è¾¾å¾®æœåŠ¡ä»¥åæ‰§è¡Œã€‚è¿™ç§è¿‡æ»¤å™¨å¯ç”¨åšå“åº”å†…å®¹ã€å“åº”å¤´çš„ä¿®æ”¹ï¼Œæ—¥å¿—çš„è¾“å‡ºï¼Œæµé‡ç›‘æ§ç­‰ã€‚</p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211162518.png" alt="image-20210211162518791"></p><h3 id="3ã€åˆ†ç±»"><a href="#3ã€åˆ†ç±»" class="headerlink" title="3ã€åˆ†ç±»"></a>3ã€åˆ†ç±»</h3><p>å±€éƒ¨è¿‡æ»¤å™¨ GatewayFilterï¼šä½œç”¨åœ¨æŸä¸€ä¸ªè·¯ç”±ä¸Š</p><p>å…¨å±€è¿‡æ»¤å™¨ GlobalFilterï¼šä½œç”¨å…¨éƒ¨è·¯ç”±ä¸Š</p><h2 id="3-2ã€å±€éƒ¨è¿‡æ»¤å™¨"><a href="#3-2ã€å±€éƒ¨è¿‡æ»¤å™¨" class="headerlink" title="3.2ã€å±€éƒ¨è¿‡æ»¤å™¨"></a>3.2ã€å±€éƒ¨è¿‡æ»¤å™¨</h2><h3 id="1ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨"><a href="#1ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨" class="headerlink" title="1ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨"></a>1ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨</h3><p>åœ¨SpringCloud Gatewayä¸­å†…ç½®äº†å¾ˆå¤šä¸åŒç±»å‹çš„ç½‘å…³è·¯ç”±è¿‡æ»¤å™¨ã€‚å…·ä½“å¦‚ä¸‹</p><table><thead><tr><th>è¿‡æ»¤å™¨å·¥å‚</th><th>ä½œç”¨</th><th>å‚æ•°</th></tr></thead><tbody><tr><td>AddRequestHeader</td><td>ä¸ºåŸå§‹è¯·æ±‚æ·»åŠ Header</td><td>Headerçš„åç§°åŠå€¼</td></tr><tr><td>AddRequestParameter</td><td>ä¸ºåŸå§‹è¯·æ±‚æ·»åŠ è¯·æ±‚å‚æ•°</td><td>å‚æ•°åç§°åŠå€¼</td></tr><tr><td>AddResponseHeader</td><td>ä¸ºåŸå§‹å“åº”æ·»åŠ Header</td><td>Headerçš„åç§°åŠå€¼</td></tr><tr><td>DedupeResponseHeader</td><td>å‰”é™¤å“åº”å¤´ä¸­é‡å¤çš„å€¼</td><td>éœ€è¦å»é‡çš„Headeråç§°åŠå»é‡ç­–ç•¥</td></tr><tr><td>Hystrix</td><td>ä¸ºè·¯ç”±å¼•å…¥Hystrixçš„æ–­è·¯å™¨ä¿æŠ¤</td><td>HystrixCommand çš„åç§°</td></tr><tr><td>FallbackHeaders</td><td>ä¸ºfallbackUriçš„è¯·æ±‚å¤´ä¸­æ·»åŠ å…·ä½“çš„å¼‚å¸¸ä¿¡æ¯</td><td>Headerçš„åç§°</td></tr><tr><td>Preï¬xPath</td><td>ä¸ºåŸå§‹è¯·æ±‚è·¯å¾„æ·»åŠ å‰ç¼€</td><td>å‰ç¼€è·¯å¾„</td></tr><tr><td>PreserveHostHeader</td><td>ä¸ºè¯·æ±‚æ·»åŠ ä¸€ä¸ªpreserveHostHeader=trueçš„å±æ€§ï¼Œè·¯ç”±è¿‡æ»¤å™¨ä¼šæ£€æŸ¥è¯¥å±æ€§ä»¥å†³å®šæ˜¯å¦è¦å‘é€åŸå§‹çš„Host</td><td>æ— </td></tr><tr><td>RequestRateLimiter</td><td>ç”¨äºå¯¹è¯·æ±‚é™æµï¼Œé™æµç®—æ³•ä¸ºä»¤ç‰Œæ¡¶</td><td>keyResolverã€rateLimiterã€statusCodeã€denyEmptyKeyã€emptyKeyStatus</td></tr><tr><td>RedirectTo</td><td>å°†åŸå§‹è¯·æ±‚é‡å®šå‘åˆ°æŒ‡å®šçš„URL</td><td>httpçŠ¶æ€ç åŠé‡å®šå‘çš„url</td></tr><tr><td>RemoveHopByHopHeadersFilter</td><td>ä¸ºåŸå§‹è¯·æ±‚åˆ é™¤IETFç»„ç»‡è§„å®šçš„ä¸€ç³»åˆ—Header</td><td>é»˜è®¤å°±ä¼šå¯ç”¨ï¼Œå¯ä»¥é€šè¿‡é…ç½®æŒ‡å®šä»…åˆ é™¤å“ªäº›Header</td></tr><tr><td>RemoveRequestHeader</td><td>ä¸ºåŸå§‹è¯·æ±‚åˆ é™¤æŸä¸ªHeader</td><td>Headeråç§°</td></tr><tr><td>RemoveResponseHeader</td><td>ä¸ºåŸå§‹å“åº”åˆ é™¤æŸä¸ªHeader</td><td>Headeråç§°</td></tr><tr><td>RewritePath</td><td>é‡å†™åŸå§‹çš„è¯·æ±‚è·¯å¾„</td><td>åŸå§‹è·¯å¾„æ­£åˆ™è¡¨è¾¾å¼ä»¥åŠé‡å†™åè·¯å¾„çš„æ­£åˆ™è¡¨è¾¾å¼</td></tr><tr><td>RewriteResponseHeader</td><td>é‡å†™åŸå§‹å“åº”ä¸­çš„æŸä¸ªHeader</td><td>Headeråç§°ï¼Œå€¼çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œé‡å†™åçš„å€¼</td></tr><tr><td>SaveSession</td><td>åœ¨è½¬å‘è¯·æ±‚ä¹‹å‰ï¼Œå¼ºåˆ¶æ‰§è¡ŒWebSession::save æ“ä½œ</td><td>æ— </td></tr><tr><td>secureHeaders</td><td>ä¸ºåŸå§‹å“åº”æ·»åŠ ä¸€ç³»åˆ—èµ·å®‰å…¨ä½œç”¨çš„å“åº”å¤´</td><td>æ— ï¼Œæ”¯æŒä¿®æ”¹è¿™äº›å®‰å…¨å“åº”å¤´çš„å€¼</td></tr><tr><td>SetPath</td><td>ä¿®æ”¹åŸå§‹çš„è¯·æ±‚è·¯å¾„</td><td>ä¿®æ”¹åçš„è·¯å¾„</td></tr><tr><td>SetResponseHeader</td><td>ä¿®æ”¹åŸå§‹å“åº”ä¸­æŸä¸ªHeaderçš„å€¼</td><td>Headeråç§°ï¼Œä¿®æ”¹åçš„å€¼</td></tr><tr><td>SetStatus</td><td>ä¿®æ”¹åŸå§‹å“åº”çš„çŠ¶æ€ç </td><td>HTTP çŠ¶æ€ç ï¼Œå¯ä»¥æ˜¯æ•°å­—ï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²</td></tr><tr><td>StripPreï¬x</td><td>ç”¨äºæˆªæ–­åŸå§‹è¯·æ±‚çš„è·¯å¾„</td><td>ä½¿ç”¨æ•°å­—è¡¨ç¤ºè¦æˆªæ–­çš„è·¯å¾„çš„æ•°é‡</td></tr><tr><td>Retry</td><td>é’ˆå¯¹ä¸åŒçš„å“åº”è¿›è¡Œé‡è¯•</td><td>retriesã€statusesã€methodsã€series</td></tr><tr><td>RequestSize</td><td>è®¾ç½®å…è®¸æ¥æ”¶æœ€å¤§è¯·æ±‚åŒ…çš„å¤§ å°ã€‚å¦‚æœè¯·æ±‚åŒ…å¤§å°è¶…è¿‡è®¾ç½®çš„å€¼ï¼Œåˆ™è¿”å› 413 Payload TooLarge</td><td>è¯·æ±‚åŒ…å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼Œé»˜è®¤å€¼ä¸º5M</td></tr><tr><td>ModifyRequestBody</td><td>åœ¨è½¬å‘è¯·æ±‚ä¹‹å‰ä¿®æ”¹åŸå§‹è¯·æ±‚ä½“å†…å®¹</td><td>ä¿®æ”¹åçš„è¯·æ±‚ä½“å†…å®¹</td></tr><tr><td>ModifyResponseBody</td><td>ä¿®æ”¹åŸå§‹å“åº”ä½“çš„å†…å®¹</td><td>ä¿®æ”¹åçš„å“åº”ä½“å†…å®¹</td></tr></tbody></table><h3 id="2ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨çš„ä½¿ç”¨"><a href="#2ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨çš„ä½¿ç”¨" class="headerlink" title="2ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨çš„ä½¿ç”¨"></a>2ã€å†…ç½®å±€éƒ¨è¿‡æ»¤å™¨çš„ä½¿ç”¨</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">routes:</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">id:</span> <span class="string">service-edu</span></span><br><span class="line">  <span class="attr">uri:</span> <span class="string">lb://service-edu</span></span><br><span class="line">  <span class="attr">predicates:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">Path=/user/**,</span> <span class="string">/*/edu/**</span></span><br><span class="line">  <span class="attr">filters:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="string">SetStatus=250</span> <span class="comment"># ä¿®æ”¹è¿”å›çŠ¶æ€ç </span></span><br></pre></td></tr></table></figure><h2 id="3-3ã€å…¨å±€è¿‡æ»¤å™¨"><a href="#3-3ã€å…¨å±€è¿‡æ»¤å™¨" class="headerlink" title="3.3ã€å…¨å±€è¿‡æ»¤å™¨"></a>3.3ã€å…¨å±€è¿‡æ»¤å™¨</h2><h3 id="1ã€å†…ç½®å…¨å±€è¿‡æ»¤å™¨"><a href="#1ã€å†…ç½®å…¨å±€è¿‡æ»¤å™¨" class="headerlink" title="1ã€å†…ç½®å…¨å±€è¿‡æ»¤å™¨"></a>1ã€å†…ç½®å…¨å±€è¿‡æ»¤å™¨</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211162756.png" alt="image-20210211162756079"></p><p>å†…ç½®å…¨å±€è¿‡æ»¤å™¨çš„ä½¿ç”¨ä¸¾ä¾‹ï¼šè´Ÿè½½å‡è¡¡è¿‡æ»¤å™¨</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">lb://service-edu</span></span><br></pre></td></tr></table></figure><h2 id="3-4ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨"><a href="#3-4ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨" class="headerlink" title="3.4ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨"></a>3.4ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªFilterå®ç° GlobalFilter å’Œ Orderedæ¥å£</p></blockquote><h3 id="1ã€ä½œç”¨-1"><a href="#1ã€ä½œç”¨-1" class="headerlink" title="1ã€ä½œç”¨"></a>1ã€ä½œç”¨</h3><ul><li>å…¨å±€æ—¥å¿—è®°å½•</li><li>ç»Ÿä¸€ç½‘å…³é‰´æƒ</li><li>â€¦</li></ul><h3 id="2ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨"><a href="#2ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨" class="headerlink" title="2ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨"></a>2ã€è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨</h3><blockquote><p>ç¼–å†™ä¸€ä¸ªè¿‡æ»¤å™¨ç±»ï¼Œè¿™ä¸ªè¿‡æ»¤å™¨ç”¨äºè®°å½•æ—¥å¿—å·²ç»é‰´æƒ</p></blockquote><ul><li>å¦‚æœè¯·æ±‚ä¸­unameå‚æ•°å€¼ä¸ºç©ºï¼Œåˆ™ä¸æ”¾è¡Œï¼Œç›´æ¥å“åº”406</li><li>è¿™ä¸ªç±»éœ€è¦å®ç°GlobalFilterå’ŒOrderedæ¥å£ï¼Œå¹¶é‡å†™ä¸¤ä¸ªæ–¹æ³•</li><li>åœ¨getOrderæ–¹æ³•ä¸­ï¼Œå®šä¹‰è¿‡æ»¤å™¨çš„ä¼˜å…ˆçº§ï¼Œorderè¶Šä½ï¼Œä¼˜å…ˆçº§è¶Šé«˜</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Ordered</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> HIGHEST_PRECEDENCE = -<span class="number">2147483648</span>;</span><br><span class="line">    <span class="keyword">int</span> LOWEST_PRECEDENCE = <span class="number">2147483647</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨filteræ–¹æ³•ä¸­è¿›è¡Œæ—¥å¿—è®°å½•å’Œé‰´æƒæ“ä½œ</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyLogGateWayFilter</span> <span class="keyword">implements</span> <span class="title">GlobalFilter</span>, <span class="title">Ordered</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;*************è¿›å…¥è‡ªå®šä¹‰å…¨å±€è¿‡æ»¤å™¨ï¼Œæ—¶é—´ä¸ºï¼š&quot;</span> + <span class="keyword">new</span> Date());</span><br><span class="line">        String uname = exchange.getRequest().getQueryParams().getFirst(<span class="string">&quot;uname&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(uname == <span class="keyword">null</span>) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;********ç”¨æˆ·åä¸ºnullï¼Œéæ³•ç”¨æˆ·ï¼&quot;</span>);</span><br><span class="line">            <span class="comment">//ç»™å“åº”å¯¹è±¡è¿”å›ä¸€ä¸ªçŠ¶æ€ç ï¼šè¯·æ±‚ä¸è¢«æ¥å—</span></span><br><span class="line">            exchange.getResponse().setStatusCode(HttpStatus.NOT_ACCEPTABLE);</span><br><span class="line">            <span class="keyword">return</span> exchange.getResponse().setComplete();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ”¾è¡Œï¼Œè¿›å…¥åˆ°ä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨</span></span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ­¤æ–¹æ³•ç”¨äºå®šä¹‰è¿™ä¸ªè¿‡æ»¤å™¨åœ¨è¿‡æ»¤å™¨é“¾ä¸­çš„ä½ç½®</span></span><br><span class="line"><span class="comment">     * è¿”å›çš„orderè¶Šå°ä¼˜å…ˆçº§è¶Šé«˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•</li></ul><blockquote><p>è®¿é—®<a href="http://localhost:9257/payment/lb">http://localhost:9257/payment/lb</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211164137.png" alt="image-20210211164137410"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211164206.png" alt="image-20210211164206315"></p><blockquote><p>è®¿é—®<a href="http://localhost:9257/payment/lb%EF%BC%8C%E5%B8%A6%E4%B8%8A%E5%8F%82%E6%95%B0uname">http://localhost:9257/payment/lbï¼Œå¸¦ä¸Šå‚æ•°uname</a></p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211164402.png" alt="image-20210211164402908"></p><h1 id="å››ã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆGateWay"><a href="#å››ã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆGateWay" class="headerlink" title="å››ã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆGateWay"></a>å››ã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆGateWay</h1><blockquote><p><strong>æ³¨æ„</strong>ï¼šgatewayåº•å±‚ä½¿ç”¨çš„æ˜¯webfluxä¼šä¸webå†²çªï¼Œæ‰€ä»¥åœ¨gatewayä¸­ä¸è¦å¼•å…¥spring-boot-starter-webä¾èµ–</p></blockquote><h2 id="4-1ã€ç»Ÿä¸€ç½‘å…³é‰´æƒ"><a href="#4-1ã€ç»Ÿä¸€ç½‘å…³é‰´æƒ" class="headerlink" title="4.1ã€ç»Ÿä¸€ç½‘å…³é‰´æƒ"></a>4.1ã€ç»Ÿä¸€ç½‘å…³é‰´æƒ</h2><blockquote><p>æˆ‘ä»¬éœ€è¦åœ¨å¾®æœåŠ¡ç½‘å…³ä¸­è‡ªå®šä¹‰ä¸€ä¸ªå…¨å±€è¿‡æ»¤å™¨ï¼Œç»Ÿä¸€å¤„ç†éœ€è¦é‰´æƒçš„æœåŠ¡</p></blockquote><h3 id="1ã€é‰´æƒé€»è¾‘æè¿°"><a href="#1ã€é‰´æƒé€»è¾‘æè¿°" class="headerlink" title="1ã€é‰´æƒé€»è¾‘æè¿°"></a>1ã€é‰´æƒé€»è¾‘æè¿°</h3><ul><li>å½“å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡æ—¶ï¼ŒæœåŠ¡ç«¯å¯¹ç”¨æˆ·è¿›è¡Œä¿¡æ¯è®¤è¯ï¼ˆç™»å½•ï¼‰</li><li>è®¤è¯é€šè¿‡ï¼Œå°†ç”¨æˆ·ä¿¡æ¯è¿›è¡ŒåŠ å¯†å½¢æˆtokenï¼Œè¿”å›ç»™å®¢æˆ·ç«¯</li><li>ä½œä¸ºç™»å½•å‡­è¯ä»¥åæ¯æ¬¡è¯·æ±‚ï¼Œå®¢æˆ·ç«¯éƒ½æºå¸¦è®¤è¯çš„token</li><li>æœåŠ¡ç«¯å¯¹tokenè¿›è¡Œè§£å¯†ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211165219.png" alt="image-20210211165219298"></p><blockquote><p>å¯¹äºéªŒè¯ç”¨æˆ·æ˜¯å¦å·²ç»ç™»å½•é‰´æƒçš„è¿‡ç¨‹å¯ä»¥åœ¨ç½‘å…³ç»Ÿä¸€æ£€éªŒã€‚æ£€éªŒçš„æ ‡å‡†å°±æ˜¯è¯·æ±‚ä¸­æ˜¯å¦æºå¸¦tokenå‡­è¯ä»¥åŠtokençš„æ­£ç¡®æ€§ã€‚</p><p>ä¸‹é¢çš„æˆ‘ä»¬è‡ªå®šä¹‰ä¸€ä¸ªGlobalFilterï¼Œå»æ ¡éªŒæ‰€æœ‰çš„è¯·æ±‚å‚æ•°ä¸­æ˜¯å¦åŒ…å«â€œtokenâ€ï¼Œå¦‚æœä¸åŒ…å«è¯·æ±‚å‚æ•°â€œtokenâ€åˆ™ä¸è½¬å‘è·¯ç”±ï¼Œå¦åˆ™æ‰§è¡Œæ­£å¸¸çš„é€»è¾‘ã€‚</p></blockquote><h3 id="2ã€åˆ›å»ºè‡ªå®šä¹‰è¿‡æ»¤å™¨"><a href="#2ã€åˆ›å»ºè‡ªå®šä¹‰è¿‡æ»¤å™¨" class="headerlink" title="2ã€åˆ›å»ºè‡ªå®šä¹‰è¿‡æ»¤å™¨"></a>2ã€åˆ›å»ºè‡ªå®šä¹‰è¿‡æ»¤å™¨</h3><ul><li>å¦‚æœtokenä¸ºç©ºæˆ–è€…tokenä¸åˆæ³•ï¼Œåˆ™ä¸æ”¾è¡Œã€‚</li><li>è¿™ä¸ªè¿‡æ»¤å™¨çš„orderä¸º0</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AuthGlobalFilter</span> <span class="keyword">implements</span> <span class="title">GlobalFilter</span>, <span class="title">Ordered</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Mono&lt;Void&gt; <span class="title">filter</span><span class="params">(ServerWebExchange exchange, GatewayFilterChain chain)</span> </span>&#123;</span><br><span class="line">        ServerHttpRequest request = exchange.getRequest();</span><br><span class="line">        String path = request.getURI().getPath();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°·ç²’å­¦é™¢apiæ¥å£ï¼Œæ ¡éªŒç”¨æˆ·å¿…é¡»ç™»å½•</span></span><br><span class="line">        AntPathMatcher antPathMatcher = <span class="keyword">new</span> AntPathMatcher();</span><br><span class="line">        <span class="keyword">if</span>(antPathMatcher.match(<span class="string">&quot;/api/**/auth/**&quot;</span>, path)) &#123;</span><br><span class="line">            List&lt;String&gt; tokenList = request.getHeaders().get(<span class="string">&quot;token&quot;</span>);</span><br><span class="line"></span><br><span class="line">            <span class="comment">//æ²¡æœ‰token</span></span><br><span class="line">            <span class="keyword">if</span>(<span class="keyword">null</span> == tokenList) &#123;</span><br><span class="line">                ServerHttpResponse response = exchange.getResponse();</span><br><span class="line">                <span class="keyword">return</span> out(response);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">//tokenæ ¡éªŒå¤±è´¥</span></span><br><span class="line">            Boolean isCheck = JwtUtils.checkJwtTToken(tokenList.get(<span class="number">0</span>));</span><br><span class="line">            <span class="keyword">if</span>(!isCheck) &#123;</span><br><span class="line">                ServerHttpResponse response = exchange.getResponse();</span><br><span class="line">                <span class="keyword">return</span> out(response);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ”¾è¡Œ</span></span><br><span class="line">        <span class="keyword">return</span> chain.filter(exchange);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//å®šä¹‰å½“å‰è¿‡æ»¤å™¨çš„ä¼˜å…ˆçº§ï¼Œå€¼è¶Šå°ï¼Œä¼˜å…ˆçº§è¶Šé«˜</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getOrder</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> Mono&lt;Void&gt; <span class="title">out</span><span class="params">(ServerHttpResponse response)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        JsonObject message = <span class="keyword">new</span> JsonObject();</span><br><span class="line">        message.addProperty(<span class="string">&quot;success&quot;</span>, <span class="keyword">false</span>);</span><br><span class="line">        message.addProperty(<span class="string">&quot;code&quot;</span>, <span class="number">28004</span>);</span><br><span class="line">        message.addProperty(<span class="string">&quot;data&quot;</span>, <span class="string">&quot;&quot;</span>);</span><br><span class="line">        message.addProperty(<span class="string">&quot;message&quot;</span>, <span class="string">&quot;é‰´æƒå¤±è´¥&quot;</span>);</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = message.toString().getBytes(StandardCharsets.UTF_8);</span><br><span class="line">        DataBuffer buffer = response.bufferFactory().wrap(bytes);</span><br><span class="line">        <span class="comment">//æŒ‡å®šç¼–ç ï¼Œå¦åˆ™åœ¨æµè§ˆå™¨ä¸­ä¼šä¸­æ–‡ä¹±ç </span></span><br><span class="line">        response.getHeaders().add(<span class="string">&quot;Content-Type&quot;</span>, <span class="string">&quot;application/json;charset=UTF-8&quot;</span>);</span><br><span class="line">        <span class="comment">//è¾“å‡ºhttpå“åº”</span></span><br><span class="line">        <span class="keyword">return</span> response.writeWith(Mono.just(buffer));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€ä¿®æ”¹å‰ç«¯"><a href="#3ã€ä¿®æ”¹å‰ç«¯" class="headerlink" title="3ã€ä¿®æ”¹å‰ç«¯"></a>3ã€ä¿®æ”¹å‰ç«¯</h3><blockquote><p>guli-siteçš„utils/request.jsä¸­ä¿®æ”¹å“åº”è¿‡æ»¤å™¨ ï¼Œæ·»åŠ åˆ†æ”¯ï¼š</p></blockquote><ul><li>å¦‚æœå“åº”ç ä¸º20004ï¼Œåˆ™è¯æ˜è®¤è¯å¤±è´¥ï¼Œç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼Œæ­¤æ—¶è®©ç”¨æˆ·è·³è½¬åˆ°ç™»å½•é¡µ</li></ul><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (res.code === <span class="number">28004</span>) &#123; <span class="comment">// é‰´æƒå¤±è´¥</span></span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">&#x27;/login&#x27;</span></span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><ul><li>ä¿®æ”¹pages/login.vueçš„submitLoginæ–¹æ³•ï¼šç™»å½•åå›åˆ°åŸæ¥çš„é¡µé¢</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// è·³è½¬åˆ°é¦–é¡µ</span></span><br><span class="line"><span class="comment">// window.location.href = &#x27;/&#x27;</span></span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">document</span>.referrer.indexOf(<span class="string">&#x27;register&#x27;</span>) !== -<span class="number">1</span>) &#123;</span><br><span class="line">    <span class="built_in">window</span>.location.href = <span class="string">&#x27;/&#x27;</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    history.go(-<span class="number">1</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2ã€ç»Ÿä¸€å¤„ç†è·¨åŸŸé—®é¢˜"><a href="#4-2ã€ç»Ÿä¸€å¤„ç†è·¨åŸŸé—®é¢˜" class="headerlink" title="4.2ã€ç»Ÿä¸€å¤„ç†è·¨åŸŸé—®é¢˜"></a>4.2ã€ç»Ÿä¸€å¤„ç†è·¨åŸŸé—®é¢˜</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ"><a href="#1ã€ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ"></a>1ã€ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿ</h3><blockquote><p>å½“ä¸€ä¸ªè¯·æ±‚urlçš„<strong>åè®®ã€åŸŸåã€ç«¯å£</strong>ä¸‰è€…ä¹‹é—´ä»»æ„ä¸€ä¸ªä¸å½“å‰é¡µé¢urlä¸åŒå³ä¸ºè·¨åŸŸ</p></blockquote><table><thead><tr><th><strong>å½“å‰é¡µé¢url</strong></th><th><strong>è¢«è¯·æ±‚é¡µé¢url</strong></th><th><strong>æ˜¯å¦è·¨åŸŸ</strong></th><th><strong>åŸå› </strong></th></tr></thead><tbody><tr><td><a href="http://www.test.com/">http://www.test.com/</a></td><td><a href="http://www.test.com/index.html">http://www.test.com/index.html</a></td><td>å¦</td><td>åŒæºï¼ˆåè®®ã€åŸŸåã€ç«¯å£å·ç›¸åŒï¼‰</td></tr><tr><td><a href="http://www.test.com/">http://www.test.com/</a></td><td><a href="https://www.test.com/index.html">https://www.test.com/index.html</a></td><td>è·¨åŸŸ</td><td>åè®®ä¸åŒï¼ˆhttp/httpsï¼‰</td></tr><tr><td><a href="http://www.test.com/">http://www.test.com/</a></td><td><a href="http://www.baidu.com/">http://www.baidu.com/</a></td><td>è·¨åŸŸ</td><td>ä¸»åŸŸåä¸åŒï¼ˆtest/baiduï¼‰</td></tr><tr><td><a href="http://www.test.com/">http://www.test.com/</a></td><td><a href="http://blog.test.com/">http://blog.test.com/</a></td><td>è·¨åŸŸ</td><td>å­åŸŸåä¸åŒï¼ˆwww/blogï¼‰</td></tr><tr><td><a href="http://www.test.com:8080/">http://www.test.com:8080/</a></td><td><a href="http://www.test.com:7001/">http://www.test.com:7001/</a></td><td>è·¨åŸŸ</td><td>ç«¯å£å·ä¸åŒï¼ˆ8080/7001ï¼‰</td></tr></tbody></table><h3 id="2ã€Spring-Bootä¸­è§£å†³è·¨åŸŸçš„å‡ ç§æ–¹æ³•"><a href="#2ã€Spring-Bootä¸­è§£å†³è·¨åŸŸçš„å‡ ç§æ–¹æ³•" class="headerlink" title="2ã€Spring Bootä¸­è§£å†³è·¨åŸŸçš„å‡ ç§æ–¹æ³•"></a>2ã€Spring Bootä¸­è§£å†³è·¨åŸŸçš„å‡ ç§æ–¹æ³•</h3><blockquote><p>åœ¨gatewayä¸­åˆ›å»ºä¸€ä¸ªé…ç½®ç±»ï¼Œè¿™ä¸ªé…ç½®ç±»ç”¨äºè§£å†³è·¨åŸŸé—®é¢˜</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CorsConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> CorsWebFilter <span class="title">corsFilter</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        CorsConfiguration config = <span class="keyword">new</span> CorsConfiguration();</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        config.addAllowedHeader(<span class="string">&quot;*&quot;</span>);</span><br><span class="line"></span><br><span class="line">        UrlBasedCorsConfigurationSource source = <span class="keyword">new</span> UrlBasedCorsConfigurationSource(<span class="keyword">new</span> PathPatternParser());</span><br><span class="line">        source.registerCorsConfiguration(<span class="string">&quot;/**&quot;</span>, config);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> CorsWebFilter(source);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨Spring Bootæ§åˆ¶å™¨ä¸­æ·»åŠ @CrossOriginæ³¨è§£ï¼Œè¿™ä¸ªæ³¨è§£å¯ä»¥åŠ åœ¨<strong>ç±»ä¸Š</strong>æˆ–è€…<strong>æ–¹æ³•</strong>ä¸Š</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;è¯¾ç¨‹åˆ†ç±»ç®¡ç†&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/edu/subject&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubjectController</span> </span>&#123;</span><br></pre></td></tr></table></figure><blockquote><p>è¯´æ˜ï¼Œè¿™ä¸¤ç§æ–¹æ³•åªå–ä¸€ç§ä½¿ç”¨å³å¯ï¼Œå¦‚æœä½¿ç”¨äº†é…ç½®ç±»ï¼Œé‚£ä¹ˆæœ€å¥½å°†æ§åˆ¶å™¨ä¸Šçš„æ³¨è§£åˆ å»ã€‚</p></blockquote><blockquote><p>å‚è€ƒæ•™ç¨‹å¦‚ä¸‹ï¼š</p></blockquote><ul><li><p>[1]  <a href="https://www.bilibili.com/video/BV1fi4y1x7on">å°šç¡…è°·åœ¨çº¿æ•™è‚²é¡¹ç›®</a></p></li><li><p>[2]  <a href="https://blog.csdn.net/qq_38128179/article/details/84956552">ä»€ä¹ˆæ˜¯è·¨åŸŸï¼Ÿè·¨åŸŸçš„ç»“å±€æ–¹æ³•</a></p></li><li><p>[3]  <a href="https://www.bilibili.com/video/BV18E411x7eT">å°šç¡…è°·SpringCloud(Hç‰ˆ&amp;alibaba)æ¡†æ¶å¼€å‘æ•™ç¨‹</a></p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Spring Cloud </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸšªç½‘å…³ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆå››ï¼‰-ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨å’Œåˆ é™¤åµŒå¥—åˆ—è¡¨</title>
      <link href="posts/4109687940.html"/>
      <url>posts/4109687940.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€éœ€æ±‚åŠæ•°æ®åº“è¯´æ˜"><a href="#ä¸€ã€éœ€æ±‚åŠæ•°æ®åº“è¯´æ˜" class="headerlink" title="ä¸€ã€éœ€æ±‚åŠæ•°æ®åº“è¯´æ˜"></a>ä¸€ã€éœ€æ±‚åŠæ•°æ®åº“è¯´æ˜</h1><blockquote><p>åœ¨åœ¨çº¿æ•™è‚²é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨Spring Securityä½œä¸ºå®‰å…¨æ¡†æ¶ï¼Œåœ¨æƒé™ç®¡ç†éœ€æ±‚ä¸­ï¼Œ<strong>ä¸åŒè§’è‰²çš„ç”¨æˆ·ç™»å½•åå°ç®¡ç†ç³»ç»Ÿæ‹¥æœ‰ä¸åŒçš„èœå•æƒé™ä¸åŠŸèƒ½æƒé™ï¼Œ</strong>æƒé™ç®¡ç†åŒ…å«ä¸‰ä¸ªåŠŸèƒ½æ¨¡å—ï¼šèœå•ç®¡ç†ã€è§’è‰²ç®¡ç†å’Œç”¨æˆ·ç®¡ç†ã€‚</p><p>åœ¨èœå•ç®¡ç†ä¸­ï¼Œè¦æ±‚æˆ‘ä»¬ä½¿ç”¨æ ‘å½¢ç»“æ„å±•ç¤ºèœå•åˆ—è¡¨ã€‚</p></blockquote><blockquote><p>åˆ›å»ºacl_permissionè¡¨ï¼Œçœç•¥éƒ¨åˆ†æ•°æ®</p></blockquote><ul><li>åœ¨permissionè¡¨ä¸­ï¼Œpidä¸º0çš„ä¸ºæƒé™èœå•é¡¶å±‚æ•°æ®</li><li>æ ¹æ®pid =  idæ¥ç¡®å®šæ•°æ®é—´çš„çˆ¶å­å…³ç³»</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE &#96;acl_permission&#96; (</span><br><span class="line">  &#96;id&#96; char(19) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;ç¼–å·&#39;,</span><br><span class="line">  &#96;pid&#96; char(19) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;æ‰€å±ä¸Šçº§&#39;,</span><br><span class="line">  &#96;name&#96; varchar(20) NOT NULL DEFAULT &#39;&#39; COMMENT &#39;åç§°&#39;,</span><br><span class="line">  &#96;type&#96; tinyint(3) NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;ç±»å‹(1:èœå•,2:æŒ‰é’®)&#39;,</span><br><span class="line">  &#96;permission_value&#96; varchar(50) DEFAULT NULL COMMENT &#39;æƒé™å€¼&#39;,</span><br><span class="line">  &#96;path&#96; varchar(100) DEFAULT NULL COMMENT &#39;è®¿é—®è·¯å¾„&#39;,</span><br><span class="line">  &#96;component&#96; varchar(100) DEFAULT NULL COMMENT &#39;ç»„ä»¶è·¯å¾„&#39;,</span><br><span class="line">  &#96;icon&#96; varchar(50) DEFAULT NULL COMMENT &#39;å›¾æ ‡&#39;,</span><br><span class="line">  &#96;status&#96; tinyint(4) DEFAULT NULL COMMENT &#39;çŠ¶æ€(0:ç¦æ­¢,1:æ­£å¸¸)&#39;,</span><br><span class="line">  &#96;is_deleted&#96; tinyint(1) unsigned NOT NULL DEFAULT &#39;0&#39; COMMENT &#39;é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤&#39;,</span><br><span class="line">  &#96;gmt_create&#96; datetime DEFAULT NULL COMMENT &#39;åˆ›å»ºæ—¶é—´&#39;,</span><br><span class="line">  &#96;gmt_modified&#96; datetime DEFAULT NULL COMMENT &#39;æ›´æ–°æ—¶é—´&#39;,</span><br><span class="line">  PRIMARY KEY (&#96;id&#96;),</span><br><span class="line">  KEY &#96;idx_pid&#96; (&#96;pid&#96;)</span><br><span class="line">) ENGINE&#x3D;InnoDB DEFAULT CHARSET&#x3D;utf8mb4 COMMENT&#x3D;&#39;æƒé™&#39;;</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line"># Data for table &quot;acl_permission&quot;</span><br><span class="line">#</span><br><span class="line"></span><br><span class="line">INSERT INTO &#96;acl_permission&#96; VALUES (&#39;1&#39;,&#39;0&#39;,&#39;å…¨éƒ¨æ•°æ®&#39;,0,NULL,NULL,NULL,NULL,NULL,0,&#39;2019-11-15 17:13:06&#39;,&#39;2019-11-15 17:13:06&#39;),(&#39;1195268474480156673&#39;,&#39;1&#39;,&#39;æƒé™ç®¡ç†&#39;,1,NULL,&#39;&#x2F;acl&#39;,&#39;Layout&#39;,NULL,NULL,0,&#39;2019-11-15 17:13:06&#39;,&#39;2019-11-18 13:54:25&#39;),(&#39;1195268616021139457&#39;,&#39;1195268474480156673&#39;,&#39;ç”¨æˆ·ç®¡ç†&#39;,1,NULL,&#39;user&#x2F;list&#39;,&#39;&#x2F;acl&#x2F;user&#x2F;list&#39;,NULL,NULL,0,&#39;2019-11-15 17:13:40&#39;,&#39;2019-11-18 13:53:12&#39;),(&#39;1195268788138598401&#39;,&#39;1195268474480156673&#39;,&#39;è§’è‰²ç®¡ç†&#39;,1,NULL,&#39;role&#x2F;list&#39;,&#39;&#x2F;acl&#x2F;role&#x2F;list&#39;,NULL,NULL,0,&#39;2019-11-15 17:14:21&#39;,&#39;2019-11-15 17:14:21&#39;),(&#39;1195268893830864898&#39;,&#39;1195268474480156673&#39;,&#39;èœå•ç®¡ç†&#39;,1,NULL,&#39;menu&#x2F;list&#39;,&#39;&#x2F;acl&#x2F;menu&#x2F;list&#39;,NULL,NULL,0,&#39;2019-11-15 17:14:46&#39;,&#39;2019-11-15 17:14:46&#39;),(&#39;1195269143060602882&#39;,&#39;1195268616021139457&#39;,&#39;æŸ¥çœ‹&#39;,2,&#39;user.list&#39;,&#39;&#39;,&#39;&#39;,NULL,NULL,0,&#39;2019-11-15 17:15:45&#39;,&#39;2019-11-17 21:57:16&#39;),(&#39;1195269295926206466&#39;,&#39;1195268616021139457&#39;,&#39;æ·»åŠ &#39;,2,&#39;user.add&#39;,&#39;user&#x2F;add&#39;,&#39;&#x2F;acl&#x2F;user&#x2F;form&#39;,NULL,NULL,0,&#39;2019-11-15 17:16:22&#39;,&#39;2019-11-15 17:16:22&#39;),(&#39;1195269473479483394&#39;,&#39;1195268616021139457&#39;,&#39;ä¿®æ”¹&#39;,2,&#39;user.update&#39;,&#39;user&#x2F;update&#x2F;:id&#39;,&#39;&#x2F;acl&#x2F;user&#x2F;form&#39;,NULL,NULL,0,&#39;2019-11-15 17:17:04&#39;,&#39;2019-11-15 17:17:04&#39;),(&#39;1195269547269873666&#39;,&#39;1195268616021139457&#39;,&#39;åˆ é™¤&#39;,2,&#39;user.remove&#39;,&#39;&#39;,&#39;&#39;,NULL,NULL,0,&#39;2019-11-15 17:17:22&#39;,&#39;2019-11-15 17:17:22&#39;),(&#39;1195269821262782465&#39;,&#39;1195268788138598401&#39;,&#39;ä¿®æ”¹&#39;,2,&#39;role.update&#39;,&#39;role&#x2F;update&#x2F;:id&#39;,&#39;&#x2F;acl&#x2F;role&#x2F;form&#39;,NULL,NULL,0,&#39;2019-11-15 17:18:27&#39;,&#39;2019-11-15 17:19:53&#39;),(&#39;1195269903542444034&#39;,&#39;1195268788138598401&#39;,&#39;æŸ¥çœ‹&#39;,2,&#39;role.list&#39;,&#39;&#39;,&#39;&#39;,NULL,NULL,0,&#39;2019-11-15 17:18:47&#39;,&#39;2019-11-15 17:18:47&#39;);</span><br></pre></td></tr></table></figure><h1 id="äºŒã€ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨"><a href="#äºŒã€ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨" class="headerlink" title="äºŒã€ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨"></a>äºŒã€ä½¿ç”¨é€’å½’æŸ¥è¯¢åµŒå¥—åˆ—è¡¨</h1><h2 id="2-1ã€å®ä½“ç±»"><a href="#2-1ã€å®ä½“ç±»" class="headerlink" title="2.1ã€å®ä½“ç±»"></a>2.1ã€å®ä½“ç±»</h2><blockquote><p>ä¸ºäº†å®ç°åµŒå¥—åˆ—è¡¨çš„æŸ¥è¯¢ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºå®ä½“ç±»æ·»åŠ ä¸€äº›é¢å¤–çš„å±æ€§</p></blockquote><ul><li>æ·»åŠ ä¸€ä¸ªIntegerç±»å‹çš„levelå±æ€§ï¼Œè¿™ä¸ªå±æ€§ç”¨äºè¡¨ç¤ºå½“å‰permissionå¯¹è±¡åœ¨å“ªä¸€çº§èœå•</li><li>æ·»åŠ ä¸€ä¸ªList&lt; Permission &gt;ç±»å‹çš„childrenå±æ€§ï¼Œè¿™ä¸ªå±æ€§ç”¨äºå­˜æ”¾å½“å‰permissionå¯¹è±¡çš„å­èœå•</li><li>ç”±äºè¿™ä¸¤ä¸ªå±æ€§ä¸å±äºæ•°æ®åº“ä¸­çš„å±æ€§ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æ·»åŠ @TableField(exist = false) æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="meta">@TableName(&quot;acl_permission&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(value=&quot;Permissionå¯¹è±¡&quot;, description=&quot;æƒé™&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Permission</span> <span class="keyword">extends</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID=<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ‰€å±ä¸Šçº§&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String pid;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;åç§°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ç±»å‹(1:èœå•,2:æŒ‰é’®)&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer type;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æƒé™å€¼&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String permissionValue;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è®¿é—®è·¯å¾„&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String path;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ç»„ä»¶è·¯å¾„&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String component;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å›¾æ ‡&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String icon;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;çŠ¶æ€(0:ç¦æ­¢,1:æ­£å¸¸)&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer status;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤&quot;)</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * ä¸‹é¢æ˜¯ä¸šåŠ¡ä¸­æ‰‹åŠ¨æ·»åŠ çš„å±æ€§</span></span><br><span class="line"><span class="comment">     * å¹¶éæ•°æ®åº“ä¸­çš„å­—æ®µ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;è¡¨ç¤ºå½“å‰permissionå¯¹è±¡æ˜¯å“ªä¸€çº§èœå•&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer level;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;ä¸‹çº§&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;Permission&gt; children;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@TableField(exist = false)</span></span><br><span class="line">    <span class="meta">@ApiModelProperty(&quot;æ˜¯å¦è¢«é€‰ä¸­&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isSelect;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2ã€Controllerå±‚"><a href="#2-2ã€Controllerå±‚" class="headerlink" title="2.2ã€Controllerå±‚"></a>2.2ã€Controllerå±‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æŸ¥è¯¢æ‰€æœ‰èœå•&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">indexAllPermission</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;Permission&gt; list = permissionService.queryAllMenu();</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;children&quot;</span>,list);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-3ã€Serviceå±‚"><a href="#2-3ã€Serviceå±‚" class="headerlink" title="2.3ã€Serviceå±‚"></a>2.3ã€Serviceå±‚</h2><blockquote><p>ç¬¬ä¸€æ­¥ï¼Œå…ˆæŸ¥è¯¢å‡ºpermissionè¡¨ä¸­æ‰€æœ‰æ•°æ®ï¼Œæ ¹æ®idæ’åº</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * é€’å½’æŸ¥è¯¢æ‰€æœ‰èœå•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Permission&gt; <span class="title">queryAllMenu</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1 æŸ¥è¯¢èœå•è¡¨ä¸­æ‰€æœ‰æ•°æ®ï¼Œæ ¹æ®idæ’åº</span></span><br><span class="line">    QueryWrapper&lt;Permission&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    wrapper.orderByAsc(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    List&lt;Permission&gt; permissionList = baseMapper.selectList(wrapper);</span><br><span class="line">    <span class="comment">//2 å°†æŸ¥è¯¢å‡ºæ¥çš„èœå•Listé›†åˆæŒ‰ç…§è¦æ±‚è¿›è¡Œå°è£…</span></span><br><span class="line">    <span class="keyword">return</span> buildPermission(permissionList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºä¸€ä¸ªbuildPermissionæ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•å°†æŸ¥è¯¢å‡ºæ¥çš„permissioné›†åˆè½¬æ¢ä¸ºåµŒå¥—åˆ—è¡¨é›†åˆ</p></blockquote><ul><li>å…ˆæŸ¥è¯¢å‡ºæ‰€æœ‰permissionå¯¹è±¡ä¸­pidä¸º0ï¼Œå³æœ€é¡¶å±‚çš„å…ƒç´ </li><li>å°†è¯¥permissionå¯¹è±¡çš„levelè®¾ç½®ä¸º1</li><li>å°†è¿™ä¸ªé¡¶å±‚å…ƒç´ åŠ å…¥åˆ°è¦è¿”å›ç»™Controllerå±‚çš„Listé›†åˆä¸­</li><li>å†™ä¸€ä¸ªselectChildrenæ–¹æ³•ï¼Œä¼ å…¥å½“å‰permissionå’Œç¬¬ä¸€æ­¥æŸ¥è¯¢å‡ºçš„æ‰€æœ‰permissioné›†åˆï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºé€’å½’ç»„è£…é¡¶å±‚å…ƒç´ çš„å­å…ƒç´ å’Œåä»£å…ƒç´ </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * å°è£…ä¼ å…¥çš„èœå•é›†åˆ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> permissionList è¦å°è£…çš„èœå•åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> å°è£…å¥½çš„åµŒå¥—èœå•åˆ—è¡¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;Permission&gt; <span class="title">buildPermission</span><span class="params">(List&lt;Permission&gt; permissionList)</span> </span>&#123;</span><br><span class="line">    List&lt;Permission&gt; finalNode = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">//éå†ä¼ å…¥çš„èœå•åˆ—è¡¨ï¼Œå¾—åˆ°æœ€é¡¶å±‚å…ƒç´ ï¼Œå³pid = 0çš„èœå•å¯¹è±¡ï¼Œè®¾ç½®å…¶levelå€¼ä¸º1</span></span><br><span class="line">    <span class="keyword">for</span> (Permission permission : permissionList) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&quot;0&quot;</span>.equals(permission.getPid())) &#123;</span><br><span class="line">            <span class="comment">//è®¾ç½®é¡¶å±‚èœå•çš„levelå€¼ä¸º1</span></span><br><span class="line">            permission.setLevel(<span class="number">1</span>);</span><br><span class="line">            <span class="comment">//æ ¹æ®é¡¶å±‚èœå•ï¼Œå‘é‡Œé¢è¿›è¡ŒæŸ¥è¯¢å­èœå•ï¼Œå°è£…åˆ°finalNode</span></span><br><span class="line">            finalNode.add(selectChildren(permission,permissionList));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> finalNode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¬¬ä¸‰æ­¥ï¼Œå†™ä¸€ä¸ªselectChildrenæ–¹æ³•ï¼Œæ ¹æ®ä¼ å…¥çš„permissionå¯¹è±¡å’Œpermissioné›†åˆé€’å½’ç»„è£…åµŒå¥—åˆ—è¡¨ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * çœŸæ­£çš„é€’å½’åœ¨è¿™é‡Œè¿›è¡Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> permission</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> permissionList</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Permission <span class="title">selectChildren</span><span class="params">(Permission permission, List&lt;Permission&gt; permissionList)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1 ç”±äºæˆ‘ä»¬è¦å‘ä¸Šä¸€å±‚èœå•å¯¹è±¡çš„childrenä¸­æ”¾ç½®å¯¹è±¡ï¼Œæ‰€ä»¥æˆ‘ä»¬å…ˆåˆå§‹åŒ–å¯¹è±¡</span></span><br><span class="line">    permission.setChildren(<span class="keyword">new</span> ArrayList&lt;Permission&gt;());</span><br><span class="line">    <span class="comment">//2 éå†æ‰€æœ‰èœå•åˆ—è¡¨ï¼Œè¿›è¡Œåˆ¤æ–­æ¯”è¾ƒï¼Œæ¯”è¾ƒidå€¼ä¸pidæ˜¯å¦ç›¸åŒ</span></span><br><span class="line">    permissionList.forEach(per -&gt; &#123;</span><br><span class="line">        <span class="comment">//åˆ¤æ–­idå’Œpidæ˜¯å¦ç›¸åŒ</span></span><br><span class="line">        <span class="keyword">if</span>(permission.getId().equals(per.getPid())) &#123;</span><br><span class="line">            <span class="comment">//æ­¤æ—¶è¯æ˜å½“å‰perå¯¹è±¡æ˜¯permissionå¯¹è±¡çš„å­èŠ‚ç‚¹</span></span><br><span class="line">            <span class="comment">//æ‰€ä»¥å­èŠ‚ç‚¹çš„levelå€¼åº”è¯¥ä¸ºçˆ¶èŠ‚ç‚¹çš„level+1</span></span><br><span class="line">            per.setLevel(permission.getLevel() + <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">if</span>(CollectionUtils.isEmpty(permission.getChildren())) &#123;</span><br><span class="line">                permission.setChildren(<span class="keyword">new</span> ArrayList&lt;&gt;());</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//æŠŠæŸ¥è¯¢å‡ºæ¥çš„å½“å‰èœå•æ”¾åœ¨ä¸Šä¸€å±‚èœå•å¯¹è±¡çš„childrenä¸­</span></span><br><span class="line">            permission.getChildren().add(selectChildren(per,permissionList));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> permission;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-4ã€æµ‹è¯•"><a href="#2-4ã€æµ‹è¯•" class="headerlink" title="2.4ã€æµ‹è¯•"></a>2.4ã€æµ‹è¯•</h2><blockquote><p>ä½¿ç”¨Swaggerè¿›è¡Œæµ‹è¯•</p></blockquote><ul><li>ç•Œé¢</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210233136.png" alt="image-20210210233136804"></p><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210233105.png" alt="image-20210210233104615"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210233608.png" alt="image-20210210233608819"></p><h1 id="ä¸‰ã€é€šè¿‡idé€’å½’åˆ é™¤åµŒå¥—èœå•"><a href="#ä¸‰ã€é€šè¿‡idé€’å½’åˆ é™¤åµŒå¥—èœå•" class="headerlink" title="ä¸‰ã€é€šè¿‡idé€’å½’åˆ é™¤åµŒå¥—èœå•"></a>ä¸‰ã€é€šè¿‡idé€’å½’åˆ é™¤åµŒå¥—èœå•</h1><blockquote><p>éœ€è¦åˆ é™¤è‡ªèº«åŠæ‰€æœ‰çš„åä»£å…ƒç´ </p></blockquote><h2 id="3-1ã€Controllerå±‚"><a href="#3-1ã€Controllerå±‚" class="headerlink" title="3.1ã€Controllerå±‚"></a>3.1ã€Controllerå±‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@DeleteMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;é€’å½’åˆ é™¤èœå•&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">deletePermission</span><span class="params">(<span class="meta">@PathVariable</span> String id)</span> </span>&#123;</span><br><span class="line">    permissionService.recurDeletePermissionById(id);</span><br><span class="line">    <span class="keyword">return</span> R.ok();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2ã€Serviceå±‚"><a href="#3-2ã€Serviceå±‚" class="headerlink" title="3.2ã€Serviceå±‚"></a>3.2ã€Serviceå±‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æ ¹æ®idé€’å½’åˆ é™¤èœå•åŠå­èœå•</span></span><br><span class="line"><span class="comment"> * è·å–idä¸ºä¼ å…¥idçš„èœå•åŠå­èœå•</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">recurDeletePermissionById</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1 åˆ›å»ºä¸€ä¸ªlisté›†åˆï¼Œç”¨äºå°è£…æ‰€æœ‰åˆ é™¤èœå•idå€¼</span></span><br><span class="line">    List&lt;String&gt; idList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="comment">//2 å‘idListä¸­è®¾ç½®è¦åˆ é™¤çš„èœå•id</span></span><br><span class="line">    <span class="keyword">this</span>.selectPermissionChildById(id,idList);</span><br><span class="line">    <span class="comment">//æ”¾å…¥è¦åˆ é™¤çš„idï¼Œé€’å½’å°è£…çš„åªæ˜¯å­èœå•çš„id</span></span><br><span class="line">    idList.add(id);</span><br><span class="line">    permissionMapper.deleteBatchIds(idList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¼–å†™selectPermissionChildByIdæ–¹æ³•ï¼Œä¼ å…¥çˆ¶çº§idå’Œç”¨äºæ‰¹é‡åˆ é™¤çš„idåˆ—è¡¨ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºæŸ¥è¯¢æ‰€æœ‰å¾…åˆ é™¤å…ƒç´ çš„åä»£å…ƒç´ çš„id</p></blockquote><ul><li>ä½¿ç”¨Mybatis-Plusè‡ªå¸¦çš„QueryWrapperæŸ¥è¯¢å‡ºpidä¸ºä¼ å…¥idçš„permissionå…ƒç´ </li><li>éå†ä¸Šä¸€æ­¥æŸ¥è¯¢åˆ°çš„permissionåˆ—è¡¨ï¼Œç„¶åä»¥åˆ—è¡¨ä¸­æ¯ä¸€ä¸ªå…ƒç´ çš„idä½œä¸ºpidï¼Œè¿›è¡Œé€’å½’æŸ¥è¯¢</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æ ¹æ®ä¼ å…¥çš„èœå•idï¼ŒæŸ¥è¯¢èœå•ä¸­çš„æ‰€æœ‰å­èœå•idï¼Œç„¶åå°è£…åˆ°listé›†åˆä¸­</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> idList</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">selectPermissionChildById</span><span class="params">(String id, List&lt;String&gt; idList)</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;Permission&gt; wrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    wrapper.eq(<span class="string">&quot;pid&quot;</span>,id);</span><br><span class="line">    wrapper.select(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    List&lt;Permission&gt; childIdList = permissionMapper.selectList(wrapper);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŠŠchildIdListä¸­çš„èœå•idä¸€ä¸€å–å‡ºï¼Œå°è£…åˆ°idListä¸­ï¼Œåšé€’å½’æŸ¥è¯¢</span></span><br><span class="line">    childIdList.forEach(item -&gt; &#123;</span><br><span class="line">        idList.add(item.getId());</span><br><span class="line">        <span class="comment">//é€’å½’æŸ¥è¯¢</span></span><br><span class="line">        <span class="keyword">this</span>.selectPermissionChildById(item.getId(),idList);</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-3ã€æµ‹è¯•"><a href="#3-3ã€æµ‹è¯•" class="headerlink" title="3.3ã€æµ‹è¯•"></a>3.3ã€æµ‹è¯•</h2><blockquote><p>åœ¨æ•°æ®åº“ä¸­æ’å…¥å‡ æ¡æµ‹è¯•æ•°æ®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210235954.png" alt="image-20210210235953698"></p><blockquote><p>æ‰“å¼€swaggerï¼Œæˆ‘ä»¬æµ‹è¯•åˆ é™¤idä¸º2çš„èœå•åŠå…¶åä»£ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211000114.png" alt="image-20210211000114430"></p><blockquote><p>æŸ¥çœ‹æ•°æ®åº“ï¼Œå‘ç°æµ‹è¯•æ•°æ®å·²ç»è¢«é€»è¾‘åˆ é™¤ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210211000230.png" alt="image-20210211000230171"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆä¸‰ï¼‰-EasyExcelçš„ä½¿ç”¨</title>
      <link href="posts/765379126.html"/>
      <url>posts/765379126.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€ä»‹ç»å’Œå…¥é—¨ä½¿ç”¨"><a href="#ä¸€ã€ä»‹ç»å’Œå…¥é—¨ä½¿ç”¨" class="headerlink" title="ä¸€ã€ä»‹ç»å’Œå…¥é—¨ä½¿ç”¨"></a>ä¸€ã€ä»‹ç»å’Œå…¥é—¨ä½¿ç”¨</h1><h2 id="1-1ã€Excelçš„åº”ç”¨åœºæ™¯"><a href="#1-1ã€Excelçš„åº”ç”¨åœºæ™¯" class="headerlink" title="1.1ã€Excelçš„åº”ç”¨åœºæ™¯"></a>1.1ã€Excelçš„åº”ç”¨åœºæ™¯</h2><blockquote><p>æ•°æ®å¯¼å…¥ï¼š<strong>å‡è½»å½•å…¥å·¥ä½œé‡</strong></p></blockquote><blockquote><p>æ•°æ®å¯¼å‡ºï¼š<strong>ç»Ÿè®¡ä¿¡æ¯å½’æ¡£</strong></p></blockquote><blockquote><p>æ•°æ®ä¼ è¾“ï¼š<strong>å¼‚æ„ç³»ç»Ÿä¹‹é—´æ•°æ®ä¼ è¾“</strong></p></blockquote><h2 id="1-2ã€EasyExcel"><a href="#1-2ã€EasyExcel" class="headerlink" title="1.2ã€EasyExcel"></a>1.2ã€EasyExcel</h2><blockquote><p><strong>Githubåœ°å€ï¼š</strong><a href="https://github.com/alibaba/easyexcel">EasyExcel</a></p><p><strong>å®˜æ–¹ç½‘ç«™ï¼š</strong><a href="https://www.yuque.com/easyexcel/doc/easyexcel">EasyExcel</a></p></blockquote><h3 id="1ã€ä»‹ç»"><a href="#1ã€ä»‹ç»" class="headerlink" title="1ã€ä»‹ç»"></a>1ã€ä»‹ç»</h3><blockquote><p>EasyExcelæ˜¯ä¸€ä¸ªåŸºäºJavaçš„ç®€å•ã€çœå†…å­˜çš„è¯»å†™Excelçš„å¼€æºé¡¹ç›®ã€‚åœ¨å°½å¯èƒ½èŠ‚çº¦å†…å­˜çš„æƒ…å†µä¸‹æ”¯æŒè¯»å†™ç™¾Mçš„Excelã€‚</p></blockquote><h3 id="2ã€ç‰¹ç‚¹"><a href="#2ã€ç‰¹ç‚¹" class="headerlink" title="2ã€ç‰¹ç‚¹"></a>2ã€ç‰¹ç‚¹</h3><ul><li>Javaé¢†åŸŸè§£æã€ç”ŸæˆExcelæ¯”è¾ƒæœ‰åçš„æ¡†æ¶æœ‰Apache poiã€jxlç­‰ã€‚ä½†ä»–ä»¬éƒ½å­˜åœ¨ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜å°±æ˜¯éå¸¸çš„è€—å†…å­˜ã€‚å¦‚æœä½ çš„ç³»ç»Ÿå¹¶å‘é‡ä¸å¤§çš„è¯å¯èƒ½è¿˜è¡Œï¼Œä½†æ˜¯ä¸€æ—¦å¹¶å‘ä¸Šæ¥åä¸€å®šä¼šOOMæˆ–è€…JVMé¢‘ç¹çš„full gcã€‚</li><li>EasyExcelæ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„ä¸€ä¸ªexcelå¤„ç†æ¡†æ¶ï¼Œ<strong>ä»¥ä½¿ç”¨ç®€å•ã€èŠ‚çœå†…å­˜è‘—ç§°</strong>ã€‚EasyExcelèƒ½å¤§å¤§å‡å°‘å ç”¨å†…å­˜çš„ä¸»è¦åŸå› æ˜¯åœ¨è§£æExcelæ—¶æ²¡æœ‰å°†æ–‡ä»¶æ•°æ®ä¸€æ¬¡æ€§å…¨éƒ¨åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œè€Œæ˜¯ä»ç£ç›˜ä¸Šä¸€è¡Œè¡Œè¯»å–æ•°æ®ï¼Œé€ä¸ªè§£æã€‚</li><li>EasyExcelé‡‡ç”¨ä¸€è¡Œä¸€è¡Œçš„è§£ææ¨¡å¼ï¼Œå¹¶å°†ä¸€è¡Œçš„è§£æç»“æœä»¥è§‚å¯Ÿè€…çš„æ¨¡å¼é€šçŸ¥å¤„ç†ï¼ˆAnalysisEventListenerï¼‰ã€‚</li></ul><h2 id="1-3ã€å…¥é—¨ä½¿ç”¨"><a href="#1-3ã€å…¥é—¨ä½¿ç”¨" class="headerlink" title="1.3ã€å…¥é—¨ä½¿ç”¨"></a>1.3ã€å…¥é—¨ä½¿ç”¨</h2><h3 id="1ã€åˆ›å»ºé¡¹ç›®å¹¶å¼•å…¥ä¾èµ–"><a href="#1ã€åˆ›å»ºé¡¹ç›®å¹¶å¼•å…¥ä¾èµ–" class="headerlink" title="1ã€åˆ›å»ºé¡¹ç›®å¹¶å¼•å…¥ä¾èµ–"></a>1ã€åˆ›å»ºé¡¹ç›®å¹¶å¼•å…¥ä¾èµ–</h3><blockquote><p>åˆ›å»ºä¸€ä¸ªæµ‹è¯•ç”¨<strong>Maven</strong>é¡¹ç›®ï¼Œå¹¶å¯¼å…¥ä»¥ä¸‹ä¾èµ–</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-simple<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.7.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.xmlbeans<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xmlbeans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.10<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€æœ€ç®€å•çš„å†™"><a href="#2ã€æœ€ç®€å•çš„å†™" class="headerlink" title="2ã€æœ€ç®€å•çš„å†™"></a>2ã€æœ€ç®€å•çš„å†™</h3><blockquote><p>åˆ›å»ºå®ä½“ç±»</p></blockquote><ul><li>ä½¿ç”¨@ExcelPropertyæ³¨è§£å¯ä»¥æŒ‡å®šexcelåˆ—åï¼Œå³nameå¯¹åº”excelä¸­çš„â€å§“åâ€åˆ—ï¼Œbirthdayå±æ€§å¯¹åº”excelä¸­çš„ç”Ÿæ—¥åˆ—â€¦</li><li>ä½¿ç”¨Lombokæ’ä»¶ç®€åŒ–å¼€å‘</li><li>å¯ä»¥ä½¿ç”¨@ExcelIgnoreå­—æ®µæ¥è®©EasyExcelå¿½ç•¥è¯¥å±æ€§</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelEmpData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;å§“å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;ç”Ÿæ—¥&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ExcelProperty(&quot;è–ªèµ„&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double salary;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨<span class="doctag">@ExcelIgnore</span>æ³¨è§£æ¥ä½¿EasyExcelå¿½ç•¥è¿™ä¸ªå±æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ç”¨ä¾‹ï¼Œåœ¨teståŒ…ä¸‹åˆ›å»ºä¸€ä¸ªTestWriteExcelDataæµ‹è¯•ç±»ï¼Œç”¨äºæµ‹è¯•EasyExcelçš„å†™åŠŸèƒ½</p></blockquote><ul><li>07ç‰ˆæœ¬çš„Excelå’Œ03ç‰ˆæœ¬çš„å†™å…¥æ–¹å¼æœ‰æ‰€ä¸åŒ</li><li>03ç‰ˆæœ¬çš„Excelå†™å…¥æœ€å¤šä¸€æ¬¡å¯å†™65536è¡Œ</li></ul><blockquote><p>ç¼–å†™ä¸€ä¸ªé™æ€æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºç”Ÿæˆæµ‹è¯•æ•°æ®</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">static</span> List&lt;ExcelEmpData&gt; <span class="title">getEmpData</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;ExcelEmpData&gt; excelEmpDataList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    ExcelEmpData data = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">65535</span>; i++) &#123;</span><br><span class="line">        data = <span class="keyword">new</span> ExcelEmpData();</span><br><span class="line">        data.setName(<span class="string">&quot;èŠœæ¹–&quot;</span> + i);</span><br><span class="line">        <span class="comment">//passwordå±æ€§çš„å€¼ä¸ä¼šè¢«å†™å…¥Excelä¸­</span></span><br><span class="line">        data.setPassword(<span class="string">&quot;123&quot;</span>);</span><br><span class="line">        data.setSalary(<span class="number">43.96</span>);</span><br><span class="line">        data.setBirthday(<span class="keyword">new</span> Date());</span><br><span class="line">        excelEmpDataList.add(data);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> excelEmpDataList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨æµ‹è¯•ç±»ä¸­ç¼–å†™ä¸€ä¸ªtestWrite07æ–¹æ³•ï¼Œç”¨äºå¯¹.xlsxæ–‡ä»¶è¿›è¡Œæ•°æ®å†™å…¥</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æŒ‡å®šæ•°æ®å†™å…¥åˆ°å“ªä¸ªexcelæ–‡ä»¶</span></span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/01-simpleWrite-07.xlsx&quot;</span>;</span><br><span class="line">    <span class="comment">// è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class="line">    EasyExcel.write(fileName, ExcelEmpData.class).sheet(<span class="string">&quot;æ¨¡æ¿&quot;</span>).doWrite(getEmpData());</span><br><span class="line">    System.out.println(<span class="string">&quot;excelå†™å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210209235417.png" alt="image-20210209235416173"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210209235558.png" alt="image-20210209235558290"></p><blockquote><p>åœ¨æµ‹è¯•ç±»ä¸­ç¼–å†™ä¸€ä¸ªtestWrite03æ–¹æ³•ï¼Œç”¨äºå¯¹.xlsæ–‡ä»¶è¿›è¡Œæ•°æ®å†™å…¥</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleWrite03</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/02-simpleWrite-03.xls&quot;</span>;</span><br><span class="line">    <span class="comment">// å¦‚æœè¿™é‡Œæƒ³ä½¿ç”¨03 åˆ™ ä¼ å…¥excelTypeå‚æ•°å³å¯</span></span><br><span class="line">    EasyExcel.write(fileName, ExcelEmpData.class).excelType(ExcelTypeEnum.XLS).sheet(<span class="string">&quot;æ¨¡æ¿&quot;</span>).doWrite(getEmpData());</span><br><span class="line">    System.out.println(<span class="string">&quot;excelå†™å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210209235836.png" alt="image-20210209235835844"></p><blockquote><p>å‘.xlsæ–‡ä»¶å†™å…¥æ•°æ®æ—¶ï¼Œä¸€æ¬¡æœ€å¤šå†™å…¥65536è¡Œ</p></blockquote><ul><li>å°†getData()å‡½æ•°ä¸­çš„å¾ªç¯æ¬¡æ•°æé«˜åˆ°65537</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrongWrite03</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/03-simpleWrite-03.xls&quot;</span>;</span><br><span class="line">    <span class="comment">// å¦‚æœè¿™é‡Œæƒ³ä½¿ç”¨03 åˆ™ ä¼ å…¥excelTypeå‚æ•°å³å¯</span></span><br><span class="line">    EasyExcel.write(fileName, ExcelEmpData.class).excelType(ExcelTypeEnum.XLS).sheet(<span class="string">&quot;æ¨¡æ¿&quot;</span>).doWrite(getEmpData());</span><br><span class="line">    System.out.println(<span class="string">&quot;excelå†™å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210000144.png" alt="image-20210210000144286"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210000202.png" alt="image-20210210000202523"></p><h3 id="3ã€æŒ‡å®šeasyExcelçš„å†™å…¥åˆ—"><a href="#3ã€æŒ‡å®šeasyExcelçš„å†™å…¥åˆ—" class="headerlink" title="3ã€æŒ‡å®šeasyExcelçš„å†™å…¥åˆ—"></a>3ã€æŒ‡å®šeasyExcelçš„å†™å…¥åˆ—</h3><blockquote><p>ä¸ºå®ä½“ç±»ä¸­çš„å­—æ®µé…ç½®indexå±æ€§</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelEmpData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;å§“å&quot;,index = 1)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;ç”Ÿæ—¥&quot;,index = 3)</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;è–ªèµ„&quot;,index = 5)</span></span><br><span class="line">    <span class="keyword">private</span> Double salary;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨<span class="doctag">@ExcelIgnore</span>æ³¨è§£æ¥ä½¿EasyExcelå¿½ç•¥è¿™ä¸ªå±æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é‡æ–°æ‰§è¡Œæµ‹è¯•æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æŒ‡å®šæ•°æ®å†™å…¥åˆ°å“ªä¸ªexcelæ–‡ä»¶</span></span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/04-simpleWrite-07.xlsx&quot;</span>;</span><br><span class="line">    <span class="comment">// è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class="line">    EasyExcel.write(fileName, ExcelEmpData.class).sheet(<span class="string">&quot;æ¨¡æ¿&quot;</span>).doWrite(getEmpData());</span><br><span class="line">    System.out.println(<span class="string">&quot;excelå†™å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210000729.png" alt="image-20210210000729446"></p><h3 id="4ã€æŒ‡å®šå±æ€§çš„æ ¼å¼åŒ–"><a href="#4ã€æŒ‡å®šå±æ€§çš„æ ¼å¼åŒ–" class="headerlink" title="4ã€æŒ‡å®šå±æ€§çš„æ ¼å¼åŒ–"></a>4ã€æŒ‡å®šå±æ€§çš„æ ¼å¼åŒ–</h3><blockquote><p>æ ¹æ®å®ä½“ç±»å±æ€§çš„ç±»å‹ä¸ºå±æ€§æ·»åŠ ä¸åŒçš„æ ¼å¼åŒ–æ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelEmpData</span> </span>&#123;</span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;å§“å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DateTimeFormat(&quot;yyyyå¹´MMæœˆddæ—¥HHæ—¶mmåˆ†ssç§’&quot;)</span></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;ç”Ÿæ—¥&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date birthday;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@NumberFormat(&quot;#.##%&quot;)</span><span class="comment">//ç™¾åˆ†æ¯”è¡¨ç¤ºï¼Œä¿ç•™ä¸¤ä½å°æ•°</span></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;è–ªèµ„&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Double salary;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * ä½¿ç”¨<span class="doctag">@ExcelIgnore</span>æ³¨è§£æ¥ä½¿EasyExcelå¿½ç•¥è¿™ä¸ªå±æ€§</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@ExcelIgnore</span></span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é‡æ–°æ‰§è¡Œæ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testWrite07</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">// æŒ‡å®šæ•°æ®å†™å…¥åˆ°å“ªä¸ªexcelæ–‡ä»¶</span></span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/05-simpleWrite-07.xlsx&quot;</span>;</span><br><span class="line">    <span class="comment">// è¿™é‡Œ éœ€è¦æŒ‡å®šå†™ç”¨å“ªä¸ªclasså»å†™ï¼Œç„¶åå†™åˆ°ç¬¬ä¸€ä¸ªsheetï¼Œåå­—ä¸ºæ¨¡æ¿ ç„¶åæ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class="line">    EasyExcel.write(fileName, ExcelEmpData.class).sheet(<span class="string">&quot;æ¨¡æ¿&quot;</span>).doWrite(getEmpData());</span><br><span class="line">    System.out.println(<span class="string">&quot;excelå†™å…¥æˆåŠŸï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210001029.png" alt="image-20210210001029235"></p><h3 id="5ã€xlsxå’Œxlsçš„åŒºåˆ«"><a href="#5ã€xlsxå’Œxlsçš„åŒºåˆ«" class="headerlink" title="5ã€xlsxå’Œxlsçš„åŒºåˆ«"></a>5ã€xlsxå’Œxlsçš„åŒºåˆ«</h3><blockquote><p>å­˜å‚¨ç›¸åŒæ•°é‡çš„æ•°æ®ï¼Œç”¨xlsxå ç”¨çš„ç©ºé—´è¾ƒå°</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210001155.png" alt="image-20210210001155925"></p><blockquote><p>xlsä¸€æ¬¡æ€§æœ€å¤šå†™å…¥65536æ¡æ•°æ®</p></blockquote><h2 id="1-4ã€ä½¿ç”¨EasyExcelè¯»å–æ–‡ä»¶"><a href="#1-4ã€ä½¿ç”¨EasyExcelè¯»å–æ–‡ä»¶" class="headerlink" title="1.4ã€ä½¿ç”¨EasyExcelè¯»å–æ–‡ä»¶"></a>1.4ã€ä½¿ç”¨EasyExcelè¯»å–æ–‡ä»¶</h2><blockquote><p>å‚è€ƒåœ°å€ï¼š<a href="https://www.yuque.com/easyexcel/doc/read">https://www.yuque.com/easyexcel/doc/read</a></p></blockquote><h3 id="1ã€åˆ›å»ºç›‘å¬å™¨"><a href="#1ã€åˆ›å»ºç›‘å¬å™¨" class="headerlink" title="1ã€åˆ›å»ºç›‘å¬å™¨"></a>1ã€åˆ›å»ºç›‘å¬å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelEmpDataListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">ExcelEmpData</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ¯éš”5æ¡å­˜å‚¨æ•°æ®åº“ï¼Œå®é™…ä½¿ç”¨ä¸­å¯ä»¥3000æ¡ï¼Œç„¶åæ¸…ç†list ï¼Œæ–¹ä¾¿å†…å­˜å›æ”¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">int</span> BATCH_COUNT = <span class="number">5</span>;</span><br><span class="line">    List&lt;ExcelEmpData&gt; list = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™ä¸ªæ¯ä¸€æ¡æ•°æ®è§£æéƒ½ä¼šæ¥è°ƒç”¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     *            one row value. Is is same as &#123;<span class="doctag">@link</span> AnalysisContext#readRowHolder()&#125;</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(ExcelEmpData data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;è§£æåˆ°ä¸€æ¡æ•°æ®:&#123;&#125;&quot;</span>, data);</span><br><span class="line">        list.add(data);</span><br><span class="line">        <span class="comment">// è¾¾åˆ°BATCH_COUNTäº†ï¼Œéœ€è¦å»å­˜å‚¨ä¸€æ¬¡æ•°æ®åº“ï¼Œé˜²æ­¢æ•°æ®å‡ ä¸‡æ¡æ•°æ®åœ¨å†…å­˜ï¼Œå®¹æ˜“OOM</span></span><br><span class="line">        <span class="keyword">if</span> (list.size() &gt;= BATCH_COUNT) &#123;</span><br><span class="line">            log.info(<span class="string">&quot;å­˜æ•°æ®åº“&quot;</span>);</span><br><span class="line">            <span class="comment">// å­˜å‚¨å®Œæˆæ¸…ç† list</span></span><br><span class="line">            list.clear();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰€æœ‰æ•°æ®è§£æå®Œæˆäº† éƒ½ä¼šæ¥è°ƒç”¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        log.info(<span class="string">&quot;æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€æµ‹è¯•"><a href="#2ã€æµ‹è¯•" class="headerlink" title="2ã€æµ‹è¯•"></a>2ã€æµ‹è¯•</h3><blockquote><p>åˆ›å»ºtestRead.xlsxæ–‡ä»¶ï¼Œæ·»åŠ æµ‹è¯•æ•°æ®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210002105.png" alt="image-20210210002105220"></p><blockquote><p>åˆ›å»ºæµ‹è¯•æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * æœ€ç®€å•çš„è¯»</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleRead07</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/testRead.xlsx&quot;</span>;</span><br><span class="line">    <span class="comment">// è¿™é‡Œé»˜è®¤è¯»å–ç¬¬ä¸€ä¸ªsheet</span></span><br><span class="line">    EasyExcel.read(fileName, ExcelEmpData.class, <span class="keyword">new</span> ExcelEmpDataListener()).sheet().doRead();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">simpleRead03</span><span class="params">()</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String fileName = <span class="string">&quot;F:/testExcel/testRead.xls&quot;</span>;</span><br><span class="line">    <span class="comment">// è¿™é‡Œé»˜è®¤è¯»å–ç¬¬ä¸€ä¸ªsheet</span></span><br><span class="line">    EasyExcel.read(fileName, ExcelEmpData.class, <span class="keyword">new</span> ExcelEmpDataListener()).excelType(ExcelTypeEnum.XLS).sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210002620.png" alt="image-20210210002619823"></p><h1 id="äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆEasyExcel"><a href="#äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆEasyExcel" class="headerlink" title="äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆEasyExcel"></a>äºŒã€åœ¨çº¿æ•™è‚²é¡¹ç›®æ•´åˆEasyExcel</h1><blockquote><p>åœ¨åœ¨çº¿æ•™è‚²é¡¹ç›®çš„è¯¾ç¨‹åˆ†ç±»ç®¡ç†ä¸­ï¼Œæˆ‘ä»¬éœ€è¦æ¥æ”¶ç®¡ç†å‘˜ä»å‰ç«¯ä¼ è¿‡æ¥çš„è¯¾ç¨‹åˆ†ç±»excelï¼Œåœ¨è§£æåå°†excelä¸­çš„æ•°æ®å­˜å…¥è¯¾ç¨‹åˆ†ç±»è¡¨</p></blockquote><h2 id="2-1ã€æ·»åŠ ä¾èµ–"><a href="#2-1ã€æ·»åŠ ä¾èµ–" class="headerlink" title="2.1ã€æ·»åŠ ä¾èµ–"></a>2.1ã€æ·»åŠ ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>easyexcel<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.xmlbeans<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>xmlbeans<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-2ã€åˆ›å»ºä¸Excelå¯¹åº”çš„å®ä½“ç±»"><a href="#2-2ã€åˆ›å»ºä¸Excelå¯¹åº”çš„å®ä½“ç±»" class="headerlink" title="2.2ã€åˆ›å»ºä¸Excelå¯¹åº”çš„å®ä½“ç±»"></a>2.2ã€åˆ›å»ºä¸Excelå¯¹åº”çš„å®ä½“ç±»</h2><blockquote><p>excelæ¨¡æ¿æ–‡ä»¶æ ¼å¼å¦‚ä¸‹ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210003102.png" alt="image-20210210003102353"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelSubjectData</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;ä¸€çº§åˆ†ç±»&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String levelOneTitle;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ExcelProperty(value = &quot;äºŒçº§åˆ†ç±»&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String levelTwoTitle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-3ã€å®ç°Excelå¯¼å…¥"><a href="#2-3ã€å®ç°Excelå¯¼å…¥" class="headerlink" title="2.3ã€å®ç°Excelå¯¼å…¥"></a>2.3ã€å®ç°Excelå¯¼å…¥</h2><h3 id="1ã€åˆ›å»ºç›‘å¬å™¨-1"><a href="#1ã€åˆ›å»ºç›‘å¬å™¨-1" class="headerlink" title="1ã€åˆ›å»ºç›‘å¬å™¨"></a>1ã€åˆ›å»ºç›‘å¬å™¨</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span> <span class="comment">//å…¨å‚</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span> <span class="comment">//æ— å‚</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ExcelSubjectDataListener</span> <span class="keyword">extends</span> <span class="title">AnalysisEventListener</span>&lt;<span class="title">ExcelSubjectData</span>&gt; </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‡è®¾è¿™ä¸ªæ˜¯ä¸€ä¸ªDAOï¼Œå½“ç„¶æœ‰ä¸šåŠ¡é€»è¾‘è¿™ä¸ªä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªserviceã€‚å½“ç„¶å¦‚æœä¸ç”¨å­˜å‚¨è¿™ä¸ªå¯¹è±¡æ²¡ç”¨ã€‚</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> SubjectMapper subjectMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     *éå†æ¯ä¸€è¡Œçš„è®°å½•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> data</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> context</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(ExcelSubjectData data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;è§£æåˆ°ä¸€æ¡è®°å½•: &#123;&#125;&quot;</span>, data);</span><br><span class="line">        <span class="comment">//å¤„ç†è¯»å–å‡ºæ¥çš„æ•°æ®</span></span><br><span class="line">        String levelOneTitle = data.getLevelOneTitle();<span class="comment">//ä¸€çº§æ ‡é¢˜</span></span><br><span class="line">        String levelTwoTitle = data.getLevelTwoTitle();<span class="comment">//äºŒçº§æ ‡é¢˜</span></span><br><span class="line">        log.info(<span class="string">&quot;levelOneTitle: &#123;&#125;&quot;</span>, levelOneTitle);</span><br><span class="line">        log.info(<span class="string">&quot;levelTwoTitle: &#123;&#125;&quot;</span>, levelTwoTitle);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// ç»„è£…æ•°æ®ï¼šSubject</span></span><br><span class="line">        <span class="comment">// å­˜å…¥æ•°æ®åº“ï¼šsubjectMapper.insert()</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰€æœ‰æ•°æ®è§£æå®Œæˆäº† éƒ½ä¼šæ¥è°ƒç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doAfterAllAnalysed</span><span class="params">(AnalysisContext context)</span> </span>&#123;</span><br><span class="line">        log.info(<span class="string">&quot;æ‰€æœ‰æ•°æ®è§£æå®Œæˆï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ç›‘å¬å™¨ä¸­æ·»åŠ è¾…åŠ©æ–¹æ³•"><a href="#2ã€ç›‘å¬å™¨ä¸­æ·»åŠ è¾…åŠ©æ–¹æ³•" class="headerlink" title="2ã€ç›‘å¬å™¨ä¸­æ·»åŠ è¾…åŠ©æ–¹æ³•"></a>2ã€ç›‘å¬å™¨ä¸­æ·»åŠ è¾…åŠ©æ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»åç§°æŸ¥è¯¢è¿™ä¸ªä¸€çº§åˆ†ç±»æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> title</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Subject <span class="title">getByTitle</span><span class="params">(String title)</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;Subject&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;title&quot;</span>, title);</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;parent_id&quot;</span>, <span class="string">&quot;0&quot;</span>);<span class="comment">//ä¸€çº§åˆ†ç±»</span></span><br><span class="line">    <span class="keyword">return</span> subjectMappter.selectOne(queryWrapper);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®åˆ†ç±»åç§°å’Œçˆ¶idæŸ¥è¯¢è¿™ä¸ªäºŒçº§åˆ†ç±»æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> title</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> Subject <span class="title">getSubByTitle</span><span class="params">(String title, String parentId)</span> </span>&#123;</span><br><span class="line">    QueryWrapper&lt;Subject&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;title&quot;</span>, title);</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;parent_id&quot;</span>, parentId);</span><br><span class="line">    <span class="keyword">return</span> subjectMappter.selectOne(queryWrapper);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€å®Œå–„invokeæ–¹æ³•"><a href="#3ã€å®Œå–„invokeæ–¹æ³•" class="headerlink" title="3ã€å®Œå–„invokeæ–¹æ³•"></a>3ã€å®Œå–„invokeæ–¹æ³•</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è¿™ä¸ªæ¯ä¸€æ¡æ•°æ®è§£æéƒ½ä¼šæ¥è°ƒç”¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">invoke</span><span class="params">(ExcelSubjectData data, AnalysisContext context)</span> </span>&#123;</span><br><span class="line">    log.info(<span class="string">&quot;è§£æåˆ°ä¸€æ¡æ•°æ®:&#123;&#125;&quot;</span>, data);</span><br><span class="line">    <span class="comment">//å¤„ç†è¯»å–è¿›æ¥çš„æ•°æ®</span></span><br><span class="line">    String titleLevelOne = data.getLevelOneTitle();</span><br><span class="line">    String titleLevelTwo = data.getLevelTwoTitle();</span><br><span class="line">    <span class="comment">//åˆ¤æ–­ä¸€çº§åˆ†ç±»æ˜¯å¦é‡å¤</span></span><br><span class="line">    Subject subjectLevelOne = <span class="keyword">this</span>.getByTitle(titleLevelOne);</span><br><span class="line">    String parentId = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(subjectLevelOne == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//å°†ä¸€çº§åˆ†ç±»å­˜å…¥æ•°æ®åº“</span></span><br><span class="line">        Subject subject = <span class="keyword">new</span> Subject();</span><br><span class="line">        subject.setParentId(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">        subject.setTitle(titleLevelOne);<span class="comment">//ä¸€çº§åˆ†ç±»åç§°</span></span><br><span class="line">        subjectMappter.insert(subject);</span><br><span class="line">        parentId = subject.getId();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        parentId = subjectLevelOne.getId();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//åˆ¤æ–­äºŒçº§åˆ†ç±»æ˜¯å¦é‡å¤</span></span><br><span class="line">    Subject subjectLevelTwo = <span class="keyword">this</span>.getSubByTitle(titleLevelTwo, parentId);</span><br><span class="line">    <span class="keyword">if</span>(subjectLevelTwo == <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="comment">//å°†äºŒçº§åˆ†ç±»å­˜å…¥æ•°æ®åº“</span></span><br><span class="line">        Subject subject = <span class="keyword">new</span> Subject();</span><br><span class="line">        subject.setTitle(titleLevelTwo);</span><br><span class="line">        subject.setParentId(parentId);</span><br><span class="line">        subjectMappter.insert(subject);<span class="comment">//æ·»åŠ </span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€SubjectService"><a href="#4ã€SubjectService" class="headerlink" title="4ã€SubjectService"></a><strong>4ã€SubjectService</strong></h3><p>æ¥å£</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">batchImport</span><span class="params">(InputStream inputStream)</span></span>;</span><br></pre></td></tr></table></figure><p>å®ç°ï¼šè·å–Excelè®°å½•å¹¶é€æ¡å¯¼å…¥</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">batchImport</span><span class="params">(InputStream inputStream)</span> </span>&#123;</span><br><span class="line">    <span class="comment">// è¿™é‡Œ éœ€è¦æŒ‡å®šè¯»ç”¨å“ªä¸ªclasså»è¯»ï¼Œç„¶åè¯»å–ç¬¬ä¸€ä¸ªsheet æ–‡ä»¶æµä¼šè‡ªåŠ¨å…³é—­</span></span><br><span class="line">    EasyExcel.read(inputStream, ExcelSubjectData.class, <span class="keyword">new</span> ExcelSubjectDataListener(baseMapper))</span><br><span class="line">        .excelType(ExcelTypeEnum.XLS).sheet().doRead();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€Controller"><a href="#5ã€Controller" class="headerlink" title="5ã€Controller"></a>5ã€Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;è¯¾ç¨‹åˆ†ç±»ç®¡ç†&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/edu/subject&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubjectController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SubjectService subjectService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;import&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;Excelæ‰¹é‡å¯¼å…¥è¯¾ç¨‹åˆ†ç±»&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">batchImport</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="meta">@ApiParam(value = &quot;Excelæ–‡ä»¶&quot;,required = true)</span></span></span></span><br><span class="line"><span class="function"><span class="params">            <span class="meta">@RequestParam(&quot;file&quot;)</span> MultipartFile file)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è°ƒç”¨serviceå±‚çš„æ‰¹é‡å¯¼å…¥æ–¹æ³•</span></span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            subjectService.batchImport(file.getInputStream());</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            <span class="comment">//æ‰“å°æ—¥å¿—</span></span><br><span class="line">            log.error(ExceptionUtils.getMessage(e));</span><br><span class="line">            <span class="comment">//æŠ›å‡ºä¸€ä¸ªExcelå¯¼å…¥å¤±è´¥å¼‚å¸¸</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.EXCEL_DATA_IMPORT_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> R.ok().message(<span class="string">&quot;æ‰¹é‡å¯¼å…¥æˆåŠŸ&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;nested&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;åµŒå¥—åˆ†ç±»æ•°æ®åˆ—è¡¨&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">nestedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//è¿”å›åˆ†ç±»VOåˆ—è¡¨</span></span><br><span class="line">        List&lt;SubjectVo&gt; subjectVoList = subjectService.nestedList();</span><br><span class="line">        <span class="keyword">return</span> R.ok().data(<span class="string">&quot;items&quot;</span>,subjectVoList);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€ä½¿ç”¨swaggerè¿›è¡Œæµ‹è¯•"><a href="#6ã€ä½¿ç”¨swaggerè¿›è¡Œæµ‹è¯•" class="headerlink" title="6ã€ä½¿ç”¨swaggerè¿›è¡Œæµ‹è¯•"></a>6ã€ä½¿ç”¨swaggerè¿›è¡Œæµ‹è¯•</h3><blockquote><p>åˆ é™¤æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¯¾ç¨‹åˆ†ç±»</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210003822.png" alt="image-20210210003821966"></p><blockquote><p>æ‰“å¼€swaggerï¼Œé€‰æ‹©æ–‡ä»¶è¿›è¡Œä¸Šä¼ </p></blockquote><ul><li>swaggeré¡µé¢</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210004001.png" alt="image-20210210004001328"></p><ul><li>è¦ä¸Šä¼ çš„æ–‡ä»¶</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210003944.png" alt="image-20210210003944206"></p><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210004050.png" alt="image-20210210004050124"></p><ul><li>æ•°æ®åº“</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210210004116.png" alt="image-20210210004116897"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> âœ¨EasyExcel </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆäºŒï¼‰-ç”¨æˆ·è®¤è¯</title>
      <link href="posts/650479038.html"/>
      <url>posts/650479038.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€æœ‰çŠ¶æ€ç™»å½•å’Œæ— çŠ¶æ€ç™»å½•"><a href="#ä¸€ã€æœ‰çŠ¶æ€ç™»å½•å’Œæ— çŠ¶æ€ç™»å½•" class="headerlink" title="ä¸€ã€æœ‰çŠ¶æ€ç™»å½•å’Œæ— çŠ¶æ€ç™»å½•"></a>ä¸€ã€æœ‰çŠ¶æ€ç™»å½•å’Œæ— çŠ¶æ€ç™»å½•</h1><h2 id="1-1-ä»€ä¹ˆæ˜¯æœ‰çŠ¶æ€ï¼Ÿ"><a href="#1-1-ä»€ä¹ˆæ˜¯æœ‰çŠ¶æ€ï¼Ÿ" class="headerlink" title="1.1.ä»€ä¹ˆæ˜¯æœ‰çŠ¶æ€ï¼Ÿ"></a>1.1.ä»€ä¹ˆæ˜¯æœ‰çŠ¶æ€ï¼Ÿ</h2><blockquote><p>æœ‰çŠ¶æ€æœåŠ¡ï¼Œå³æœåŠ¡ç«¯éœ€è¦è®°å½•æ¯æ¬¡ä¼šè¯çš„å®¢æˆ·ç«¯ä¿¡æ¯ï¼Œä»è€Œè¯†åˆ«å®¢æˆ·ç«¯èº«ä»½ï¼Œæ ¹æ®ç”¨æˆ·èº«ä»½è¿›è¡Œè¯·æ±‚çš„å¤„ç†ï¼Œå…¸å‹çš„è®¾è®¡å¦‚tomcatä¸­çš„sessionã€‚</p><p>ä¾‹å¦‚ç™»å½•ï¼šç”¨æˆ·ç™»å½•åï¼Œæˆ‘ä»¬æŠŠç™»å½•è€…çš„ä¿¡æ¯ä¿å­˜åœ¨æœåŠ¡ç«¯sessionä¸­ï¼Œå¹¶ä¸”ç»™ç”¨æˆ·ä¸€ä¸ªcookieå€¼ï¼Œè®°å½•å¯¹åº”çš„sessionã€‚ç„¶åä¸‹æ¬¡è¯·æ±‚ï¼Œç”¨æˆ·æºå¸¦cookieå€¼æ¥ï¼Œæˆ‘ä»¬å°±èƒ½è¯†åˆ«åˆ°å¯¹åº”sessionï¼Œä»è€Œæ‰¾åˆ°ç”¨æˆ·çš„ä¿¡æ¯ã€‚</p></blockquote><p>ç¼ºç‚¹ï¼š</p><ul><li>æœåŠ¡ç«¯ä¿å­˜å¤§é‡æ•°æ®ï¼Œå¢åŠ æœåŠ¡ç«¯å‹åŠ›</li><li>æœåŠ¡ç«¯ä¿å­˜ç”¨æˆ·çŠ¶æ€ï¼Œæ— æ³•è¿›è¡Œæ°´å¹³æ‰©å±•</li><li>å®¢æˆ·ç«¯è¯·æ±‚ä¾èµ–æœåŠ¡ç«¯ï¼Œå¤šæ¬¡è¯·æ±‚å¿…é¡»è®¿é—®åŒä¸€å°æœåŠ¡å™¨</li></ul><h2 id="1-2ã€ä»€ä¹ˆæ˜¯æ— çŠ¶æ€ï¼Ÿ"><a href="#1-2ã€ä»€ä¹ˆæ˜¯æ— çŠ¶æ€ï¼Ÿ" class="headerlink" title="1.2ã€ä»€ä¹ˆæ˜¯æ— çŠ¶æ€ï¼Ÿ"></a>1.2ã€ä»€ä¹ˆæ˜¯æ— çŠ¶æ€ï¼Ÿ</h2><blockquote><p>æœåŠ¡å™¨ä¸ä¿å­˜ç”¨æˆ·çš„ç™»å½•ä¿¡æ¯ï¼</p><p>å¾®æœåŠ¡é›†ç¾¤ä¸­çš„æ¯ä¸ªæœåŠ¡ï¼Œå¯¹å¤–æä¾›çš„éƒ½æ˜¯Resté£æ ¼çš„æ¥å£ã€‚è€ŒResté£æ ¼çš„ä¸€ä¸ªæœ€é‡è¦çš„è§„èŒƒå°±æ˜¯ï¼šæœåŠ¡çš„æ— çŠ¶æ€æ€§ï¼Œå³ï¼š</p><ul><li><strong>æœåŠ¡ç«¯ä¸ä¿å­˜ä»»ä½•å®¢æˆ·ç«¯è¯·æ±‚è€…ä¿¡æ¯</strong></li><li>å®¢æˆ·ç«¯çš„æ¯æ¬¡è¯·æ±‚å¿…é¡»å…·å¤‡è‡ªæè¿°ä¿¡æ¯ï¼ˆjwtï¼‰ï¼Œé€šè¿‡è¿™äº›ä¿¡æ¯è¯†åˆ«å®¢æˆ·ç«¯èº«ä»½</li></ul></blockquote><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ— çŠ¶æ€ï¼š tokenæ˜¯æ— çŠ¶æ€ï¼Œsessionæ˜¯æœ‰çŠ¶æ€çš„</li><li>åŸºäºæ ‡å‡†åŒ–ï¼šä½ çš„APIå¯ä»¥é‡‡ç”¨æ ‡å‡†åŒ–çš„ JSON Web Token (JWT)</li><li>å®¢æˆ·ç«¯è¯·æ±‚ä¸ä¾èµ–æœåŠ¡ç«¯çš„ä¿¡æ¯ï¼Œä»»ä½•å¤šæ¬¡è¯·æ±‚ä¸éœ€è¦å¿…é¡»è®¿é—®åˆ°åŒä¸€å°æœåŠ¡</li><li>æœåŠ¡ç«¯çš„é›†ç¾¤å’ŒçŠ¶æ€å¯¹å®¢æˆ·ç«¯é€æ˜</li><li>æœåŠ¡ç«¯å¯ä»¥ä»»æ„çš„è¿ç§»å’Œä¼¸ç¼©</li><li>å‡å°æœåŠ¡ç«¯å­˜å‚¨å‹åŠ›</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å ç”¨å¸¦å®½</li><li>æ— æ³•åœ¨æœåŠ¡å™¨ç«¯é”€æ¯</li></ul><h1 id="äºŒã€å¸¸è§ç™»å½•æ–¹å¼"><a href="#äºŒã€å¸¸è§ç™»å½•æ–¹å¼" class="headerlink" title="äºŒã€å¸¸è§ç™»å½•æ–¹å¼"></a>äºŒã€å¸¸è§ç™»å½•æ–¹å¼</h1><h2 id="2-1ã€å•ä¸€æœåŠ¡å™¨æ¨¡å¼"><a href="#2-1ã€å•ä¸€æœåŠ¡å™¨æ¨¡å¼" class="headerlink" title="2.1ã€å•ä¸€æœåŠ¡å™¨æ¨¡å¼"></a>2.1ã€å•ä¸€æœåŠ¡å™¨æ¨¡å¼</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205210527.png" alt="image-20210205210527360"></p><p><strong>ä¸€èˆ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š</strong></p><ol><li>ç”¨æˆ·å‘æœåŠ¡å™¨å‘é€ç”¨æˆ·åå’Œå¯†ç ã€‚</li><li>éªŒè¯æœåŠ¡å™¨åï¼Œç›¸å…³æ•°æ®ï¼ˆå¦‚ç”¨æˆ·åï¼Œç”¨æˆ·è§’è‰²ç­‰ï¼‰å°†ä¿å­˜åœ¨å½“å‰ä¼šè¯ï¼ˆsessionï¼‰ä¸­ã€‚</li><li>æœåŠ¡å™¨å‘ç”¨æˆ·è¿”å›session_idï¼Œsessionä¿¡æ¯éƒ½ä¼šå†™å…¥åˆ°ç”¨æˆ·çš„Cookieã€‚</li><li>ç”¨æˆ·çš„æ¯ä¸ªåç»­è¯·æ±‚éƒ½å°†é€šè¿‡åœ¨Cookieä¸­å–å‡ºsession_idä¼ ç»™æœåŠ¡å™¨ã€‚</li><li>æœåŠ¡å™¨æ”¶åˆ°session_idå¹¶å¯¹æ¯”ä¹‹å‰ä¿å­˜çš„æ•°æ®ï¼Œç¡®è®¤ç”¨æˆ·çš„èº«ä»½ã€‚</li></ol><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å•ç‚¹æ€§èƒ½å‹åŠ›ï¼Œæ— æ³•æ‰©å±•ã€‚</li><li>åˆ†å¸ƒå¼æ¶æ„ä¸­ï¼Œéœ€è¦sessionå…±äº«æ–¹æ¡ˆï¼Œsessionå…±äº«æ–¹æ¡ˆå­˜åœ¨æ€§èƒ½ç“¶é¢ˆã€‚</li></ul><h2 id="2-2ã€å•ç‚¹ç™»å½•ï¼ˆSingle-Sign-Onï¼‰"><a href="#2-2ã€å•ç‚¹ç™»å½•ï¼ˆSingle-Sign-Onï¼‰" class="headerlink" title="2.2ã€å•ç‚¹ç™»å½•ï¼ˆSingle  Sign  Onï¼‰"></a>2.2ã€å•ç‚¹ç™»å½•ï¼ˆSingle  Sign  Onï¼‰</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205210648.png" alt="image-20210205210648124"></p><p>åˆ†å¸ƒå¼ï¼ŒSSO(single sign on)æ¨¡å¼ï¼šå•ç‚¹ç™»å½•è‹±æ–‡å…¨ç§°Single Sign Onï¼Œç®€ç§°å°±æ˜¯SSOã€‚å®ƒçš„è§£é‡Šæ˜¯ï¼šåœ¨å¤šä¸ªåº”ç”¨ç³»ç»Ÿä¸­ï¼Œåªéœ€è¦ç™»å½•ä¸€æ¬¡ï¼Œå°±å¯ä»¥è®¿é—®å…¶ä»–ç›¸äº’ä¿¡ä»»çš„åº”ç”¨ç³»ç»Ÿã€‚</p><ul><li>å¦‚å›¾æ‰€ç¤ºï¼Œå›¾ä¸­æœ‰3ä¸ªç³»ç»Ÿï¼Œåˆ†åˆ«æ˜¯ä¸šåŠ¡Aã€ä¸šåŠ¡Bã€å’ŒSSOã€‚</li><li>ä¸šåŠ¡Aã€ä¸šåŠ¡Bæ²¡æœ‰ç™»å½•æ¨¡å—ã€‚</li><li>è€ŒSSOåªæœ‰ç™»å½•æ¨¡å—ï¼Œæ²¡æœ‰å…¶ä»–çš„ä¸šåŠ¡æ¨¡å—ã€‚</li></ul><p><strong>ä¸€èˆ¬è¿‡ç¨‹å¦‚ä¸‹ï¼š</strong></p><ol><li>å½“ä¸šåŠ¡Aã€ä¸šåŠ¡Béœ€è¦ç™»å½•æ—¶ï¼Œå°†è·³åˆ°SSOç³»ç»Ÿã€‚</li><li>SSOä»ç”¨æˆ·ä¿¡æ¯æ•°æ®åº“ä¸­è·å–ç”¨æˆ·ä¿¡æ¯å¹¶æ ¡éªŒç”¨æˆ·ä¿¡æ¯ï¼ŒSSOç³»ç»Ÿå®Œæˆç™»å½•ã€‚</li><li>ç„¶åå°†ç”¨æˆ·ä¿¡æ¯å­˜å…¥ç¼“å­˜ï¼ˆä¾‹å¦‚redisï¼‰ã€‚</li><li>å½“ç”¨æˆ·è®¿é—®ä¸šåŠ¡Aæˆ–ä¸šåŠ¡Bï¼Œéœ€è¦åˆ¤æ–­ç”¨æˆ·æ˜¯å¦ç™»å½•æ—¶ï¼Œå°†è·³è½¬åˆ°SSOç³»ç»Ÿä¸­è¿›è¡Œç”¨æˆ·èº«ä»½éªŒè¯ï¼ŒSSOåˆ¤æ–­ç¼“å­˜ä¸­æ˜¯å¦å­˜åœ¨ç”¨æˆ·èº«ä»½ä¿¡æ¯ã€‚</li><li>è¿™æ ·ï¼Œåªè¦å…¶ä¸­ä¸€ä¸ªç³»ç»Ÿå®Œæˆç™»å½•ï¼Œå…¶ä»–çš„åº”ç”¨ç³»ç»Ÿä¹Ÿå°±éšä¹‹ç™»å½•äº†ã€‚è¿™å°±æ˜¯å•ç‚¹ç™»å½•ï¼ˆSSOï¼‰çš„å®šä¹‰ã€‚</li></ol><p><strong>ä¼˜ç‚¹ ï¼š</strong>  </p><p>ç”¨æˆ·èº«ä»½ä¿¡æ¯ç‹¬ç«‹ç®¡ç†ï¼Œæ›´å¥½çš„åˆ†å¸ƒå¼ç®¡ç†ã€‚å¯ä»¥è‡ªå·±æ‰©å±•å®‰å…¨ç­–ç•¥</p><p><strong>ç¼ºç‚¹ï¼š</strong></p><p>è®¤è¯æœåŠ¡å™¨è®¿é—®å‹åŠ›è¾ƒå¤§ã€‚</p><h2 id="2-3ã€Tokenæ¨¡å¼"><a href="#2-3ã€Tokenæ¨¡å¼" class="headerlink" title="2.3ã€Tokenæ¨¡å¼"></a>2.3ã€Tokenæ¨¡å¼</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205210734.png" alt="image-20210205210734269"></p><p><strong>ä¼˜ç‚¹ï¼š</strong></p><ul><li>æ— çŠ¶æ€ï¼š tokenæ˜¯æ— çŠ¶æ€ï¼Œsessionæ˜¯æœ‰çŠ¶æ€çš„</li><li>åŸºäºæ ‡å‡†åŒ–ï¼šä½ çš„APIå¯ä»¥é‡‡ç”¨æ ‡å‡†åŒ–çš„ JSON Web Token (JWT)</li></ul><p><strong>ç¼ºç‚¹ï¼š</strong></p><ul><li>å ç”¨å¸¦å®½</li><li>æ— æ³•åœ¨æœåŠ¡å™¨ç«¯é”€æ¯</li></ul><blockquote><p>æ— çŠ¶æ€ç™»å½•çš„æµç¨‹ï¼š</p></blockquote><ul><li>å½“å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚æœåŠ¡æ—¶ï¼ŒæœåŠ¡ç«¯å¯¹ç”¨æˆ·è¿›è¡Œä¿¡æ¯è®¤è¯ï¼ˆç™»å½•ï¼‰</li><li>è®¤è¯é€šè¿‡ï¼Œå°†ç”¨æˆ·ä¿¡æ¯è¿›è¡ŒåŠ å¯†å½¢æˆtokenï¼Œè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œä½œä¸ºç™»å½•å‡­è¯</li><li>ä»¥åæ¯æ¬¡è¯·æ±‚ï¼Œå®¢æˆ·ç«¯éƒ½æºå¸¦è®¤è¯çš„token</li><li>æœåŠ¡çš„å¯¹tokenè¿›è¡Œè§£å¯†ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰æ•ˆã€‚</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205211358.png" alt="image-20210205211358667"></p><p>æ•´ä¸ªç™»å½•è¿‡ç¨‹ä¸­ï¼Œæœ€å…³é”®çš„ç‚¹æ˜¯ä»€ä¹ˆï¼Ÿ</p><p><strong>tokençš„å®‰å…¨æ€§</strong></p><h1 id="ä¸‰ã€JWT"><a href="#ä¸‰ã€JWT" class="headerlink" title="ä¸‰ã€JWT"></a>ä¸‰ã€JWT</h1><h2 id="3-1ã€ä»€ä¹ˆæ˜¯JWTä»¤ç‰Œ"><a href="#3-1ã€ä»€ä¹ˆæ˜¯JWTä»¤ç‰Œ" class="headerlink" title="3.1ã€ä»€ä¹ˆæ˜¯JWTä»¤ç‰Œ"></a>3.1ã€ä»€ä¹ˆæ˜¯JWTä»¤ç‰Œ</h2><blockquote><p>JWTæ˜¯JSON Web Tokençš„ç¼©å†™ï¼Œå³JSON Webä»¤ç‰Œï¼Œæ˜¯ä¸€ç§è‡ªåŒ…å«ä»¤ç‰Œã€‚ </p></blockquote><h3 id="1ã€ä½¿ç”¨åœºæ™¯"><a href="#1ã€ä½¿ç”¨åœºæ™¯" class="headerlink" title="1ã€ä½¿ç”¨åœºæ™¯"></a>1ã€ä½¿ç”¨åœºæ™¯</h3><ul><li>ä¸€ç§æƒ…å†µæ˜¯webapiï¼Œç±»ä¼¼é˜¿é‡Œäº‘æ’­æ”¾å‡­è¯çš„åŠŸèƒ½ã€‚</li><li>å¦ä¸€ç§æƒ…å†µæ˜¯å¤šwebæœåŠ¡å™¨ä¸‹å®ç°æ— çŠ¶æ€åˆ†å¸ƒå¼èº«ä»½éªŒè¯ã€‚</li></ul><h3 id="2ã€äº¤äº’æµç¨‹"><a href="#2ã€äº¤äº’æµç¨‹" class="headerlink" title="2ã€äº¤äº’æµç¨‹"></a>2ã€äº¤äº’æµç¨‹</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205211838.png" alt="image-20210205211838506"></p><p>æ­¥éª¤ç¿»è¯‘ï¼š</p><ul><li>1ã€ç”¨æˆ·ç™»å½•</li><li>2ã€æœåŠ¡çš„è®¤è¯ï¼Œé€šè¿‡åæ ¹æ®secretç”Ÿæˆtoken</li><li>3ã€å°†ç”Ÿæˆçš„tokenè¿”å›ç»™æµè§ˆå™¨</li><li>4ã€ç”¨æˆ·æ¯æ¬¡è¯·æ±‚æºå¸¦token</li><li>5ã€æœåŠ¡ç«¯åˆ©ç”¨å…¬é’¥è§£è¯»jwtç­¾åï¼Œåˆ¤æ–­ç­¾åæœ‰æ•ˆåï¼Œä»Payloadä¸­è·å–ç”¨æˆ·ä¿¡æ¯</li><li>6ã€å¤„ç†è¯·æ±‚ï¼Œè¿”å›å“åº”ç»“æœ</li></ul><p>å› ä¸ºJWTç­¾å‘çš„tokenä¸­å·²ç»åŒ…å«äº†ç”¨æˆ·çš„èº«ä»½ä¿¡æ¯ï¼Œå¹¶ä¸”æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæºå¸¦ï¼Œè¿™æ ·æœåŠ¡çš„å°±æ— éœ€ä¿å­˜ç”¨æˆ·ä¿¡æ¯ï¼Œç”šè‡³æ— éœ€å»æ•°æ®åº“æŸ¥è¯¢ï¼Œå®Œå…¨ç¬¦åˆäº†Restçš„æ— çŠ¶æ€è§„èŒƒã€‚</p><h3 id="3ã€ä½œç”¨"><a href="#3ã€ä½œç”¨" class="headerlink" title="3ã€ä½œç”¨"></a>3ã€ä½œç”¨</h3><blockquote><p>JWT æœ€é‡è¦çš„ä½œç”¨å°±æ˜¯å¯¹ tokenä¿¡æ¯çš„é˜²ä¼ªä½œç”¨</p></blockquote><h3 id="4ã€åŸç†"><a href="#4ã€åŸç†" class="headerlink" title="4ã€åŸç†"></a>4ã€åŸç†</h3><ul><li>ä¸€ä¸ªJWTç”±ä¸‰ä¸ªéƒ¨åˆ†ç»„æˆï¼šJWTå¤´ã€æœ‰æ•ˆè½½è·ã€ç­¾åå“ˆå¸Œ</li><li>æœ€åç”±è¿™ä¸‰è€…ç»„åˆè¿›è¡Œbase64ç¼–ç å¾—åˆ°JWT</li></ul><h2 id="3-2ã€JWTä»¤ç‰Œçš„ç»„æˆ"><a href="#3-2ã€JWTä»¤ç‰Œçš„ç»„æˆ" class="headerlink" title="3.2ã€JWTä»¤ç‰Œçš„ç»„æˆ"></a>3.2ã€JWTä»¤ç‰Œçš„ç»„æˆ</h2><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205212928.png" alt="image-20210205212928770"></p><p><strong>JWTå¤´</strong></p><p>JWTå¤´éƒ¨åˆ†æ˜¯ä¸€ä¸ªæè¿°JWTå…ƒæ•°æ®çš„JSONå¯¹è±¡ï¼Œé€šå¸¸å¦‚ä¸‹æ‰€ç¤ºã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;alg&quot;: &quot;HS256&quot;,</span><br><span class="line">  &quot;typ&quot;: &quot;JWT&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ä¸Šé¢çš„ä»£ç ä¸­ï¼Œalgå±æ€§è¡¨ç¤ºç­¾åä½¿ç”¨çš„ç®—æ³•ï¼Œé»˜è®¤ä¸ºHMAC SHA256ï¼ˆå†™ä¸ºHS256ï¼‰ï¼›typå±æ€§è¡¨ç¤ºä»¤ç‰Œçš„ç±»å‹ï¼ŒJWTä»¤ç‰Œç»Ÿä¸€å†™ä¸ºJWTã€‚æœ€åï¼Œä½¿ç”¨Base64 URLç®—æ³•å°†ä¸Šè¿°JSONå¯¹è±¡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ä¿å­˜ã€‚</p><p><strong>æœ‰æ•ˆè½½è·</strong></p><p>æœ‰æ•ˆè½½è·éƒ¨åˆ†ï¼Œæ˜¯JWTçš„ä¸»ä½“å†…å®¹éƒ¨åˆ†ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªJSONå¯¹è±¡ï¼ŒåŒ…å«éœ€è¦ä¼ é€’çš„æ•°æ®ã€‚ JWTæŒ‡å®šä¸ƒä¸ªé»˜è®¤å­—æ®µä¾›é€‰æ‹©ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">iss: jwtç­¾å‘è€…</span><br><span class="line">sub: ä¸»é¢˜</span><br><span class="line">aud: æ¥æ”¶jwtçš„ä¸€æ–¹</span><br><span class="line">exp: jwtçš„è¿‡æœŸæ—¶é—´ï¼Œè¿™ä¸ªè¿‡æœŸæ—¶é—´å¿…é¡»è¦å¤§äºç­¾å‘æ—¶é—´</span><br><span class="line">nbf: å®šä¹‰åœ¨ä»€ä¹ˆæ—¶é—´ä¹‹å‰ï¼Œè¯¥jwtéƒ½æ˜¯ä¸å¯ç”¨çš„.</span><br><span class="line">iat: jwtçš„ç­¾å‘æ—¶é—´</span><br><span class="line">jti: jwtçš„å”¯ä¸€èº«ä»½æ ‡è¯†ï¼Œä¸»è¦ç”¨æ¥ä½œä¸ºä¸€æ¬¡æ€§token,ä»è€Œå›é¿é‡æ”¾æ”»å‡»ã€‚</span><br></pre></td></tr></table></figure><p>é™¤ä»¥ä¸Šé»˜è®¤å­—æ®µå¤–ï¼Œæˆ‘ä»¬è¿˜å¯ä»¥è‡ªå®šä¹‰ç§æœ‰å­—æ®µï¼Œå¦‚ä¸‹ä¾‹ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  &quot;name&quot;: &quot;Helen&quot;,</span><br><span class="line">  &quot;admin&quot;: true,</span><br><span class="line">  &quot;avatar&quot;: &quot;helen.jpg&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¯·æ³¨æ„ï¼Œé»˜è®¤æƒ…å†µä¸‹JWTæ˜¯æœªåŠ å¯†çš„ï¼Œä»»ä½•äººéƒ½å¯ä»¥è§£è¯»å…¶å†…å®¹ï¼Œå› æ­¤ä¸è¦æ„å»ºéšç§ä¿¡æ¯å­—æ®µï¼Œå­˜æ”¾ä¿å¯†ä¿¡æ¯ï¼Œä»¥é˜²æ­¢ä¿¡æ¯æ³„éœ²ã€‚</p><p>JSONå¯¹è±¡ä¹Ÿä½¿ç”¨Base64 URLç®—æ³•è½¬æ¢ä¸ºå­—ç¬¦ä¸²ä¿å­˜ã€‚</p><p><strong>ç­¾åå“ˆå¸Œ</strong></p><p>ç­¾åå“ˆå¸Œéƒ¨åˆ†æ˜¯å¯¹ä¸Šé¢ä¸¤éƒ¨åˆ†æ•°æ®ç­¾åï¼Œé€šè¿‡æŒ‡å®šçš„ç®—æ³•ç”Ÿæˆå“ˆå¸Œï¼Œä»¥ç¡®ä¿æ•°æ®ä¸ä¼šè¢«ç¯¡æ”¹ã€‚</p><p>é¦–å…ˆï¼Œéœ€è¦æŒ‡å®šä¸€ä¸ªå¯†ç ï¼ˆsecretï¼‰ã€‚è¯¥å¯†ç ä»…ä»…ä¸ºä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œå¹¶ä¸”ä¸èƒ½å‘ç”¨æˆ·å…¬å¼€ã€‚ç„¶åï¼Œä½¿ç”¨æ ‡å¤´ä¸­æŒ‡å®šçš„ç­¾åç®—æ³•ï¼ˆé»˜è®¤æƒ…å†µä¸‹ä¸ºHMAC SHA256ï¼‰æ ¹æ®ä»¥ä¸‹å…¬å¼ç”Ÿæˆç­¾åã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">HMACSHA256(base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(claims), secret)</span><br></pre></td></tr></table></figure><p>åœ¨è®¡ç®—å‡ºç­¾åå“ˆå¸Œåï¼ŒJWTå¤´ï¼Œæœ‰æ•ˆè½½è·å’Œç­¾åå“ˆå¸Œçš„ä¸‰ä¸ªéƒ¨åˆ†ç»„åˆæˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œæ¯ä¸ªéƒ¨åˆ†ç”¨â€.â€åˆ†éš”ï¼Œå°±æ„æˆæ•´ä¸ªJWTå¯¹è±¡ã€‚</p><p><strong>Base64URLç®—æ³•</strong></p><p>å¦‚å‰æ‰€è¿°ï¼ŒJWTå¤´å’Œæœ‰æ•ˆè½½è·åºåˆ—åŒ–çš„ç®—æ³•éƒ½ç”¨åˆ°äº†Base64URLã€‚è¯¥ç®—æ³•å’Œå¸¸è§Base64ç®—æ³•ç±»ä¼¼ï¼Œç¨æœ‰å·®åˆ«ã€‚</p><p>ä½œä¸ºä»¤ç‰Œçš„JWTå¯ä»¥æ”¾åœ¨URLä¸­ï¼ˆä¾‹å¦‚api.example/?token=xxxï¼‰ã€‚ Base64ä¸­ç”¨çš„ä¸‰ä¸ªå­—ç¬¦æ˜¯â€+â€ï¼Œâ€/â€œå’Œâ€=â€ï¼Œç”±äºåœ¨URLä¸­æœ‰ç‰¹æ®Šå«ä¹‰ï¼Œå› æ­¤Base64URLä¸­å¯¹ä»–ä»¬åšäº†æ›¿æ¢ï¼šâ€=â€å»æ‰ï¼Œâ€+â€ç”¨â€-â€œæ›¿æ¢ï¼Œâ€/â€œç”¨â€_â€æ›¿æ¢ï¼Œè¿™å°±æ˜¯Base64URLç®—æ³•ã€‚</p><p><strong>æ³¨æ„ï¼š</strong>base64ç¼–ç ï¼Œå¹¶ä¸æ˜¯åŠ å¯†ï¼Œåªæ˜¯æŠŠæ˜æ–‡ä¿¡æ¯å˜æˆäº†ä¸å¯è§çš„å­—ç¬¦ä¸²ã€‚ä½†æ˜¯å…¶å®åªè¦ç”¨ä¸€äº›å·¥å…·å°±å¯ä»¥æŠŠbase64ç¼–ç è§£æˆæ˜æ–‡ï¼Œæ‰€ä»¥ä¸è¦åœ¨JWTä¸­æ”¾å…¥æ¶‰åŠç§å¯†çš„ä¿¡æ¯ã€‚</p><h2 id="3-3ã€JWTçš„ç”¨æ³•"><a href="#3-3ã€JWTçš„ç”¨æ³•" class="headerlink" title="3.3ã€JWTçš„ç”¨æ³•"></a>3.3ã€JWTçš„ç”¨æ³•</h2><blockquote><p>å®¢æˆ·ç«¯æ¥æ”¶æœåŠ¡å™¨è¿”å›çš„JWTï¼Œå°†å…¶å­˜å‚¨åœ¨Cookieæˆ–localStorageä¸­ã€‚</p><p>æ­¤åï¼Œå®¢æˆ·ç«¯å°†åœ¨ä¸æœåŠ¡å™¨äº¤äº’ä¸­éƒ½ä¼šå¸¦JWTã€‚å¦‚æœå°†å®ƒå­˜å‚¨åœ¨Cookieä¸­ï¼Œå°±å¯ä»¥è‡ªåŠ¨å‘é€ï¼Œä½†æ˜¯ä¸ä¼šè·¨åŸŸï¼Œå› æ­¤ä¸€èˆ¬æ˜¯å°†å®ƒæ”¾å…¥HTTPè¯·æ±‚çš„Header Authorizationå­—æ®µä¸­ã€‚</p><p>å½“è·¨åŸŸæ—¶ï¼Œä¹Ÿå¯ä»¥å°†JWTæ”¾ç½®äºPOSTè¯·æ±‚çš„æ•°æ®ä¸»ä½“ä¸­ã€‚</p></blockquote><h2 id="3-4ã€é—®é¢˜å’Œè¶‹åŠ¿"><a href="#3-4ã€é—®é¢˜å’Œè¶‹åŠ¿" class="headerlink" title="3.4ã€é—®é¢˜å’Œè¶‹åŠ¿"></a>3.4ã€é—®é¢˜å’Œè¶‹åŠ¿</h2><p>1ã€JWTé»˜è®¤ä¸åŠ å¯†ï¼Œä½†å¯ä»¥åŠ å¯†ã€‚ç”ŸæˆåŸå§‹ä»¤ç‰Œåï¼Œå¯ä»¥ä½¿ç”¨è¯¥ä»¤ç‰Œå†æ¬¡å¯¹å…¶è¿›è¡ŒåŠ å¯†ã€‚</p><p>2ã€å½“JWTæœªåŠ å¯†æ—¶ï¼Œä¸€äº›ç§å¯†æ•°æ®æ— æ³•é€šè¿‡JWTä¼ è¾“ã€‚</p><p>3ã€JWTä¸ä»…å¯ç”¨äºè®¤è¯ï¼Œè¿˜å¯ç”¨äºä¿¡æ¯äº¤æ¢ã€‚å–„ç”¨JWTæœ‰åŠ©äºå‡å°‘æœåŠ¡å™¨è¯·æ±‚æ•°æ®åº“çš„æ¬¡æ•°ã€‚</p><p>4ã€JWTçš„æœ€å¤§ç¼ºç‚¹æ˜¯æœåŠ¡å™¨ä¸ä¿å­˜ä¼šè¯çŠ¶æ€ï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨æœŸé—´ä¸å¯èƒ½å–æ¶ˆä»¤ç‰Œæˆ–æ›´æ”¹ä»¤ç‰Œçš„æƒé™ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸€æ—¦JWTç­¾å‘ï¼Œåœ¨æœ‰æ•ˆæœŸå†…å°†ä¼šä¸€ç›´æœ‰æ•ˆã€‚</p><p>5ã€JWTæœ¬èº«åŒ…å«è®¤è¯ä¿¡æ¯ï¼Œå› æ­¤ä¸€æ—¦ä¿¡æ¯æ³„éœ²ï¼Œä»»ä½•äººéƒ½å¯ä»¥è·å¾—ä»¤ç‰Œçš„æ‰€æœ‰æƒé™ã€‚ä¸ºäº†å‡å°‘ç›—ç”¨ï¼ŒJWTçš„æœ‰æ•ˆæœŸä¸å®œè®¾ç½®å¤ªé•¿ã€‚å¯¹äºæŸäº›é‡è¦æ“ä½œï¼Œç”¨æˆ·åœ¨ä½¿ç”¨æ—¶åº”è¯¥æ¯æ¬¡éƒ½è¿›è¡Œèº«ä»½éªŒè¯ã€‚</p><p>6ã€ä¸ºäº†å‡å°‘ç›—ç”¨å’Œçªƒå–ï¼ŒJWTä¸å»ºè®®ä½¿ç”¨HTTPåè®®æ¥ä¼ è¾“ä»£ç ï¼Œè€Œæ˜¯ä½¿ç”¨åŠ å¯†çš„HTTPSåè®®è¿›è¡Œä¼ è¾“ã€‚</p><h1 id="å››ã€ç”¨æˆ·èº«ä»½è®¤è¯"><a href="#å››ã€ç”¨æˆ·èº«ä»½è®¤è¯" class="headerlink" title="å››ã€ç”¨æˆ·èº«ä»½è®¤è¯"></a>å››ã€ç”¨æˆ·èº«ä»½è®¤è¯</h1><h2 id="4-1ã€å¼•å…¥ä¾èµ–"><a href="#4-1ã€å¼•å…¥ä¾èµ–" class="headerlink" title="4.1ã€å¼•å…¥ä¾èµ–"></a>4.1ã€å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.jsonwebtoken<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jjwt<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>joda-time<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-2ã€å¼•å…¥å·¥å…·ç±»å’Œç”¨æˆ·æœ‰æ•ˆè½½è·ç±»"><a href="#4-2ã€å¼•å…¥å·¥å…·ç±»å’Œç”¨æˆ·æœ‰æ•ˆè½½è·ç±»" class="headerlink" title="4.2ã€å¼•å…¥å·¥å…·ç±»å’Œç”¨æˆ·æœ‰æ•ˆè½½è·ç±»"></a>4.2ã€å¼•å…¥å·¥å…·ç±»å’Œç”¨æˆ·æœ‰æ•ˆè½½è·ç±»</h2><blockquote><p>JwtUtils.javaï¼Œç”¨äºæ ¹æ®<strong>ç”¨æˆ·ä¿¡æ¯</strong>ç”Ÿæˆ<strong>token</strong>ã€åˆ¤æ–­tokenæ˜¯å¦æœ‰æ•ˆçš„å·¥å…·ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String APP_SECRET = <span class="string">&quot;ukc8BDbRigUDaY6pZFfWus2jZWLPHO&quot;</span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> Key <span class="title">getKeyInstance</span><span class="params">()</span></span>&#123;</span><br><span class="line">        SignatureAlgorithm signatureAlgorithm = SignatureAlgorithm.HS256;</span><br><span class="line">        <span class="keyword">byte</span>[] bytes = DatatypeConverter.parseBase64Binary(APP_SECRET);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> SecretKeySpec(bytes,signatureAlgorithm.getJcaName());</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getJwtToken</span><span class="params">(JwtInfo jwtInfo, <span class="keyword">int</span> expire)</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        String JwtToken = Jwts.builder()</span><br><span class="line">                .setHeaderParam(<span class="string">&quot;typ&quot;</span>, <span class="string">&quot;JWT&quot;</span>)</span><br><span class="line">                .setHeaderParam(<span class="string">&quot;alg&quot;</span>, <span class="string">&quot;HS256&quot;</span>)</span><br><span class="line">                .setSubject(<span class="string">&quot;guli-user&quot;</span>)<span class="comment">//ä¸»é¢˜</span></span><br><span class="line">                .setIssuedAt(<span class="keyword">new</span> Date())<span class="comment">//é¢å‘æ—¶é—´</span></span><br><span class="line">                .setExpiration(DateTime.now().plusSeconds(expire).toDate())<span class="comment">//è¿‡æœŸæ—¶é—´</span></span><br><span class="line">                .claim(<span class="string">&quot;id&quot;</span>, jwtInfo.getId())<span class="comment">//ç”¨æˆ·id</span></span><br><span class="line">                .claim(<span class="string">&quot;nickname&quot;</span>, jwtInfo.getNickname())<span class="comment">//ç”¨æˆ·æ˜µç§°</span></span><br><span class="line">                .claim(<span class="string">&quot;avatar&quot;</span>, jwtInfo.getAvatar())<span class="comment">//ç”¨æˆ·å¤´åƒ</span></span><br><span class="line">                .signWith(SignatureAlgorithm.HS256, getKeyInstance())</span><br><span class="line">                .compact();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> JwtToken;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> jwtToken</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkJwtTToken</span><span class="params">(String jwtToken)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(jwtToken)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­tokenæ˜¯å¦å­˜åœ¨ä¸æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">checkJwtTToken</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String jwtToken = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">            <span class="keyword">if</span>(StringUtils.isEmpty(jwtToken)) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®tokenè·å–ä¼šå‘˜id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> request</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> JwtInfo <span class="title">getMemberIdByJwtToken</span><span class="params">(HttpServletRequest request)</span> </span>&#123;</span><br><span class="line">        String jwtToken = request.getHeader(<span class="string">&quot;token&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isEmpty(jwtToken)) <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        Jws&lt;Claims&gt; claimsJws = Jwts.parser().setSigningKey(getKeyInstance()).parseClaimsJws(jwtToken);</span><br><span class="line">        Claims claims = claimsJws.getBody();</span><br><span class="line">        JwtInfo jwtInfo = <span class="keyword">new</span> JwtInfo(claims.get(<span class="string">&quot;id&quot;</span>).toString(), claims.get(<span class="string">&quot;nickname&quot;</span>).toString(), claims.get(<span class="string">&quot;avatar&quot;</span>).toString());</span><br><span class="line">        <span class="keyword">return</span> jwtInfo;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>JwtInfoï¼Œå­˜æ”¾ç”¨æˆ·çš„æœ‰æ•ˆä¿¡æ¯</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">JwtInfo</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String nickname;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="comment">//æƒé™ã€è§’è‰²ç­‰</span></span><br><span class="line">    <span class="comment">//ä¸è¦å­˜æ•æ„Ÿä¿¡æ¯</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3ã€å®šä¹‰LoginVo"><a href="#4-3ã€å®šä¹‰LoginVo" class="headerlink" title="4.3ã€å®šä¹‰LoginVo"></a>4.3ã€å®šä¹‰LoginVo</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LoginVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String mobile;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4ã€å®šä¹‰æ§åˆ¶å±‚æ¥å£"><a href="#4-4ã€å®šä¹‰æ§åˆ¶å±‚æ¥å£" class="headerlink" title="4.4ã€å®šä¹‰æ§åˆ¶å±‚æ¥å£"></a>4.4ã€å®šä¹‰æ§åˆ¶å±‚æ¥å£</h2><blockquote><p>è¯¥æ¥å£æ¥æ”¶Serviceå±‚ç”Ÿæˆçš„Tokenï¼Œç„¶åå°†tokenè¿”å›è‡³å‰ç«¯</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@ApiOperation(value = &quot;ä¼šå‘˜ç™»å½•&quot;)</span></span><br><span class="line"><span class="meta">@PostMapping(&quot;login&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">login</span><span class="params">(<span class="meta">@RequestBody</span> LoginVo loginVo)</span> </span>&#123;</span><br><span class="line">    String token = memberService.login(loginVo);</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;token&quot;</span>, token);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-5ã€å®šä¹‰Serviceå±‚"><a href="#4-5ã€å®šä¹‰Serviceå±‚" class="headerlink" title="4.5ã€å®šä¹‰Serviceå±‚"></a>4.5ã€å®šä¹‰Serviceå±‚</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> String <span class="title">login</span><span class="params">(LoginVo loginVo)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    String mobile = loginVo.getMobile();</span><br><span class="line">    String password = loginVo.getPassword();</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¡éªŒå‚æ•°</span></span><br><span class="line">    <span class="keyword">if</span> (StringUtils.isEmpty(mobile)</span><br><span class="line">        || !FormUtils.isMobile(mobile)</span><br><span class="line">        || StringUtils.isEmpty(password)) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> GuliException(ResultCodeEnum.PARAM_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¡éªŒæ‰‹æœºå·</span></span><br><span class="line">    QueryWrapper&lt;Member&gt; queryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    queryWrapper.eq(<span class="string">&quot;mobile&quot;</span>, mobile);</span><br><span class="line">    Member member = baseMapper.selectOne(queryWrapper);</span><br><span class="line">    <span class="keyword">if</span>(member == <span class="keyword">null</span>)&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> GuliException(ResultCodeEnum.LOGIN_MOBLE_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ ¡éªŒå¯†ç </span></span><br><span class="line">    <span class="keyword">if</span>(!MD5.encrypt(password).equals(member.getPassword()))&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> GuliException(ResultCodeEnum.LOGIN_PASSWORD_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ£€éªŒç”¨æˆ·æ˜¯å¦è¢«ç¦ç”¨</span></span><br><span class="line">    <span class="keyword">if</span>(member.getDisabled())&#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> GuliException(ResultCodeEnum.LOGIN_DISABLED_ERROR);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    JwtInfo jwtInfo = <span class="keyword">new</span> JwtInfo();</span><br><span class="line">    jwtInfo.setId(member.getId());</span><br><span class="line">    jwtInfo.setNickname(member.getNickname());</span><br><span class="line">    jwtInfo.setAvatar(member.getAvatar());</span><br><span class="line">    String jwtToken = JwtUtils.getJwtToken(jwtInfo, <span class="number">1800</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> jwtToken;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-6ã€æµ‹è¯•"><a href="#4-6ã€æµ‹è¯•" class="headerlink" title="4.6ã€æµ‹è¯•"></a>4.6ã€æµ‹è¯•</h2><blockquote><p>å¾€æ•°æ®åº“ä¸­æ’å…¥ä¸€æ¡æµ‹è¯•æ•°æ®ï¼Œmobileä¸º13711111111ï¼Œå¯†ç ä¸º123</p></blockquote><blockquote><p>æ‰“å¼€swaggerï¼Œè¿›è¡Œæµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205215334.png" alt="image-20210205215334387"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205215350.png" alt="image-20210205215350880"></p><blockquote><p>å½“mobileå’Œå¯†ç å‡è¾“å…¥æ— è¯¯æ—¶ï¼Œåç«¯ä¼šè¿”å›ä¸€ä¸ªtoken</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205215435.png" alt="image-20210205215435940"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205215449.png" alt="image-20210205215449715"></p>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸ†”JWT </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ï¼ˆä¸‰ï¼‰-äºŒå‰æ’åºæ ‘è¯¦è§£</title>
      <link href="posts/3310991137.html"/>
      <url>posts/3310991137.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€ç®€ä»‹"><a href="#ä¸€ã€ç®€ä»‹" class="headerlink" title="ä¸€ã€ç®€ä»‹"></a>ä¸€ã€ç®€ä»‹</h1><blockquote><p><strong>äºŒå‰æ’åºæ ‘</strong>äº¦ç§°<strong>äºŒå‰æŸ¥æ‰¾æ ‘</strong>ï¼Œæ˜¯æ ‘å½¢æ•°æ®ç»“æ„çš„ä¸€ç§ï¼Œåœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼ŒäºŒå‰æ’åºæ ‘çš„æŸ¥æ‰¾æ•ˆç‡è¦<strong>é«˜äº</strong>æ™®é€šé“¾è¡¨ï¼Œå®ƒè¦ä¹ˆæ˜¯ä¸€æ£µç©ºæ ‘ï¼Œè¦ä¹ˆå…·æœ‰ä»¥ä¸‹æ€§è´¨ï¼š</p><ul><li>è‹¥å®ƒçš„å·¦å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™<strong>å·¦å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å°äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼</strong>ï¼›</li><li>è‹¥å®ƒçš„å³å­æ ‘ä¸ä¸ºç©ºï¼Œåˆ™<strong>å³å­æ ‘ä¸Šæ‰€æœ‰ç»“ç‚¹çš„å€¼å‡å¤§äºå®ƒçš„æ ¹ç»“ç‚¹çš„å€¼</strong>ï¼›</li><li><strong>å®ƒçš„å·¦ã€å³å­æ ‘åˆ†åˆ«ä¸ºäºŒå‰æ’åºæ ‘</strong>ã€‚</li><li>ä¸‹é¢æ˜¯ä¸€æ£µæ ‡å‡†çš„äºŒå‰æ’åºæ ‘</li></ul></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205180351.png" alt="image-20210205180344323"></p><h1 id="äºŒã€äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆä¸èŠ‚ç‚¹æ’å…¥"><a href="#äºŒã€äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆä¸èŠ‚ç‚¹æ’å…¥" class="headerlink" title="äºŒã€äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆä¸èŠ‚ç‚¹æ’å…¥"></a>äºŒã€äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆä¸èŠ‚ç‚¹æ’å…¥</h1><h2 id="2-1ã€ç”Ÿæˆ"><a href="#2-1ã€ç”Ÿæˆ" class="headerlink" title="2.1ã€ç”Ÿæˆ"></a>2.1ã€ç”Ÿæˆ</h2><h3 id="1ã€åˆ›å»ºNodeç±»å’ŒTreeç±»"><a href="#1ã€åˆ›å»ºNodeç±»å’ŒTreeç±»" class="headerlink" title="1ã€åˆ›å»ºNodeç±»å’ŒTreeç±»"></a>1ã€åˆ›å»ºNodeç±»å’ŒTreeç±»</h3><blockquote><p>åˆ›å»ºä¸€ä¸ª<strong>Node</strong>ç±»ä½œä¸ºäºŒå‰æ’åºæ ‘çš„<strong>èŠ‚ç‚¹ç±»</strong>ï¼Œè¿™é‡Œçœç•¥getterã€setterå’ŒtoStringæ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    <span class="comment">// èŠ‚ç‚¹çš„å€¼</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="comment">// å½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹</span></span><br><span class="line">    Node left;</span><br><span class="line">    <span class="comment">// å½“å‰èŠ‚ç‚¹çš„å³å­èŠ‚ç‚¹</span></span><br><span class="line">    Node right;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><blockquote><p>åˆ›å»ºä¸€ä¸ª<strong>Tree</strong>ç±»ï¼Œè¿™ä¸ªç±»åŒ…å«ä¸€ä¸ªNodeç±»å‹çš„rootå±æ€§ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Tree</span> </span>&#123;</span><br><span class="line">    <span class="comment">// å½“å‰æ ‘çš„æ ¹èŠ‚ç‚¹</span></span><br><span class="line">    Node root;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><h3 id="2ã€ç”Ÿæˆæ€è·¯"><a href="#2ã€ç”Ÿæˆæ€è·¯" class="headerlink" title="2ã€ç”Ÿæˆæ€è·¯"></a>2ã€ç”Ÿæˆæ€è·¯</h3><blockquote><p>æ—¢å¯ä»¥åœ¨åˆ›å»ºäºŒå‰æ ‘å¯¹è±¡æ—¶ç›´æ¥ä½¿ç”¨æœ‰å‚æ„é€ å‡½æ•°ä¼ å…¥æ ¹èŠ‚ç‚¹å¯¹è±¡ï¼Œä¹Ÿå¯ä»¥åœ¨æ·»åŠ èŠ‚ç‚¹æ—¶æ‰æ’å…¥rootèŠ‚ç‚¹</p><p>æ³¨ï¼šå½“ä¸€æ£µæ ‘rootèŠ‚ç‚¹ä¸ºç©ºæ—¶ï¼Œç¬¬ä¸€ä¸ªæ’å…¥è¯¥æ ‘çš„èŠ‚ç‚¹å°±æ˜¯æ ¹èŠ‚ç‚¹ã€‚</p></blockquote><h2 id="2ã€èŠ‚ç‚¹æ’å…¥"><a href="#2ã€èŠ‚ç‚¹æ’å…¥" class="headerlink" title="2ã€èŠ‚ç‚¹æ’å…¥"></a>2ã€èŠ‚ç‚¹æ’å…¥</h2><h3 id="1ã€æ€è·¯"><a href="#1ã€æ€è·¯" class="headerlink" title="1ã€æ€è·¯"></a>1ã€æ€è·¯</h3><blockquote><p>åœ¨Treeç±»ä¸­æ·»åŠ ä¸€ä¸ªaddNodeæ–¹æ³•ï¼Œ<strong>å¦‚æœå½“å‰æ ‘çš„æ ¹èŠ‚ç‚¹ä¸ºç©ºï¼Œé‚£ä¹ˆå°†è¦æ·»åŠ åˆ°äºŒå‰æ’åºæ ‘çš„èŠ‚ç‚¹è®¾ç½®ä¸ºæ ¹èŠ‚ç‚¹</strong>ï¼Œå¦åˆ™å°±<strong>è°ƒç”¨rootèŠ‚ç‚¹å¯¹è±¡çš„addæ–¹æ³•</strong>ï¼Œåœ¨rootå¯¹è±¡çš„addæ–¹æ³•ä¸­ï¼š</p><ul><li>  å¦‚æœä¼ å…¥è¦æ·»åŠ çš„èŠ‚ç‚¹nodeä¸ºç©ºï¼Œé‚£ä¹ˆç›´æ¥è¿”å›ï¼Œä¸åšæ·»åŠ ã€‚</li><li>å¦‚æœä¼ å…¥è¦æ·»åŠ çš„èŠ‚ç‚¹nodeçš„æ•°å€¼å°äºå½“å‰èŠ‚ç‚¹çš„æ•°å€¼ï¼Œé‚£ä¹ˆè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ºç©ºï¼Œé‚£ä¹ˆç›´æ¥è®©å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ºè¦æ·»åŠ çš„èŠ‚ç‚¹nodeã€‚å¦åˆ™å‘å·¦è¿›è¡Œé€’å½’æ·»åŠ ï¼Œåˆ¤æ–­å¾…æ·»åŠ èŠ‚ç‚¹nodeçš„æ•°æ®ä¸å½“å‰å·¦å­èŠ‚ç‚¹æ•°æ®çš„å…³ç³»ï¼Œé‡å¤ä»¥ä¸Šæ“ä½œã€‚</li><li>å¦‚æœä¼ å…¥è¦æ·»åŠ çš„èŠ‚ç‚¹nodeçš„æ•°å€¼å¤§äºç­‰äºå½“å‰èŠ‚ç‚¹çš„æ•°å€¼ï¼Œè¿™ç§æƒ…å†µéœ€è¦å°½é‡é¿å…ï¼Œè¿™ä¸ªæ—¶å€™è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹å³å­æ ‘ä¸ºç©ºï¼Œé‚£ä¹ˆä»¤å½“å‰èŠ‚ç‚¹å³å­æ ‘ç­‰äºè¦æ·»åŠ çš„èŠ‚ç‚¹nodeã€‚å¦åˆ™å‘å³è¿›è¡Œé€’å½’æ·»åŠ ï¼Œåˆ¤æ–­å¾…æ·»åŠ èŠ‚ç‚¹nodeçš„æ•°æ®ä¸å½“å‰å³å­èŠ‚ç‚¹æ•°æ®çš„å…³ç³»ï¼Œé‡å¤ä»¥ä¸Šæ“ä½œã€‚</li></ul></blockquote><h3 id="2ã€æ’å…¥èŠ‚ç‚¹â€“Tree"><a href="#2ã€æ’å…¥èŠ‚ç‚¹â€“Tree" class="headerlink" title="2ã€æ’å…¥èŠ‚ç‚¹â€“Tree"></a>2ã€æ’å…¥èŠ‚ç‚¹â€“Tree</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.root == <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.root = node; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="keyword">this</span>.root.add(node); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€èŠ‚ç‚¹çš„æ¯”è¾ƒä¸æ’å…¥â€“Node"><a href="#3ã€èŠ‚ç‚¹çš„æ¯”è¾ƒä¸æ’å…¥â€“Node" class="headerlink" title="3ã€èŠ‚ç‚¹çš„æ¯”è¾ƒä¸æ’å…¥â€“Node"></a>3ã€èŠ‚ç‚¹çš„æ¯”è¾ƒä¸æ’å…¥â€“Node</h3><blockquote><p><strong>æ¯”è¾ƒèŠ‚ç‚¹æ ‘çš„é™æ€æ–¹æ³•</strong>å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">compare</span><span class="params">(Node node1,Node node2)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> node1.data &gt; node2.data; </span><br><span class="line">&#125; </span><br></pre></td></tr></table></figure><blockquote><p>Nodeç±»ä¸­æ’å…¥èŠ‚ç‚¹çš„æ–¹æ³•å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(node == <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">return</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(compare(<span class="keyword">this</span>,node)) &#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.left == <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">this</span>.left = node; </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">this</span>.left.add(node); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.right == <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">this</span>.right = node; </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">this</span>.right.add(node); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="ä¸‰ã€äºŒå‰æ ‘çš„å‰ä¸­ååºéå†"><a href="#ä¸‰ã€äºŒå‰æ ‘çš„å‰ä¸­ååºéå†" class="headerlink" title="ä¸‰ã€äºŒå‰æ ‘çš„å‰ä¸­ååºéå†"></a>ä¸‰ã€äºŒå‰æ ‘çš„å‰ä¸­ååºéå†</h1><blockquote><p>å‰åºéå†çš„é¡ºåºï¼š<strong>æ ¹èŠ‚ç‚¹â€“å·¦å­èŠ‚ç‚¹â€“å³å­èŠ‚ç‚¹</strong></p><p>ä¸­åºéå†çš„é¡ºåºï¼š<strong>å·¦å­èŠ‚ç‚¹â€“æ ¹èŠ‚ç‚¹â€“å³å­èŠ‚ç‚¹</strong></p><p>ååºéå†çš„é¡ºåºï¼š<strong>å·¦å­èŠ‚ç‚¹â€“å³å­èŠ‚ç‚¹â€“æ ¹èŠ‚ç‚¹</strong></p></blockquote><h2 id="3-1ã€é€’å½’å®ç°"><a href="#3-1ã€é€’å½’å®ç°" class="headerlink" title="3.1ã€é€’å½’å®ç°"></a>3.1ã€é€’å½’å®ç°</h2><h3 id="1ã€å‰åºéå†"><a href="#1ã€å‰åºéå†" class="headerlink" title="1ã€å‰åºéå†"></a>1ã€å‰åºéå†</h3><blockquote><p>å…ˆè¾“å‡ºå½“å‰èŠ‚ç‚¹ï¼Œç„¶ååˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œå°±å‘å·¦é€’å½’è¿›è¡Œå‰åºéå†ã€‚ç„¶ååˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºï¼Œå‘å³é€’å½’è¿›è¡Œå‰åºéå†ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Treeç±» </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrder</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.root != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.root.preOrder(); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;äºŒå‰æ ‘ä¸ºç©ºï¼Œæ— æ³•éå†ï¼&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//Nodeç±» </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrder</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    System.out.println(<span class="keyword">this</span>); </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.getLeft() != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.getLeft().preOrder(); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.getRight() != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.getRight().preOrder(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ä¸­åºéå†"><a href="#2ã€ä¸­åºéå†" class="headerlink" title="2ã€ä¸­åºéå†"></a>2ã€ä¸­åºéå†</h3><blockquote><p>å…ˆåˆ¤æ–­å½“å‰èŠ‚ç‚¹å·¦å­æ ‘æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºï¼Œå‘å·¦é€’å½’è¿›è¡Œä¸­åºéå†ï¼Œç„¶åè¾“å‡ºå½“å‰èŠ‚ç‚¹ï¼›æœ€ååˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºï¼Œå‘å³é€’å½’è¿›è¡Œä¸­åºéå†ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Treeç±» </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">infixOrder</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.root != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.root.infixOrder(); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;äºŒå‰æ ‘ä¸ºç©ºï¼Œæ— æ³•éå†ï¼&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//Nodeç±» </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">infixOrder</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.getLeft() != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.getLeft().infixOrder(); </span><br><span class="line">    &#125; </span><br><span class="line">    System.out.println(<span class="keyword">this</span>); </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.getRight() != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.getRight().infixOrder(); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€ååºéå†"><a href="#3ã€ååºéå†" class="headerlink" title="3ã€ååºéå†"></a>3ã€ååºéå†</h3><blockquote><p>å…ˆåˆ¤æ–­å½“å‰èŠ‚ç‚¹å·¦å­æ ‘æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºï¼Œå‘å·¦é€’å½’è¿›è¡Œååºéå†ï¼›ç„¶ååˆ¤æ–­å½“å‰èŠ‚ç‚¹çš„å³å­æ ‘æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ä¸ºç©ºï¼Œå‘å³é€’å½’è¿›è¡Œååºéå†ã€‚æœ€åè¾“å‡ºå½“å‰èŠ‚ç‚¹ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//Treeç±» </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postOrder</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.root != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.root.postOrder(); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;äºŒå‰æ ‘ä¸ºç©ºï¼Œæ— æ³•éå†ï¼&quot;</span>); </span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"> </span><br><span class="line"><span class="comment">//Nodeç±» </span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postOrder</span><span class="params">()</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.getLeft() != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.getLeft().postOrder(); </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(<span class="keyword">this</span>.getRight() != <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">this</span>.getRight().postOrder(); </span><br><span class="line">    &#125; </span><br><span class="line">    System.out.println(<span class="keyword">this</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-2ã€éé€’å½’å®ç°"><a href="#3-2ã€éé€’å½’å®ç°" class="headerlink" title="3.2ã€éé€’å½’å®ç°"></a>3.2ã€éé€’å½’å®ç°</h2><blockquote><p>æˆ‘ä»¬éœ€è¦ä½¿ç”¨åˆ°<strong>æ ˆ</strong>è¿™ä¸€æ•°æ®ç»“æ„æ¥è§£å†³é—®é¢˜</p></blockquote><h3 id="1ã€å‰åºéå†-1"><a href="#1ã€å‰åºéå†-1" class="headerlink" title="1ã€å‰åºéå†"></a>1ã€å‰åºéå†</h3><blockquote><p>å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œå…ˆè¾“å‡ºå½“å‰èŠ‚ç‚¹ä¿¡æ¯ï¼Œç„¶åå°†è¯¥èŠ‚ç‚¹å‹å…¥æ ˆï¼Œå¹¶å°†æŒ‡é’ˆç§»åŠ¨åˆ°å½“å‰èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹ï¼Œæ­¤æ—¶å¦‚æœè¯¥å·¦å­æ ‘ä¸ºç©ºï¼Œå°±é€€å‡ºå¾ªç¯ï¼Œæ­¤æ—¶å¦‚æœæ ˆä¸ä¸ºç©ºï¼Œå°±å¼¹å‡ºæ ˆé¡¶æ•°æ®ï¼Œå°†æŒ‡é’ˆç§»åŠ¨åˆ°å½“å‰ç»“ç‚¹å³å­æ ‘ï¼Œå¾ªç¯ï¼Œç›´åˆ°æ ˆç©ºæˆ–è€…å½“å‰èŠ‚ç‚¹ä¸ºç©ºã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">preOrder</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    Stack&lt;Node&gt; nodeStack = <span class="keyword">new</span> Stack&lt;&gt;(); </span><br><span class="line">    <span class="keyword">while</span>(node != <span class="keyword">null</span> || !nodeStack.empty()) &#123; </span><br><span class="line">        <span class="keyword">while</span>(node != <span class="keyword">null</span>) &#123; </span><br><span class="line">            System.out.println(node); </span><br><span class="line">            nodeStack.push(node); </span><br><span class="line">            node = node.getLeft(); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">if</span>(!nodeStack.empty()) &#123; </span><br><span class="line">            node = nodeStack.pop(); </span><br><span class="line">            node = node.getRight(); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ä¸­åºéå†-1"><a href="#2ã€ä¸­åºéå†-1" class="headerlink" title="2ã€ä¸­åºéå†"></a>2ã€ä¸­åºéå†</h3><blockquote><p>å¦‚æœå½“å‰èŠ‚ç‚¹ä¸ä¸ºç©ºï¼Œå°†å½“å‰èŠ‚ç‚¹å‹å…¥æ ˆä¸­ï¼Œç„¶åå°†æŒ‡é’ˆæŒ‡å‘å½“å‰èŠ‚ç‚¹å·¦å­æ ‘ï¼Œç›´åˆ°å·¦å­æ ‘ä¸ºç©ºï¼Œæ­¤æ—¶æ ˆä¸ä¸ºç©ºï¼Œå°†æ ˆé¡¶å…ƒç´ å¼¹å‡ºå¹¶è¾“å‡ºåï¼Œå°†æŒ‡é’ˆç§»åŠ¨åˆ°å½“å‰ç»“ç‚¹å³å­æ ‘ï¼Œå¾ªç¯ï¼Œç›´åˆ°æ ˆç©ºæˆ–è€…å½“å‰èŠ‚ç‚¹ä¸ºç©ºã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">midOrder</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    Stack&lt;Node&gt; nodeStack = <span class="keyword">new</span> Stack&lt;&gt;(); </span><br><span class="line">    <span class="keyword">while</span>(node != <span class="keyword">null</span> || !nodeStack.empty()) &#123; </span><br><span class="line">        <span class="keyword">while</span>(node != <span class="keyword">null</span>) &#123; </span><br><span class="line">            nodeStack.push(node); </span><br><span class="line">            node = node.getLeft(); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">if</span>(!nodeStack.empty()) &#123; </span><br><span class="line">            node = nodeStack.pop(); </span><br><span class="line">            System.out.println(node); </span><br><span class="line">            node = node.getRight(); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€ååºéå†-1"><a href="#3ã€ååºéå†-1" class="headerlink" title="3ã€ååºéå†"></a>3ã€ååºéå†</h3><blockquote><p>éœ€è¦åˆ©ç”¨åˆ°ä¸€ä¸ªè¾…åŠ©æ ˆç”¨äºè¾“å‡ºç»“æœï¼Œç”±äºæ ˆå…·æœ‰å…ˆè¿›åå‡ºçš„ç‰¹ç‚¹ï¼Œè€Œååºéå†çš„é¡ºåºæ˜¯å·¦å³æ ¹ï¼Œæ‰€ä»¥å‹å…¥æ ˆé¡ºåºä¸ºæ ¹ã€å³ã€å·¦ã€‚æœ€åä½¿ç”¨è¾…åŠ©æ ˆè¾“å‡º</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">postOrder</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(node == <span class="keyword">null</span>) &#123; </span><br><span class="line">        System.out.println(<span class="string">&quot;è¦éå†çš„äºŒå‰æ ‘ä¸ºç©ºï¼&quot;</span>); </span><br><span class="line">        <span class="keyword">return</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    Stack&lt;Node&gt; stack = <span class="keyword">new</span> Stack&lt;&gt;(); </span><br><span class="line">    <span class="comment">//è¾…åŠ©æ ˆ </span></span><br><span class="line">    Stack&lt;Node&gt; assistStack = <span class="keyword">new</span> Stack&lt;&gt;(); </span><br><span class="line">    <span class="keyword">while</span>(node != <span class="keyword">null</span> || !stack.isEmpty()) &#123; </span><br><span class="line">        <span class="keyword">while</span>(node != <span class="keyword">null</span>) &#123; </span><br><span class="line">            stack.push(node); </span><br><span class="line">            assistStack.push(node); </span><br><span class="line">            node = node.getRight(); </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">if</span>(!stack.isEmpty()) &#123; </span><br><span class="line">            node = stack.pop(); </span><br><span class="line">            node = node.getLeft(); </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">while</span>(!assistStack.isEmpty()) &#123; </span><br><span class="line">        System.out.println(assistStack.pop()); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å››ã€äºŒå‰æ’åºæ ‘èŠ‚ç‚¹çš„åˆ é™¤"><a href="#å››ã€äºŒå‰æ’åºæ ‘èŠ‚ç‚¹çš„åˆ é™¤" class="headerlink" title="å››ã€äºŒå‰æ’åºæ ‘èŠ‚ç‚¹çš„åˆ é™¤"></a>å››ã€äºŒå‰æ’åºæ ‘èŠ‚ç‚¹çš„åˆ é™¤</h1><blockquote><p>äºŒå‰æ’åºæ ‘ä¸­çš„èŠ‚ç‚¹å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§ï¼š</p><ul><li>å¶å­èŠ‚ç‚¹</li><li>æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹</li><li>æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹</li></ul><p>æˆ‘ä»¬éœ€è¦åˆ¤æ–­å¾…åˆ é™¤èŠ‚ç‚¹ä¸ºä»€ä¹ˆç±»å‹ï¼Œç„¶åæ ¹æ®èŠ‚ç‚¹ç±»å‹è¿›è¡Œåˆ é™¤æ“ä½œã€‚</p></blockquote><h2 id="4-1ã€ç¼–å†™ç”¨äºæœç´¢å¾…åˆ é™¤èŠ‚ç‚¹å’Œå¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•"><a href="#4-1ã€ç¼–å†™ç”¨äºæœç´¢å¾…åˆ é™¤èŠ‚ç‚¹å’Œå¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•" class="headerlink" title="4.1ã€ç¼–å†™ç”¨äºæœç´¢å¾…åˆ é™¤èŠ‚ç‚¹å’Œå¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•"></a>4.1ã€ç¼–å†™ç”¨äºæœç´¢å¾…åˆ é™¤èŠ‚ç‚¹å’Œå¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•</h2><h3 id="1ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•"><a href="#1ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•" class="headerlink" title="1ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•"></a>1ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•</h3><blockquote><p>æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹ï¼Œé¦–å…ˆåˆ¤æ–­å½“å‰äºŒå‰æ’åºæ ‘æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©ºï¼Œç›´æ¥è¿”å›ï¼Œå¦åˆ™è°ƒç”¨å½“å‰äºŒå‰æ’åºæ ‘æ ¹èŠ‚ç‚¹çš„searchæ–¹æ³•</p><ul><li><p>å¦‚æœå½“å‰ä¼ å…¥çš„æ•°æ®dataçš„å€¼åˆšå¥½ç­‰äºå½“å‰èŠ‚ç‚¹çš„dataå€¼ï¼Œé‚£ä¹ˆå½“å‰èŠ‚ç‚¹å°±æ˜¯å¾…åˆ é™¤èŠ‚ç‚¹ï¼Œç›´æ¥è¿”å›å³å¯</p></li><li><p> å¦‚æœå½“å‰ä¼ å…¥çš„æ•°æ®dataçš„å€¼å°äºå½“å‰èŠ‚ç‚¹çš„å€¼ä¸”å½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ºç©ºï¼Œè¯æ˜å½“å‰äºŒå‰æ’åºæ ‘ä¸­æ²¡æœ‰è¦åˆ é™¤çš„èŠ‚ç‚¹ï¼›å¦‚æœå½“å‰ä¼ å…¥æ•°æ®dataå€¼å°äºå½“å‰èŠ‚ç‚¹å€¼ä¸”å½“å‰èŠ‚ç‚¹å·¦å­æ ‘ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆè°ƒç”¨å½“å‰èŠ‚ç‚¹å·¦å­æ ‘çš„searchæ–¹æ³•ï¼Œå‘å·¦é€’å½’æŸ¥è¯¢ã€‚</p></li><li><p>åŒç†ï¼Œå¦‚æœå½“å‰ä¼ å…¥çš„æ•°æ®dataå€¼å¤§äºå½“å‰èŠ‚ç‚¹å€¼ä¸”å½“å‰èŠ‚ç‚¹å³å­æ ‘ä¸ºç©ºï¼Œè¯æ˜å½“å‰äºŒå‰æ’åºæ ‘æ²¡æœ‰è¦åˆ é™¤èŠ‚ç‚¹ï¼Œæ­¤åˆ»åªèƒ½è¿”å›nullï¼›å¦‚æœå½“å‰ä¼ å…¥æ•°æ®dataå€¼å¤§äºå½“å‰èŠ‚ç‚¹ä¸”å½“å‰èŠ‚ç‚¹å³å­æ ‘ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆè°ƒç”¨å½“å‰å³å­æ ‘çš„searchæ–¹æ³•ï¼Œå‘å³é€’å½’æŸ¥è¯¢ã€‚</p></li></ul><p>ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * æ ¹æ®èŠ‚ç‚¹çš„dataæ•°æ®æœç´¢NodeèŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data ç›®æ ‡èŠ‚ç‚¹çš„dataå€¼ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> å¦‚æœæ‰¾åˆ°ç¬¦åˆæ¡ä»¶çš„nodeèŠ‚ç‚¹ï¼Œé‚£ä¹ˆè¿”å›è¯¥nodeèŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> *         å¦åˆ™è¿”å›null </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">search</span><span class="params">(<span class="keyword">int</span> data)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(data == <span class="keyword">this</span>.data) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>; </span><br><span class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>(data &lt; <span class="keyword">this</span>.data) &#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.left == <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.left.search(data); </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.right == <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.right.search(data); </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•"><a href="#2ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•" class="headerlink" title="2ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•"></a>2ã€æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•</h3><blockquote><p>æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„æ–¹æ³•ï¼ŒåŒç†å…ˆåˆ¤æ–­å½“å‰äºŒå‰æ’åºæ ‘çš„æ ¹èŠ‚ç‚¹æ˜¯å¦ä¸ºç©ºï¼Œè‹¥ä¸ºç©ºï¼Œè¿”å›nullï¼Œå¦åˆ™è°ƒç”¨å½“å‰äºŒå‰æ’åºæ ‘çš„æ ¹èŠ‚ç‚¹çš„æœç´¢å¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹ï¼ˆsearchParentï¼‰çš„æ–¹æ³•ã€‚</p><ul><li><p>å¦‚æœå½“å‰èŠ‚ç‚¹çš„å·¦å­æ ‘ä¸ä¸ºç©ºä¸”å½“å‰èŠ‚ç‚¹å·¦å­æ ‘çš„dataå€¼ç­‰äºç”¨æˆ·ä¼ å…¥çš„è¦æ£€ç´¢çš„dataå€¼æˆ–è€…å½“å‰èŠ‚ç‚¹å³å­æ ‘ä¸ä¸ºç©ºä¸”å½“å‰èŠ‚ç‚¹å³å­æ ‘çš„dataå€¼ç­‰äºç”¨æˆ·ä¼ å…¥çš„è¦æ£€ç´¢çš„dataå€¼ï¼Œé‚£ä¹ˆè¯æ˜å½“å‰èŠ‚ç‚¹å°±æ˜¯å¾…æ£€ç´¢èŠ‚ç‚¹ï¼Œè¿”å›å½“å‰èŠ‚ç‚¹ã€‚</p></li><li><p>å¦‚æœä¼ å…¥çš„dataå€¼å°äºå½“å‰èŠ‚ç‚¹å€¼ä¸”å½“å‰å·¦å­æ ‘ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆè°ƒç”¨å½“å‰å·¦å­èŠ‚ç‚¹çš„searchParentçš„æ–¹æ³•ã€‚</p></li><li><p>åŒç†ï¼Œå¦‚æœä¼ å…¥dataå€¼å¤§äºç­‰äºå½“å‰èŠ‚ç‚¹çš„dataå€¼ä¸”å½“å‰èŠ‚ç‚¹å³å­æ ‘ä¸ä¸ºç©ºï¼Œé‚£ä¹ˆè°ƒç”¨å½“å‰èŠ‚ç‚¹å³å­èŠ‚ç‚¹çš„searchParentæ–¹æ³•ã€‚</p></li><li><p>å¦‚æœç¨‹åºèµ°åˆ°æ­¤å¤„ï¼Œè¯æ˜æ²¡æœ‰æ‰¾åˆ°å¾…åˆ é™¤æ•°æ®çš„çˆ¶èŠ‚ç‚¹ï¼Œæ­¤æ—¶è¿”å›nullã€‚</p></li></ul><p>ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * æŸ¥æ‰¾è¦åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data è¦åˆ é™¤çš„èŠ‚ç‚¹çš„æ•°æ® </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> å¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> Node <span class="title">searchParent</span><span class="params">(<span class="keyword">int</span> data)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>((<span class="keyword">this</span>.left != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.left.data == data) || (<span class="keyword">this</span>.right != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.right.data == data)) &#123; </span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">this</span>; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="comment">//å¦‚æœè¦æŸ¥æ‰¾çš„å€¼å°äºå½“å‰èŠ‚ç‚¹å€¼ï¼Œä¸”å½“å‰èŠ‚ç‚¹å·¦å­èŠ‚ç‚¹ä¸ä¸ºç©º </span></span><br><span class="line">        <span class="comment">//é€’å½’å‘å·¦ </span></span><br><span class="line">        <span class="keyword">if</span>(data &lt; <span class="keyword">this</span>.data &amp;&amp; <span class="keyword">this</span>.left != <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.left.searchParent(data); </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(data &gt;= <span class="keyword">this</span>.data &amp;&amp; <span class="keyword">this</span>.right != <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">this</span>.right.searchParent(data); </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-2ã€åˆ é™¤å¶å­èŠ‚ç‚¹"><a href="#4-2ã€åˆ é™¤å¶å­èŠ‚ç‚¹" class="headerlink" title="4.2ã€åˆ é™¤å¶å­èŠ‚ç‚¹"></a>4.2ã€åˆ é™¤å¶å­èŠ‚ç‚¹</h2><blockquote><p>å¯¹äºå¶å­èŠ‚ç‚¹ï¼Œæˆ‘ä»¬éœ€è¦å…ˆæ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹targetå’Œå¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹parentï¼Œç„¶ååˆ¤æ–­å¾…åˆ é™¤å¶å­èŠ‚ç‚¹æ˜¯å…¶çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘ï¼Œå¦‚æœä¸ºå·¦å­æ ‘ï¼Œé‚£ä¹ˆä»¤parent.left = nullï¼Œå¦åˆ™è®©parent.right = nullã€‚</p></blockquote><ul><li>äºŒå‰æ’åºæ ‘ä¸­åˆ¤æ–­å¾…åˆ é™¤èŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹çš„é™æ€æ–¹æ³•ä¸Nodeç±»ä¸­åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹ä¸ºå½“å‰å·¦å­æ ‘/å³å­æ ‘çš„æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­nodeèŠ‚ç‚¹æ˜¯å¦ä¸ºå¶å­èŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isLeaf</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> node.left == <span class="keyword">null</span> &amp;&amp; node.right == <span class="keyword">null</span>; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦ä¸ºå½“å‰èŠ‚ç‚¹å·¦å­èŠ‚ç‚¹çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> target </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeft</span><span class="params">(Node target)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.left != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.left.data == target.data; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦ä¸ºå½“å‰èŠ‚ç‚¹å³å­èŠ‚ç‚¹çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> target </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRight</span><span class="params">(Node target)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.right != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.right.data == target.data; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹"><a href="#4-3ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹" class="headerlink" title="4.3ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹"></a>4.3ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹</h2><blockquote><p>å¯¹äºæœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹çš„åˆ é™¤ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°å¾…åˆ é™¤èŠ‚ç‚¹å’Œå¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹ï¼Œç„¶ååˆ¤æ–­ä¸¤ä¸ªæ¡ä»¶ï¼š1ï¼ˆå¾…åˆ é™¤èŠ‚ç‚¹æ˜¯å…¶çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘ï¼‰ã€2ï¼ˆå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘ï¼‰</p><ul><li><p>å¦‚æœå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å·¦å­æ ‘ä¸”ä¸ºå…¶çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼šæ­¤æ—¶è®©å¾…åˆ é™¤èŠ‚ç‚¹çš„çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘ç­‰äºå¾…åˆ é™¤èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼Œå³parent.left = target.leftã€‚</p></li><li><p> å¦‚æœå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å·¦å­æ ‘ä¸”ä¸ºå…¶çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘ï¼šæ­¤æ—¶æ ¹æ®äºŒå‰æ’åºæ ‘çš„æ€§è´¨ï¼Œå¾…åˆ é™¤èŠ‚ç‚¹çš„å·¦å­æ ‘çš„æ•°æ®è¦å…¨éƒ¨å¤§äºï¼ˆç­‰äºï¼‰å…¶çˆ¶èŠ‚ç‚¹çš„æ•°æ®ï¼Œæ‰€ä»¥ä»¤å¾…åˆ é™¤èŠ‚ç‚¹çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘ç­‰äºå¾…åˆ é™¤èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼Œå³parent.right = target.leftã€‚</p></li><li><p>å¦‚æœå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å³å­æ ‘ä¸”ä¸ºå…¶çˆ¶èŠ‚ç‚¹çš„å·¦å­æ ‘ï¼šæ­¤æ—¶è®©parent.left = target.right</p></li><li><p>å¦‚æœå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å³å­æ ‘ä¸”ä¸ºå…¶çˆ¶èŠ‚ç‚¹çš„å³å­æ ‘ï¼Œæ­¤æ—¶è®©parent.right = target.right</p></li></ul></blockquote><ul><li>Nodeç±»ä¸­åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦ä¸ºå½“å‰èŠ‚ç‚¹å·¦/å³å­æ ‘çš„æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦ä¸ºå½“å‰èŠ‚ç‚¹å·¦å­èŠ‚ç‚¹çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> target </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isLeft</span><span class="params">(Node target)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.left != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.left.data == target.data; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦ä¸ºå½“å‰èŠ‚ç‚¹å³å­èŠ‚ç‚¹çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> target </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">isRight</span><span class="params">(Node target)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.right != <span class="keyword">null</span> &amp;&amp; <span class="keyword">this</span>.right.data == target.data; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-4ã€åˆ é™¤æœ‰ä¸¤æ£µæ ‘çš„èŠ‚ç‚¹"><a href="#4-4ã€åˆ é™¤æœ‰ä¸¤æ£µæ ‘çš„èŠ‚ç‚¹" class="headerlink" title="4.4ã€åˆ é™¤æœ‰ä¸¤æ£µæ ‘çš„èŠ‚ç‚¹"></a>4.4ã€åˆ é™¤æœ‰ä¸¤æ£µæ ‘çš„èŠ‚ç‚¹</h2><blockquote><p>å¯¹äºæœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹çš„åˆ é™¤ï¼šéœ€è¦å…ˆå–åˆ°å¾…åˆ é™¤èŠ‚ç‚¹çš„å³å­æ ‘çš„æœ€å°èŠ‚ç‚¹çš„å€¼ï¼Œç„¶åå°†æ•°å€¼æœ€å°çš„èŠ‚ç‚¹åˆ é™¤ï¼Œæœ€åå°†å‰é¢å–åˆ°çš„æœ€å°èŠ‚ç‚¹çš„å€¼èµ‹å€¼ç»™å¾…åˆ é™¤èŠ‚ç‚¹ã€‚</p></blockquote><ul><li>è·å–å¾…åˆ é™¤èŠ‚ç‚¹å³å­æ ‘ä¸­æœ€å°èŠ‚ç‚¹çš„å€¼å¹¶åˆ é™¤æœ€å°èŠ‚ç‚¹çš„æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * 1 è¿”å›ä»¥nodeä¸ºæ ¹èŠ‚ç‚¹çš„äºŒå‰æ’åºæ ‘çš„æœ€å°èŠ‚ç‚¹çš„å€¼ </span></span><br><span class="line"><span class="comment"> * 2 åˆ é™¤ä»¥nodeä¸ºæ ¹èŠ‚ç‚¹çš„äºŒå‰æ’åºæ ‘çš„æœ€å°èŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node ä¼ å…¥çš„èŠ‚ç‚¹ï¼ˆäºŒå‰æ’åºæ ‘çš„æ ¹èŠ‚ç‚¹ï¼‰ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> è¿”å›çš„ä»¥Nodeä¸ºæ ¹èŠ‚ç‚¹çš„äºŒå‰æ’åºæ ‘çš„æ ¹èŠ‚ç‚¹çš„å€¼ </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">delTreeMin</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    Node target = node; </span><br><span class="line">    <span class="comment">//å¾ªç¯çš„æŸ¥æ‰¾å·¦èŠ‚ç‚¹ï¼Œå°±èƒ½æ‰¾åˆ°æœ€å°å€¼ </span></span><br><span class="line">    <span class="keyword">while</span>(target.left != <span class="keyword">null</span>) &#123; </span><br><span class="line">        target = target.left; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="comment">//æ­¤æ—¶å¾ªç¯ç»“æŸåï¼ŒtargetæŒ‡å‘æœ€å°èŠ‚ç‚¹ </span></span><br><span class="line">    <span class="comment">//åˆ é™¤æœ€å°èŠ‚ç‚¹ </span></span><br><span class="line">    delNode(target.data); </span><br><span class="line">    <span class="keyword">return</span> target.data; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰ä¸¤æ£µå­æ ‘çš„æ–¹æ³•</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * åˆ¤æ–­ä¼ å…¥èŠ‚ç‚¹æ˜¯å¦æœ‰å·¦å³å­æ ‘çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> node </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">hasTwoSon</span><span class="params">(Node node)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> node.left != <span class="keyword">null</span> &amp;&amp; node.right != <span class="keyword">null</span>; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-5ã€äºŒå‰æ’åºæ ‘ä¸­æ ¹æ®èŠ‚ç‚¹æ•°æ®åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•"><a href="#4-5ã€äºŒå‰æ’åºæ ‘ä¸­æ ¹æ®èŠ‚ç‚¹æ•°æ®åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•" class="headerlink" title="4.5ã€äºŒå‰æ’åºæ ‘ä¸­æ ¹æ®èŠ‚ç‚¹æ•°æ®åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•"></a>4.5ã€äºŒå‰æ’åºæ ‘ä¸­æ ¹æ®èŠ‚ç‚¹æ•°æ®åˆ é™¤èŠ‚ç‚¹çš„æ–¹æ³•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * æ ¹æ®dataåˆ é™¤èŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> data è¦åˆ é™¤çš„èŠ‚ç‚¹çš„data </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">delNode</span><span class="params">(<span class="keyword">int</span> data)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">if</span>(root == <span class="keyword">null</span>) &#123; </span><br><span class="line">        <span class="keyword">return</span>; </span><br><span class="line">    &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="comment">//1 å…ˆæ‰¾åˆ°è¦åˆ é™¤çš„èŠ‚ç‚¹target </span></span><br><span class="line">        Node target = search(data); </span><br><span class="line">        <span class="comment">//1.1 å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹ä¸å­˜åœ¨ï¼Œç›´æ¥è¿”å› </span></span><br><span class="line">        <span class="keyword">if</span>(target == <span class="keyword">null</span>) &#123; </span><br><span class="line">            <span class="keyword">return</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">//1.2 å¦‚æœå½“å‰æ ‘åªæœ‰ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¸”ä¸ºå¾…åˆ é™¤èŠ‚ç‚¹ï¼Œé‚£ä¹ˆç›´æ¥ç½®ç©º </span></span><br><span class="line">        <span class="keyword">if</span>(root.left == <span class="keyword">null</span> &amp;&amp; root.right == <span class="keyword">null</span>) &#123; </span><br><span class="line">            root = <span class="keyword">null</span>; </span><br><span class="line">            <span class="keyword">return</span>; </span><br><span class="line">        &#125; </span><br><span class="line">        <span class="comment">//2 å»æ‰¾åˆ°targetçš„çˆ¶èŠ‚ç‚¹ </span></span><br><span class="line">        Node parent = searchParent(data); </span><br><span class="line">        <span class="comment">//2.1 å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æ˜¯å¶å­èŠ‚ç‚¹ </span></span><br><span class="line">        <span class="keyword">if</span>(isLeaf(target)) &#123; </span><br><span class="line">            <span class="comment">//a åˆ¤æ–­targetæ˜¯çˆ¶èŠ‚ç‚¹çš„å·¦å­èŠ‚ç‚¹è¿˜æ˜¯æœ‰å­èŠ‚ç‚¹ </span></span><br><span class="line">            <span class="keyword">if</span>(parent.isLeft(target)) &#123; </span><br><span class="line">                <span class="comment">//å¦‚æœæ˜¯å·¦å­èŠ‚ç‚¹ </span></span><br><span class="line">                parent.left = <span class="keyword">null</span>; </span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span>(parent.isRight(target)) &#123; </span><br><span class="line">                <span class="comment">//å¦‚æœæ˜¯å³å­èŠ‚ç‚¹ </span></span><br><span class="line">                parent.right = <span class="keyword">null</span>; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(hasTwoSon(target)) &#123; </span><br><span class="line">            <span class="comment">//2.2 å¦‚æœè¦åˆ é™¤çš„èŠ‚ç‚¹æœ‰å·¦å³å­æ ‘ </span></span><br><span class="line">            <span class="comment">//åˆ é™¤å³å­æ ‘æœ€å°èŠ‚ç‚¹ï¼ŒåŒæ—¶å°†æœ€å°èŠ‚ç‚¹çš„å€¼å–å‡ºæ¥ </span></span><br><span class="line">            <span class="keyword">int</span> minData = delTreeMin(target.right); </span><br><span class="line">            target.data = minData; </span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">            <span class="comment">//2.3 åˆ é™¤åªæœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹ </span></span><br><span class="line">            <span class="comment">//å¦‚æœå¾…åˆ é™¤èŠ‚ç‚¹æœ‰å·¦å­èŠ‚ç‚¹ </span></span><br><span class="line">            <span class="keyword">if</span>(target.left != <span class="keyword">null</span>) &#123; </span><br><span class="line">                <span class="comment">//å¦‚æœtargetæ˜¯parentçš„å·¦å­èŠ‚ç‚¹ </span></span><br><span class="line">                <span class="keyword">if</span>(parent.isLeft(target)) &#123; </span><br><span class="line">                    parent.left = target.left; </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                    <span class="comment">//è¯´æ˜targetæ˜¯parentçš„å³å­èŠ‚ç‚¹ </span></span><br><span class="line">                    parent.right = target.left; </span><br><span class="line">                &#125; </span><br><span class="line">            &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                <span class="comment">//å¾…åˆ é™¤èŠ‚ç‚¹æœ‰å³å­èŠ‚ç‚¹ </span></span><br><span class="line">                <span class="comment">//å¦‚æœtargetæ˜¯parentçš„å·¦èŠ‚ç‚¹ </span></span><br><span class="line">                <span class="keyword">if</span>(parent.isLeft(target)) &#123; </span><br><span class="line">                    parent.left = target.right; </span><br><span class="line">                &#125; <span class="keyword">else</span> &#123; </span><br><span class="line">                    parent.right = target.right; </span><br><span class="line">                &#125; </span><br><span class="line">            &#125; </span><br><span class="line">        &#125; </span><br><span class="line">    &#125; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äº”ã€ä½¿ç”¨é€’å½’è·å–äºŒå‰æ ‘æ·±åº¦"><a href="#äº”ã€ä½¿ç”¨é€’å½’è·å–äºŒå‰æ ‘æ·±åº¦" class="headerlink" title="äº”ã€ä½¿ç”¨é€’å½’è·å–äºŒå‰æ ‘æ·±åº¦"></a>äº”ã€ä½¿ç”¨é€’å½’è·å–äºŒå‰æ ‘æ·±åº¦</h1><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*** </span></span><br><span class="line"><span class="comment"> * é€’å½’è·å–äºŒå‰æ ‘æ·±åº¦çš„æ–¹æ³• </span></span><br><span class="line"><span class="comment"> * å¦‚æœæ ¹ä¸ºç©ºï¼šè¿”å›0 </span></span><br><span class="line"><span class="comment"> * å¦åˆ™åˆ†åˆ«é€’å½’æ·±å…¥å·¦å³èŠ‚ç‚¹ï¼Œè¿”å›æ·±åº¦ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> root äºŒå‰æ ‘çš„æ ¹èŠ‚ç‚¹ </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> äºŒå‰æ ‘æ·±åº¦ </span></span><br><span class="line"><span class="comment"> */</span> </span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">int</span> <span class="title">getTreeDepth</span><span class="params">(Node root)</span> </span>&#123; </span><br><span class="line">    <span class="keyword">return</span> root == <span class="keyword">null</span> ? <span class="number">0</span> : (<span class="number">1</span> + Math.max(getTreeDepth(root.left), getTreeDepth(root.right))); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="å…­ã€æµ‹è¯•"><a href="#å…­ã€æµ‹è¯•" class="headerlink" title="å…­ã€æµ‹è¯•"></a>å…­ã€æµ‹è¯•</h1><h2 id="6-1ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆå’Œæ’å…¥"><a href="#6-1ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆå’Œæ’å…¥" class="headerlink" title="6.1ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆå’Œæ’å…¥"></a>6.1ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„ç”Ÿæˆå’Œæ’å…¥</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Tree tree = <span class="keyword">new</span> Tree(<span class="keyword">null</span>);</span><br><span class="line"><span class="keyword">int</span>[] arr = &#123;<span class="number">7</span>,<span class="number">8</span>,<span class="number">19</span>,-<span class="number">1</span>,<span class="number">26</span>,<span class="number">100</span>,<span class="number">777</span>,-<span class="number">1012</span>,<span class="number">222</span>,<span class="number">18</span>&#125;;</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; arr.length; i++) &#123;</span><br><span class="line">    <span class="keyword">int</span> data = arr[i];</span><br><span class="line">    Node node = <span class="keyword">new</span> Node(data);</span><br><span class="line">    tree.addNode(node);</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;tree:&quot;</span>);</span><br><span class="line">Tree.show(tree.root);</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232121.png" alt="image-20210205232120723"></p><h2 id="6-2ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„åˆ é™¤"><a href="#6-2ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„åˆ é™¤" class="headerlink" title="6.2ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„åˆ é™¤"></a>6.2ã€æµ‹è¯•äºŒå‰æ’åºæ ‘çš„åˆ é™¤</h2><h3 id="1ã€åˆ é™¤å¶å­èŠ‚ç‚¹"><a href="#1ã€åˆ é™¤å¶å­èŠ‚ç‚¹" class="headerlink" title="1ã€åˆ é™¤å¶å­èŠ‚ç‚¹"></a>1ã€åˆ é™¤å¶å­èŠ‚ç‚¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;---------------------------------åˆ é™¤å¶å­èŠ‚ç‚¹-1012ï¼Œåˆ é™¤å‰ï¼š&quot;</span>); </span><br><span class="line">Tree.show(tree.root); </span><br><span class="line">tree.delNode(-<span class="number">1012</span>); </span><br><span class="line">System.out.println(<span class="string">&quot;---------------------------------åˆ é™¤å¶å­èŠ‚ç‚¹-1012ï¼Œåˆ é™¤åï¼š&quot;</span>); </span><br><span class="line">Tree.show(tree.root);</span><br></pre></td></tr></table></figure><blockquote><p>åˆ é™¤å‰ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232357.png" alt="image-20210205232357649"></p><blockquote><p>åˆ é™¤åï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232418.png" alt="image-20210205232417944"></p><h3 id="2ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹"><a href="#2ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹" class="headerlink" title="2ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹"></a>2ã€åˆ é™¤æœ‰ä¸€æ£µå­æ ‘çš„èŠ‚ç‚¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;---------------------------------åˆ é™¤æœ‰ä¸€æ£µæ ‘çš„èŠ‚ç‚¹-1ï¼Œåˆ é™¤å‰ï¼š&quot;</span>); </span><br><span class="line">Tree.show(tree.root); </span><br><span class="line">tree.delNode(-<span class="number">1</span>); </span><br><span class="line">System.out.println(<span class="string">&quot;---------------------------------åˆ é™¤æœ‰ä¸€æ£µæ ‘çš„èŠ‚ç‚¹-1ï¼Œåˆ é™¤åï¼š&quot;</span>); </span><br><span class="line">Tree.show(tree.root);</span><br></pre></td></tr></table></figure><blockquote><p>åˆ é™¤å‰ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232621.png" alt="image-20210205232621385"></p><blockquote><p>åˆ é™¤åï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232636.png" alt="image-20210205232635923"></p><h3 id="3ã€åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹"><a href="#3ã€åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹" class="headerlink" title="3ã€åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹"></a>3ã€åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">System.out.println(<span class="string">&quot;---------------------------------åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹7ï¼Œåˆ é™¤å‰ï¼š&quot;</span>); </span><br><span class="line">Tree.show(tree.root); </span><br><span class="line">tree.delNode(<span class="number">7</span>); </span><br><span class="line">System.out.println(<span class="string">&quot;---------------------------------åˆ é™¤æœ‰ä¸¤æ£µå­æ ‘çš„èŠ‚ç‚¹7ï¼Œåˆ é™¤åï¼š&quot;</span>); </span><br><span class="line">Tree.show(tree.root);</span><br></pre></td></tr></table></figure><blockquote><p>åˆ é™¤å‰ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232821.png" alt="image-20210205232820859"></p><blockquote><p>åˆ é™¤åï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210205232835.png" alt="image-20210205232834775"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ„æ ‘ </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså­¦ä¹ æ‰‹å†Œï¼ˆä¸‰ï¼‰--é…ç½®æ–‡ä»¶ã€æŒä¹…åŒ–ä¸å­˜å‚¨éªŒè¯ç </title>
      <link href="posts/3873979871.html"/>
      <url>posts/3873979871.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸ƒã€Redis-confé…ç½®æ–‡ä»¶"><a href="#ä¸ƒã€Redis-confé…ç½®æ–‡ä»¶" class="headerlink" title="ä¸ƒã€Redis.confé…ç½®æ–‡ä»¶"></a>ä¸ƒã€Redis.confé…ç½®æ–‡ä»¶</h1><h2 id="7-1ã€ç½‘ç»œ"><a href="#7-1ã€ç½‘ç»œ" class="headerlink" title="7.1ã€ç½‘ç»œ"></a>7.1ã€ç½‘ç»œ</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">bind</span>  127.0.0.1  <span class="comment"># ç»‘å®šçš„ip </span></span><br><span class="line">protected-mode  yes  <span class="comment">#  ä¿æŠ¤æ¨¡å¼ï¼Œé»˜è®¤å¼€å¯</span></span><br><span class="line">port  6379  <span class="comment">#  ç«¯å£è®¾ç½®</span></span><br></pre></td></tr></table></figure><h2 id="7-2ã€å¿«ç…§"><a href="#7-2ã€å¿«ç…§" class="headerlink" title="7.2ã€å¿«ç…§"></a>7.2ã€å¿«ç…§</h2><h3 id="1ã€æŒä¹…åŒ–"><a href="#1ã€æŒä¹…åŒ–" class="headerlink" title="1ã€æŒä¹…åŒ–"></a>1ã€æŒä¹…åŒ–</h3><blockquote><p>åœ¨è§„å®šæ—¶é—´å†…æ‰§è¡Œäº†å¤šå°‘æ“ä½œï¼Œå°±ä¼šæŒä¹…åˆ°æ–‡ä»¶ï¼ˆ.rdbã€.aofï¼‰</p><p><strong>ç”±äºredisæ˜¯å†…å­˜æ•°æ®åº“ï¼Œå¦‚æœæ²¡æœ‰æŒä¹…åŒ–ï¼Œé‚£ä¹ˆæ•°æ®æ–­ç”µå³å¤±</strong></p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># å¦‚æœ900så†…è‡³å°‘æœ‰ä¸€ä¸ªkeyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span></span><br><span class="line">save 900 1</span><br><span class="line"><span class="comment"># å¦‚æœ300så†…è‡³å°‘æœ‰10ä¸ªkeyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span></span><br><span class="line">save 300 10</span><br><span class="line"><span class="comment"># å¦‚æœ60så†…è‡³å°‘æœ‰ä¸€ä¸‡ä¸ªkeyè¿›è¡Œäº†ä¿®æ”¹ï¼Œæˆ‘ä»¬å°±è¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</span></span><br><span class="line">save 60 10000</span><br><span class="line"><span class="comment"># ä¹‹åæˆ‘ä»¬å¯ä»¥è®¾ç½®è‡ªå·±çš„</span></span><br></pre></td></tr></table></figure><h3 id="2ã€é™åˆ¶Clients"><a href="#2ã€é™åˆ¶Clients" class="headerlink" title="2ã€é™åˆ¶Clients"></a>2ã€é™åˆ¶Clients</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">maxclients   10000  <span class="comment"># æœ€å¤šæœ‰10000ä¸ªå®¢æˆ·ç«¯èƒ½è¿æ¥ä¸Šæ­¤redis</span></span><br><span class="line"></span><br><span class="line">maxmemory    &lt;bytes&gt;  <span class="comment"># redisè®¾ç½®æœ€å¤§å†…å­˜å®¹é‡</span></span><br></pre></td></tr></table></figure><h3 id="3ã€å†…å­˜è¾¾åˆ°ä¸Šé™çš„å¤„ç†ç­–ç•¥"><a href="#3ã€å†…å­˜è¾¾åˆ°ä¸Šé™çš„å¤„ç†ç­–ç•¥" class="headerlink" title="3ã€å†…å­˜è¾¾åˆ°ä¸Šé™çš„å¤„ç†ç­–ç•¥"></a>3ã€å†…å­˜è¾¾åˆ°ä¸Šé™çš„å¤„ç†ç­–ç•¥</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">maxmemory-policy   noeviction   <span class="comment"># å†…å­˜åˆ°è¾¾ä¸Šé™åçš„å¤„ç†ç­–ç•¥ï¼Œé»˜è®¤ä¸åˆ é™¤æ•°æ®ï¼Œç›´æ¥æŠ¥é”™</span></span><br></pre></td></tr></table></figure><blockquote><p>æœ‰å…­ç§ç­–ç•¥ï¼š</p><p>1   volatile-lru:ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„å†…å­˜æ•°æ®é›†ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ® æ·˜æ±°ï¼›</p><p>2    volatile-ttl: ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„å†…å­˜æ•°æ®é›†ä¸­æŒ‘é€‰å³å°†è¿‡æœŸçš„æ•°æ® æ·˜æ±°ï¼›</p><p>3    volatile-random:ä»å·²è®¾ç½®è¿‡æœŸæ—¶é—´çš„å†…å­˜æ•°æ®é›†ä¸­ä»»æ„æŒ‘é€‰æ•°æ® æ·˜æ±°ï¼›</p><p>4    allkeys-lru:ä»å†…å­˜æ•°æ®é›†ä¸­æŒ‘é€‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„æ•°æ® æ·˜æ±°ï¼›</p><p>5     allkeys-random:ä»æ•°æ®é›†ä¸­ä»»æ„æŒ‘é€‰æ•°æ® æ·˜æ±°ï¼›</p><p>6     noenviction(é©±é€)ï¼šç¦æ­¢é©±é€æ•°æ®ã€‚</p></blockquote><h1 id="å…«ã€æŒä¹…åŒ–"><a href="#å…«ã€æŒä¹…åŒ–" class="headerlink" title="å…«ã€æŒä¹…åŒ–"></a>å…«ã€æŒä¹…åŒ–</h1><blockquote><p>Redisæ˜¯ä¸€ä¸ªå†…å­˜æ•°æ®åº“ï¼Œå¦‚æœä¸å¯¹Redisæ•°æ®è¿›è¡ŒæŒä¹…åŒ–æ“ä½œï¼Œé‚£ä¹ˆä¸€æ—¦æœåŠ¡å™¨è¿›ç¨‹é€€å‡ºï¼ŒæœåŠ¡å™¨ä¸­çš„æ•°æ®åº“çŠ¶æ€ä¹Ÿä¼šæ¶ˆå¤±ã€‚</p><p>Redisçš„æŒä¹…åŒ–å¯åˆ†ä¸ºRDBï¼ˆRedis DataBaseï¼‰å’ŒAOFï¼ˆAppend Only Fileï¼‰</p></blockquote><h2 id="8-1ã€RDB"><a href="#8-1ã€RDB" class="headerlink" title="8.1ã€RDB"></a>8.1ã€RDB</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯RDB"><a href="#1ã€ä»€ä¹ˆæ˜¯RDB" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯RDB"></a>1ã€ä»€ä¹ˆæ˜¯RDB</h3><blockquote><p>åœ¨æŒ‡å®šæ—¶é—´é—´éš”å°†å†…å­˜é›†çš„æ•°æ®é›†å¿«ç…§å†™å…¥ç£ç›˜ï¼Œæ¢å¤æ—¶å°†å¿«ç…§æ–‡ä»¶ç›´æ¥è¯»å…¥å†…å­˜ã€‚åœ¨è¿›è¡Œå†™å…¥çš„è¿‡ç¨‹ä¸­ï¼ŒRedisä¼š<strong>å•ç‹¬åˆ›å»º</strong>ä¸€ä¸ª<strong>å­è¿›ç¨‹</strong>ï¼Œä¼šå…ˆå°†æ•°æ®å†™å…¥ä¸€ä¸ªä¸´æ—¶æ–‡ä»¶ä¸­ï¼Œå¾…æŒä¹…åŒ–è¿‡ç¨‹ç»“æŸåï¼Œå†å°†è¿™ä¸ªä¸´æ—¶æ–‡ä»¶æ›¿æ¢ä¸Šæ¬¡æŒä¹…åŒ–å¥½çš„æ–‡ä»¶ã€‚æ•´ä¸ªè¿‡ç¨‹ä¸­ï¼Œ<strong>ä¸»çº¿ç¨‹ä¸è¿›è¡Œä»»ä½•IOæ“ä½œ</strong>ï¼Œç¡®ä¿äº†æé«˜çš„æ€§èƒ½ã€‚</p><p>å¦‚æœè¦è¿›è¡Œå¤§è§„æ¨¡çš„æ•°æ®æ¢å¤ï¼Œä¸”å¯¹äºæ•°æ®æ¢å¤å®Œæ•´æ€§å¹¶ä¸æ˜¯ç‰¹åˆ«æ•æ„Ÿï¼Œåˆ™RDBæ–¹å¼è¦æ¯”AOFæ–¹å¼æ›´åŠ é«˜æ•ˆï¼ŒRdbçš„<strong>ç¼ºç‚¹</strong>æ˜¯<strong>æœ€åä¸€æ¬¡æŒä¹…åŒ–åçš„æ•°æ®å¯èƒ½ä¸¢å¤±</strong>ï¼ŒRedis<strong>é»˜è®¤ä½¿ç”¨RDBè¿›è¡ŒæŒä¹…åŒ–æ“ä½œ</strong>ã€‚</p></blockquote><h3 id="2ã€RDBä¿å­˜çš„æ–‡ä»¶æ˜¯dump-rdb"><a href="#2ã€RDBä¿å­˜çš„æ–‡ä»¶æ˜¯dump-rdb" class="headerlink" title="2ã€RDBä¿å­˜çš„æ–‡ä»¶æ˜¯dump.rdb"></a>2ã€RDBä¿å­˜çš„æ–‡ä»¶æ˜¯dump.rdb</h3><h3 id="3ã€ä¼˜ç‚¹ï¼š"><a href="#3ã€ä¼˜ç‚¹ï¼š" class="headerlink" title="3ã€ä¼˜ç‚¹ï¼š"></a>3ã€ä¼˜ç‚¹ï¼š</h3><ul><li>é€‚åˆå¤§è§„æ¨¡æ•°æ®æ¢å¤</li><li>å¯¹æ•°æ®å®Œæ•´æ€§è¦æ±‚ä¸é«˜</li></ul><h3 id="4ã€ç¼ºç‚¹ï¼š"><a href="#4ã€ç¼ºç‚¹ï¼š" class="headerlink" title="4ã€ç¼ºç‚¹ï¼š"></a>4ã€ç¼ºç‚¹ï¼š</h3><ul><li>éœ€è¦ä¸€å®šçš„æ—¶é—´é—´éš”è¿›ç¨‹æ“ä½œï¼Œå¦‚æœredisæ„å¤–å®•æœºï¼Œæœ€åä¸€æ¬¡ä¿®æ”¹æ•°æ®ä¼šæ¶ˆå¤±</li><li>forkè¿›ç¨‹æ—¶ä¼šå ç”¨ä¸€å®šç©ºé—´</li></ul><h3 id="5ã€è§¦å‘æœºåˆ¶"><a href="#5ã€è§¦å‘æœºåˆ¶" class="headerlink" title="5ã€è§¦å‘æœºåˆ¶"></a>5ã€è§¦å‘æœºåˆ¶</h3><ul><li>saveçš„è§„åˆ™æ»¡è¶³çš„æ¡ä»¶ä¸‹ï¼Œä¼šè‡ªåŠ¨è§¦å‘RDBè§„åˆ™</li><li>æ‰§è¡Œflashallå‘½ä»¤ï¼Œä¼šè§¦å‘RDBè§„åˆ™</li><li>é€€å‡ºredisï¼Œä¹Ÿä¼šäº§ç”Ÿrdbæ–‡ä»¶</li><li>å¤‡ä»½ç”Ÿæˆä¸€ä¸ªdump.rdbæ–‡ä»¶</li></ul><h3 id="6ã€å¦‚ä½•æ¢å¤rdbæ–‡ä»¶"><a href="#6ã€å¦‚ä½•æ¢å¤rdbæ–‡ä»¶" class="headerlink" title="6ã€å¦‚ä½•æ¢å¤rdbæ–‡ä»¶"></a>6ã€å¦‚ä½•æ¢å¤rdbæ–‡ä»¶</h3><blockquote><p>åªéœ€è¦å°†rdbæ–‡ä»¶æ”¾åœ¨rediså¯åŠ¨ç›®å½•ä¸‹å³å¯ï¼Œrediså¯åŠ¨æ—¶ä¼šæ£€æŸ¥å¹¶æ¢å¤dump.rdbä¸­çš„æ•°æ®</p></blockquote><h2 id="8-2ã€AOF"><a href="#8-2ã€AOF" class="headerlink" title="8.2ã€AOF"></a>8.2ã€AOF</h2><h3 id="1ã€ä»€ä¹ˆæ˜¯AOF"><a href="#1ã€ä»€ä¹ˆæ˜¯AOF" class="headerlink" title="1ã€ä»€ä¹ˆæ˜¯AOF?"></a>1ã€ä»€ä¹ˆæ˜¯AOF?</h3><blockquote><p>ä»¥æ—¥å¿—çš„å½¢å¼æ¥è®°å½•æ¯ä¸ªå†™æ“ä½œï¼Œå°†Redisæ‰§è¡Œè¿‡çš„æ‰€æœ‰æŒ‡ä»¤<strong>ï¼ˆè¯»æ“ä½œä¸è®°å½•ï¼‰</strong>è®°å½•ä¸‹æ¥ï¼Œåªè®¸è¿½åŠ æ–‡ä»¶ä½†ä¸å¯ä»¥æ”¹å†™æ–‡ä»¶ï¼Œrediså¯åŠ¨ä¹‹åˆä¼šè¯»å–æ–‡ä»¶é‡æ–°æ„å»ºæ•°æ®ï¼Œæ¢è¨€ä¹‹ï¼Œredisé‡å¯çš„è¯å°±è¦æ ¹æ®æ—¥å¿—æ–‡ä»¶çš„å†…å®¹å°†å†™æŒ‡ä»¤<strong>ä»å¤´åˆ°å°¾</strong>æ‰§è¡Œä¸€æ¬¡ä»¥<strong>å®Œæˆæ•°æ®çš„æ¢å¤å·¥ä½œ</strong></p></blockquote><h3 id="2ã€ä½¿ç”¨"><a href="#2ã€ä½¿ç”¨" class="headerlink" title="2ã€ä½¿ç”¨"></a>2ã€ä½¿ç”¨</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">appendonly yes</span><br></pre></td></tr></table></figure><h1 id="ä¹ã€Rediså®ç°æ‰‹æœºéªŒè¯ç "><a href="#ä¹ã€Rediså®ç°æ‰‹æœºéªŒè¯ç " class="headerlink" title="ä¹ã€Rediså®ç°æ‰‹æœºéªŒè¯ç "></a>ä¹ã€Rediså®ç°æ‰‹æœºéªŒè¯ç </h1><h2 id="9-1ã€å®ç°åŸç†"><a href="#9-1ã€å®ç°åŸç†" class="headerlink" title="9.1ã€å®ç°åŸç†"></a>9.1ã€å®ç°åŸç†</h2><ul><li>ä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆ4ä½æˆ–6ä½çš„æ•°å­—éªŒè¯ç </li><li>æ ¡éªŒæ‰‹æœºå·ä¸ºåˆæ³•åé€šè¿‡çŸ­ä¿¡å¾®æœåŠ¡å‘é€éªŒè¯ç </li><li>å°†æ‰‹æœºå·ä½œä¸ºkeyï¼ŒéªŒè¯ç ä½œä¸ºvalueå­˜å…¥redisä¸­ï¼Œå¹¶è®¾ç½®ä¸€ä¸ªè¿‡æœŸæ—¶é—´</li><li>ç”¨æˆ·è¿›è¡Œç™»å½•/æ³¨å†Œæ—¶é€šè¿‡keyï¼ˆæ‰‹æœºå·ï¼‰åˆ°redisä¸­å–å‡ºéªŒè¯ç </li><li>è¿›è¡ŒéªŒè¯ç æ¯”å¯¹ï¼Œè‹¥åŒ¹é…åˆ™ç™»å½•/æ³¨å†Œé€šè¿‡ï¼Œéšæœºåˆ é™¤redisä¸­çš„key-value</li></ul><h2 id="9-2ã€å®ç°"><a href="#9-2ã€å®ç°" class="headerlink" title="9.2ã€å®ç°"></a>9.2ã€å®ç°</h2><h3 id="1ã€æ ¡éªŒæ‰‹æœºå·æ˜¯å¦åˆæ³•çš„å·¥å…·ç±»"><a href="#1ã€æ ¡éªŒæ‰‹æœºå·æ˜¯å¦åˆæ³•çš„å·¥å…·ç±»" class="headerlink" title="1ã€æ ¡éªŒæ‰‹æœºå·æ˜¯å¦åˆæ³•çš„å·¥å…·ç±»"></a>1ã€æ ¡éªŒæ‰‹æœºå·æ˜¯å¦åˆæ³•çš„å·¥å…·ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">FormUtils</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Pattern NUMBER_PATTERN = Pattern.compile(<span class="string">&quot;^[1][3,4,5,7,8,9][0-9]&#123;9&#125;$&quot;</span>);</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ‰‹æœºå·éªŒè¯</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">boolean</span> <span class="title">isMobile</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//éªŒè¯æ‰‹æœºå·çš„æ­£åˆ™è¡¨è¾¾å¼</span></span><br><span class="line">        <span class="keyword">return</span> NUMBER_PATTERN.matcher(str).matches();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ç”ŸæˆéªŒè¯ç çš„å·¥å…·ç±»"><a href="#2ã€ç”ŸæˆéªŒè¯ç çš„å·¥å…·ç±»" class="headerlink" title="2ã€ç”ŸæˆéªŒè¯ç çš„å·¥å…·ç±»"></a>2ã€ç”ŸæˆéªŒè¯ç çš„å·¥å…·ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RandomUtils</span> </span>&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> Random random = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> DecimalFormat fourdf = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;0000&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> DecimalFormat sixdf = <span class="keyword">new</span> DecimalFormat(<span class="string">&quot;000000&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getFourBitRandom</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> fourdf.format(random.nextInt(<span class="number">10000</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">getSixBitRandom</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> sixdf.format(random.nextInt(<span class="number">1000000</span>));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * ç»™å®šæ•°ç»„ï¼ŒæŠ½å–nä¸ªæ•°æ®</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> list</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> n</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> ArrayList <span class="title">getRandom</span><span class="params">(List list, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">Random random = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">HashMap&lt;Object, Object&gt; hashMap = <span class="keyword">new</span> HashMap&lt;Object, Object&gt;();</span><br><span class="line"></span><br><span class="line"><span class="comment">// ç”Ÿæˆéšæœºæ•°å­—å¹¶å­˜å…¥HashMap</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; list.size(); i++) &#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> number = random.nextInt(<span class="number">100</span>) + <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">hashMap.put(number, i);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// ä»HashMapå¯¼å…¥æ•°ç»„</span></span><br><span class="line">Object[] robjs = hashMap.values().toArray();</span><br><span class="line"></span><br><span class="line">ArrayList r = <span class="keyword">new</span> ArrayList();</span><br><span class="line"></span><br><span class="line"><span class="comment">// éå†æ•°ç»„å¹¶æ‰“å°æ•°æ®</span></span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) &#123;</span><br><span class="line">r.add(list.get((<span class="keyword">int</span>) robjs[i]));</span><br><span class="line">System.out.print(list.get((<span class="keyword">int</span>) robjs[i]) + <span class="string">&quot;\t&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">System.out.print(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line"><span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€çŸ­ä¿¡å¾®æœåŠ¡Controller"><a href="#3ã€çŸ­ä¿¡å¾®æœåŠ¡Controller" class="headerlink" title="3ã€çŸ­ä¿¡å¾®æœåŠ¡Controller"></a>3ã€çŸ­ä¿¡å¾®æœåŠ¡Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;çŸ­ä¿¡ç®¡ç†æ§åˆ¶å™¨&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/sms&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiSmsController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SmsService smsService;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ä¼ å…¥çš„æ‰‹æœºå·æ¥ç”Ÿæˆå¹¶å‘é€éªŒè¯ç </span></span><br><span class="line"><span class="comment">     * å¹¶å°†éªŒè¯ç å­˜å…¥redisç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> mobile æ‰‹æœºå·</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;send/&#123;mobile&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ä¸€ä¸ªç”¨äºç”ŸæˆéªŒè¯ç ï¼Œå¹¶å°†éªŒè¯ç å­˜å…¥redisä¸­çš„æ¥å£&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">getCode</span><span class="params">(<span class="meta">@PathVariable(&quot;mobile&quot;)</span> String mobile)</span> <span class="keyword">throws</span> ClientException </span>&#123;</span><br><span class="line">        <span class="comment">//0 æ ¡éªŒæ‰‹æœºå·æ˜¯å¦åˆæ³•</span></span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isBlank(mobile) || !FormUtils.isMobile(mobile)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœæ‰‹æœºå·ä¸ºç©ºæˆ–æ‰‹æœºå·ä¸åˆæ³•</span></span><br><span class="line">            log.error(<span class="string">&quot;æ‰‹æœºå·ä¸åˆæ³•ï¼&quot;</span>);</span><br><span class="line">            <span class="comment">// new GrainException(ResultCodeEnum.LOGIN_MOBILE_ERROR);</span></span><br><span class="line">            <span class="keyword">return</span> R.error().message(<span class="string">&quot;æ‰‹æœºå·ä¸æ­£ç¡®ï¼&quot;</span>).code(<span class="number">28001</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//1 ä½¿ç”¨å·¥å…·ç±»ç”Ÿæˆç”ŸæˆéªŒè¯ç </span></span><br><span class="line">        String checkCode = RandomUtils.getSixBitRandom();</span><br><span class="line">        <span class="comment">//2 å‘é€éªŒè¯ç </span></span><br><span class="line">        smsService.send(mobile,checkCode);</span><br><span class="line">        <span class="comment">//3 å­˜å‚¨éªŒè¯ç åˆ°redis</span></span><br><span class="line">        <span class="comment">//ä½¿ç”¨redisTemplateï¼Œä½¿ç”¨æ‰‹æœºå·ä½œä¸ºé”®ï¼Œä¿å­˜æ—¶é•¿ä¸º5åˆ†é’Ÿ</span></span><br><span class="line">        redisTemplate.opsForValue().set(mobile,checkCode,<span class="number">5</span>, TimeUnit.MINUTES);</span><br><span class="line">        <span class="keyword">return</span> R.ok().message(<span class="string">&quot;çŸ­ä¿¡å‘é€æˆåŠŸï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€çŸ­ä¿¡å¾®æœåŠ¡Serviceå±‚"><a href="#4ã€çŸ­ä¿¡å¾®æœåŠ¡Serviceå±‚" class="headerlink" title="4ã€çŸ­ä¿¡å¾®æœåŠ¡Serviceå±‚"></a>4ã€çŸ­ä¿¡å¾®æœåŠ¡Serviceå±‚</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SmsServiceImpl</span> <span class="keyword">implements</span> <span class="title">SmsService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> SmsProperties smsProperties;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">send</span><span class="params">(String mobile, String checkCode)</span> <span class="keyword">throws</span> ClientException, ClientException </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è°ƒç”¨çŸ­ä¿¡å‘é€SDKï¼Œåˆ›å»ºclientå¯¹è±¡</span></span><br><span class="line">        DefaultProfile profile = DefaultProfile.getProfile(</span><br><span class="line">                smsProperties.getRegionId(),</span><br><span class="line">                smsProperties.getKeyId(),</span><br><span class="line">                smsProperties.getKeySecret());</span><br><span class="line">        IAcsClient client = <span class="keyword">new</span> DefaultAcsClient(profile);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//ç»„è£…è¯·æ±‚å‚æ•°</span></span><br><span class="line">        CommonRequest request = <span class="keyword">new</span> CommonRequest();</span><br><span class="line">        request.setSysMethod(MethodType.POST);</span><br><span class="line">        request.setSysDomain(<span class="string">&quot;dysmsapi.aliyuncs.com&quot;</span>);</span><br><span class="line">        request.setSysVersion(<span class="string">&quot;2017-05-25&quot;</span>);</span><br><span class="line">        request.setSysAction(<span class="string">&quot;SendSms&quot;</span>);</span><br><span class="line">        request.putQueryParameter(<span class="string">&quot;RegionId&quot;</span>, smsProperties.getRegionId());</span><br><span class="line">        request.putQueryParameter(<span class="string">&quot;PhoneNumbers&quot;</span>, mobile);</span><br><span class="line">        request.putQueryParameter(<span class="string">&quot;SignName&quot;</span>, smsProperties.getSignName());</span><br><span class="line">        request.putQueryParameter(<span class="string">&quot;TemplateCode&quot;</span>, smsProperties.getTemplateCode());</span><br><span class="line"></span><br><span class="line">        Map&lt;String, Object&gt; param = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        param.put(<span class="string">&quot;code&quot;</span>, checkCode);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å°†åŒ…å«éªŒè¯ç çš„é›†åˆè½¬æ¢ä¸ºjsonå­—ç¬¦ä¸²</span></span><br><span class="line">        Gson gson = <span class="keyword">new</span> Gson();</span><br><span class="line">        request.putQueryParameter(<span class="string">&quot;TemplateParam&quot;</span>, gson.toJson(param));</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å‘é€çŸ­ä¿¡</span></span><br><span class="line">        CommonResponse response = client.getCommonResponse(request);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//å¾—åˆ°jsonå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”ç»“æœ</span></span><br><span class="line">        String data = response.getData();</span><br><span class="line"></span><br><span class="line">        <span class="comment">//è§£æjsonå­—ç¬¦ä¸²æ ¼å¼çš„å“åº”ç»“æœ</span></span><br><span class="line">        HashMap&lt;String, String&gt; map = gson.fromJson(data, HashMap.class);</span><br><span class="line">        String code = map.get(<span class="string">&quot;Code&quot;</span>);</span><br><span class="line">        String message = map.get(<span class="string">&quot;Message&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//é…ç½®å‚è€ƒï¼šçŸ­ä¿¡æœåŠ¡-&gt;ç³»ç»Ÿè®¾ç½®-&gt;å›½å†…æ¶ˆæ¯è®¾ç½®</span></span><br><span class="line">        <span class="comment">//é”™è¯¯ç å‚è€ƒï¼š</span></span><br><span class="line">        <span class="comment">//https://help.aliyun.com/document_detail/101346.html?spm=a2c4g.11186623.6.613.3f6e2246sDg6Ry</span></span><br><span class="line">        <span class="comment">//æ§åˆ¶æ‰€æœ‰çŸ­ä¿¡æµå‘é™åˆ¶ï¼ˆåŒä¸€æ‰‹æœºå·ï¼šä¸€åˆ†é’Ÿä¸€æ¡ã€ä¸€ä¸ªå°æ—¶äº”æ¡ã€ä¸€å¤©åæ¡ï¼‰</span></span><br><span class="line">        <span class="keyword">if</span> (<span class="string">&quot;isv.BUSINESS_LIMIT_CONTROL&quot;</span>.equals(code)) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;çŸ­ä¿¡å‘é€è¿‡äºé¢‘ç¹ &quot;</span> + <span class="string">&quot;ã€codeã€‘&quot;</span> + code + <span class="string">&quot;, ã€messageã€‘&quot;</span> + message);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.SMS_SEND_ERROR_BUSINESS_LIMIT_CONTROL);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!<span class="string">&quot;OK&quot;</span>.equals(code)) &#123;</span><br><span class="line">            log.error(<span class="string">&quot;çŸ­ä¿¡å‘é€å¤±è´¥ &quot;</span> + <span class="string">&quot; - code: &quot;</span> + code + <span class="string">&quot;, message: &quot;</span> + message);</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.SMS_SEND_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Controller"><a href="#5ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Controller" class="headerlink" title="5ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Controller"></a>5ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Controller</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;ä¼šå‘˜ç®¡ç†æ§åˆ¶å™¨&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/api/ucenter/member&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ApiMemberController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MemberService memberService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ä¼šå‘˜æ³¨å†Œ&quot;)</span></span><br><span class="line">    <span class="meta">@PostMapping(&quot;register&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">register</span><span class="params">(<span class="meta">@RequestBody</span> RegisterVo registerVo)</span> </span>&#123;</span><br><span class="line">        memberService.register(registerVo);</span><br><span class="line">        <span class="keyword">return</span> R.ok().message(<span class="string">&quot;æ³¨å†ŒæˆåŠŸï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Service"><a href="#6ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Service" class="headerlink" title="6ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Service"></a>6ã€ç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡Service</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MemberServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">MemberMapper</span>, <span class="title">Member</span>&gt; <span class="keyword">implements</span> <span class="title">MemberService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> MemberMapper memberMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">register</span><span class="params">(RegisterVo registerVo)</span> </span>&#123;</span><br><span class="line">        String nickname = registerVo.getNickname();</span><br><span class="line">        String mobile = registerVo.getMobile();</span><br><span class="line">        String code = registerVo.getCode();</span><br><span class="line">        String password = registerVo.getPassword();</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isBlank(mobile) || !FormUtils.isMobile(mobile)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.LOGIN_MOBILE_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(StringUtils.isBlank(nickname) || StringUtils.isBlank(password) || StringUtils.isBlank(code)) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.PARAM_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ ¡éªŒéªŒè¯ç </span></span><br><span class="line">        String checkCode = (String)redisTemplate.opsForValue().get(mobile);</span><br><span class="line">        <span class="keyword">if</span>(!StringUtils.equals(code,checkCode)) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœç”¨æˆ·è¾“å…¥éªŒè¯ç å’Œredisä¸­éªŒè¯ç ä¸ç›¸ç­‰</span></span><br><span class="line">            <span class="comment">//æ ¡éªŒå¤±è´¥</span></span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.CODE_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//åˆ¤æ–­ç”¨æˆ·æ‰‹æœºå·æ˜¯å¦æ³¨å†Œ</span></span><br><span class="line">        QueryWrapper&lt;Member&gt; memberQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        memberQueryWrapper.eq(<span class="string">&quot;mobile&quot;</span>,mobile);</span><br><span class="line">        Integer result = memberMapper.selectCount(memberQueryWrapper);</span><br><span class="line">        <span class="keyword">if</span>(result &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> GrainException(ResultCodeEnum.REGISTER_MOBLE_ERROR);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ³¨å†Œ</span></span><br><span class="line">        Member member = <span class="keyword">new</span> Member();</span><br><span class="line">        member.setNickname(nickname);</span><br><span class="line">        member.setMobile(mobile);</span><br><span class="line">        <span class="comment">//å¯†ç éœ€è¦åŠ å¯†</span></span><br><span class="line">        member.setPassword(MD5.encrypt(password));</span><br><span class="line">        member.setAvatar(<span class="string">&quot;http://tiebapic.baidu.com/forum/w%3D580/sign=21e19fd45010b912bfc1f6f6f3fcfcb5/c0d5d04b20a44623e5077d0d8f22720e0ef3d78e.jpg&quot;</span>);</span><br><span class="line">        member.setDisabled(<span class="keyword">false</span>);</span><br><span class="line">        memberMapper.insert(member);</span><br><span class="line">        <span class="comment">//å°†redisç¼“å­˜ä¸­çš„éªŒè¯ç åˆ é™¤</span></span><br><span class="line">        redisTemplate.delete(mobile);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="9-3ã€æµ‹è¯•"><a href="#9-3ã€æµ‹è¯•" class="headerlink" title="9.3ã€æµ‹è¯•"></a>9.3ã€æµ‹è¯•</h2><blockquote><p>å¯åŠ¨çŸ­ä¿¡å¾®æœåŠ¡å’Œç”¨æˆ·æ³¨å†Œå¾®æœåŠ¡ï¼Œä½¿ç”¨Swaggerè¿›è¡Œæµ‹è¯•</p></blockquote><h3 id="1ã€ä½¿ç”¨çŸ­ä¿¡å¾®æœåŠ¡å‘æŒ‡å®šæ‰‹æœºå·å‘é€éªŒè¯ç "><a href="#1ã€ä½¿ç”¨çŸ­ä¿¡å¾®æœåŠ¡å‘æŒ‡å®šæ‰‹æœºå·å‘é€éªŒè¯ç " class="headerlink" title="1ã€ä½¿ç”¨çŸ­ä¿¡å¾®æœåŠ¡å‘æŒ‡å®šæ‰‹æœºå·å‘é€éªŒè¯ç "></a>1ã€ä½¿ç”¨çŸ­ä¿¡å¾®æœåŠ¡å‘æŒ‡å®šæ‰‹æœºå·å‘é€éªŒè¯ç </h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000422.png" alt="image-20210204000422442"></p><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000623.png" alt="image-20210204000623694"></p><h3 id="2ã€æŸ¥çœ‹Redisç¼“å­˜å’ŒçŸ­ä¿¡"><a href="#2ã€æŸ¥çœ‹Redisç¼“å­˜å’ŒçŸ­ä¿¡" class="headerlink" title="2ã€æŸ¥çœ‹Redisç¼“å­˜å’ŒçŸ­ä¿¡"></a>2ã€æŸ¥çœ‹Redisç¼“å­˜å’ŒçŸ­ä¿¡</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000652.png" alt="image-20210204000652056"></p><blockquote><p>çŸ­ä¿¡</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204001029.png" alt="image-20210204001029230"></p><h3 id="3ã€æ‰“å¼€ç”¨æˆ·ä¸­å¿ƒå¾®æœåŠ¡è¿›è¡Œæµ‹è¯•"><a href="#3ã€æ‰“å¼€ç”¨æˆ·ä¸­å¿ƒå¾®æœåŠ¡è¿›è¡Œæµ‹è¯•" class="headerlink" title="3ã€æ‰“å¼€ç”¨æˆ·ä¸­å¿ƒå¾®æœåŠ¡è¿›è¡Œæµ‹è¯•"></a>3ã€æ‰“å¼€ç”¨æˆ·ä¸­å¿ƒå¾®æœåŠ¡è¿›è¡Œæµ‹è¯•</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000749.png" alt="image-20210204000749533"></p><h3 id="4ã€ç»“æœ"><a href="#4ã€ç»“æœ" class="headerlink" title="4ã€ç»“æœ"></a>4ã€ç»“æœ</h3><blockquote><p>swaggeræç¤ºæ³¨å†ŒæˆåŠŸ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000814.png" alt="image-20210204000813999"></p><blockquote><p>redisç¼“å­˜ä¸­è¯¥é”®å€¼å¯¹è¢«åˆ é™¤</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000908.png" alt="image-20210204000908928"></p><blockquote><p>æ•°æ®åº“</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204000944.png" alt="image-20210204000944206"></p>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså­¦ä¹ æ‰‹å†Œï¼ˆäºŒï¼‰--äº‹åŠ¡ã€Jediså’ŒSpring Bootæ•´åˆRedis</title>
      <link href="posts/2589988718.html"/>
      <url>posts/2589988718.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="å››ã€äº‹åŠ¡"><a href="#å››ã€äº‹åŠ¡" class="headerlink" title="å››ã€äº‹åŠ¡"></a>å››ã€äº‹åŠ¡</h1><h2 id="4-1ã€ä»‹ç»"><a href="#4-1ã€ä»‹ç»" class="headerlink" title="4.1ã€ä»‹ç»"></a>4.1ã€ä»‹ç»</h2><blockquote><p>Redisäº‹åŠ¡æ˜¯ä¸€ä¸ªå•ç‹¬çš„éš”ç¦»è¿‡ç¨‹ï¼šäº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­ï¼Œredisäº‹åŠ¡çš„ä¸»è¦ä½œç”¨å°±æ˜¯ä¸²è”å¤šä¸ªå‘½ä»¤é˜²æ­¢åˆ«çš„å‘½ä»¤æ’é˜Ÿã€‚</p></blockquote><h2 id="4-2ã€Redisäº‹åŠ¡çš„ç‰¹æ€§"><a href="#4-2ã€Redisäº‹åŠ¡çš„ç‰¹æ€§" class="headerlink" title="4.2ã€Redisäº‹åŠ¡çš„ç‰¹æ€§"></a>4.2ã€Redisäº‹åŠ¡çš„ç‰¹æ€§</h2><blockquote><p>å•ç‹¬çš„éš”ç¦»æ“ä½œï¼š</p><ul><li>äº‹åŠ¡ä¸­çš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«åºåˆ—åŒ–ã€æŒ‰é¡ºåºåœ°æ‰§è¡Œã€‚äº‹åŠ¡åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸ä¼šè¢«å…¶ä»–å®¢æˆ·ç«¯å‘é€æ¥çš„å‘½ä»¤è¯·æ±‚æ‰€æ‰“æ–­</li></ul></blockquote><blockquote><p>æ²¡æœ‰éš”ç¦»çº§åˆ«çš„æ¦‚å¿µ</p><ul><li>é˜Ÿåˆ—ä¸­çš„å‘½ä»¤æ²¡æœ‰æäº¤ä¹‹å‰éƒ½ä¸ä¼šå®é™…çš„è¢«æ‰§è¡Œã€‚</li></ul></blockquote><blockquote><p>ä¸ä¿è¯åŸå­æ€§</p><ul><li>RedisåŒä¸€ä¸ªäº‹åŠ¡ä¸­å¦‚æœæœ‰ä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«æ‰§è¡Œï¼Œæ²¡æœ‰å›æ»š</li></ul></blockquote><h2 id="4-3ã€ä½¿ç”¨"><a href="#4-3ã€ä½¿ç”¨" class="headerlink" title="4.3ã€ä½¿ç”¨"></a>4.3ã€ä½¿ç”¨</h2><ul><li>å¼€å¯äº‹åŠ¡ï¼ˆmultiï¼‰</li><li>å‘½ä»¤å…¥é˜Ÿ</li><li>æ‰§è¡Œäº‹åŠ¡ï¼ˆexecï¼‰</li></ul><blockquote><p>æ­£å¸¸æ‰§è¡Œäº‹åŠ¡</p></blockquote><ul><li>ä½¿ç”¨redisäº‹åŠ¡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi    <span class="comment"># å¼€å¯äº‹åŠ¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1   <span class="comment"># QUEUEDä»£è¡¨å‘½ä»¤å…¥é˜Ÿåˆ—</span></span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; get k1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 v3</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k4 1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incr k4</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span>       <span class="comment"># execä»£è¡¨æ‰§è¡Œäº‹åŠ¡</span></span><br><span class="line">1) OK</span><br><span class="line">2) OK</span><br><span class="line">3) <span class="string">&quot;v1&quot;</span></span><br><span class="line">4) OK</span><br><span class="line">5) OK</span><br><span class="line">6) (<span class="built_in">integer</span>) 2</span><br></pre></td></tr></table></figure><blockquote><p>æ”¾å¼ƒäº‹åŠ¡ï¼ˆdiscardï¼‰</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k1 v1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k2 v2</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> k3 1</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby k3 50</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; decrby k3 26</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; DISCARD</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; get k3</span><br><span class="line">(nil)         <span class="comment">#æ”¾å¼ƒäº‹åŠ¡åå‘ç°k3å€¼ä¸ºnull</span></span><br></pre></td></tr></table></figure><blockquote><p>ï¼ˆæŠ¥å‘Šé”™è¯¯ï¼‰ç¼–è¯‘å‹å¼‚å¸¸ï¼ˆä»£ç /å‘½ä»¤æœ‰é—®é¢˜ï¼‰ï¼Œ<strong>äº‹åŠ¡ä¸­æ‰€æœ‰å‘½ä»¤éƒ½ä¸ä¼šè¢«æ‰§è¡Œ</strong></p></blockquote><blockquote><p>ï¼ˆæ‰§è¡Œé”™è¯¯ï¼‰è¿è¡Œæ—¶å¼‚å¸¸ï¼ˆä¾‹å¦‚ï¼š1/0æˆ–ç©ºæŒ‡é’ˆï¼‰ï¼Œå¦‚æœäº‹åŠ¡é˜Ÿåˆ—ä¸­å­˜åœ¨è¿è¡Œæ—¶å¼‚å¸¸ï¼Œé‚£ä¹ˆè¿™æ¡å‘ç”Ÿå¼‚å¸¸çš„å‘½ä»¤ä¸ä¼šè¢«æ‰§è¡Œï¼Œå…¶ä»–å‘½ä»¤ç»§ç»­æ‰§è¡Œï¼ˆredisäº‹åŠ¡æ²¡æœ‰ä¸€è‡´æ€§ï¼‰ï¼Œé”™è¯¯å‘½ä»¤æŠ›å‡ºå¼‚å¸¸</p></blockquote><blockquote><p>åŸå­æ€§ï¼šæŒ‡äº‹åŠ¡çš„ä¸å¯åˆ†å‰²æ€§ï¼Œä¸€ä¸ªäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆä¸é—´æ–­åœ°å…¨éƒ¨è¢«æ‰§è¡Œï¼Œè¦ä¹ˆä¸€ä¸ªä¹Ÿæ²¡æœ‰æ‰§è¡Œã€‚</p></blockquote><h2 id="4-4ã€æ³¨æ„ç‚¹"><a href="#4-4ã€æ³¨æ„ç‚¹" class="headerlink" title="4.4ã€æ³¨æ„ç‚¹"></a>4.4ã€æ³¨æ„ç‚¹</h2><blockquote><p><strong>Rediså•æ¡å‘½ä»¤æ˜¯ä¿è¯åŸå­æ€§çš„ï¼Œä½†æ˜¯Redisçš„äº‹åŠ¡æ˜¯ä¸ä¿è¯åŸå­æ€§çš„ï¼</strong></p></blockquote><h2 id="4-5ã€ç›‘æ§"><a href="#4-5ã€ç›‘æ§" class="headerlink" title="4.5ã€ç›‘æ§"></a>4.5ã€ç›‘æ§</h2><h3 id="1ã€æ‚²è§‚é”"><a href="#1ã€æ‚²è§‚é”" class="headerlink" title="1ã€æ‚²è§‚é”"></a>1ã€æ‚²è§‚é”</h3><ul><li>æ— è®ºåšä»€ä¹ˆéƒ½åŠ é”ï¼ˆä¼šå½±å“æ€§èƒ½ï¼‰</li></ul><h3 id="2ã€ä¹è§‚é”"><a href="#2ã€ä¹è§‚é”" class="headerlink" title="2ã€ä¹è§‚é”"></a>2ã€ä¹è§‚é”</h3><ul><li>è®¤ä¸ºä»€ä¹ˆæ—¶å€™éƒ½ä¸ä¼šå‡ºé—®é¢˜ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼æ›´æ–°æ•°æ®æ—¶å»åˆ¤æ–­ä»¥ä¸‹æœŸé—´æœ‰æ²¡æœ‰äººä¿®æ”¹è¿‡æ­¤æ•°æ®ã€‚</li><li>mysqlä¸­ï¼šè·å–versionï¼Œæ¯”è¾ƒversion</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203224610.png" alt="image-20210203224610835"></p><h3 id="3ã€ä½¿ç”¨watchæ¥ç›‘æ§"><a href="#3ã€ä½¿ç”¨watchæ¥ç›‘æ§" class="headerlink" title="3ã€ä½¿ç”¨watchæ¥ç›‘æ§"></a>3ã€ä½¿ç”¨watchæ¥ç›‘æ§</h3><blockquote><p>åœ¨æ‰§è¡Œmultiä¹‹å‰ï¼Œå…ˆæ‰§è¡Œwatch key1 [key2]ï¼Œå¯ä»¥ç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªkeyï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ªï¼ˆæˆ–è¿™äº›ï¼‰keyè¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«<strong>æ‰“æ–­</strong></p></blockquote><ul><li>æ­£å¸¸æ‰§è¡ŒæˆåŠŸ</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> money 100</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">set</span> out 0</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; watch money       <span class="comment">#ä½¿ç”¨watchç›‘è§†moneyå¯¹è±¡</span></span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; multi</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; decrby money 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; incrby out 20</span><br><span class="line">QUEUED</span><br><span class="line">127.0.0.1:6379&gt; <span class="built_in">exec</span></span><br><span class="line">1) (<span class="built_in">integer</span>) 80</span><br><span class="line">2) (<span class="built_in">integer</span>) 20</span><br></pre></td></tr></table></figure><h1 id="äº”ã€Jedis"><a href="#äº”ã€Jedis" class="headerlink" title="äº”ã€Jedis"></a>äº”ã€Jedis</h1><blockquote><p>JRedisæ˜¯Rediså®˜æ–¹æ¨èçš„javaè¿æ¥å¼€å‘å·¥å…·ï¼Œä½¿ç”¨javaæ“ä½œredisçš„ä¸­é—´ä»¶ï¼Œç±»ä¼¼JDBCDriver</p></blockquote><h2 id="5-1ã€å¸¸ç”¨API"><a href="#5-1ã€å¸¸ç”¨API" class="headerlink" title="5.1ã€å¸¸ç”¨API"></a>5.1ã€å¸¸ç”¨API</h2><h3 id="1ã€å¯¼å…¥ä¾èµ–"><a href="#1ã€å¯¼å…¥ä¾èµ–" class="headerlink" title="1ã€å¯¼å…¥ä¾èµ–"></a>1ã€å¯¼å…¥ä¾èµ–</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- å¯¼å…¥Jedisçš„åŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>redis.clients<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jedis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>fastjson<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.62<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2ã€ç¼–ç æµ‹è¯•"><a href="#2ã€ç¼–ç æµ‹è¯•" class="headerlink" title="2ã€ç¼–ç æµ‹è¯•"></a>2ã€ç¼–ç æµ‹è¯•</h3><blockquote><p>ä½¿ç”¨Jedisè¿æ¥Redis</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestPing</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//1 new ä¸€ä¸ªJediså¯¹è±¡ï¼Œæ„é€ å‚æ•°å¡«å…¥åœ°å€å’Œç«¯å£å·</span></span><br><span class="line">        Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">        <span class="comment">//jedis çš„å‡½æ•°å°±æ˜¯æˆ‘ä»¬ä¹‹å‰å­¦ä¹ çš„æ‰€æœ‰å‘½ä»¤</span></span><br><span class="line">        System.out.println(jedis.ping());</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203225023.png" alt="image-20210203225023793"></p><h3 id="3ã€æ“ä½œå‘½ä»¤"><a href="#3ã€æ“ä½œå‘½ä»¤" class="headerlink" title="3ã€æ“ä½œå‘½ä»¤"></a>3ã€æ“ä½œå‘½ä»¤</h3><blockquote><p>Jedisçš„æ–¹æ³•å’Œä¸Šé¢çš„å‘½ä»¤å‡ ä¹ä¸€æ ·ï¼Œè¿™é‡Œåˆ—å‡ºRedis-keyçš„</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>,<span class="number">6379</span>);</span><br><span class="line">System.out.println(<span class="string">&quot;æ¸…ç©ºæŒ‡å®šæ•°æ®åº“ä¸­çš„æ•°æ®ï¼š&quot;</span> + jedis.flushDB());</span><br><span class="line">System.out.println(<span class="string">&quot;æ¸…ç©ºæ‰€æœ‰æ•°æ®ï¼š&quot;</span> + jedis.flushAll());</span><br><span class="line">System.out.println(<span class="string">&quot;æ–°å¢&lt;&#x27;username&#x27;,&#x27;wuhu&#x27;&gt;çš„é”®å€¼å¯¹ï¼š&quot;</span> + jedis.set(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;wuhu&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;æ–°å¢&lt;&#x27;password&#x27;,&#x27;qifei&#x27;&gt;çš„é”®å€¼å¯¹ï¼š&quot;</span> + jedis.set(<span class="string">&quot;password&quot;</span>,<span class="string">&quot;qifei&quot;</span>));</span><br><span class="line">System.out.print(<span class="string">&quot;ç³»ç»Ÿä¸­æ‰€æœ‰çš„é”®å¦‚ä¸‹ï¼š&quot;</span>);</span><br><span class="line">Set&lt;String&gt; keys = jedis.keys(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">System.out.println(keys);</span><br><span class="line">System.out.println(<span class="string">&quot;åˆ é™¤é”®passwordï¼š&quot;</span> + jedis.del(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;åˆ¤æ–­é”®passwordæ˜¯å¦å­˜åœ¨ï¼š&quot;</span> + jedis.exists(<span class="string">&quot;password&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;æŸ¥çœ‹é”®usernameæ‰€å­˜å‚¨çš„å€¼çš„ç±»å‹&quot;</span> + jedis.type(<span class="string">&quot;username&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;éšæœºè¿”å›keyç©ºé—´çš„ä¸€ä¸ª&quot;</span> + jedis.randomKey());</span><br><span class="line">System.out.println(<span class="string">&quot;é‡å‘½åkeyï¼š&quot;</span> + jedis.rename(<span class="string">&quot;username&quot;</span>,<span class="string">&quot;userName&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;å–å‡ºæ”¹åçš„userNameï¼š&quot;</span> + jedis.get(<span class="string">&quot;userName&quot;</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;æŒ‰ç´¢å¼•æŸ¥è¯¢ï¼š&quot;</span> + jedis.select(<span class="number">0</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°é‡ï¼š&quot;</span> + jedis.dbSize());</span><br><span class="line">System.out.println(<span class="string">&quot;åˆ é™¤å½“å‰é€‰æ‹©æ•°æ®åº“ä¸­æ‰€æœ‰çš„keyï¼š&quot;</span> + jedis.flushDB());</span><br><span class="line">System.out.println(<span class="string">&quot;è¿”å›å½“å‰æ•°æ®åº“ä¸­keyçš„æ•°é‡ï¼š&quot;</span> + jedis.dbSize());</span><br><span class="line">System.out.println(<span class="string">&quot;åˆ é™¤æ‰€æœ‰æ•°æ®åº“ä¸­é‚£ä¸ªæ‰€æœ‰keyï¼š&quot;</span> + jedis.flushAll());</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203225132.png" alt="image-20210203225132042"></p><blockquote><p>æ–­å¼€è¿æ¥</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">jedis.close();</span><br></pre></td></tr></table></figure><h2 id="5-2ã€ä½¿ç”¨Jedisæ¨¡æ‹ŸRedisä¸­çš„äº‹åŠ¡"><a href="#5-2ã€ä½¿ç”¨Jedisæ¨¡æ‹ŸRedisä¸­çš„äº‹åŠ¡" class="headerlink" title="5.2ã€ä½¿ç”¨Jedisæ¨¡æ‹ŸRedisä¸­çš„äº‹åŠ¡"></a>5.2ã€ä½¿ç”¨Jedisæ¨¡æ‹ŸRedisä¸­çš„äº‹åŠ¡</h2><h3 id="1ã€æ¨¡æ‹Ÿäº‹åŠ¡æˆåŠŸæ‰§è¡Œ"><a href="#1ã€æ¨¡æ‹Ÿäº‹åŠ¡æˆåŠŸæ‰§è¡Œ" class="headerlink" title="1ã€æ¨¡æ‹Ÿäº‹åŠ¡æˆåŠŸæ‰§è¡Œ"></a>1ã€æ¨¡æ‹Ÿäº‹åŠ¡æˆåŠŸæ‰§è¡Œ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">jsonObject.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;wuhu&quot;</span>);</span><br><span class="line">jsonObject.put(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">String jsonStr = jsonObject.toJSONString();</span><br><span class="line"><span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line">Transaction multi = jedis.multi();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//å°†æ–¹æ³•æ”¾å…¥æ‰§è¡Œé˜Ÿåˆ—</span></span><br><span class="line">    multi.set(<span class="string">&quot;user1&quot;</span>,jsonStr);</span><br><span class="line">    multi.set(<span class="string">&quot;user2&quot;</span>,jsonStr);</span><br><span class="line">    multi.set(<span class="string">&quot;user3&quot;</span>,jsonStr);</span><br><span class="line">    multi.set(<span class="string">&quot;user4&quot;</span>,jsonStr);</span><br><span class="line">    <span class="comment">//æ‰§è¡Œäº‹åŠ¡</span></span><br><span class="line">    multi.exec();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œå°±æ”¾å¼ƒäº‹åŠ¡</span></span><br><span class="line">    multi.discard();</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œé‚£ä¹ˆå¯ä»¥è¾“å‡ºå€¼</span></span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user1&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user2&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user3&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user4&quot;</span>));</span><br><span class="line">    jedis.close();<span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203225306.png" alt="image-20210203225306161"></p><h3 id="2ã€æ¨¡æ‹Ÿäº‹åŠ¡å‡ºç°å¼‚å¸¸çš„æƒ…å†µ"><a href="#2ã€æ¨¡æ‹Ÿäº‹åŠ¡å‡ºç°å¼‚å¸¸çš„æƒ…å†µ" class="headerlink" title="2ã€æ¨¡æ‹Ÿäº‹åŠ¡å‡ºç°å¼‚å¸¸çš„æƒ…å†µ"></a>2ã€æ¨¡æ‹Ÿäº‹åŠ¡å‡ºç°å¼‚å¸¸çš„æƒ…å†µ</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">Jedis jedis = <span class="keyword">new</span> Jedis(<span class="string">&quot;127.0.0.1&quot;</span>, <span class="number">6379</span>);</span><br><span class="line">jedis.flushAll();<span class="comment">//å…ˆæ¸…é™¤æ‰€æœ‰é”®å€¼å¯¹</span></span><br><span class="line">JSONObject jsonObject = <span class="keyword">new</span> JSONObject();</span><br><span class="line">jsonObject.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;wuhu&quot;</span>);</span><br><span class="line">jsonObject.put(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">String jsonStr = jsonObject.toJSONString();</span><br><span class="line"><span class="comment">//å¼€å¯äº‹åŠ¡</span></span><br><span class="line">Transaction multi = jedis.multi();</span><br><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    <span class="comment">//å°†æ–¹æ³•æ”¾å…¥æ‰§è¡Œé˜Ÿåˆ—</span></span><br><span class="line">    multi.set(<span class="string">&quot;user1&quot;</span>,jsonStr);</span><br><span class="line">    multi.set(<span class="string">&quot;user2&quot;</span>,jsonStr);</span><br><span class="line">    multi.set(<span class="string">&quot;user3&quot;</span>,jsonStr);</span><br><span class="line">    multi.set(<span class="string">&quot;user4&quot;</span>,jsonStr);</span><br><span class="line">    <span class="comment">//æ¨¡æ‹Ÿå¼‚å¸¸</span></span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">1</span> / <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ‰§è¡Œäº‹åŠ¡</span></span><br><span class="line">    multi.exec();</span><br><span class="line">&#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœå‡ºç°å¼‚å¸¸ï¼Œå°±æ”¾å¼ƒäº‹åŠ¡</span></span><br><span class="line">    multi.discard();</span><br><span class="line">    e.printStackTrace();</span><br><span class="line">&#125; <span class="keyword">finally</span> &#123;</span><br><span class="line">    <span class="comment">//å¦‚æœæ²¡æœ‰å¼‚å¸¸ï¼Œé‚£ä¹ˆå¯ä»¥è¾“å‡ºå€¼</span></span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user1&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user2&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user3&quot;</span>));</span><br><span class="line">    System.out.println(jedis.get(<span class="string">&quot;user4&quot;</span>));</span><br><span class="line">    jedis.close();<span class="comment">//å…³é—­è¿æ¥</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203225346.png" alt="image-20210203225346130"></p><h1 id="å…­ã€Spring-Bootæ•´åˆRedis"><a href="#å…­ã€Spring-Bootæ•´åˆRedis" class="headerlink" title="å…­ã€Spring Bootæ•´åˆRedis"></a>å…­ã€Spring Bootæ•´åˆRedis</h1><blockquote><p>Spring Boot Data redisæä¾›äº†<strong>RedisTemplate</strong>å’Œ<strong>StringTemplate</strong>ï¼Œå…¶ä¸­StringTemplateæ˜¯RedisTemplateçš„å­ç±»ï¼ŒRedisTemplateä¸­ä¸¤ä¸ªæ³›å‹éƒ½æ˜¯Objectï¼Œæ„å‘³ç€å­˜å‚¨çš„keyå’Œvalueéƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€ŒStringTemplateä¸¤ä¸ªæ³›å‹éƒ½æ˜¯String</p><p><strong>æ³¨ï¼šå¯¹è±¡çš„ä¿å­˜éœ€è¦åºåˆ—åŒ–</strong></p></blockquote><h2 id="6-1ã€å¼•å…¥ä¾èµ–"><a href="#6-1ã€å¼•å…¥ä¾èµ–" class="headerlink" title="6.1ã€å¼•å…¥ä¾èµ–"></a>6.1ã€å¼•å…¥ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- æ“ä½œredis --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-data-redis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨springboot2.xåï¼ŒåŸæ¥çš„jedisè¢«æ›¿æ¢ä¸ºäº†lecture</li><li>jedisï¼šé‡‡ç”¨ç›´è¿ï¼Œå¤šçº¿ç¨‹æ“ä½œä¸å®‰å…¨ï¼Œéœ€è¦ä½¿ç”¨è¿æ¥æ± ï¼ŒBIO</li><li>lectureï¼šåº•å±‚ä½¿ç”¨nettyï¼Œä¸å­˜åœ¨æ€§èƒ½ä¸å®‰å…¨çš„æƒ…å†µ,NIO</li></ul><h2 id="6-2ã€é…ç½®"><a href="#6-2ã€é…ç½®" class="headerlink" title="6.2ã€é…ç½®"></a>6.2ã€é…ç½®</h2><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">redis:</span></span><br><span class="line">    <span class="attr">host:</span> <span class="number">127.0</span><span class="number">.0</span><span class="number">.1</span></span><br><span class="line">    <span class="attr">port:</span> <span class="number">6379</span></span><br></pre></td></tr></table></figure><h2 id="6-3ã€æµ‹è¯•"><a href="#6-3ã€æµ‹è¯•" class="headerlink" title="6.3ã€æµ‹è¯•"></a>6.3ã€æµ‹è¯•</h2><blockquote><p>åˆ†ææºç å¯çŸ¥ï¼ŒSpring Bootå·²ç»ä¸ºæˆ‘ä»¬æ³¨å†Œäº†ä¸€ä¸ª<strong>keyå’Œvalueå‡ä¸ºObject</strong>çš„RedisTemplateï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå·±æ³¨å†Œä¸€ä¸ª<strong>RedisTemplate</strong>æ¥æ›¿æ¢Spring Bootä¸ºæˆ‘ä»¬è‡ªåŠ¨æ³¨å…¥çš„RedisTemplate</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203225717.png" alt="image-20210203225717224"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//redisTemplate</span></span><br><span class="line">    <span class="comment">//opsForValue æ“ä½œå­—ç¬¦ä¸²ï¼Œç±»ä¼¼String</span></span><br><span class="line">    <span class="comment">//opsForList  æ“ä½œlistï¼Œç±»ä¼¼List</span></span><br><span class="line">    <span class="comment">//opsForSet   æ“ä½œSetï¼Œç±»ä¼¼Set</span></span><br><span class="line">    <span class="comment">//opsForZset  æ“ä½œZsetï¼Œç±»ä¼¼Zset</span></span><br><span class="line">    <span class="comment">//opsForHash  æ“ä½œHashï¼Œç±»ä¼¼Hash</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//åŸºæœ¬æ“ä½œå·²ç»å°è£…åˆ°redisTemplateä¸­</span></span><br><span class="line">    <span class="comment">//        RedisConnection connection = redisTemplate.getConnectionFactory().getConnection();</span></span><br><span class="line">    <span class="comment">//        connection.flushAll();</span></span><br><span class="line">    <span class="comment">//        connection.flushDb();</span></span><br><span class="line"></span><br><span class="line">    redisTemplate.opsForValue().set(<span class="string">&quot;key&quot;</span>,<span class="string">&quot;value&quot;</span>);</span><br><span class="line">    System.out.println(redisTemplate.opsForValue().get(<span class="string">&quot;key&quot;</span>));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>Spring Boot é»˜è®¤ä½¿ç”¨JDKåºåˆ—åŒ–ï¼ŒJDKåºåˆ—åŒ–ä¼šä½¿å­—ç¬¦è½¬ä¹‰ï¼Œæˆ‘ä»¬å¯ä»¥è‡ªå®šä¹‰é…ç½®ç±»ï¼Œä½¿ç”¨JSONè¿›è¡Œåºåˆ—åŒ–ã€‚</p></blockquote><h2 id="6-4ã€è‡ªå®šä¹‰RedisTemplate"><a href="#6-4ã€è‡ªå®šä¹‰RedisTemplate" class="headerlink" title="6.4ã€è‡ªå®šä¹‰RedisTemplate"></a>6.4ã€è‡ªå®šä¹‰RedisTemplate</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.JsonAutoDetect;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.annotation.PropertyAccessor;</span><br><span class="line"><span class="keyword">import</span> com.fasterxml.jackson.databind.ObjectMapper;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.connection.RedisConnectionFactory;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.Jackson2JsonRedisSerializer;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.serializer.StringRedisSerializer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisConfig</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;all&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> RedisTemplate&lt;String, Object&gt; <span class="title">redisTemplate</span><span class="params">(RedisConnectionFactory factory)</span> </span>&#123;</span><br><span class="line">        RedisTemplate&lt;String, Object&gt; template = <span class="keyword">new</span> RedisTemplate&lt;String, Object&gt;();</span><br><span class="line">        template.setConnectionFactory(factory);</span><br><span class="line">        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = <span class="keyword">new</span> Jackson2JsonRedisSerializer(Object.class);</span><br><span class="line">        ObjectMapper om = <span class="keyword">new</span> ObjectMapper();</span><br><span class="line">        om.setVisibility(PropertyAccessor.ALL, JsonAutoDetect.Visibility.ANY);</span><br><span class="line">        om.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);</span><br><span class="line">        jackson2JsonRedisSerializer.setObjectMapper(om);</span><br><span class="line">        StringRedisSerializer stringRedisSerializer = <span class="keyword">new</span> StringRedisSerializer();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// keyé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span></span><br><span class="line">        template.setKeySerializer(stringRedisSerializer);</span><br><span class="line">        <span class="comment">// hashçš„keyä¹Ÿé‡‡ç”¨Stringçš„åºåˆ—åŒ–æ–¹å¼</span></span><br><span class="line">        template.setHashKeySerializer(stringRedisSerializer);</span><br><span class="line">        <span class="comment">// valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span></span><br><span class="line">        template.setValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        <span class="comment">// hashçš„valueåºåˆ—åŒ–æ–¹å¼é‡‡ç”¨jackson</span></span><br><span class="line">        template.setHashValueSerializer(jackson2JsonRedisSerializer);</span><br><span class="line">        template.afterPropertiesSet();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> template;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨è‡ªå®šä¹‰çš„RedisTemplateä¸­ï¼Œå°†é”®ä»Objectæ¢ä¸ºStringï¼ŒåŒæ—¶ä½¿ç”¨JSONåºåˆ—åŒ–å¯¹è±¡ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line">   <span class="function"><span class="keyword">void</span> <span class="title">contextLoads</span><span class="params">()</span> </span>&#123;</span><br><span class="line">       User user = <span class="keyword">new</span> User(<span class="number">1</span>,<span class="string">&quot;èŠœæ¹–&quot;</span>,<span class="string">&quot;èµ·é£&quot;</span>);</span><br><span class="line">       String userJson = JSON.toJSONString(user);</span><br><span class="line">       redisTemplate.opsForValue().set(<span class="string">&quot;user2&quot;</span>,userJson);</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure><h3 id="1ã€ä½¿ç”¨JDKåºåˆ—åŒ–å¯¹è±¡"><a href="#1ã€ä½¿ç”¨JDKåºåˆ—åŒ–å¯¹è±¡" class="headerlink" title="1ã€ä½¿ç”¨JDKåºåˆ—åŒ–å¯¹è±¡"></a>1ã€ä½¿ç”¨JDKåºåˆ—åŒ–å¯¹è±¡</h3><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203231614.png" alt="image-20210203231614676"></p><h3 id="2ã€ä½¿ç”¨JSONåºåˆ—åŒ–å¯¹è±¡"><a href="#2ã€ä½¿ç”¨JSONåºåˆ—åŒ–å¯¹è±¡" class="headerlink" title="2ã€ä½¿ç”¨JSONåºåˆ—åŒ–å¯¹è±¡"></a>2ã€ä½¿ç”¨JSONåºåˆ—åŒ–å¯¹è±¡</h3><blockquote><p>åˆ é™¤Redisä¸­çš„é”®å€¼å¯¹ï¼Œå¼•å…¥æˆ‘ä»¬è‡ªå®šä¹‰çš„RedisTemplateï¼Œé‡æ–°æ‰§è¡Œä¸Šé¢çš„æ–¹æ³•ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203231754.png" alt="image-20210203231753977"></p><h2 id="6-5ã€RedisUtils"><a href="#6-5ã€RedisUtils" class="headerlink" title="6.5ã€RedisUtils"></a>6.5ã€RedisUtils</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzx.springboot_redis.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.data.redis.core.RedisTemplate;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Component;</span><br><span class="line"><span class="keyword">import</span> org.springframework.util.CollectionUtils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Map;</span><br><span class="line"><span class="keyword">import</span> java.util.Set;</span><br><span class="line"><span class="keyword">import</span> java.util.concurrent.TimeUnit;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">final</span> <span class="class"><span class="keyword">class</span> <span class="title">RedisUtil</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> RedisTemplate&lt;String, Object&gt; redisTemplate;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// =============================common============================</span></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æŒ‡å®šç¼“å­˜å¤±æ•ˆæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">expire</span><span class="params">(String key, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                redisTemplate.expire(key, time, TimeUnit.SECONDS);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®key è·å–è¿‡æœŸæ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æ—¶é—´(ç§’) è¿”å›0ä»£è¡¨ä¸ºæ°¸ä¹…æœ‰æ•ˆ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">getExpire</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.getExpire(key, TimeUnit.SECONDS);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hasKey</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.hasKey(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤ç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key å¯ä»¥ä¼ ä¸€ä¸ªå€¼ æˆ–å¤šä¸ª</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@SuppressWarnings(&quot;unchecked&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">del</span><span class="params">(String... key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (key != <span class="keyword">null</span> &amp;&amp; key.length &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (key.length == <span class="number">1</span>) &#123;</span><br><span class="line">                redisTemplate.delete(key[<span class="number">0</span>]);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                redisTemplate.delete(CollectionUtils.arrayToList(key));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ============================String=============================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šç¼“å­˜è·å–</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">get</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> key == <span class="keyword">null</span> ? <span class="keyword">null</span> : redisTemplate.opsForValue().get(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šç¼“å­˜æ”¾å…¥</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueæˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForValue().set(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ™®é€šç¼“å­˜æ”¾å…¥å¹¶è®¾ç½®æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’) timeè¦å¤§äº0 å¦‚æœtimeå°äºç­‰äº0 å°†è®¾ç½®æ— é™æœŸ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueæˆåŠŸ false å¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">set</span><span class="params">(String key, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                redisTemplate.opsForValue().set(key, value, time, TimeUnit.SECONDS);</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                set(key, value);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å¢</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta è¦å¢åŠ å‡ (å¤§äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">incr</span><span class="params">(String key, <span class="keyword">long</span> delta)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;é€’å¢å› å­å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€’å‡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> delta è¦å‡å°‘å‡ (å°äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">decr</span><span class="params">(String key, <span class="keyword">long</span> delta)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (delta &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">&quot;é€’å‡å› å­å¿…é¡»å¤§äº0&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForValue().increment(key, -delta);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ================================Map=================================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashGet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹ ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">hget</span><span class="params">(String key, String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().get(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–hashKeyå¯¹åº”çš„æ‰€æœ‰é”®å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å¯¹åº”çš„å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Map&lt;Object, Object&gt; <span class="title">hmget</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().entries(key);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashSet</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map å¯¹åº”å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * HashSet å¹¶è®¾ç½®æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> map  å¯¹åº”å¤šä¸ªé”®å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> trueæˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hmset</span><span class="params">(String key, Map&lt;String, Object&gt; map, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().putAll(key, map);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item  é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true æˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hset</span><span class="params">(String key, String item, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å‘ä¸€å¼ hashè¡¨ä¸­æ”¾å…¥æ•°æ®,å¦‚æœä¸å­˜åœ¨å°†åˆ›å»º</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item  é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’) æ³¨æ„:å¦‚æœå·²å­˜åœ¨çš„hashè¡¨æœ‰æ—¶é—´,è¿™é‡Œå°†ä¼šæ›¿æ¢åŸæœ‰çš„æ—¶é—´</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true æˆåŠŸ falseå¤±è´¥</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hset</span><span class="params">(String key, String item, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForHash().put(key, item, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                expire(key, time);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ é™¤hashè¡¨ä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹ å¯ä»¥ä½¿å¤šä¸ª ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">hdel</span><span class="params">(String key, Object... item)</span> </span>&#123;</span><br><span class="line">        redisTemplate.opsForHash().delete(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åˆ¤æ–­hashè¡¨ä¸­æ˜¯å¦æœ‰è¯¥é¡¹çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”® ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹ ä¸èƒ½ä¸ºnull</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">hHasKey</span><span class="params">(String key, String item)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().hasKey(key, item);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hashé€’å¢ å¦‚æœä¸å­˜åœ¨,å°±ä¼šåˆ›å»ºä¸€ä¸ª å¹¶æŠŠæ–°å¢åçš„å€¼è¿”å›</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> by   è¦å¢åŠ å‡ (å¤§äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">hincr</span><span class="params">(String key, String item, <span class="keyword">double</span> by)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, by);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * hashé€’å‡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key  é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> item é¡¹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> by   è¦å‡å°‘è®°(å°äº0)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">hdecr</span><span class="params">(String key, String item, <span class="keyword">double</span> by)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> redisTemplate.opsForHash().increment(key, item, -by);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">// ============================set=============================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®keyè·å–Setä¸­çš„æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Set&lt;Object&gt; <span class="title">sGet</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().members(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®valueä»ä¸€ä¸ªsetä¸­æŸ¥è¯¢,æ˜¯å¦å­˜åœ¨</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> true å­˜åœ¨ falseä¸å­˜åœ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">sHasKey</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().isMember(key, value);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†æ•°æ®æ”¾å…¥setç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆåŠŸä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sSet</span><span class="params">(String key, Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().add(key, values);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†setæ•°æ®æ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time   æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> æˆåŠŸä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sSetAndTime</span><span class="params">(String key, <span class="keyword">long</span> time, Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long count = redisTemplate.opsForSet().add(key, values);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–setç¼“å­˜çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">sGetSetSize</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForSet().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤å€¼ä¸ºvalueçš„</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key    é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> values å€¼ å¯ä»¥æ˜¯å¤šä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç§»é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">setRemove</span><span class="params">(String key, Object... values)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long count = redisTemplate.opsForSet().remove(key, values);</span><br><span class="line">            <span class="keyword">return</span> count;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// ===============================list=================================</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–listç¼“å­˜çš„å†…å®¹</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> start å¼€å§‹</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> end   ç»“æŸ 0 åˆ° -1ä»£è¡¨æ‰€æœ‰å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Object&gt; <span class="title">lGet</span><span class="params">(String key, <span class="keyword">long</span> start, <span class="keyword">long</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().range(key, start, end);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * è·å–listç¼“å­˜çš„é•¿åº¦</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key é”®</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">lGetListSize</span><span class="params">(String key)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().size(key);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * é€šè¿‡ç´¢å¼• è·å–listä¸­çš„å€¼</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index ç´¢å¼• index&gt;=0æ—¶ï¼Œ 0 è¡¨å¤´ï¼Œ1 ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨ï¼›index&lt;0æ—¶ï¼Œ-1ï¼Œè¡¨å°¾ï¼Œ-2å€’æ•°ç¬¬äºŒä¸ªå…ƒç´ ï¼Œä¾æ¬¡ç±»æ¨</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">lGetIndex</span><span class="params">(String key, <span class="keyword">long</span> index)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> redisTemplate.opsForList().index(key, index);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, Object value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPush(key, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, List&lt;Object&gt; value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * å°†listæ”¾å…¥ç¼“å­˜</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> time  æ—¶é—´(ç§’)</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lSet</span><span class="params">(String key, List&lt;Object&gt; value, <span class="keyword">long</span> time)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().rightPushAll(key, value);</span><br><span class="line">            <span class="keyword">if</span> (time &gt; <span class="number">0</span>)</span><br><span class="line">                expire(key, time);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * æ ¹æ®ç´¢å¼•ä¿®æ”¹listä¸­çš„æŸæ¡æ•°æ®</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> index ç´¢å¼•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">lUpdateIndex</span><span class="params">(String key, <span class="keyword">long</span> index, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            redisTemplate.opsForList().set(key, index, value);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ç§»é™¤Nä¸ªå€¼ä¸ºvalue</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> key   é”®</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> count ç§»é™¤å¤šå°‘ä¸ª</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> value å€¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ç§»é™¤çš„ä¸ªæ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">long</span> <span class="title">lRemove</span><span class="params">(String key, <span class="keyword">long</span> count, Object value)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            Long remove = redisTemplate.opsForList().remove(key, count, value);</span><br><span class="line">            <span class="keyword">return</span> remove;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Rediså­¦ä¹ æ‰‹å†Œï¼ˆä¸€ï¼‰--NoSQLã€rediså…¥é—¨åŠåŸºæœ¬æ•°æ®ç±»å‹</title>
      <link href="posts/2005124203.html"/>
      <url>posts/2005124203.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€NoSQL"><a href="#ä¸€ã€NoSQL" class="headerlink" title="ä¸€ã€NoSQL"></a>ä¸€ã€NoSQL</h1><blockquote><p>NoSQL = Not Only SQLï¼Œä¸ä»…ä»…æ˜¯SQLï¼Œæ³›æŒ‡éå…³ç³»æ•°æ®åº“</p><p>ä½¿ç”¨åœºæ™¯ï¼šæ•°æ®å˜åŒ–ä¸æ˜¯å¾ˆé¢‘ç¹ï¼Œè®¿é—®é‡ç›¸å¯¹è¾ƒå¤§</p></blockquote><h1 id="äºŒã€Rediså…¥é—¨"><a href="#äºŒã€Rediså…¥é—¨" class="headerlink" title="äºŒã€Rediså…¥é—¨"></a>äºŒã€Rediså…¥é—¨</h1><h2 id="2-1ã€æ¦‚è¿°"><a href="#2-1ã€æ¦‚è¿°" class="headerlink" title="2.1ã€æ¦‚è¿°"></a>2.1ã€æ¦‚è¿°</h2><ul><li><p>RedisæŒ‡Remote Dictionary Serverï¼Œå³<strong>è¿œç¨‹å­—å…¸æœåŠ¡</strong></p></li><li><p>ä¸€ä¸ªå¼€æºçš„ç”±ANSI Cè¯­è¨€ç¼–å†™ï¼Œæ”¯æŒç½‘ç»œã€å¯åŸºäºå†…å­˜ä¹Ÿå¯æŒä¹…åŒ–çš„æ—¥å¿—å‹Key-valueæ•°æ®åº“ï¼Œæ”¯æŒå¤šç§è¯­è¨€</p></li><li><p>redisä¼šå‘¨æœŸæ€§å°†æ›´æ–°çš„æ•°æ®å†™å…¥ç£ç›˜æˆ–è€…æŠŠä¿®æ”¹æ“ä½œå†™å…¥è¿½åŠ çš„è®°å½•æ–‡ä»¶</p></li></ul><h2 id="2-2ã€ç‰¹æ€§"><a href="#2-2ã€ç‰¹æ€§" class="headerlink" title="2.2ã€ç‰¹æ€§"></a>2.2ã€ç‰¹æ€§</h2><ul><li>å¼€æº</li><li>æ”¯æŒå¤šç§è¯­è¨€</li><li>æ”¯æŒæŒä¹…åŒ–ã€é›†ç¾¤å’Œäº‹åŠ¡</li></ul><h2 id="2-3ã€åŸºç¡€çŸ¥è¯†"><a href="#2-3ã€åŸºç¡€çŸ¥è¯†" class="headerlink" title="2.3ã€åŸºç¡€çŸ¥è¯†"></a>2.3ã€åŸºç¡€çŸ¥è¯†</h2><ul><li>redisæœ‰16ä¸ªæ•°æ®åº“ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬1ä¸ªæ•°æ®åº“ï¼ˆä¸‹æ ‡ä¸º0ï¼‰</li><li>ä½¿ç”¨selectå¯ä»¥åˆ‡æ¢æ•°æ®åº“ï¼Œä½¿ç”¨DBSIZEå¯ä»¥æŸ¥çœ‹å½“å‰æ•°æ®åº“çš„æ•°æ®æ•°é‡</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203220924.png"></p><ul><li>æ¸…é™¤å½“å‰æ•°æ®åº“ï¼šflushdb</li><li>æ¸…æ¥šæ‰€æœ‰æ•°æ®åº“ï¼šflushall</li><li>redisæ˜¯å•çº¿ç¨‹çš„ï¼Œredisçš„ç“¶é¢ˆæ˜¯æ ¹æ®æœºå™¨çš„å†…å­˜å’Œç½‘ç»œå¸¦å®½ã€‚</li></ul><h1 id="ä¸‰ã€äº”å¤§æ•°æ®ç±»å‹"><a href="#ä¸‰ã€äº”å¤§æ•°æ®ç±»å‹" class="headerlink" title="ä¸‰ã€äº”å¤§æ•°æ®ç±»å‹"></a>ä¸‰ã€äº”å¤§æ•°æ®ç±»å‹</h1><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203221317.png" alt="image-20210203221317019"></p><h2 id="3-1ã€Redis-key"><a href="#3-1ã€Redis-key" class="headerlink" title="3.1ã€Redis-key"></a>3.1ã€Redis-key</h2><blockquote><p>EXISTS é”®åï¼Œå¦‚æœæœ‰è¿™ä¸ªé”®ï¼Œè¿”å›1ï¼Œå¦åˆ™è¿”å›0<br>exists é”®å</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203221451.png" alt="image-20201011214514520"></p><h2 id="3-2ã€Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"><a href="#3-2ã€Stringï¼ˆå­—ç¬¦ä¸²ï¼‰" class="headerlink" title="3.2ã€Stringï¼ˆå­—ç¬¦ä¸²ï¼‰"></a>3.2ã€Stringï¼ˆå­—ç¬¦ä¸²ï¼‰</h2><h3 id="1ã€append-é”®å-è¦è¿½åŠ çš„å†…å®¹ï¼š"><a href="#1ã€append-é”®å-è¦è¿½åŠ çš„å†…å®¹ï¼š" class="headerlink" title="1ã€append é”®å è¦è¿½åŠ çš„å†…å®¹ï¼š"></a>1ã€append é”®å è¦è¿½åŠ çš„å†…å®¹ï¼š</h3><blockquote><p>å¾€å·²æœ‰çš„é”®å€¼å¯¹çš„å€¼ä¸­æ‹¼æ¥æ–°å†…å®¹ï¼Œå¦‚æœæ²¡æœ‰è¯¥é”®ï¼Œé‚£ä¹ˆå°±æ–°å»ºä¸€ä¸ªé”®å€¼å¯¹ï¼ˆç›¸å½“äºsetï¼‰</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> name hello</span><br><span class="line">get name</span><br><span class="line">è¾“å‡ºhello</span><br><span class="line">append name world</span><br><span class="line">è¾“å‡º10--&gt;è¿”å›æ‹¼æ¥åå€¼çš„é•¿åº¦</span><br><span class="line">get name</span><br><span class="line">è¾“å‡ºhelloworld</span><br></pre></td></tr></table></figure><ul><li>å…ˆè®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ï¼Œå³nameâ€“&gt;helloï¼Œç„¶åå¾€è¯¥é”®å€¼å¯¹çš„å€¼ä¸­æ‹¼æ¥å­—ç¬¦worldï¼Œæœ€åä½¿ç”¨get nameæŸ¥çœ‹ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142557.png" alt="image-20201011222603013"></p><h3 id="2ã€strlen-é”®å-ï¼š"><a href="#2ã€strlen-é”®å-ï¼š" class="headerlink" title="2ã€strlen é”®å ï¼š"></a>2ã€strlen é”®å ï¼š</h3><blockquote><p>è·å–è¯¥é”®å€¼å¯¹ä¸­å€¼çš„é•¿åº¦</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">strlen name</span><br><span class="line">è¾“å‡º10</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142558.png" alt="image-20201011222916865"></p><h3 id="3ã€incr-é”®åï¼š"><a href="#3ã€incr-é”®åï¼š" class="headerlink" title="3ã€incr é”®åï¼š"></a>3ã€incr é”®åï¼š</h3><blockquote><p>é’ˆå¯¹æ•°å€¼ä½¿ç”¨ï¼Œè®©æ•°å€¼çš„å€¼+1</p></blockquote><ul><li>åˆå§‹åŒ–ä¸€ä¸ªé”®å€¼å¯¹ï¼ˆviewsâ€“0ï¼‰ï¼Œç„¶åä½¿ç”¨incr å‘½ä»¤è®©å…¶+1</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> views 0</span><br><span class="line">è¾“å‡º0</span><br><span class="line">incr views</span><br><span class="line">get views</span><br><span class="line">è¾“å‡º1</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142559.png" alt="image-20201011224023734"></p><h3 id="4ã€decr-é”®åï¼š"><a href="#4ã€decr-é”®åï¼š" class="headerlink" title="4ã€decr é”®åï¼š"></a>4ã€decr é”®åï¼š</h3><blockquote><p>åŒé’ˆå¯¹æ•°å€¼ä½¿ç”¨ï¼Œè®©è¯¥æ•°å€¼çš„å€¼-1</p></blockquote><ul><li>å°†ä¸Šé¢çš„viewsä»3å‡åˆ°2</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">decr views</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142600.png" alt="image-20201011224227673"></p><h3 id="5ã€incrby-decrbyï¼š"><a href="#5ã€incrby-decrbyï¼š" class="headerlink" title="5ã€incrby/decrbyï¼š"></a>5ã€incrby/decrbyï¼š</h3><blockquote><p>ç±»ä¼¼incr/decrï¼Œå¤šäº†ä¸ªæ­¥é•¿</p></blockquote><ul><li>å°†viewsçš„å€¼ä»2ç›´æ¥åŠ åˆ°12ï¼ˆæ­¥é•¿è®¾ç½®ä¸º10ï¼‰ï¼Œç„¶åæŠŠviewsçš„å€¼ä»12é™åˆ°7ï¼ˆæ­¥é•¿ä¸º5ï¼‰</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">incrby views 10</span><br><span class="line">decrby views 5</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142601.png" alt="image-20201011224913175"></p><h3 id="6ã€GETRANGE-é”®å-èµ·å§‹åæ ‡-ç»ˆæ­¢åæ ‡ï¼ˆç±»ä¼¼javaä¸­Stringç±»çš„substringï¼‰"><a href="#6ã€GETRANGE-é”®å-èµ·å§‹åæ ‡-ç»ˆæ­¢åæ ‡ï¼ˆç±»ä¼¼javaä¸­Stringç±»çš„substringï¼‰" class="headerlink" title="6ã€GETRANGE é”®å èµ·å§‹åæ ‡ ç»ˆæ­¢åæ ‡ï¼ˆç±»ä¼¼javaä¸­Stringç±»çš„substringï¼‰"></a>6ã€GETRANGE é”®å èµ·å§‹åæ ‡ ç»ˆæ­¢åæ ‡ï¼ˆç±»ä¼¼javaä¸­Stringç±»çš„substringï¼‰</h3><blockquote><p>æˆªå–ï¼ˆç»ˆæ­¢åæ ‡ - èµ·å§‹åæ ‡ï¼‰ + 1ä¸ªå­—ç¬¦ï¼Œé—­åŒºé—´[èµ·å§‹,ç»ˆæ­¢]</p></blockquote><ul><li>è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç„¶åæˆªå–è¯¥å€¼çš„ä¸€éƒ¨åˆ†</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142602.png" alt="image-20201011225254904"></p><blockquote><p>ä½¿ç”¨GETRANGE é”®å 0  -1è·å–å€¼å¯¹åº”çš„æ•´ä¸ªå­—ç¬¦ä¸²ï¼Œç›¸å½“äºget é”®å</p></blockquote><ul><li>è·å–è¯¥é”®å€¼å¯¹å€¼çš„å…¨éƒ¨å†…å®¹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142603.png" alt="image-20201011225441783"></p><h3 id="7ã€SETRANGE-é”®å-åç§»é‡n-è¦æ›¿æ¢çš„å­—ç¬¦ä¸²"><a href="#7ã€SETRANGE-é”®å-åç§»é‡n-è¦æ›¿æ¢çš„å­—ç¬¦ä¸²" class="headerlink" title="7ã€SETRANGE é”®å åç§»é‡n è¦æ›¿æ¢çš„å­—ç¬¦ä¸²"></a>7ã€SETRANGE é”®å åç§»é‡n è¦æ›¿æ¢çš„å­—ç¬¦ä¸²</h3><blockquote><p>æ›¿æ¢æŒ‡å®šå­—ç¬¦å¼€å§‹çš„å­—ç¬¦ä¸²</p></blockquote><ul><li>å…ˆè®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ï¼škey2â€“&gt;abcdefgï¼Œç„¶ååç§»ä¸€ä¸ªå•ä½ï¼Œå°†xxæ›¿æ¢åˆ°ç›®æ ‡ä¸²ä¸­</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142604.png" alt="image-20201011230122084"></p><h3 id="8ã€setex-é”®å-è¿‡æœŸæ—¶é—´-å€¼"><a href="#8ã€setex-é”®å-è¿‡æœŸæ—¶é—´-å€¼" class="headerlink" title="8ã€setex é”®å è¿‡æœŸæ—¶é—´ å€¼"></a>8ã€setex é”®å è¿‡æœŸæ—¶é—´ å€¼</h3><blockquote><p>ä¸ºæŒ‡å®šçš„keyè®¾ç½®å€¼å’Œè¿‡æœŸæ—¶é—´ï¼Œå¦‚æœkeyå·²ç»å­˜åœ¨ï¼ŒSETEXå‘½ä»¤ä¼šæ›¿æ¢æ—§çš„å€¼</p></blockquote><ul><li>å…ˆè®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç„¶åä½¿ç”¨setexè¦†ç›–</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142605.png" alt="image-20201011232438878"></p><h3 id="9ã€setnx-SET-IF-NOT-EXISTS-é”®å-å€¼"><a href="#9ã€setnx-SET-IF-NOT-EXISTS-é”®å-å€¼" class="headerlink" title="9ã€setnx(SET IF NOT EXISTS) é”®å å€¼"></a>9ã€setnx(SET IF NOT EXISTS) é”®å å€¼</h3><blockquote><p>å½“æŒ‡å®šçš„keyä¸å­˜åœ¨æ—¶ï¼Œä¸ºkeyè®¾ç½®æŒ‡å®šçš„å€¼ï¼Œå¦‚æœå­˜åœ¨ä¼šè¦†ç›–å¤±è´¥ï¼Œè¿”å›0ï¼ŒæˆåŠŸè¿”å›1ï¼Œè¿™ä¸ªå‘½ä»¤ç»å¸¸åœ¨åˆ†å¸ƒå¼é”ä¸­ç”¨åˆ°</p></blockquote><ul><li>å…ˆè®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹ï¼Œç„¶åå°è¯•ä½¿ç”¨setnxè¦†ç›–ï¼Œè§‚å¯Ÿç»“æœï¼Œå‘ç°è¿”å›0ï¼Œä¸”keyçš„å€¼è¿˜æ˜¯wuhu111</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142606.png" alt="image-20201011232537974"></p><h3 id="10ã€mset-é”®1-å€¼1-é”®2-å€¼2-â€¦"><a href="#10ã€mset-é”®1-å€¼1-é”®2-å€¼2-â€¦" class="headerlink" title="10ã€mset é”®1 å€¼1 é”®2 å€¼2 â€¦"></a>10ã€mset é”®1 å€¼1 é”®2 å€¼2 â€¦</h3><blockquote><p>ä½¿ç”¨è¿™ä¸ªå‘½ä»¤å¯ä»¥æ‰¹é‡æ·»åŠ é”®å€¼å¯¹</p></blockquote><ul><li>æ·»åŠ ä¸‰ä¸ªé”®å€¼å¯¹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142607.png" alt="image-20201011233358741"></p><h3 id="11ã€mget-é”®1-é”®2-â€¦"><a href="#11ã€mget-é”®1-é”®2-â€¦" class="headerlink" title="11ã€mget é”®1 é”®2 â€¦"></a>11ã€mget é”®1 é”®2 â€¦</h3><blockquote><p>æ‰¹é‡å–å¾—å€¼</p></blockquote><ul><li>å–å¾—ä¸Šé¢æ·»åŠ çš„å€¼</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142608.png" alt="image-20201011233547127"></p><h3 id="12ã€msetnx-é”®1-å€¼1-â€¦"><a href="#12ã€msetnx-é”®1-å€¼1-â€¦" class="headerlink" title="12ã€msetnx é”®1 å€¼1 â€¦"></a>12ã€msetnx é”®1 å€¼1 â€¦</h3><blockquote><p>åŒæ—¶æ’å…¥å¤šä¸ªé”®å€¼å¯¹ï¼Œå¦‚æœæœ‰ä¸€ä¸ªé”®å·²ç»å­˜åœ¨ï¼Œå°±ä¸æ‰§è¡Œæ’å…¥æ“ä½œï¼Œæ‰€æœ‰é”®éƒ½ä¸å­˜åœ¨æ—¶æ‰æ’å…¥</p></blockquote><h3 id="13ã€è®¾ç½®å¯¹è±¡"><a href="#13ã€è®¾ç½®å¯¹è±¡" class="headerlink" title="13ã€è®¾ç½®å¯¹è±¡"></a>13ã€è®¾ç½®å¯¹è±¡</h3><blockquote><p>set user : 1 {username : zhuo,age : 18}</p></blockquote><ul><li>ä½¿ç”¨msetå’Œmgetå­˜å‚¨å’Œè·å–å¯¹è±¡</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; mset user:1:name hzx user:1:age 18</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; mget user:1:name user:1:age</span><br><span class="line">1) <span class="string">&quot;hzx&quot;</span></span><br><span class="line">2) <span class="string">&quot;18&quot;</span></span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142609.png" alt="image-20201011234455595"></p><h3 id="14ã€getset-å…ˆå–åèµ‹å€¼"><a href="#14ã€getset-å…ˆå–åèµ‹å€¼" class="headerlink" title="14ã€getset å…ˆå–åèµ‹å€¼"></a>14ã€getset å…ˆå–åèµ‹å€¼</h3><blockquote><p>ç”±äºæ˜¯å…ˆgetåsetï¼Œæ‰€ä»¥æ³¨æ„ç»“æœæ˜¯ä¸Šæ¬¡çš„å€¼ï¼Œå…ˆè¿”å›å½“å‰å€¼ï¼Œåè®¾ç½®æ–°å€¼</p></blockquote><ul><li>è®¾ç½®ä¸€ä¸ªé”®å€¼å¯¹k1-v1ï¼Œç„¶åä½¿ç”¨getsetå°†å€¼å˜ä¸ºvalue1ï¼Œè§‚å¯Ÿ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210204142610.png" alt="image-20201011235025047"></p><h3 id="15ã€Stringåº”ç”¨åœºæ™¯ï¼š"><a href="#15ã€Stringåº”ç”¨åœºæ™¯ï¼š" class="headerlink" title="15ã€Stringåº”ç”¨åœºæ™¯ï¼š"></a>15ã€Stringåº”ç”¨åœºæ™¯ï¼š</h3><ul><li>ç”±äºredisä¸­æ²¡æœ‰æ•°å€¼ç±»å‹ï¼Œæ‰€ä»¥æ•°å­—ä¹Ÿæ˜¯ç”¨stringå­˜å‚¨</li><li>å¯ä»¥ç”¨ä½œè®¡æ•°å™¨</li><li>ç»Ÿè®¡æ•°é‡</li><li>å¯¹è±¡ç¼“å­˜å­˜å‚¨</li></ul><h2 id="3-3ã€List"><a href="#3-3ã€List" class="headerlink" title="3.3ã€List"></a>3.3ã€List</h2><ul><li>åœ¨redisä¸­ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡è®¾ç½®è§„åˆ™æ¥ä½¿listæˆä¸ºä¸€ä¸ªæ ˆæˆ–é˜Ÿåˆ—</li><li>æ‰€æœ‰listå‘½ä»¤å¤§éƒ¨åˆ†ä»¥lå¼€å¤´</li></ul><h3 id="1ã€LPUSH-é›†åˆå-å€¼"><a href="#1ã€LPUSH-é›†åˆå-å€¼" class="headerlink" title="1ã€LPUSH é›†åˆå å€¼"></a>1ã€LPUSH é›†åˆå å€¼</h3><blockquote><p>å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ä»å·¦è¾¹æ’è¿›åˆ—è¡¨</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LPUSH list one <span class="comment"># åœ¨åˆ—è¡¨å·¦è¾¹æ’å…¥å€¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; LPUSH list two three <span class="comment"># åœ¨åˆ—è¡¨ä¸­æ’å…¥å¤šä¸ªå€¼</span></span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1  <span class="comment"># è·å–åˆ—è¡¨ä¸­æ‰€æœ‰çš„å€¼</span></span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Lrange list 0 1 <span class="comment">#è·å–åˆ—è¡¨ä¸­ä¸‹æ ‡åœ¨[0,1]çš„å€¼</span></span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="2ã€RPUSH-é›†åˆå-å€¼"><a href="#2ã€RPUSH-é›†åˆå-å€¼" class="headerlink" title="2ã€RPUSH é›†åˆå å€¼"></a>2ã€RPUSH é›†åˆå å€¼</h3><blockquote><p>å°†ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ä»å³è¾¹æ’è¿›åˆ—è¡¨</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; Rpush list right</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; rpush list right1 right2</span><br><span class="line">(<span class="built_in">integer</span>) 6</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;three&quot;</span></span><br><span class="line">2) <span class="string">&quot;two&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;right&quot;</span></span><br><span class="line">5) <span class="string">&quot;right1&quot;</span></span><br><span class="line">6) <span class="string">&quot;right2&quot;</span></span><br></pre></td></tr></table></figure><h3 id="3ã€LPOP-åˆ—è¡¨å"><a href="#3ã€LPOP-åˆ—è¡¨å" class="headerlink" title="3ã€LPOP åˆ—è¡¨å"></a>3ã€LPOP åˆ—è¡¨å</h3><blockquote><p>ä»å·¦è¾¹å¼¹å‡ºï¼ˆç§»å‡ºï¼‰ä¸€ä¸ªå…ƒç´ </p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LPOP list </span><br><span class="line"><span class="string">&quot;three&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">3) <span class="string">&quot;right&quot;</span></span><br><span class="line">4) <span class="string">&quot;right1&quot;</span></span><br><span class="line">5) <span class="string">&quot;right2&quot;</span></span><br></pre></td></tr></table></figure><h3 id="4ã€RPOP-åˆ—è¡¨å"><a href="#4ã€RPOP-åˆ—è¡¨å" class="headerlink" title="4ã€RPOP åˆ—è¡¨å"></a>4ã€RPOP åˆ—è¡¨å</h3><blockquote><p>ä»å³è¾¹å¼¹å‡ºä¸€ä¸ªå…ƒç´ </p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; RPOP list</span><br><span class="line"><span class="string">&quot;right2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">3) <span class="string">&quot;right&quot;</span></span><br><span class="line">4) <span class="string">&quot;right1&quot;</span></span><br></pre></td></tr></table></figure><h3 id="5ã€LINDEX-åˆ—è¡¨å-ä¸‹æ ‡"><a href="#5ã€LINDEX-åˆ—è¡¨å-ä¸‹æ ‡" class="headerlink" title="5ã€LINDEX åˆ—è¡¨å ä¸‹æ ‡"></a>5ã€LINDEX åˆ—è¡¨å ä¸‹æ ‡</h3><blockquote><p>é€šè¿‡ä¸‹æ ‡è·å–å€¼</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LINDEX list 0</span><br><span class="line"><span class="string">&quot;two&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; LINDEX list 3</span><br><span class="line"><span class="string">&quot;right1&quot;</span></span><br></pre></td></tr></table></figure><h3 id="6ã€Llen-åˆ—è¡¨å"><a href="#6ã€Llen-åˆ—è¡¨å" class="headerlink" title="6ã€Llen åˆ—è¡¨å"></a>6ã€Llen åˆ—è¡¨å</h3><blockquote><p>è·å–åˆ—è¡¨é•¿åº¦</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; LRANGE list 0 -1</span><br><span class="line">1) <span class="string">&quot;two&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">3) <span class="string">&quot;right&quot;</span></span><br><span class="line">4) <span class="string">&quot;right1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; Llen list</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="7ã€Lrem-åˆ—è¡¨å-ç§»é™¤ä¸ªæ•°-ç²¾ç¡®å€¼"><a href="#7ã€Lrem-åˆ—è¡¨å-ç§»é™¤ä¸ªæ•°-ç²¾ç¡®å€¼" class="headerlink" title="7ã€Lrem  åˆ—è¡¨å  ç§»é™¤ä¸ªæ•°  ç²¾ç¡®å€¼"></a>7ã€Lrem  åˆ—è¡¨å  ç§»é™¤ä¸ªæ•°  ç²¾ç¡®å€¼</h3><blockquote><p>ç§»é™¤åˆ—è¡¨ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå€¼ï¼Œç²¾ç¡®åŒ¹é…</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;one&quot;</span></span><br><span class="line">5) <span class="string">&quot;two&quot;</span></span><br><span class="line">6) <span class="string">&quot;one&quot;</span></span><br><span class="line">7) <span class="string">&quot;right&quot;</span></span><br><span class="line">8) <span class="string">&quot;right1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list 1 two</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;one&quot;</span></span><br><span class="line">2) <span class="string">&quot;one&quot;</span></span><br><span class="line">3) <span class="string">&quot;one&quot;</span></span><br><span class="line">4) <span class="string">&quot;one&quot;</span></span><br><span class="line">5) <span class="string">&quot;one&quot;</span></span><br><span class="line">6) <span class="string">&quot;right&quot;</span></span><br><span class="line">7) <span class="string">&quot;right1&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lrem list 5 one</span><br><span class="line">(<span class="built_in">integer</span>) 5</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;right&quot;</span></span><br><span class="line">2) <span class="string">&quot;right1&quot;</span></span><br></pre></td></tr></table></figure><h3 id="8ã€ltrim-åˆ—è¡¨å-èµ·å§‹åæ ‡-ç»“æŸåæ ‡"><a href="#8ã€ltrim-åˆ—è¡¨å-èµ·å§‹åæ ‡-ç»“æŸåæ ‡" class="headerlink" title="8ã€ltrim  åˆ—è¡¨å  èµ·å§‹åæ ‡  ç»“æŸåæ ‡"></a>8ã€ltrim  åˆ—è¡¨å  èµ·å§‹åæ ‡  ç»“æŸåæ ‡</h3><blockquote><p>æˆªæ–­åˆ—è¡¨ï¼Œåˆ—è¡¨å…ƒç´ å˜ä¸º[start ,end]</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;hello1&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello2&quot;</span></span><br><span class="line">3) <span class="string">&quot;hello3&quot;</span></span><br><span class="line">4) <span class="string">&quot;hello4&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; ltrim list 1 2</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;hello2&quot;</span></span><br><span class="line">2) <span class="string">&quot;hello3&quot;</span></span><br></pre></td></tr></table></figure><h3 id="9ã€exists-åˆ—è¡¨å"><a href="#9ã€exists-åˆ—è¡¨å" class="headerlink" title="9ã€exists åˆ—è¡¨å"></a>9ã€exists åˆ—è¡¨å</h3><blockquote><p>åˆ¤æ–­åˆ—è¡¨ä¸­æœ‰å‡ ä¸ªå€¼</p></blockquote><h3 id="10ã€LSET-åˆ—è¡¨å-ä¸‹æ ‡-å€¼"><a href="#10ã€LSET-åˆ—è¡¨å-ä¸‹æ ‡-å€¼" class="headerlink" title="10ã€LSET åˆ—è¡¨å  ä¸‹æ ‡  å€¼"></a>10ã€LSET åˆ—è¡¨å  ä¸‹æ ‡  å€¼</h3><blockquote><p>æ›¿æ¢åˆ—è¡¨æŒ‡å®šä¸‹æ ‡çš„å€¼ï¼Œå¦‚æœå½“å‰åˆ—è¡¨ä¸­ä¸å­˜åœ¨æŒ‡å®šä¸‹æ ‡æ‰€å¯¹åº”çš„å€¼ï¼Œå°±æŠ¥é”™</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;value3&quot;</span></span><br><span class="line">2) <span class="string">&quot;value2&quot;</span></span><br><span class="line">3) <span class="string">&quot;value1&quot;</span></span><br><span class="line">4) <span class="string">&quot;hello2&quot;</span></span><br><span class="line">127.0.0.1:6379&gt; lset list 0 item</span><br><span class="line">OK</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;item&quot;</span></span><br><span class="line">2) <span class="string">&quot;value2&quot;</span></span><br><span class="line">3) <span class="string">&quot;value1&quot;</span></span><br><span class="line">4) <span class="string">&quot;hello2&quot;</span></span><br></pre></td></tr></table></figure><h3 id="11ã€LINSERT-åˆ—è¡¨å-å‰-å-è¦æ’å…¥çš„ä½ç½®-è¦æ’å…¥çš„å€¼"><a href="#11ã€LINSERT-åˆ—è¡¨å-å‰-å-è¦æ’å…¥çš„ä½ç½®-è¦æ’å…¥çš„å€¼" class="headerlink" title="11ã€LINSERT   åˆ—è¡¨å   å‰|å   è¦æ’å…¥çš„ä½ç½®    è¦æ’å…¥çš„å€¼"></a>11ã€LINSERT   åˆ—è¡¨å   å‰|å   è¦æ’å…¥çš„ä½ç½®    è¦æ’å…¥çš„å€¼</h3><blockquote><p>åœ¨åˆ—è¡¨çš„æŸä¸ªå€¼å‰|åæ’å…¥ä¸€ä¸ªå€¼</p></blockquote><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; rpush list hello</span><br><span class="line">(<span class="built_in">integer</span>) 1</span><br><span class="line">127.0.0.1:6379&gt; rpush list world</span><br><span class="line">(<span class="built_in">integer</span>) 2</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;world&quot;</span></span><br><span class="line"><span class="comment"># åœ¨worldå•è¯å‰æ’å…¥ä¸€ä¸ªå€¼ï¼šother</span></span><br><span class="line">127.0.0.1:6379&gt; linsert list before <span class="string">&quot;world&quot;</span> other</span><br><span class="line">(<span class="built_in">integer</span>) 3</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;other&quot;</span></span><br><span class="line">3) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure><ul><li>å¾€ä¸Šé¢listçš„otherå…ƒç´ åæ’å…¥ä¸€ä¸ªå€¼wuhu</li></ul><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1:6379&gt; linsert list after <span class="string">&quot;other&quot;</span> wuhu</span><br><span class="line">(<span class="built_in">integer</span>) 4</span><br><span class="line">127.0.0.1:6379&gt; lrange list 0 -1</span><br><span class="line">1) <span class="string">&quot;hello&quot;</span></span><br><span class="line">2) <span class="string">&quot;other&quot;</span></span><br><span class="line">3) <span class="string">&quot;wuhu&quot;</span></span><br><span class="line">4) <span class="string">&quot;world&quot;</span></span><br></pre></td></tr></table></figure><h3 id="12ã€å°ç»“ï¼š"><a href="#12ã€å°ç»“ï¼š" class="headerlink" title="12ã€å°ç»“ï¼š"></a>12ã€å°ç»“ï¼š</h3><ul><li><p>listå®é™…ä¸Šæ˜¯ä¸€ä¸ªé“¾è¡¨ï¼Œæ‰€ä»¥å¯ä»¥åœ¨èŠ‚ç‚¹å‰åæ’å…¥èŠ‚ç‚¹ï¼Œä¹Ÿå¯ä»¥åœ¨æœ€å·¦ç«¯ã€æœ€å³ç«¯æ’å…¥å…ƒç´ </p></li><li><p>å¦‚æœkeyä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°çš„é“¾è¡¨</p></li><li><p>å¦‚æœkeyå­˜åœ¨ï¼Œæ–°å¢å†…å®¹</p></li><li><p>å¦‚æœç§»é™¤äº†keyï¼Œé‚£ä¹ˆé“¾è¡¨è¢«ç§»é™¤</p></li><li><p>åœ¨ä¸¤è¾¹æ’å…¥æˆ–æ”¹åŠ¨å€¼æ•ˆç‡æœ€é«˜ï¼æ“ä½œä¸­é—´å€¼æ•ˆç‡ä¼šé™ä½</p></li><li><p>å¯ä»¥ç”¨æ¥æ¨¡æ‹Ÿæ ˆï¼ˆLPUSHã€LPOPï¼‰ã€æ¶ˆæ¯é˜Ÿåˆ—ï¼ˆLPUSHRã€RPOPï¼‰</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Redis </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>åœ¨çº¿æ•™è‚²é¡¹ç›®æ€»ç»“ï¼ˆä¸€ï¼‰-ä½¿ç”¨MPçš„QueryWrapperè¿›è¡Œè‡ªå®šä¹‰sqlä¸æå‡åµŒå¥—æŸ¥è¯¢æ•ˆç‡ã€‚</title>
      <link href="posts/2126557972.html"/>
      <url>posts/2126557972.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€ä½¿ç”¨æ¡ä»¶æ„é€ å™¨è‡ªå®šä¹‰SQL"><a href="#ä¸€ã€ä½¿ç”¨æ¡ä»¶æ„é€ å™¨è‡ªå®šä¹‰SQL" class="headerlink" title="ä¸€ã€ä½¿ç”¨æ¡ä»¶æ„é€ å™¨è‡ªå®šä¹‰SQL"></a>ä¸€ã€ä½¿ç”¨æ¡ä»¶æ„é€ å™¨è‡ªå®šä¹‰SQL</h1><blockquote><p>åœ¨åœ¨çº¿æ•™è‚²é¡¹ç›®çš„å­¦ä¹ è¿‡ç¨‹ä¸­ï¼Œé‡åˆ°ä¸€ä¸ªéœ€è¦å±•ç¤ºè¯¾ç¨‹è¯¦ç»†ä¿¡æ¯çš„éœ€æ±‚ï¼Œè¿™ä¸ªè¯¾ç¨‹ä¿¡æ¯é¡µé¢éœ€è¦å±•ç¤ºè¯¾ç¨‹titleã€è¯¾ç¨‹ä¸€çº§ç±»åˆ«ã€äºŒçº§ç±»åˆ«ã€è®²å¸ˆå§“åã€è¯¾æ—¶æ•°ã€è¯¾ç¨‹ä»·æ ¼ã€è¯¾ç¨‹å°é¢ã€è¯¾ç¨‹è´­ä¹°é‡ã€æµè§ˆé‡ã€è¯¾ç¨‹çŠ¶æ€ï¼ˆå·²å‘å¸ƒã€æœªå‘å¸ƒï¼‰å’Œè¯¾ç¨‹åˆ›å»ºæ—¶é—´ã€‚</p></blockquote><h2 id="1-1ã€æ‰€éœ€ä¾èµ–"><a href="#1-1ã€æ‰€éœ€ä¾èµ–" class="headerlink" title="1.1ã€æ‰€éœ€ä¾èµ–"></a>1.1ã€æ‰€éœ€ä¾èµ–</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">   <span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">encoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">encoding</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">java.version</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">java.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mybatis-plus.version</span>&gt;</span>3.3.1<span class="tag">&lt;/<span class="name">mybatis-plus.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">swagger.version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">swagger.version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>8.0.19<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">   <span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--mybatis-plus--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-generator<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--mysql--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">exclusions</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;<span class="name">exclusion</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">                   <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">               <span class="tag">&lt;/<span class="name">exclusion</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;/<span class="name">exclusions</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-bootstrap-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-models<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.21<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!--lombokç”¨æ¥ç®€åŒ–å®ä½“ç±»ï¼šéœ€è¦å®‰è£…lombokæ’ä»¶--&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">       <span class="comment">&lt;!-- org.apache.commons.lang3.StringUtils --&gt;</span></span><br><span class="line">       <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.commons<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>commons-lang3<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.7<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">       <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-2ã€å®ä½“ç±»"><a href="#1-2ã€å®ä½“ç±»" class="headerlink" title="1.2ã€å®ä½“ç±»"></a>1.2ã€å®ä½“ç±»</h2><blockquote><p>è¯¥ä¸šåŠ¡æ‰€æ¶‰åŠçš„å®ä½“ç±»å¦‚ä¸‹æ‰€ç¤º</p></blockquote><h3 id="1ã€BaseEntity"><a href="#1ã€BaseEntity" class="headerlink" title="1ã€BaseEntity"></a>1ã€BaseEntity</h3><blockquote><p>è¿™ä¸ªå®ä½“ç±»å®šä¹‰äº†å®ä½“ç±»çš„<strong>å…±åŒå±æ€§</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = false)</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">BaseEntity</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID=<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è®²å¸ˆID&quot;)</span></span><br><span class="line">    <span class="meta">@TableId(value = &quot;id&quot;, type = IdType.ASSIGN_ID)</span></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;åˆ›å»ºæ—¶é—´&quot;)</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> Date gmtCreate;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ›´æ–°æ—¶é—´&quot;)</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">    <span class="keyword">private</span> Date gmtModified;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€Course"><a href="#2ã€Course" class="headerlink" title="2ã€Course"></a>2ã€Course</h3><blockquote><p>è¯¾ç¨‹å®ä½“ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="meta">@TableName(&quot;edu_course&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(value=&quot;Courseå¯¹è±¡&quot;, description=&quot;è¯¾ç¨‹&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Course</span> <span class="keyword">extends</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID=<span class="number">1L</span>;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹æœªå‘å¸ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COURSE_DRAFT = <span class="string">&quot;Draft&quot;</span>;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * è¯¾ç¨‹å·²å‘å¸ƒ</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">final</span> String COURSE_NORMAL = <span class="string">&quot;Normal&quot;</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹è®²å¸ˆID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String teacherId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹ä¸“ä¸šID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String subjectId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹ä¸“ä¸šçˆ¶çº§ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String subjectParentId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹æ ‡é¢˜&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹é”€å”®ä»·æ ¼ï¼Œè®¾ç½®ä¸º0åˆ™å¯å…è´¹è§‚çœ‹&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ€»è¯¾æ—¶&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer lessonNum;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹å°é¢å›¾ç‰‡è·¯å¾„&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String cover;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;é”€å”®æ•°é‡&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long buyCount;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æµè§ˆæ•°é‡&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long viewCount;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ä¹è§‚é”&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Long version;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è¯¾ç¨‹çŠ¶æ€ Draftæœªå‘å¸ƒ  Normalå·²å‘å¸ƒ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€Teacher"><a href="#3ã€Teacher" class="headerlink" title="3ã€Teacher"></a>3ã€Teacher</h3><blockquote><p>æ•™å¸ˆå®ä½“ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="meta">@TableName(&quot;edu_teacher&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(value=&quot;Teacherå¯¹è±¡&quot;, description=&quot;è®²å¸ˆ&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Teacher</span> <span class="keyword">extends</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID=<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è®²å¸ˆå§“å&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è®²å¸ˆç®€ä»‹&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String intro;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è®²å¸ˆèµ„å†,ä¸€å¥è¯è¯´æ˜è®²å¸ˆ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String career;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å¤´è¡” 1é«˜çº§è®²å¸ˆ 2é¦–å¸­è®²å¸ˆ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer level;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;è®²å¸ˆå¤´åƒ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ’åº&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer sort;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;å…¥é©»æ—¶é—´&quot;)</span></span><br><span class="line">    <span class="meta">@JsonFormat(timezone = &quot;GMT+8&quot;, pattern = &quot;yyyy-MM-dd&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Date joinDate;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;é€»è¾‘åˆ é™¤ 1ï¼ˆtrueï¼‰å·²åˆ é™¤ï¼Œ 0ï¼ˆfalseï¼‰æœªåˆ é™¤&quot;)</span></span><br><span class="line">    <span class="meta">@TableLogic</span></span><br><span class="line">    <span class="keyword">private</span> Integer isDeleted;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€Subject"><a href="#4ã€Subject" class="headerlink" title="4ã€Subject"></a>4ã€Subject</h3><blockquote><p><strong>è¯¾ç¨‹åˆ†ç±»å®ä½“ç±»</strong></p><p>ä¸€çº§åˆ†ç±»å’ŒäºŒçº§åˆ†ç±»å…±ç”¨ä¸€ä¸ªå®ä½“ç±»ï¼Œå¦‚æœåˆ†ç±»å¯¹è±¡çš„parentIdä¸º0ï¼Œè¯æ˜å…¶æ˜¯ä¸€çº§åˆ†ç±»ï¼Œå¦‚æœä¸ä¸º0ï¼Œè¯æ˜ä¸ºäºŒçº§åˆ†ç±»ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@EqualsAndHashCode(callSuper = true)</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="meta">@TableName(&quot;edu_subject&quot;)</span></span><br><span class="line"><span class="meta">@ApiModel(value=&quot;Subjectå¯¹è±¡&quot;, description=&quot;è¯¾ç¨‹ç§‘ç›®&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Subject</span> <span class="keyword">extends</span> <span class="title">BaseEntity</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID=<span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;ç±»åˆ«åç§°&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;çˆ¶ID&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> String parentId;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@ApiModelProperty(value = &quot;æ’åºå­—æ®µ&quot;)</span></span><br><span class="line">    <span class="keyword">private</span> Integer sort;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€CourseVo"><a href="#5ã€CourseVo" class="headerlink" title="5ã€CourseVo"></a>5ã€CourseVo</h3><blockquote><p>è¿™ä¸ªVoç±»ç”¨äºå®šä¹‰éœ€è¦å±•ç¤ºåœ¨è¯¾ç¨‹è¯¦æƒ…é¡µé¢çš„å±æ€§</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹æ ‡é¢˜</span></span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹ä¸€çº§åˆ†ç±»</span></span><br><span class="line">    <span class="keyword">private</span> String subjectParentTitle;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹äºŒçº§åˆ†ç±»</span></span><br><span class="line">    <span class="keyword">private</span> String subjectTitle;</span><br><span class="line">    <span class="comment">// è®²å¸ˆå§“å</span></span><br><span class="line">    <span class="keyword">private</span> String teacherName;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹è¯¾æ—¶æ•°</span></span><br><span class="line">    <span class="keyword">private</span> Integer lessonNum;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹ä»·æ ¼</span></span><br><span class="line">    <span class="keyword">private</span> String price;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹å°é¢</span></span><br><span class="line">    <span class="keyword">private</span> String cover;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹è´­ä¹°æ•°</span></span><br><span class="line">    <span class="keyword">private</span> Long buyCount;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹æµè§ˆé‡</span></span><br><span class="line">    <span class="keyword">private</span> Long viewCount;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹çŠ¶æ€</span></span><br><span class="line">    <span class="keyword">private</span> String status;</span><br><span class="line">    <span class="comment">// è¯¾ç¨‹åˆ›å»ºæ—¶é—´</span></span><br><span class="line">    <span class="keyword">private</span> String gmtCreate;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="6ã€CourseQueryVo"><a href="#6ã€CourseQueryVo" class="headerlink" title="6ã€CourseQueryVo"></a>6ã€CourseQueryVo</h3><blockquote><p>è¯¥ä¸šåŠ¡è¿˜éœ€è¦ç”¨åˆ°åˆ†é¡µæŸ¥è¯¢ä¸æ¡ä»¶æŸ¥è¯¢ï¼Œæ‰€ä»¥å¼•å…¥ä¸€ä¸ªç”¨äºæ„é€ æ¡ä»¶æŸ¥è¯¢çš„æŸ¥è¯¢å®ä½“ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseQueryVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> String teacherId;</span><br><span class="line">    <span class="keyword">private</span> String subjectParentId;</span><br><span class="line">    <span class="keyword">private</span> String subjectId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-3ã€Controllerå±‚"><a href="#1-3ã€Controllerå±‚" class="headerlink" title="1.3ã€Controllerå±‚"></a>1.3ã€Controllerå±‚</h2><blockquote><p>å®šä¹‰ä¸€ä¸ªCourseListPageæ¥å£ï¼Œéœ€è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼š</p><ul><li>pageï¼šå½“å‰é¡µç </li><li>limitï¼šæ¯é¡µè®°å½•æ•°</li><li>courseQueryVoï¼šç”±æŸ¥è¯¢æ¡ä»¶å°è£…æˆçš„æŸ¥è¯¢å¯¹è±¡</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="meta">@CrossOrigin</span></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;è¯¾ç¨‹ç®¡ç†æ§åˆ¶å™¨&quot;)</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/admin/edu/course&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CourseService courseService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@ApiOperation(&quot;è¯¾ç¨‹åˆ†é¡µåˆ—è¡¨&quot;)</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;list/&#123;page&#125;/&#123;limit&#125;&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> R <span class="title">courseListPage</span><span class="params">(<span class="meta">@ApiParam(value = &quot;å½“å‰é¡µç &quot;,required = true)</span> <span class="meta">@PathVariable</span> Long page,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="meta">@ApiParam(value = &quot;æ¯é¡µè®°å½•æ•°&quot;,required = true)</span> <span class="meta">@PathVariable</span> Long limit,</span></span></span><br><span class="line"><span class="function"><span class="params">                            <span class="meta">@ApiParam(value = &quot;è¯¾ç¨‹åˆ—è¡¨æŸ¥è¯¢å¯¹è±¡&quot;)</span>CourseQueryVo courseQueryVo)</span> </span>&#123;</span><br><span class="line">        IPage&lt;CourseVo&gt; pageModel = courseService.selectPage(page, limit, courseQueryVo);</span><br><span class="line">        List&lt;CourseVo&gt; records = pageModel.getRecords();</span><br><span class="line">        <span class="keyword">long</span> total = pageModel.getTotal();</span><br><span class="line">        <span class="keyword">return</span>  R.ok().data(<span class="string">&quot;total&quot;</span>, total).data(<span class="string">&quot;rows&quot;</span>, records);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-4ã€Serviceå®ç°ç±»"><a href="#1-4ã€Serviceå®ç°ç±»" class="headerlink" title="1.4ã€Serviceå®ç°ç±»"></a>1.4ã€Serviceå®ç°ç±»</h2><blockquote><p>ä½¿ç”¨QueryWrapperç»„è£…sqlçš„æ­¥éª¤å¦‚ä¸‹ï¼š</p><ul><li>åˆ†åˆ«å–å‡ºæŸ¥è¯¢å¯¹è±¡ä¸­çš„æŸ¥è¯¢å±æ€§å¹¶åˆ¤æ–­æ˜¯å¦ä¸ºç©º</li><li>è‹¥ä¸ä¸ºç©ºï¼Œåˆ™ä½¿ç”¨æ¡ä»¶æ„é€ å™¨æ ¹æ®å±æ€§ç±»å‹æ„é€ æŸ¥è¯¢æ¡ä»¶</li><li>åœ¨ä½¿ç”¨æ¡ä»¶æ„é€ å™¨æ„é€ æŸ¥è¯¢æ¡ä»¶æ—¶éœ€è¦ä½¿ç”¨<strong>è¡¨åˆ«å.å±æ€§å</strong>çš„å½¢å¼æ„é€ æ¡ä»¶</li><li>å°†ç»„è£…å¥½çš„æ¡ä»¶æ„é€ å™¨ä¼ å…¥Mapperå±‚</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CourseServiceImpl</span> <span class="keyword">extends</span> <span class="title">ServiceImpl</span>&lt;<span class="title">CourseMapper</span>, <span class="title">Course</span>&gt; <span class="keyword">implements</span> <span class="title">CourseService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> VideoMapper videoMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> ChapterMapper chapterMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CommentMapper commentMapper;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CourseCollectMapper courseCollectMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> CourseMapper courseMapper;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> IPage&lt;CourseVo&gt; <span class="title">selectPage</span><span class="params">(Long page, Long limit, CourseQueryVo courseQueryVo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//ç»„è£…æŸ¥è¯¢æ¡ä»¶</span></span><br><span class="line">        QueryWrapper&lt;CourseVo&gt; courseVoQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">        courseVoQueryWrapper.orderByDesc(<span class="string">&quot;c.gmt_create&quot;</span>);</span><br><span class="line">        <span class="comment">//å››ä¸ªæŸ¥è¯¢æ¡ä»¶å¦‚ä¸‹</span></span><br><span class="line">        String title = courseQueryVo.getTitle();</span><br><span class="line">        String teacherId = courseQueryVo.getTeacherId();</span><br><span class="line">        String subjectParentId = courseQueryVo.getSubjectParentId();</span><br><span class="line">        String subjectId = courseQueryVo.getSubjectId();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(title)) &#123;</span><br><span class="line">            courseVoQueryWrapper.like(<span class="string">&quot;c.title&quot;</span>, title);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(teacherId)) &#123;</span><br><span class="line">            courseVoQueryWrapper.eq(<span class="string">&quot;c.teacher_id&quot;</span>, teacherId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(subjectParentId)) &#123;</span><br><span class="line">            courseVoQueryWrapper.eq(<span class="string">&quot;c.subject_parent_id&quot;</span>, subjectParentId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (StringUtils.isNotBlank(subjectId)) &#123;</span><br><span class="line">            courseVoQueryWrapper.eq(<span class="string">&quot;c.subject_id&quot;</span>, subjectId);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç»„è£…åˆ†é¡µ</span></span><br><span class="line">        Page&lt;CourseVo&gt; pageParam = <span class="keyword">new</span> Page&lt;&gt;(page, limit);</span><br><span class="line"></span><br><span class="line">        <span class="comment">//æ‰§è¡ŒæŸ¥è¯¢</span></span><br><span class="line">        List&lt;CourseVo&gt; courseVoList = courseMapper.selectPageByQueryVo(pageParam, courseVoQueryWrapper);</span><br><span class="line">        pageParam.setRecords(courseVoList);</span><br><span class="line">        <span class="keyword">return</span> pageParam;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="1-5ã€Mapperå±‚"><a href="#1-5ã€Mapperå±‚" class="headerlink" title="1.5ã€Mapperå±‚"></a>1.5ã€Mapperå±‚</h2><h3 id="1ã€Mapperæ¥å£"><a href="#1ã€Mapperæ¥å£" class="headerlink" title="1ã€Mapperæ¥å£"></a>1ã€Mapperæ¥å£</h3><blockquote><p>å¯¹äºServiceå±‚ä¸­ä¼ å…¥çš„æ¡ä»¶æ„é€ å™¨ï¼Œéœ€è¦ä½¿Mybatis-plusèƒ½å¤Ÿè¯†åˆ«ï¼Œæ­¤æ—¶æˆ‘ä»¬éœ€è¦åœ¨Mapperå±‚ä¸­çš„æ¡ä»¶æ„é€ å™¨å¯¹è±¡å‰æ·»åŠ **@Param(Constants.WRAPPER)**æ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">CourseMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">Course</span>&gt; </span>&#123;</span><br><span class="line">    <span class="function">List&lt;CourseVo&gt; <span class="title">selectPageByQueryVo</span><span class="params">(Page&lt;CourseVo&gt; pageParam,</span></span></span><br><span class="line"><span class="function"><span class="params">                                       <span class="meta">@Param(Constants.WRAPPER)</span> QueryWrapper&lt;CourseVo&gt; courseVoQueryWrapper)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€Mapper-xmlæ–‡ä»¶"><a href="#2ã€Mapper-xmlæ–‡ä»¶" class="headerlink" title="2ã€Mapper.xmlæ–‡ä»¶"></a>2ã€Mapper.xmlæ–‡ä»¶</h3><blockquote><p>é™¤å»Mapperæ¥å£æ·»åŠ çš„**@Param(Constants.WRAPPER)<strong>æ³¨è§£å¤–ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åœ¨è‡ªå®šä¹‰çš„sqlè¯­å¥åæ·»åŠ </strong>${ew.customSqlSegment}**</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">mapper</span> <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;com.hzx.grain.service.edu.mapper.CourseMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectPageByQueryVo&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;com.hzx.grain.service.edu.entity.vo.CourseVo&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;courseVoColumns&quot;</span>/&gt;</span></span><br><span class="line">        FROM</span><br><span class="line">            <span class="tag">&lt;<span class="name">include</span> <span class="attr">refid</span>=<span class="string">&quot;tables&quot;</span>/&gt;</span></span><br><span class="line">        $&#123;ew.customSqlSegment&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŠ½å–sqlç‰‡æ®µ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;courseVoColumns&quot;</span>&gt;</span></span><br><span class="line">           c.id,</span><br><span class="line">           c.title,</span><br><span class="line">           c.lesson_num AS lessonNum,</span><br><span class="line">           c.price,</span><br><span class="line">           c.cover,</span><br><span class="line">           c.buy_count AS buyCount,</span><br><span class="line">           c.view_count AS viewCount,</span><br><span class="line">           c.status,</span><br><span class="line">           c.gmt_create AS gmtCreate,</span><br><span class="line">           t.name AS teacherName,</span><br><span class="line">           s1.title AS subjectParentTitle,</span><br><span class="line">           s2.title AS subjectTitle</span><br><span class="line">    <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æŠ½å–sqlç‰‡æ®µï¼šä¸courseè¡¨è¿æ¥çš„å…¶ä½™è¡¨ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">sql</span> <span class="attr">id</span>=<span class="string">&quot;tables&quot;</span>&gt;</span></span><br><span class="line">            guli_edu.edu_course c</span><br><span class="line">        LEFT JOIN guli_edu.edu_teacher t ON c.teacher_id = t.id</span><br><span class="line">        LEFT JOIN guli_edu.edu_subject s1 ON c.subject_parent_id = s1.id</span><br><span class="line">        LEFT JOIN guli_edu.edu_subject s2 ON c.subject_id = s2.id</span><br><span class="line">    <span class="tag">&lt;/<span class="name">sql</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="3ã€æ³¨æ„äº‹é¡¹"><a href="#3ã€æ³¨æ„äº‹é¡¹" class="headerlink" title="3ã€æ³¨æ„äº‹é¡¹"></a>3ã€æ³¨æ„äº‹é¡¹</h3><blockquote><p>éœ€è¦<code>mybatis-plus</code>ç‰ˆæœ¬ &gt;= <code>3.0.7</code></p></blockquote><h2 id="1-6ã€æµ‹è¯•"><a href="#1-6ã€æµ‹è¯•" class="headerlink" title="1.6ã€æµ‹è¯•"></a>1.6ã€æµ‹è¯•</h2><blockquote><p>æ‰“å¼€Swaggerè¿›è¡Œæµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210203201739.png"></p><h3 id="1ã€ç»“æœ"><a href="#1ã€ç»“æœ" class="headerlink" title="1ã€ç»“æœ"></a>1ã€ç»“æœ</h3><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  <span class="attr">&quot;success&quot;</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">&quot;code&quot;</span>: <span class="number">20000</span>,</span><br><span class="line">  <span class="attr">&quot;message&quot;</span>: <span class="string">&quot;æˆåŠŸ&quot;</span>,</span><br><span class="line">  <span class="attr">&quot;data&quot;</span>: &#123;</span><br><span class="line">    <span class="attr">&quot;total&quot;</span>: <span class="number">3</span>,</span><br><span class="line">    <span class="attr">&quot;rows&quot;</span>: [</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1353316219423391746&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;Spring Bootæ¡†æ¶å…¥é—¨æ•™ç¨‹&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;subjectParentTitle&quot;</span>: <span class="string">&quot;åç«¯å¼€å‘&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;subjectTitle&quot;</span>: <span class="string">&quot;Java&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;teacherName&quot;</span>: <span class="string">&quot;åˆ˜å¾·å&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;lessonNum&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">&quot;price&quot;</span>: <span class="string">&quot;0.00&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;cover&quot;</span>: <span class="string">&quot;https://edu-system-1010.oss-cn-shenzhen.aliyuncs.com/cover/2021/01/24/2afcb3fd-da73-40d1-ba41-4d6cf74c7e7a.jpg&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;buyCount&quot;</span>: <span class="number">8</span>,</span><br><span class="line">        <span class="attr">&quot;viewCount&quot;</span>: <span class="number">0</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;Normal&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;gmtCreate&quot;</span>: <span class="string">&quot;2021-01-24 20:18:25&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1353313325668200450&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;Mybatis-Plusæ¡†æ¶å…¥é—¨æ•™ç¨‹&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;subjectParentTitle&quot;</span>: <span class="string">&quot;åç«¯å¼€å‘&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;subjectTitle&quot;</span>: <span class="string">&quot;Java&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;teacherName&quot;</span>: <span class="string">&quot;åˆ˜å¾·å&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;lessonNum&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">&quot;price&quot;</span>: <span class="string">&quot;1.00&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;cover&quot;</span>: <span class="string">&quot;https://edu-system-1010.oss-cn-shenzhen.aliyuncs.com/cover/2021/01/24/804b29e5-4ca7-4819-9bac-eb34f65068ca.jpg&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;buyCount&quot;</span>: <span class="number">9</span>,</span><br><span class="line">        <span class="attr">&quot;viewCount&quot;</span>: <span class="number">2</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;Normal&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;gmtCreate&quot;</span>: <span class="string">&quot;2021-01-24 20:06:55&quot;</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123;</span><br><span class="line">        <span class="attr">&quot;id&quot;</span>: <span class="string">&quot;1353310049325309953&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;title&quot;</span>: <span class="string">&quot;java--ä»å…¥é—¨åˆ°å…¥åœŸ&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;subjectParentTitle&quot;</span>: <span class="string">&quot;åç«¯å¼€å‘&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;subjectTitle&quot;</span>: <span class="string">&quot;Java&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;teacherName&quot;</span>: <span class="string">&quot;åˆ˜å¾·å&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;lessonNum&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">&quot;price&quot;</span>: <span class="string">&quot;6.00&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;cover&quot;</span>: <span class="string">&quot;https://edu-system-1010.oss-cn-shenzhen.aliyuncs.com/cover/2021/01/24/d7c25aaa-5c09-4b46-a56d-5000f9265bc7.jpg&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;buyCount&quot;</span>: <span class="number">10</span>,</span><br><span class="line">        <span class="attr">&quot;viewCount&quot;</span>: <span class="number">5</span>,</span><br><span class="line">        <span class="attr">&quot;status&quot;</span>: <span class="string">&quot;Normal&quot;</span>,</span><br><span class="line">        <span class="attr">&quot;gmtCreate&quot;</span>: <span class="string">&quot;2021-01-24 19:53:54&quot;</span></span><br><span class="line">      &#125;</span><br><span class="line">    ]</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€æ‰§è¡Œçš„sqlè¯­å¥"><a href="#2ã€æ‰§è¡Œçš„sqlè¯­å¥" class="headerlink" title="2ã€æ‰§è¡Œçš„sqlè¯­å¥"></a>2ã€æ‰§è¡Œçš„sqlè¯­å¥</h3><blockquote><p>ä½¿ç”¨Ideaçš„Mybatisæ’ä»¶æŸ¥çœ‹æ‰§è¡Œçš„sqlè¯­å¥</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">SELECT </span><br><span class="line">c.id, </span><br><span class="line">c.title, </span><br><span class="line">c.lesson_num AS lessonNum, </span><br><span class="line">c.price, </span><br><span class="line">c.cover, </span><br><span class="line">c.buy_count AS buyCount, </span><br><span class="line">c.view_count AS viewCount, </span><br><span class="line">c.status, </span><br><span class="line">c.gmt_create AS gmtCreate, </span><br><span class="line">t.name AS teacherName, </span><br><span class="line">s1.title AS subjectParentTitle, </span><br><span class="line">s2.title AS subjectTitle</span><br><span class="line">FROM guli_edu.edu_course c</span><br><span class="line">LEFT JOIN guli_edu.edu_teacher t ON c.teacher_id &#x3D; t.id</span><br><span class="line">LEFT JOIN guli_edu.edu_subject s1 ON c.subject_parent_id &#x3D; s1.id</span><br><span class="line">LEFT JOIN guli_edu.edu_subject s2 ON c.subject_id &#x3D; s2.id</span><br><span class="line">WHERE c.title LIKE &#39;%å…¥é—¨%&#39;</span><br><span class="line">AND c.teacher_id &#x3D; &#39;1&#39;</span><br><span class="line">AND c.subject_parent_id &#x3D; &#39;1352924754100617218&#39;</span><br><span class="line">AND c.subject_id &#x3D; &#39;1352924754167726082&#39;</span><br><span class="line">ORDER BY c.gmt_create DESC</span><br><span class="line">LIMIT 0, 3;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€æ€»ç»“åµŒå¥—æŸ¥è¯¢"><a href="#äºŒã€æ€»ç»“åµŒå¥—æŸ¥è¯¢" class="headerlink" title="äºŒã€æ€»ç»“åµŒå¥—æŸ¥è¯¢"></a>äºŒã€æ€»ç»“åµŒå¥—æŸ¥è¯¢</h1><h2 id="2-1ã€ä½¿ç”¨å­æŸ¥è¯¢"><a href="#2-1ã€ä½¿ç”¨å­æŸ¥è¯¢" class="headerlink" title="2.1ã€ä½¿ç”¨å­æŸ¥è¯¢"></a>2.1ã€ä½¿ç”¨å­æŸ¥è¯¢</h2><h3 id="1ã€Controllerå±‚"><a href="#1ã€Controllerå±‚" class="headerlink" title="1ã€Controllerå±‚"></a>1ã€Controllerå±‚</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;nested&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;åµŒå¥—åˆ†ç±»æ•°æ®åˆ—è¡¨&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">nestedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¿”å›åˆ†ç±»VOåˆ—è¡¨</span></span><br><span class="line">    List&lt;SubjectVo&gt; subjectVoList = subjectService.nestedList();</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;items&quot;</span>,subjectVoList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€Serviceå®ç°ç±»"><a href="#2ã€Serviceå®ç°ç±»" class="headerlink" title="2ã€Serviceå®ç°ç±»"></a>2ã€Serviceå®ç°ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;SubjectVo&gt; <span class="title">nestedList</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> subjectMapper.selectNestedListByParentId(<span class="string">&quot;0&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€Mapper-xmlæ–‡ä»¶"><a href="#3ã€Mapper-xmlæ–‡ä»¶" class="headerlink" title="3ã€Mapper.xmlæ–‡ä»¶"></a>3ã€Mapper.xmlæ–‡ä»¶</h3><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- ä½¿ç”¨ResultMapè¿›è¡Œæ˜ å°„ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;subjectVoMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;com.hzx.grain.service.edu.entity.vo.SubjectVo&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- å°†è¡¨ä¸­å­—æ®µä¸ç±»ä¸­å±æ€§ä¸€ä¸€æ˜ å°„ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;title&quot;</span> <span class="attr">column</span>=<span class="string">&quot;title&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;sort&quot;</span> <span class="attr">column</span>=<span class="string">&quot;sort&quot;</span> /&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- è¿™é‡Œæ ¹æ®åŸæ¥çš„æ–¹æ³•è¿›è¡ŒåµŒå¥—æŸ¥è¯¢ --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">collection</span> <span class="attr">property</span>=<span class="string">&quot;children&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">column</span>=<span class="string">&quot;id&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">select</span>=<span class="string">&quot;selectNestedListByParentId&quot;</span></span></span><br><span class="line"><span class="tag">                <span class="attr">ofType</span>=<span class="string">&quot;com.hzx.grain.service.edu.entity.vo.SubjectVo&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- åµŒå¥—æŸ¥è¯¢ä¸€çº§åˆ†ç±»ä¸äºŒçº§åˆ†ç±»å¹¶ç»„è£…ä¸ºSubjectVoåˆ—è¡¨çš„sqlè¯­å¥ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;selectNestedListByParentId&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;subjectVoMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">     `id`,</span><br><span class="line">     `sort`,</span><br><span class="line">     `title`</span><br><span class="line">    FROM</span><br><span class="line">     guli_edu.edu_subject</span><br><span class="line">    WHERE</span><br><span class="line">     `parent_id` = #&#123;parentId&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4ã€SubjectVoå®ä½“ç±»"><a href="#4ã€SubjectVoå®ä½“ç±»" class="headerlink" title="4ã€SubjectVoå®ä½“ç±»"></a>4ã€SubjectVoå®ä½“ç±»</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SubjectVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> Integer sort;</span><br><span class="line">    <span class="keyword">private</span> List&lt;SubjectVo&gt; children = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€æ€»ç»“"><a href="#5ã€æ€»ç»“" class="headerlink" title="5ã€æ€»ç»“"></a>5ã€æ€»ç»“</h3><blockquote><p>è¿™ç§ä½¿ç”¨å­æŸ¥è¯¢çš„åµŒå¥—æŸ¥è¯¢å®ç°ç®€å•ï¼Œä½†æŸ¥è¯¢æ•ˆç‡ä¼šéšç€æ•°æ®é‡å¢å¤§è€Œé™ä½ã€‚</p></blockquote><h2 id="2-2ã€ä¸‰å±‚åµŒå¥—æŸ¥è¯¢ä¸­ä½¿ç”¨å†—ä½™å­—æ®µæé«˜æŸ¥è¯¢æ•ˆç‡"><a href="#2-2ã€ä¸‰å±‚åµŒå¥—æŸ¥è¯¢ä¸­ä½¿ç”¨å†—ä½™å­—æ®µæé«˜æŸ¥è¯¢æ•ˆç‡" class="headerlink" title="2.2ã€ä¸‰å±‚åµŒå¥—æŸ¥è¯¢ä¸­ä½¿ç”¨å†—ä½™å­—æ®µæé«˜æŸ¥è¯¢æ•ˆç‡"></a>2.2ã€ä¸‰å±‚åµŒå¥—æŸ¥è¯¢ä¸­ä½¿ç”¨å†—ä½™å­—æ®µæé«˜æŸ¥è¯¢æ•ˆç‡</h2><blockquote><p>è¯¥ä¸šåŠ¡éœ€æ±‚æ˜¯ï¼šæ ¹æ®è¯¾ç¨‹IdæŸ¥è¯¢è¯¾ç¨‹è¯¦æƒ…ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¯¾ç¨‹ä¿¡æ¯ã€åµŒå¥—ç« èŠ‚è¯¾æ—¶åˆ—è¡¨</p><p>å³ä¸€ä¸ªè¯¾ç¨‹ä¸‹æœ‰å¤šä¸ªç« èŠ‚ï¼Œè€Œä¸€ä¸ªç« èŠ‚ä¸‹åˆæœ‰å¤šä¸ªå°èŠ‚</p></blockquote><h3 id="1ã€CourseVo"><a href="#1ã€CourseVo" class="headerlink" title="1ã€CourseVo"></a>1ã€CourseVo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">WebCourseVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> BigDecimal price;</span><br><span class="line">    <span class="keyword">private</span> Integer lessonNum;</span><br><span class="line">    <span class="keyword">private</span> String cover;</span><br><span class="line">    <span class="keyword">private</span> Long buyCount;</span><br><span class="line">    <span class="keyword">private</span> Long viewCount;</span><br><span class="line">    <span class="keyword">private</span> String description;</span><br><span class="line">    <span class="keyword">private</span> String teacherId;</span><br><span class="line">    <span class="keyword">private</span> String teacherName;</span><br><span class="line">    <span class="keyword">private</span> String intro;</span><br><span class="line">    <span class="keyword">private</span> String avatar;</span><br><span class="line">    <span class="keyword">private</span> String subjectLevelOneId;</span><br><span class="line">    <span class="keyword">private</span> String subjectLevelOne;</span><br><span class="line">    <span class="keyword">private</span> String subjectLevelTwoId;</span><br><span class="line">    <span class="keyword">private</span> String subjectLevelTwo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2ã€ChapterVo"><a href="#2ã€ChapterVo" class="headerlink" title="2ã€ChapterVo"></a>2ã€ChapterVo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ChapterVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> Integer sort;</span><br><span class="line">    <span class="keyword">private</span> List&lt;VideoVo&gt; children = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3ã€VideoVo"><a href="#3ã€VideoVo" class="headerlink" title="3ã€VideoVo"></a>3ã€VideoVo</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">VideoVo</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">final</span> <span class="keyword">long</span> serialVersionUID = <span class="number">1L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String id;</span><br><span class="line">    <span class="keyword">private</span> String title;</span><br><span class="line">    <span class="keyword">private</span> Boolean free;</span><br><span class="line">    <span class="keyword">private</span> Integer sort;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> String videoSourceId;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="4ã€æ§åˆ¶å™¨å±‚"><a href="#4ã€æ§åˆ¶å™¨å±‚" class="headerlink" title="4ã€æ§åˆ¶å™¨å±‚"></a>4ã€æ§åˆ¶å™¨å±‚</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;get/&#123;courseId&#125;&quot;)</span></span><br><span class="line"><span class="meta">@ApiOperation(&quot;æ ¹æ®courseIdæŸ¥è¯¢è¯¾ç¨‹è¯¦ç»†ä¿¡æ¯&quot;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> R <span class="title">getById</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="meta">@ApiParam(value = &quot;è¯¾ç¨‹id&quot;,required = true)</span></span></span></span><br><span class="line"><span class="function"><span class="params">        <span class="meta">@PathVariable</span> String courseId)</span> </span>&#123;</span><br><span class="line">    WebCourseVo courseVo = courseService.selectWebCourseVoById(courseId);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æŸ¥è¯¢å½“å‰è¯¾ç¨‹çš„åµŒå¥—ç« èŠ‚å’Œè¯¾æ—¶ä¿¡æ¯</span></span><br><span class="line">    List&lt;ChapterVo&gt; chapterVoList = chapterService.nestedList(courseId);</span><br><span class="line">    <span class="keyword">return</span> R.ok().data(<span class="string">&quot;course&quot;</span>,courseVo).data(<span class="string">&quot;chapterVoList&quot;</span>,chapterVoList);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="5ã€serviceå±‚"><a href="#5ã€serviceå±‚" class="headerlink" title="5ã€serviceå±‚"></a>5ã€serviceå±‚</h3><blockquote><p>CourseServiceImpl</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional(rollbackFor = Exception.class)</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> WebCourseVo <span class="title">selectWebCourseVoById</span><span class="params">(String id)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ›´æ–°è¯¾ç¨‹æµè§ˆæ•°</span></span><br><span class="line">    Course course = baseMapper.selectById(id);</span><br><span class="line">    course.setViewCount(course.getViewCount() + <span class="number">1</span>);</span><br><span class="line">    baseMapper.updateById(course);</span><br><span class="line">    <span class="comment">//è·å–è¯¾ç¨‹ä¿¡æ¯</span></span><br><span class="line">    <span class="keyword">return</span> baseMapper.selectWebCourseVoById(id);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ChapterServiceImpl</p><p>ç”±äºå‰é¢ä½¿ç”¨å­æŸ¥è¯¢å¯¼è‡´æŸ¥è¯¢é€Ÿç‡ä½ä¸‹ï¼Œæ‰€ä»¥åœ¨è¿™é‡Œä½¿ç”¨videoè¡¨å†—ä½™çš„CourseIdå­—æ®µæ¥æé«˜æŸ¥è¯¢é€Ÿç‡ï¼Œæ­¥éª¤å¦‚ä¸‹</p><ul><li>é€šè¿‡Chapterç±»çš„courseIdè·å–è¯¥è¯¾ç¨‹ä¸‹çš„æ‰€æœ‰ç« èŠ‚å¯¹è±¡</li><li>é€šè¿‡Videoç±»å†—ä½™çš„courseIdè·å–è¯¥è¯¾ç¨‹ä¸‹çš„æ‰€æœ‰å°èŠ‚å¯¹è±¡</li><li>å¾ªç¯éå†è¯¥è¯¾ç¨‹ä¸‹çš„ç« èŠ‚å¯¹è±¡åˆ—è¡¨ï¼Œé€šè¿‡Chapterå¯¹è±¡çš„idå’ŒVideoå¯¹è±¡çš„chapterIdå­—æ®µæ¥å»ºç«‹è”ç³»ï¼Œç»„è£…Chapterå¯¹è±¡çš„Videoåˆ—è¡¨</li></ul></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;ChapterVo&gt; <span class="title">nestedList</span><span class="params">(String courseId)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//1 é€šè¿‡courseIdè·å–ç« èŠ‚åˆ—è¡¨ä¿¡æ¯ï¼šList&lt;Chapter&gt;</span></span><br><span class="line">    QueryWrapper&lt;Chapter&gt; chapterQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    chapterQueryWrapper.eq(<span class="string">&quot;course_id&quot;</span>,courseId);</span><br><span class="line">    List&lt;Chapter&gt; chapterList = chapterMapper.selectList(chapterQueryWrapper);</span><br><span class="line">    <span class="comment">//2 é€šè¿‡edu_videoè¡¨ä¸­å†—ä½™çš„course_idè·å–å±äºè¿™ä¸ªè¯¾ç¨‹çš„æ‰€æœ‰Videoåˆ—è¡¨ï¼šList&lt;Video&gt;</span></span><br><span class="line">    QueryWrapper&lt;Video&gt; videoQueryWrapper = <span class="keyword">new</span> QueryWrapper&lt;&gt;();</span><br><span class="line">    videoQueryWrapper.eq(<span class="string">&quot;course_id&quot;</span>,courseId);</span><br><span class="line">    List&lt;Video&gt; videoList = videoMapper.selectList(videoQueryWrapper);</span><br><span class="line">    <span class="comment">//3 å…ˆè·å–ç« èŠ‚ä¿¡æ¯ChapterVoåˆ—è¡¨ï¼Œå†è·å–VideoVoåˆ—è¡¨</span></span><br><span class="line">    List&lt;ChapterVo&gt; chapterVoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    chapterList.forEach(chapter -&gt; &#123;</span><br><span class="line">        ChapterVo chapterVo = <span class="keyword">new</span> ChapterVo();</span><br><span class="line">        BeanUtils.copyProperties(chapter,chapterVo);</span><br><span class="line">        chapterVoList.add(chapterVo);</span><br><span class="line">        List&lt;VideoVo&gt; videoVoList = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">        <span class="comment">//4 å¾ªç¯ç»„è£…ç« èŠ‚ä¿¡æ¯åˆ—è¡¨</span></span><br><span class="line">        videoList.forEach(video -&gt; &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœå½“å‰chapterçš„idçš„å€¼ç­‰äºvideoçš„chapterIdå€¼</span></span><br><span class="line">            <span class="comment">//è¯æ˜å½“å‰videoå¯¹è±¡å±äºè¯¥Chapterå¯¹è±¡</span></span><br><span class="line">            <span class="keyword">if</span>(StringUtils.equals(chapter.getId(),video.getChapterId())) &#123;</span><br><span class="line">                VideoVo videoVo = <span class="keyword">new</span> VideoVo();</span><br><span class="line">                BeanUtils.copyProperties(video,videoVo);</span><br><span class="line">                videoVoList.add(videoVo);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">        chapterVo.setChildren(videoVoList);</span><br><span class="line">    &#125;);</span><br><span class="line">    <span class="keyword">return</span> chapterVoList;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> é¡¹ç›®æ€»ç»“ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸ’Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaåº”ç”¨å­¦ä¹ ï¼ˆä¸‰ï¼‰-SSMæ¡†æ¶æ•´åˆåŠåŸºæœ¬ä½¿ç”¨</title>
      <link href="posts/3009255528.html"/>
      <url>posts/3009255528.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><blockquote><p>SSMæ¡†æ¶å¤šç§æ•´åˆæ–¹å¼ï¼Œè¿™é‡Œä½¿ç”¨æ³¨è§£+XMLæ–‡ä»¶çš„æ–¹å¼æ¥è¿›è¡Œæ•´åˆå¼€å‘</p></blockquote><h1 id="ä¸€ã€å‰æœŸå‡†å¤‡"><a href="#ä¸€ã€å‰æœŸå‡†å¤‡" class="headerlink" title="ä¸€ã€å‰æœŸå‡†å¤‡"></a>ä¸€ã€å‰æœŸå‡†å¤‡</h1><h2 id="1-1ã€åˆ›å»ºæ•°æ®åº“ä¸è¡¨"><a href="#1-1ã€åˆ›å»ºæ•°æ®åº“ä¸è¡¨" class="headerlink" title="1.1ã€åˆ›å»ºæ•°æ®åº“ä¸è¡¨"></a>1.1ã€åˆ›å»ºæ•°æ®åº“ä¸è¡¨</h2><blockquote><p>æ‰“å¼€æ•°æ®åº“å¯è§†åŒ–å·¥å…·ï¼Œæ‰§è¡Œä»¥ä¸‹sqlè¯­å¥</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">CREATE DATABASE ssm;</span><br><span class="line"></span><br><span class="line">USE ssm;</span><br><span class="line"></span><br><span class="line">CREATE TABLE &#96;student&#96;(</span><br><span class="line">    id INT PRIMARY KEY AUTO_INCREMENT,</span><br><span class="line">    &#96;name&#96; VARCHAR(32),</span><br><span class="line">    score DOUBLE</span><br><span class="line">);</span><br><span class="line">INSERT INTO &#96;student&#96; VALUES (1, &#39;A&#39;, 80);</span><br><span class="line">INSERT INTO &#96;student&#96; VALUES (2, &#39;B&#39;, 95);</span><br><span class="line">INSERT INTO &#96;student&#96; VALUES (3, &#39;C&#39;, 90);</span><br><span class="line">INSERT INTO &#96;student&#96; VALUES (4, &#39;D&#39;, 100);</span><br></pre></td></tr></table></figure><h2 id="1-2ã€åˆ›å»ºmavené¡¹ç›®"><a href="#1-2ã€åˆ›å»ºmavené¡¹ç›®" class="headerlink" title="1.2ã€åˆ›å»ºmavené¡¹ç›®"></a>1.2ã€åˆ›å»ºmavené¡¹ç›®</h2><blockquote><p>æ³¨ï¼šè¿™é‡Œéœ€è¦ä»¥maven-archetype-webappä¸ºéª¨æ¶æ„å»ºé¡¹ç›®</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131125931.png" alt="image-20210131125931386"></p><blockquote><p>è®¾ç½®é¡¹ç›®è·¯å¾„ä¸åæ ‡åï¼Œç‚¹å‡»next</p></blockquote><blockquote><p>é€‰æ‹©é¡¹ç›®ä½¿ç”¨çš„mavenç‰ˆæœ¬åŠsettings.xmlæ–‡ä»¶ï¼Œ<strong>åœ¨å±æ€§ä¸­æ·»åŠ ä¸€é”®å€¼å¯¹</strong>ï¼š**(archetypeCatalog:internal)**ï¼Œè¿™ä¸ªé”®å€¼å¯¹å¯ä»¥è§£å†³mavené¡¹ç›®æ„å»ºé€Ÿåº¦è¿‡æ…¢çš„é—®é¢˜ã€‚</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131130358.png" alt="image-20210131130358733"></p><h2 id="1-3ã€ç¼–è¾‘pom-xml"><a href="#1-3ã€ç¼–è¾‘pom-xml" class="headerlink" title="1.3ã€ç¼–è¾‘pom.xml"></a>1.3ã€ç¼–è¾‘pom.xml</h2><blockquote><p>åœ¨pom.xmlæ–‡ä»¶ä¸­<strong>å¼•å…¥é¡¹ç›®ä¾èµ–</strong>ä¸<strong>ç‰ˆæœ¬é”å®š</strong></p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">properties</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">project.build.sourceEncoding</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">project.build.sourceEncoding</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.source</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.source</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">maven.compiler.target</span>&gt;</span>1.8<span class="tag">&lt;/<span class="name">maven.compiler.target</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">spring.version</span>&gt;</span>5.0.2.RELEASE<span class="tag">&lt;/<span class="name">spring.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">slf4j.version</span>&gt;</span>1.6.6<span class="tag">&lt;/<span class="name">slf4j.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">log4j.version</span>&gt;</span>1.2.12<span class="tag">&lt;/<span class="name">log4j.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mysql.version</span>&gt;</span>8.0.19<span class="tag">&lt;/<span class="name">mysql.version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">mybatis.version</span>&gt;</span>3.4.5<span class="tag">&lt;/<span class="name">mybatis.version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">properties</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- spring --&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- aopç›¸å…³çš„æŠ€æœ¯ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.aspectj<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>aspectjweaver<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.6.8<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- aop --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-aop<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- contextå®¹å™¨ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-context<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- web --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- webmvc --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-webmvc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- springæµ‹è¯• --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- äº‹åŠ¡ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-tx<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- jdbcæ¨¡æ¿æŠ€æœ¯ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-jdbc<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;spring.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- å•å…ƒæµ‹è¯• --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.12<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>compile<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- mysqlè¿æ¥ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mysql.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- servlet --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>servlet-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.5<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- jsp --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>javax.servlet.jsp<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jsp-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">scope</span>&gt;</span>provided<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- EL JL TLè¡¨è¾¾å¼ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>jstl<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- log start --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>log4j<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;log4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-api<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.slf4j<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>slf4j-log4j12<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;slf4j.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!-- log end --&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- mybatisç›¸å…³ --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>$&#123;mybatis.version&#125;<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.mybatis<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-spring<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.3.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">&lt;!-- druid è¿æ¥æ±  --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.alibaba<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>druid<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.0.9<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.18.16<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="1-4ã€å®Œå–„ç›®å½•ç»“æ„"><a href="#1-4ã€å®Œå–„ç›®å½•ç»“æ„" class="headerlink" title="1.4ã€å®Œå–„ç›®å½•ç»“æ„"></a>1.4ã€å®Œå–„ç›®å½•ç»“æ„</h2><ul><li>åœ¨src/mainç›®å½•ä¸‹åˆ›å»ºjavaæ–‡ä»¶å¤¹ä¸resourceæ–‡ä»¶å¤¹ã€‚</li><li>åœ¨ä¸Šä¸€æ­¥åˆ›å»ºçš„javaç›®å½•ä¸‹åˆ›å»ºcom.hzx.entityã€com.hzx.daoã€com.hzx.controllerã€com.hzx.serviceå’Œcom.hzx.teståŒ…</li></ul><blockquote><p>å®Œå–„åçš„ç›®å½•å¦‚ä¸‹ï¼š</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131131024.png" alt="image-20210131131024222"></p><h2 id="1-5ã€åˆ›å»ºåŸºæœ¬ç±»"><a href="#1-5ã€åˆ›å»ºåŸºæœ¬ç±»" class="headerlink" title="1.5ã€åˆ›å»ºåŸºæœ¬ç±»"></a>1.5ã€åˆ›å»ºåŸºæœ¬ç±»</h2><blockquote><p>æ ¹æ®æ•°æ®åº“çš„è¡¨ç»“æ„åˆ›å»ºå®ä½“ç±»ï¼Œè¿™é‡Œä½¿ç”¨äº†<strong>Lombok</strong>ç®€åŒ–å¼€å‘</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzx.entity;</span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Student</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Integer id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Double score;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨serviceåŒ…ä¸‹åˆ›å»ºä¸€ä¸ªStudentServiceæ¥å£ï¼Œå†åˆ›å»ºä¸€ä¸ªimplåŒ…ï¼Œç„¶ååœ¨implåŒ…ä¸‹æ–°å»ºä¸€ä¸ªStudentServiceImplå®ç°ç±»ï¼Œè¿™ä¸ªç±»å®ç°StudentServiceæ¥å£ã€‚</p></blockquote><ul><li>æ¥å£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzx.service;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å®ç°ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzx.service.impl;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨mapperåŒ…ä¸‹åˆ›å»ºStudentMapperæ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzx.mapper;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨controlleråŒ…ä¸‹åˆ›å»ºä¸€ä¸ªStudentControlleræ¥å£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> com.hzx.controller;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="äºŒã€Springç›¸å…³ç¯å¢ƒé…ç½®"><a href="#äºŒã€Springç›¸å…³ç¯å¢ƒé…ç½®" class="headerlink" title="äºŒã€Springç›¸å…³ç¯å¢ƒé…ç½®"></a>äºŒã€Springç›¸å…³ç¯å¢ƒé…ç½®</h1><h2 id="2-1ã€ç¼–å†™Springæ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#2-1ã€ç¼–å†™Springæ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="2.1ã€ç¼–å†™Springæ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>2.1ã€ç¼–å†™Springæ ¸å¿ƒé…ç½®æ–‡ä»¶</h2><blockquote><p>åœ¨resourceç›®å½•ä¸‹åˆ›å»ºSpringæ ¸å¿ƒé…ç½®æ–‡ä»¶â€“applicationContext.xml</p><p>åœ¨è¿™ä¸ªæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­ï¼Œæˆ‘ä»¬éœ€è¦</p></blockquote><ul><li>å¼€å¯ç»„ä»¶æ‰«æï¼Œæ‰«æcom.hzxåŒ…ä¸‹çš„æ‰€æœ‰ç»„ä»¶</li><li>ç”±äºcontrolleråŒ…ä¸‹çš„æ§åˆ¶å™¨ç»„ä»¶å±äºSpringMVCï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦åœ¨ç»„ä»¶æ‰«æä¸­æ’é™¤com.hzxåŒ…ä¸‹æ‰€æœ‰æ·»åŠ äº†@Controlleræ³¨è§£çš„ç»„ä»¶ã€‚</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:aop</span>=<span class="string">&quot;http://www.springframework.org/schema/aop&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:tx</span>=<span class="string">&quot;http://www.springframework.org/schema/tx&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/context/spring-context.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/aop/spring-aop.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx</span></span></span><br><span class="line"><span class="tag"><span class="string">   http://www.springframework.org/schema/tx/spring-tx.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- å¼€å¯æ³¨è§£æ‰«æï¼Œå¤„ç†serviceå’Œdaoï¼Œä½†æ˜¯ä¸éœ€è¦å¤„ç† controller --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.hzx&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- é…ç½®å“ªäº›æ³¨è§£ä¸æ‰«æ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:exclude-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-2ã€æµ‹è¯•"><a href="#2-2ã€æµ‹è¯•" class="headerlink" title="2.2ã€æµ‹è¯•"></a>2.2ã€æµ‹è¯•</h2><blockquote><p>åœ¨StudentServiceImplä¸Šæ·»åŠ @Serviceæ³¨è§£ï¼ŒåŒæ—¶æ·»åŠ ä¸¤ä¸ªæ–¹æ³•è¿›è¡Œæµ‹è¯•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getAllStudent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Serviceå±‚çš„getAllæ–¹æ³•ï¼Œéœ€è¦è°ƒç”¨Mapperå±‚ä¸æ•°æ®åº“äº¤äº’.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨com.hzx.teståŒ…ä¸‹åˆ›å»ºä¸€ä¸ªTestSpringç±»ï¼Œç¼–å†™æ–¹æ³•ä½¿ç”¨junitè¿›è¡Œæµ‹è¯•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TestSpring</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testGetAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ApplicationContext ioc = <span class="keyword">new</span> ClassPathXmlApplicationContext(<span class="string">&quot;applicationContext.xml&quot;</span>);</span><br><span class="line">        StudentService studentService = ioc.getBean(StudentServiceImpl.class);</span><br><span class="line">        studentService.getAllStudent();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131133141.png" alt="image-20210131133141706"></p><blockquote><p>å‡ºç°ä»¥ä¸Šç»“æœè¯æ˜SpringåŸºæœ¬ç¯å¢ƒå·²ç»æ­å»ºå®Œæˆï¼Œä¸‹é¢é…ç½®SpringMVC</p></blockquote><h1 id="ä¸‰ã€SpringMVCç›¸å…³ç¯å¢ƒé…ç½®"><a href="#ä¸‰ã€SpringMVCç›¸å…³ç¯å¢ƒé…ç½®" class="headerlink" title="ä¸‰ã€SpringMVCç›¸å…³ç¯å¢ƒé…ç½®"></a>ä¸‰ã€SpringMVCç›¸å…³ç¯å¢ƒé…ç½®</h1><h2 id="3-1ã€é…ç½®web-xml"><a href="#3-1ã€é…ç½®web-xml" class="headerlink" title="3,1ã€é…ç½®web.xml"></a>3,1ã€é…ç½®web.xml</h2><blockquote><p>é…ç½®SpringMVCçš„æ ¸å¿ƒå‰ç«¯æ§åˆ¶å™¨ï¼š<strong>DispatcherServlet</strong></p><p>web.xmlæ–‡ä»¶ä½ç½®å¦‚ä¸‹</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131133440.png" alt="image-20210131133440460"></p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®å‰ç«¯æ§åˆ¶å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-class</span>&gt;</span>org.springframework.web.servlet.DispatcherServlet<span class="tag">&lt;/<span class="name">servlet-class</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--åŠ è½½springmvc.xmlé…ç½®æ–‡ä»¶--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:springmvc.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line">  <span class="comment">&lt;!--å¯åŠ¨æœåŠ¡å™¨ï¼Œåˆ›å»ºè¯¥servlet--&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">load-on-startup</span>&gt;</span>1<span class="tag">&lt;/<span class="name">load-on-startup</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">servlet-mapping</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">servlet-name</span>&gt;</span>dispatcherServlet<span class="tag">&lt;/<span class="name">servlet-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">servlet-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>é…ç½®å‰ç«¯æ§åˆ¶å™¨çš„è¿‡ç¨‹ä¸­ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šspringmvcçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ä½ç½®ï¼Œåœ¨resourceç›®å½•ä¸‹åˆ›å»ºspringmvcæ ¸å¿ƒé…ç½®æ–‡ä»¶â€“<strong>springmvc.xml</strong></p></li><li><p>ä½¿ç”¨è¯¥å‰ç«¯æ§åˆ¶å™¨æ‹¦æˆªæ‰€æœ‰è¯·æ±‚ï¼Œåœ¨æœåŠ¡å™¨å¯åŠ¨æ—¶åˆ›å»ºè¯¥servlet</p></li></ul><blockquote><p>é…ç½®å­—ç¬¦ç¼–ç è¿‡æ»¤å™¨ï¼Œç”¨äºè§£å†³ä¸­æ–‡ä¹±ç </p><p>æ³¨ï¼š<strong>å¦‚æœé…ç½®äº†å¤šä¸ªè¿‡æ»¤å™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå­—ç¬¦ç¼–ç è¿‡æ»¤å™¨å¿…é¡»æ”¾åœ¨æœ€å‰</strong></p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®è¿‡æ»¤å™¨ï¼Œè§£å†³ä¸­æ–‡ä¹±ç --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.CharacterEncodingFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">init-param</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>encoding<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>UTF-8<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">init-param</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>characterEncodingFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>å¯é€‰ï¼šå¦‚æœä½ åœ¨SSMæ¡†æ¶ä¸­æƒ³ä½¿ç”¨RESTé£æ ¼çš„APIï¼Œé‚£ä¹ˆéœ€è¦é…ç½®ä¸€ä¸ª<strong>HiddenHttpMethodFilter</strong></p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- é…ç½®ä½¿ç”¨Resté£æ ¼çš„URL --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-class</span>&gt;</span>org.springframework.web.filter.HiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">filter-mapping</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">filter-name</span>&gt;</span>hiddenHttpMethodFilter<span class="tag">&lt;/<span class="name">filter-name</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">url-pattern</span>&gt;</span>/*<span class="tag">&lt;/<span class="name">url-pattern</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">filter-mapping</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-2ã€é…ç½®springmvc-xml"><a href="#3-2ã€é…ç½®springmvc-xml" class="headerlink" title="3.2ã€é…ç½®springmvc.xml"></a>3.2ã€é…ç½®springmvc.xml</h2><blockquote><p>åœ¨resourceç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªspringmvc.xmlé…ç½®æ–‡ä»¶</p></blockquote><ul><li><p>åˆ›å»ºé…ç½®æ–‡ä»¶ï¼Œå¼•å…¥å‘½åç©ºé—´</p></li><li><p>å¼€å¯ç»„ä»¶æ‰«æï¼Œç”±äºSpringæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­å·²ç»æ‰«æé™¤<strong>æ§åˆ¶å™¨</strong>ä¹‹å¤–çš„ç»„ä»¶ï¼Œæ‰€ä»¥åœ¨springmvcæ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­åªéœ€è¦æ‰«ææ§åˆ¶å™¨å³å¯ã€‚</p></li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--1  å¼€å¯åªå¯¹controllerçš„æ‰«æ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.hzx&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>é…ç½®è§†å›¾è§£æå™¨ï¼Œåœ¨WEB-INFæ–‡ä»¶å¤¹ä¸‹åˆ›å»ºä¸€ä¸ªpagesæ–‡ä»¶å¤¹</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--2 é…ç½®è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;org&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--JSP ç›®å½•--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/pages/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--æ–‡ä»¶åç¼€--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><ul><li>åœ¨webappç›®å½•ä¸‹åˆ›å»ºä¸‰ä¸ªç”¨äºå­˜æ”¾é™æ€èµ„æºçš„æ–‡ä»¶å¤¹ï¼ˆcssã€imagesã€jsï¼‰ï¼Œå¹¶æ”¾è¡Œé™æ€èµ„æº</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--3 ä¸è¿‡æ»¤é™æ€èµ„æº--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/css/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/css/&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/images/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/images/&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/js/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/js/&quot;</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>å¼€å¯æ³¨è§£æ”¯æŒ</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--4 å¼€å¯æ³¨è§£æ”¯æŒ--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br></pre></td></tr></table></figure><ul><li>springmvc.xmlé…ç½®å¦‚ä¸‹ï¼š</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">beans</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://www.springframework.org/schema/beans&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:mvc</span>=<span class="string">&quot;http://www.springframework.org/schema/mvc&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:context</span>=<span class="string">&quot;http://www.springframework.org/schema/context&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xmlns:xsi</span>=<span class="string">&quot;http://www.w3.org/2001/XMLSchema-instance&quot;</span></span></span><br><span class="line"><span class="tag">       <span class="attr">xsi:schemaLocation</span>=<span class="string">&quot;</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/beans/spring-beans.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/mvc/spring-mvc.xsd</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context</span></span></span><br><span class="line"><span class="tag"><span class="string">        http://www.springframework.org/schema/context/spring-context.xsd&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--1  å¼€å¯åªå¯¹controllerçš„æ‰«æ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">context:component-scan</span> <span class="attr">base-package</span>=<span class="string">&quot;com.hzx&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">context:include-filter</span> <span class="attr">type</span>=<span class="string">&quot;annotation&quot;</span> <span class="attr">expression</span>=<span class="string">&quot;org.springframework.stereotype.Controller&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">context:component-scan</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--2 é…ç½®è§†å›¾è§£æå™¨--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;org&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.web.servlet.view.InternalResourceViewResolver&quot;</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--JSP ç›®å½•--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;prefix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;/WEB-INF/pages/&quot;</span>/&gt;</span></span><br><span class="line">        <span class="comment">&lt;!--æ–‡ä»¶åç¼€--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;suffix&quot;</span> <span class="attr">value</span>=<span class="string">&quot;.jsp&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--3 ä¸è¿‡æ»¤é™æ€èµ„æº--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/css/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/css/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/images/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/images/&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:resources</span> <span class="attr">mapping</span>=<span class="string">&quot;/js/**&quot;</span> <span class="attr">location</span>=<span class="string">&quot;/js/&quot;</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--4 å¼€å¯æ³¨è§£æ”¯æŒ--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">mvc:annotation-driven</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">beans</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-3ã€ç¼–å†™é¡µé¢"><a href="#3-3ã€ç¼–å†™é¡µé¢" class="headerlink" title="3.3ã€ç¼–å†™é¡µé¢"></a>3.3ã€ç¼–å†™é¡µé¢</h2><blockquote><p>ä¿®æ”¹index.jsp</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ä¸»é¡µ&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;a href=&quot;student/getAll&quot;&gt;æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿ&lt;/a&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨WEB-INF/pagesç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªlist.jsp</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> isELIgnored=<span class="string">&quot;false&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;æŸ¥è¯¢æ‰€æœ‰é¡µé¢&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;è¿™æ˜¯å­¦ç”Ÿåˆ—è¡¨&lt;/h3&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><h2 id="3-4ã€æµ‹è¯•"><a href="#3-4ã€æµ‹è¯•" class="headerlink" title="3.4ã€æµ‹è¯•"></a>3.4ã€æµ‹è¯•</h2><blockquote><p>åœ¨StudentControlleræ·»åŠ ä¸€æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ç”¨äºè·³è½¬åˆ°list.jspé¡µé¢</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">getAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.setViewName(<span class="string">&quot;list&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®tomcat</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131140153.png" alt="image-20210131140153219"></p><blockquote><p>ç‚¹å‡»è¶…é“¾æ¥åè·³è½¬æˆåŠŸï¼Œè¯æ˜SpringmvcåŸºæœ¬é…ç½®å®Œæˆ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131140235.png" alt="image-20210131140235530"></p><h1 id="å››ã€Springæ•´åˆSpring-MVC"><a href="#å››ã€Springæ•´åˆSpring-MVC" class="headerlink" title="å››ã€Springæ•´åˆSpring MVC"></a>å››ã€Springæ•´åˆSpring MVC</h1><h2 id="4-1ã€é…ç½®ç›‘å¬å™¨"><a href="#4-1ã€é…ç½®ç›‘å¬å™¨" class="headerlink" title="4.1ã€é…ç½®ç›‘å¬å™¨"></a>4.1ã€é…ç½®ç›‘å¬å™¨</h2><blockquote><p>é€šè¿‡å¯¹ Spring MVC çš„ä»£ç ç¼–å†™ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œåœ¨æœåŠ¡å™¨å¯åŠ¨çš„æ—¶å€™å°±å›å»åŠ è½½ springmvc.xml è¿™ä¸ªé…ç½®ï¼Œç°åœ¨æˆ‘ä»¬å°±éœ€è¦ç»§ç»­åœ¨ web.xml ä¸­é…ç½®ï¼Œä½¿å¾—åœ¨é¡¹ç›®å¯åŠ¨çš„æ—¶å€™ï¼Œå°±å»åŠ è½½applicationContext.xmlçš„é…ç½®æ–‡ä»¶</p><p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥åœ¨ <strong>web.xml</strong> ä¸­ï¼Œ<strong>é…ç½®springæ ¸å¿ƒç›‘å¬å™¨</strong>ï¼Œå®ƒé»˜è®¤ä¼šä»¥ /WEB-INF/applicationContext.xmlä½œä¸ºé…ç½®æ–‡ä»¶ï¼Œè¿™é‡Œéœ€è¦æ³¨æ„web.xmlæ–‡ä»¶ä¸­å„ä¸ªç»„ä»¶çš„å­˜æ”¾ä½ç½®</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--è®¾ç½®é…ç½®æ–‡ä»¶è·¯å¾„--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">context-param</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-name</span>&gt;</span>contextConfigLocation<span class="tag">&lt;/<span class="name">param-name</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">param-value</span>&gt;</span>classpath:applicationContext.xml<span class="tag">&lt;/<span class="name">param-value</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">context-param</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½® Spring çš„ç›‘å¬å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">listener</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">listener-class</span>&gt;</span>org.springframework.web.context.ContextLoaderListener<span class="tag">&lt;/<span class="name">listener-class</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">listener</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="4-2ã€ä½¿ç”¨controllerè°ƒç”¨service"><a href="#4-2ã€ä½¿ç”¨controllerè°ƒç”¨service" class="headerlink" title="4.2ã€ä½¿ç”¨controllerè°ƒç”¨service"></a>4.2ã€ä½¿ç”¨controllerè°ƒç”¨service</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentService studentService;</span><br><span class="line">    </span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">getAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ§åˆ¶å±‚çš„getAllæ–¹æ³•...&quot;</span>);</span><br><span class="line">        studentService.getAllStudent();</span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.setViewName(<span class="string">&quot;list&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3ã€é‡æ–°å¯åŠ¨tomcatï¼Œæµ‹è¯•"><a href="#4-3ã€é‡æ–°å¯åŠ¨tomcatï¼Œæµ‹è¯•" class="headerlink" title="4.3ã€é‡æ–°å¯åŠ¨tomcatï¼Œæµ‹è¯•"></a>4.3ã€é‡æ–°å¯åŠ¨tomcatï¼Œæµ‹è¯•</h2><blockquote><p>åœ¨tomcatçš„VM optionsä¸­å¡«å…¥ï¼š-Dfile.encoding=UTF-8ï¼Œç”¨äºè§£å†³IDEAçš„æ§åˆ¶å°ä¹±ç é—®é¢˜</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131141119.png" alt="image-20210131141119573"></p><h1 id="äº”ã€ä½¿ç”¨Springæ•´åˆMybatis"><a href="#äº”ã€ä½¿ç”¨Springæ•´åˆMybatis" class="headerlink" title="äº”ã€ä½¿ç”¨Springæ•´åˆMybatis"></a>äº”ã€ä½¿ç”¨Springæ•´åˆMybatis</h1><h2 id="5-1ã€ç¼–å†™Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#5-1ã€ç¼–å†™Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="5.1ã€ç¼–å†™Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>5.1ã€ç¼–å†™Mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶</h2><blockquote><p>åœ¨resourceç›®å½•ä¸‹æ–°å»ºä¸€ä¸ªSqlMapConfig.xmlï¼Œè¿™ä¸ªæ–‡ä»¶å…¶å®å¯ä»¥çœç•¥ï¼Œä½†æˆ‘ä»¬è¿˜æ˜¯ç”¨å®ƒæ¥ç¼–å†™ç±»åç®€åŒ–é…ç½®ã€‚</p></blockquote><ul><li>åˆ›å»ºSqlMapConfig.xmlé…ç½®æ–‡ä»¶</li><li>æ‰«æcom.hzxåŒ…ï¼Œä¸ºåŒ…ä¸‹çš„å®ä½“ç±»èµ·ä¸€ä¸ªåˆ«åï¼Œå¹¶åœ¨æ§åˆ¶å°è¾“å‡ºæ‰§è¡Œçš„sql</li><li>ä¸æ•°æ®åº“è¿æ¥ç›¸å…³çš„é…ç½®æˆ‘ä»¬æ”¾åœ¨Springçš„æ ¸å¿ƒé…ç½®æ–‡ä»¶ä¸­é…ç½®ã€‚</li></ul><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="meta-keyword">configuration</span></span></span><br><span class="line"><span class="meta">        <span class="meta-keyword">PUBLIC</span> <span class="meta-string">&quot;-//mybatis.org//DTD Config 3.0//EN&quot;</span></span></span><br><span class="line"><span class="meta">        <span class="meta-string">&quot;http://mybatis.org/dtd/mybatis-3-config.dtd&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">settings</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- æ‰“å°æŸ¥è¯¢è¯­å¥ --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">setting</span> <span class="attr">name</span>=<span class="string">&quot;logImpl&quot;</span> <span class="attr">value</span>=<span class="string">&quot;STDOUT_LOGGING&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">settings</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">typeAliases</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">package</span> <span class="attr">name</span>=<span class="string">&quot;com.hzx&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">typeAliases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-2ã€ç¼–å†™StudentMapperæ¥å£"><a href="#5-2ã€ç¼–å†™StudentMapperæ¥å£" class="headerlink" title="5.2ã€ç¼–å†™StudentMapperæ¥å£"></a>5.2ã€ç¼–å†™StudentMapperæ¥å£</h2><blockquote><p>ä½¿ç”¨æ³¨è§£å½¢å¼ç¼–å†™sqlè¯­å¥ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨xmlé…ç½®æ–‡ä»¶çš„æ–¹å¼</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">StudentMapper</span> </span>&#123;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Select(&quot;select * from `ssm`.`student`&quot;)</span></span><br><span class="line">    <span class="function">List&lt;Student&gt; <span class="title">getAll</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * å‘æ•°æ®åº“ä¸­æ’å…¥ä¸€ä¸ªå­¦ç”Ÿ</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> student</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Insert(&quot;insert into `ssm`.`student`(name,score) values(#&#123;name&#125;,#&#123;score&#125;)&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addStudent</span><span class="params">(Student student)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-3ã€ç¼–å†™é“¾æ¥æ•°æ®åº“çš„é…ç½®æ–‡ä»¶"><a href="#5-3ã€ç¼–å†™é“¾æ¥æ•°æ®åº“çš„é…ç½®æ–‡ä»¶" class="headerlink" title="5.3ã€ç¼–å†™é“¾æ¥æ•°æ®åº“çš„é…ç½®æ–‡ä»¶"></a>5.3ã€ç¼–å†™é“¾æ¥æ•°æ®åº“çš„é…ç½®æ–‡ä»¶</h2><figure class="highlight properties"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">jdbc.driver</span>=<span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line"><span class="meta">jdbc.url</span>=<span class="string">jdbc:mysql://localhost:3306/ssm?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;nullCatalogMeansCurrent=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line"><span class="meta">jdbc.username</span>=<span class="string">root</span></span><br><span class="line"><span class="meta">jdbc.password</span>=<span class="string">tianxin1230.</span></span><br></pre></td></tr></table></figure><h2 id="5-4ã€ä¿®æ”¹Springæ ¸å¿ƒé…ç½®æ–‡ä»¶"><a href="#5-4ã€ä¿®æ”¹Springæ ¸å¿ƒé…ç½®æ–‡ä»¶" class="headerlink" title="5.4ã€ä¿®æ”¹Springæ ¸å¿ƒé…ç½®æ–‡ä»¶"></a>5.4ã€ä¿®æ”¹Springæ ¸å¿ƒé…ç½®æ–‡ä»¶</h2><blockquote><p>åœ¨Springæ ¸å¿ƒé…ç½®æ–‡ä»¶é…ç½®æ•°æ®åº“è¿æ¥æ± ï¼Œå¼•å…¥propertiesæ–‡ä»¶</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">context:property-placeholder</span> <span class="attr">location</span>=<span class="string">&quot;classpath:db.properties&quot;</span> <span class="attr">ignore-unresolvable</span>=<span class="string">&quot;true&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®æ•°æ®åº“è¿æ¥æ± --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">class</span>=<span class="string">&quot;com.alibaba.druid.pool.DruidDataSource&quot;</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!-- æ•°æ®åº“åŸºæœ¬ä¿¡æ¯é…ç½® --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;driverClassName&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.driver&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;url&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.url&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;username&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.username&#125;&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;password&quot;</span> <span class="attr">value</span>=<span class="string">&quot;$&#123;jdbc.password&#125;&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®SqlSessionFactoryå·¥å‚ --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;sqlSessionFactory&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.SqlSessionFactoryBean&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!-- é…ç½®StudentMapperæ¥å£æ‰€åœ¨åŒ… --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;mapperScanner&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.mybatis.spring.mapper.MapperScannerConfigurer&quot;</span> &gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;basePackage&quot;</span> <span class="attr">value</span>=<span class="string">&quot;com.hzx.mapper&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="5-5ã€ä¿®æ”¹serviceå®ç°ç±»å’Œcontrollerå±‚"><a href="#5-5ã€ä¿®æ”¹serviceå®ç°ç±»å’Œcontrollerå±‚" class="headerlink" title="5.5ã€ä¿®æ”¹serviceå®ç°ç±»å’Œcontrollerå±‚"></a>5.5ã€ä¿®æ”¹serviceå®ç°ç±»å’Œcontrollerå±‚</h2><blockquote><p>serviceå®ç°ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentServiceImpl</span> <span class="keyword">implements</span> <span class="title">StudentService</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentMapper studentMapper;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;Student&gt; <span class="title">getAllStudent</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Serviceå±‚çš„getAllæ–¹æ³•ï¼Œéœ€è¦è°ƒç”¨Mapperå±‚ä¸æ•°æ®åº“äº¤äº’.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> studentMapper.getAll();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addStudent</span><span class="params">(Student student)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;Serviceå±‚çš„addStudentæ–¹æ³•ï¼Œéœ€è¦è°ƒç”¨Mapperå±‚ä¸æ•°æ®åº“äº¤äº’.&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> studentMapper.addStudent(student);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>controllerå±‚</p><p>ä¿®æ”¹getAllæ–¹æ³•ï¼Œå¹¶æ·»åŠ addæ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Controller</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/student&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StudentController</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> StudentService studentService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/getAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> ModelAndView <span class="title">getAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">&quot;æ§åˆ¶å±‚çš„getAllæ–¹æ³•...&quot;</span>);</span><br><span class="line">        List&lt;Student&gt; students = studentService.getAllStudent();</span><br><span class="line">        ModelAndView mv = <span class="keyword">new</span> ModelAndView();</span><br><span class="line">        mv.addObject(<span class="string">&quot;students&quot;</span>,students);</span><br><span class="line">        mv.setViewName(<span class="string">&quot;list&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span> mv;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@RequestMapping(&quot;/add&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">add</span><span class="params">(Student student, HttpServletRequest request, HttpServletResponse response)</span> <span class="keyword">throws</span> IOException, IOException </span>&#123;</span><br><span class="line">        studentService.addStudent(student);</span><br><span class="line">        response.sendRedirect(request.getContextPath()+<span class="string">&quot;/student/getAll&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-6ã€ä¿®æ”¹index-jspå’Œ"><a href="#5-6ã€ä¿®æ”¹index-jspå’Œ" class="headerlink" title="5.6ã€ä¿®æ”¹index.jspå’Œ"></a>5.6ã€ä¿®æ”¹index.jspå’Œ</h2><blockquote><p>index.jsp</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;ä¸»é¡µ&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;a href=&quot;student/getAll&quot;&gt;æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿ&lt;/a&gt;</span><br><span class="line">    &lt;form action=<span class="string">&quot;student/add&quot;</span> method=<span class="string">&quot;post&quot;</span>&gt;</span><br><span class="line">        å­¦ç”Ÿå§“å:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;name&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">        å­¦ç§‘æˆç»©:&lt;input type=<span class="string">&quot;text&quot;</span> name=<span class="string">&quot;score&quot;</span>&gt;&lt;br/&gt;</span><br><span class="line">        &lt;input type=<span class="string">&quot;submit&quot;</span> value=<span class="string">&quot;æ·»åŠ &quot;</span>/&gt;&lt;br/&gt;</span><br><span class="line">    &lt;/form&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><blockquote><p>list.jsp</p></blockquote><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;%@ taglib prefix=<span class="string">&quot;c&quot;</span> uri=<span class="string">&quot;http://java.sun.com/jsp/jstl/core&quot;</span> %&gt;</span><br><span class="line">&lt;%@ page contentType=<span class="string">&quot;text/html;charset=UTF-8&quot;</span> language=<span class="string">&quot;java&quot;</span> isELIgnored=<span class="string">&quot;false&quot;</span> %&gt;</span><br><span class="line">&lt;html&gt;</span><br><span class="line">&lt;head&gt;</span><br><span class="line">    &lt;title&gt;å­¦ç”Ÿåˆ—è¡¨&lt;/title&gt;</span><br><span class="line">&lt;/head&gt;</span><br><span class="line">&lt;body&gt;</span><br><span class="line">    &lt;h3&gt;å­¦ç”Ÿåˆ—è¡¨&lt;/h3&gt;</span><br><span class="line">    &lt;c:forEach items=<span class="string">&quot;$&#123;students&#125;&quot;</span> <span class="keyword">var</span>=<span class="string">&quot;student&quot;</span>&gt;</span><br><span class="line">        $&#123;student.name&#125; çš„æˆç»©ä¸º: $&#123;student.score&#125;</span><br><span class="line">    &lt;/c:forEach&gt;</span><br><span class="line">&lt;/body&gt;</span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•æŸ¥è¯¢æ‰€æœ‰å­¦ç”Ÿæ–¹æ³•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131143231.png" alt="image-20210131143231582"></p><blockquote><p>æµ‹è¯•æ·»åŠ æ‰€æœ‰å­¦ç”Ÿæ–¹æ³•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131143459.png" alt="image-20210131143459450"></p><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/20210131144430.png" alt="image-20210131144429826"></p><h2 id="5-7ã€æ·»åŠ äº‹åŠ¡æ§åˆ¶"><a href="#5-7ã€æ·»åŠ äº‹åŠ¡æ§åˆ¶" class="headerlink" title="5.7ã€æ·»åŠ äº‹åŠ¡æ§åˆ¶"></a>5.7ã€æ·»åŠ äº‹åŠ¡æ§åˆ¶</h2><blockquote><p>ä¿®æ”¹springæ ¸å¿ƒé…ç½®æ–‡ä»¶</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--é…ç½®Springæ¡†æ¶å£°æ˜å¼äº‹åŠ¡ç®¡ç†--&gt;</span></span><br><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡ç®¡ç†å™¨--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">bean</span> <span class="attr">id</span>=<span class="string">&quot;transactionManager&quot;</span> <span class="attr">class</span>=<span class="string">&quot;org.springframework.jdbc.datasource.DataSourceTransactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;dataSource&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;dataSource&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">bean</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®äº‹åŠ¡é€šçŸ¥--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">tx:advice</span> <span class="attr">id</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">transaction-manager</span>=<span class="string">&quot;transactionManager&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;find*&quot;</span> <span class="attr">read-only</span>=<span class="string">&quot;true&quot;</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">tx:method</span> <span class="attr">name</span>=<span class="string">&quot;*&quot;</span> <span class="attr">isolation</span>=<span class="string">&quot;DEFAULT&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">tx:attributes</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">tx:advice</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--é…ç½®AOPå¢å¼º--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">aop:config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">aop:advisor</span> <span class="attr">advice-ref</span>=<span class="string">&quot;txAdvice&quot;</span> <span class="attr">pointcut</span>=<span class="string">&quot;execution(* cn.ideal.service.impl.*ServiceImpl.*(..))&quot;</span>/&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">aop:config</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ’Mybatis </tag>
            
            <tag> ğŸƒSpring </tag>
            
            <tag> ğŸƒSpring MVC </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaåº”ç”¨å­¦ä¹ ï¼ˆäºŒï¼‰-Springbootæ•´åˆswagger/swagger-Bootstrap-UIä½¿ç”¨</title>
      <link href="posts/2938255980.html"/>
      <url>posts/2938255980.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€SwaggeråŠSwagger-Bootstrap-UIç®€ä»‹"><a href="#ä¸€ã€SwaggeråŠSwagger-Bootstrap-UIç®€ä»‹" class="headerlink" title="ä¸€ã€SwaggeråŠSwagger-Bootstrap-UIç®€ä»‹"></a>ä¸€ã€SwaggeråŠSwagger-Bootstrap-UIç®€ä»‹</h1><h2 id="1-1ã€swaggerç®€ä»‹"><a href="#1-1ã€swaggerç®€ä»‹" class="headerlink" title="1.1ã€swaggerç®€ä»‹"></a>1.1ã€swaggerç®€ä»‹</h2><blockquote><p><a href="https://swagger.io/">Swagger</a> æ˜¯ä¸€æ¬¾RESTFULæ¥å£çš„ã€åŸºäºYAMLã€JSONè¯­è¨€çš„æ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆã€ä»£ç è‡ªåŠ¨ç”Ÿæˆçš„å·¥å…·ã€‚æ˜¯ä¸€ä¸ªè§„èŒƒå’Œå®Œæ•´çš„æ¡†æ¶ï¼Œç”¨äºç”Ÿæˆã€æè¿°ã€è°ƒç”¨å’Œå¯è§†åŒ– RESTful é£æ ¼çš„ Web æœåŠ¡ã€‚</p><p>æ€»ä½“ç›®æ ‡æ˜¯ä½¿å®¢æˆ·ç«¯å’Œæ–‡ä»¶ç³»ç»Ÿä½œä¸ºæœåŠ¡å™¨ä»¥åŒæ ·çš„é€Ÿåº¦æ¥æ›´æ–°ã€‚æ–‡ä»¶çš„æ–¹æ³•ã€å‚æ•°å’Œæ¨¡å‹ç´§å¯†é›†æˆåˆ°æœåŠ¡å™¨ç«¯çš„ä»£ç ï¼Œå…è®¸ API æ¥å§‹ç»ˆä¿æŒåŒæ­¥ã€‚Swagger è®©éƒ¨ç½²ç®¡ç†å’Œä½¿ç”¨åŠŸèƒ½å¼ºå¤§çš„ API ä»æœªå¦‚æ­¤ç®€å•ã€‚</p></blockquote><h2 id="1-2ã€å…³äºSwagger-Bootstrap-UI"><a href="#1-2ã€å…³äºSwagger-Bootstrap-UI" class="headerlink" title="1.2ã€å…³äºSwagger-Bootstrap-UI"></a>1.2ã€å…³äºSwagger-Bootstrap-UI</h2><h3 id="1-2-1ã€ç®€ä»‹"><a href="#1-2-1ã€ç®€ä»‹" class="headerlink" title="1.2.1ã€ç®€ä»‹"></a>1.2.1ã€ç®€ä»‹</h3><blockquote><p><a href="https://gitee.com/xiaoym/swagger-bootstrap-ui">swagger-bootstrap-ui</a>æ˜¯springfox-swaggerçš„å¢å¼ºUIå®ç°ï¼Œä¸ºJavaå¼€å‘è€…åœ¨ä½¿ç”¨Swaggerçš„æ—¶å€™ï¼Œèƒ½æ‹¥æœ‰ä¸€ä»½ç®€æ´ã€å¼ºå¤§çš„æ¥å£æ–‡æ¡£ä½“éªŒã€‚</p></blockquote><h3 id="1-2-2ã€æ ¸å¿ƒåŠŸèƒ½"><a href="#1-2-2ã€æ ¸å¿ƒåŠŸèƒ½" class="headerlink" title="1.2.2ã€æ ¸å¿ƒåŠŸèƒ½"></a>1.2.2ã€æ ¸å¿ƒåŠŸèƒ½</h3><blockquote><p>è¯¥UIå¢å¼ºåŒ…ä¸»è¦åŒ…æ‹¬ä¸¤å¤§æ ¸å¿ƒåŠŸèƒ½ï¼š<strong>æ–‡æ¡£è¯´æ˜</strong> å’Œ <strong>åœ¨çº¿è°ƒè¯•</strong></p><ul><li><p><strong>æ–‡æ¡£è¯´æ˜</strong>ï¼šæ ¹æ®Swaggerçš„è§„èŒƒè¯´æ˜ï¼Œè¯¦ç»†åˆ—å‡ºæ¥å£æ–‡æ¡£çš„è¯´æ˜ï¼ŒåŒ…æ‹¬æ¥å£åœ°å€ã€ç±»å‹ã€è¯·æ±‚ç¤ºä¾‹ã€è¯·æ±‚å‚æ•°ã€å“åº”ç¤ºä¾‹ã€å“åº”å‚æ•°ã€å“åº”ç ç­‰ä¿¡æ¯ï¼Œä½¿ç”¨swagger-bootstrap-uièƒ½æ ¹æ®è¯¥æ–‡æ¡£è¯´æ˜ï¼Œå¯¹è¯¥æ¥å£çš„ä½¿ç”¨æƒ…å†µä¸€ç›®äº†ç„¶ã€‚</p></li><li><p><strong>åœ¨çº¿è°ƒè¯•</strong>ï¼šæä¾›åœ¨çº¿æ¥å£è”è°ƒçš„å¼ºå¤§åŠŸèƒ½ï¼Œè‡ªåŠ¨è§£æå½“å‰æ¥å£å‚æ•°,åŒæ—¶åŒ…å«è¡¨å•éªŒè¯ï¼Œè°ƒç”¨å‚æ•°å¯è¿”å›æ¥å£å“åº”å†…å®¹ã€headersã€Curlè¯·æ±‚å‘½ä»¤å®ä¾‹ã€å“åº”æ—¶é—´ã€å“åº”çŠ¶æ€ç ç­‰ä¿¡æ¯ï¼Œå¸®åŠ©å¼€å‘è€…åœ¨çº¿è°ƒè¯•ï¼Œè€Œä¸å¿…é€šè¿‡å…¶ä»–æµ‹è¯•å·¥å…·æµ‹è¯•æ¥å£æ˜¯å¦æ­£ç¡®,ç®€ä»‹ã€å¼ºå¤§ã€‚</p></li></ul></blockquote><h3 id="1-2-3ã€UIå¢å¼º"><a href="#1-2-3ã€UIå¢å¼º" class="headerlink" title="1.2.3ã€UIå¢å¼º"></a>1.2.3ã€UIå¢å¼º</h3><blockquote><p>åŒæ—¶ï¼Œswagger-bootstrap-uiåœ¨æ»¡è¶³ä»¥ä¸ŠåŠŸèƒ½çš„åŒæ—¶ï¼Œè¿˜æä¾›äº†æ–‡æ¡£çš„å¢å¼ºåŠŸèƒ½ï¼Œè¿™äº›åŠŸèƒ½æ˜¯å®˜æ–¹swagger-uiæ‰€æ²¡æœ‰çš„ï¼Œæ¯ä¸€ä¸ªå¢å¼ºçš„åŠŸèƒ½éƒ½æ˜¯è´´åˆå®é™…,è€ƒè™‘åˆ°å¼€å‘è€…çš„å®é™…å¼€å‘éœ€è¦,æ˜¯æ¯”ä¸å¯å°‘çš„åŠŸèƒ½ï¼Œä¸»è¦åŒ…æ‹¬ï¼š</p><ul><li><p><strong>ä¸ªæ€§åŒ–é…ç½®</strong>ï¼šé€šè¿‡ä¸ªæ€§åŒ–uié…ç½®é¡¹ï¼Œå¯è‡ªå®šä¹‰UIçš„ç›¸å…³æ˜¾ç¤ºä¿¡æ¯</p></li><li><p><strong>ç¦»çº¿æ–‡æ¡£</strong>ï¼šæ ¹æ®æ ‡å‡†è§„èŒƒï¼Œç”Ÿæˆçš„åœ¨çº¿markdownç¦»çº¿æ–‡æ¡£ï¼Œå¼€å‘è€…å¯ä»¥è¿›è¡Œæ‹·è´ç”Ÿæˆmarkdownæ¥å£æ–‡æ¡£ï¼Œé€šè¿‡å…¶ä»–ç¬¬ä¸‰æ–¹markdownè½¬æ¢å·¥å…·è½¬æ¢æˆhtmlæˆ–pdfï¼Œè¿™æ ·ä¹Ÿå¯ä»¥æ”¾å¼ƒswagger2markdownç»„ä»¶</p></li><li><p><strong>æ¥å£æ’åº</strong>ï¼šè‡ª1.8.5åï¼Œuiæ”¯æŒäº†æ¥å£æ’åºåŠŸèƒ½ï¼Œä¾‹å¦‚ä¸€ä¸ªæ³¨å†ŒåŠŸèƒ½ä¸»è¦åŒ…å«äº†å¤šä¸ªæ­¥éª¤,å¯ä»¥æ ¹æ®swagger-bootstrap-uiæä¾›çš„æ¥å£æ’åºè§„åˆ™å®ç°æ¥å£çš„æ’åºï¼ŒstepåŒ–æ¥å£æ“ä½œï¼Œæ–¹ä¾¿å…¶ä»–å¼€å‘è€…è¿›è¡Œæ¥å£å¯¹æ¥</p></li></ul></blockquote><h3 id="1-2-4ã€UIç‰¹ç‚¹"><a href="#1-2-4ã€UIç‰¹ç‚¹" class="headerlink" title="1.2.4ã€UIç‰¹ç‚¹"></a>1.2.4ã€UIç‰¹ç‚¹</h3><blockquote><ul><li>ä»¥markdownå½¢å¼å±•ç¤ºæ–‡æ¡£,å°†æ–‡æ¡£çš„è¯·æ±‚åœ°å€ã€ç±»å‹ã€è¯·æ±‚å‚æ•°ã€ç¤ºä¾‹ã€å“åº”å‚æ•°åˆ†å±‚æ¬¡ä¾æ¬¡å±•ç¤º,æ¥å£æ–‡æ¡£ä¸€ç›®äº†ç„¶,æ–¹ä¾¿å¼€å‘è€…å¯¹æ¥</li><li>åœ¨çº¿è°ƒè¯•æ é™¤äº†è‡ªåŠ¨è§£æå‚æ•°å¤–,é’ˆå¯¹å¿…å¡«é¡¹ç€é¢œè‰²åŒºåˆ†,åŒæ—¶æ”¯æŒtabé”®å¿«é€Ÿè¾“å…¥ä¸Šä¸‹åˆ‡æ¢.è°ƒè¯•æ—¶å¯è‡ªå®šä¹‰Content-Typeè¯·æ±‚å¤´ç±»å‹</li><li>ä¸ªæ€§åŒ–é…ç½®é¡¹,æ”¯æŒæ¥å£åœ°å€ã€æ¥å£descriptionå±æ€§ã€UIå¢å¼ºç­‰ä¸ªæ€§åŒ–é…ç½®åŠŸèƒ½</li><li>æ¥å£æ’åº,æ”¯æŒåˆ†ç»„åŠæ¥å£çš„æ’åºåŠŸèƒ½</li><li>æ”¯æŒmarkdownæ–‡æ¡£ç¦»çº¿æ–‡æ¡£å¯¼å‡º,ä¹Ÿå¯åœ¨çº¿æŸ¥çœ‹ç¦»çº¿æ–‡æ¡£</li><li>è°ƒè¯•ä¿¡æ¯å…¨å±€ç¼“å­˜,é¡µé¢åˆ·æ–°åä¾ç„¶å­˜åœ¨,æ–¹ä¾¿å¼€å‘è€…è°ƒè¯•</li><li>ä»¥æ›´äººæ€§åŒ–çš„treetableç»„ä»¶å±•ç¤ºSwagger ModelsåŠŸèƒ½</li><li>å“åº”å†…å®¹å¯å…¨å±æŸ¥çœ‹,é’ˆå¯¹å“åº”å†…å®¹å¾ˆå¤šçš„æƒ…å†µä¸‹ï¼Œå…¨å±æŸ¥çœ‹ï¼Œæ–¹ä¾¿è°ƒè¯•ã€å¤åˆ¶</li><li>æ–‡æ¡£ä»¥å¤štabæ–¹å¼å¯æ˜¾ç¤ºå¤šä¸ªæ¥å£æ–‡æ¡£</li><li>è¯·æ±‚å‚æ•°æ è¯·æ±‚ç±»å‹ã€æ˜¯å¦å¿…å¡«ç€é¢œè‰²åŒºåˆ†</li><li>ä¸»é¡µä¸­ç²—ç•¥ç»Ÿè®¡æ¥å£ä¸åŒç±»å‹æ•°é‡</li><li>æ”¯æŒæ¥å£åœ¨çº¿æœç´¢åŠŸèƒ½</li><li>å·¦å³èœå•å’Œå†…å®¹é¡µå¯è‡ªç”±æ‹–åŠ¨å®½åº¦</li><li>æ”¯æŒè‡ªå®šä¹‰å…¨å±€å‚æ•°åŠŸèƒ½ï¼Œä¸»é¡µåŒ…æ‹¬headeråŠqueryä¸¤ç§ç±»å‹</li><li>i18nå›½é™…åŒ–æ”¯æŒ,ç›®å‰æ”¯æŒï¼šä¸­æ–‡ç®€ä½“ã€ä¸­æ–‡ç¹ä½“ã€è‹±æ–‡</li><li>JSR-303 annotations æ³¨è§£çš„æ”¯æŒ</li></ul></blockquote><h1 id="äºŒã€Spring-bootæ•´åˆSwagger-Bootstrap-UI"><a href="#äºŒã€Spring-bootæ•´åˆSwagger-Bootstrap-UI" class="headerlink" title="äºŒã€Spring-bootæ•´åˆSwagger-Bootstrap-UI"></a>äºŒã€Spring-bootæ•´åˆSwagger-Bootstrap-UI</h1><blockquote><p>ä½¿ç”¨ä¸Šæ¬¡å¤ä¹ Mybatis-Plusæ—¶å»ºç«‹çš„é¡¹ç›®ï¼Œåœ¨è¯¥é¡¹ç›®çš„åŸºç¡€ä¸Šå¯¹Swagger-Bootstrap-uiè¿›è¡Œåˆæ­¥å­¦ä¹ ã€‚</p></blockquote><h2 id="2-1ã€å¼•å…¥ä¾èµ–ã€ç¼–å†™é…ç½®ç±»"><a href="#2-1ã€å¼•å…¥ä¾èµ–ã€ç¼–å†™é…ç½®ç±»" class="headerlink" title="2.1ã€å¼•å…¥ä¾èµ–ã€ç¼–å†™é…ç½®ç±»"></a>2.1ã€å¼•å…¥ä¾èµ–ã€ç¼–å†™é…ç½®ç±»</h2><blockquote><p>å¦‚æœä½¿ç”¨åŸæœ‰çš„swaggerï¼Œé‚£ä¹ˆéœ€è¦å¼•å…¥çš„ä¾èµ–æœ‰</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.7.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.swagger<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-annotations<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.5.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>å¦‚æœä½¿ç”¨swagger-bootstrap-uiï¼Œé‚£ä¹ˆåªéœ€è¦å¼•å…¥ä¸‹é¢ä¸¤ä¸ªä¾èµ–å³å¯</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--swagger--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>io.springfox<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>springfox-swagger2<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.9.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.github.xiaoymin<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>swagger-bootstrap-ui<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.9.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨configåŒ…ä¸‹æ–°å»ºä¸€ä¸ªé…ç½®ç±»</p><p>ä¸æ™®é€šswaggerçš„é…ç½®ç±»ç›¸æ¯”ï¼Œswagger-bootstap-uiçš„é…ç½®ç±»å¤šäº†ä¸€ä¸ª@EnableSwaggerBootstrapUIæ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableSwagger2</span></span><br><span class="line"><span class="meta">@EnableSwaggerBootstrapUI</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SwaggerConfiguration</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Docket <span class="title">webApiConfig</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> Docket(DocumentationType.SWAGGER_2)</span><br><span class="line">                .groupName(<span class="string">&quot;webApi&quot;</span>)</span><br><span class="line">                .apiInfo(webApiInfo())</span><br><span class="line">                .select()</span><br><span class="line">                .paths(Predicates.not(PathSelectors.regex(<span class="string">&quot;/admin/.*&quot;</span>)))</span><br><span class="line">                .paths(Predicates.not(PathSelectors.regex(<span class="string">&quot;/error.*&quot;</span>)))</span><br><span class="line">                .build();</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> ApiInfo <span class="title">webApiInfo</span><span class="params">()</span></span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ApiInfoBuilder()</span><br><span class="line">                .title(<span class="string">&quot;æµ‹è¯•API&quot;</span>)</span><br><span class="line">                .description(<span class="string">&quot;æœ¬æ–‡æ¡£æè¿°äº†è¯¾ç¨‹ä¸­å¿ƒå¾®æœåŠ¡æ¥å£å®šä¹‰&quot;</span>)</span><br><span class="line">                .version(<span class="string">&quot;1.0&quot;</span>)</span><br><span class="line">                .contact(<span class="keyword">new</span> Contact(<span class="string">&quot;è”¡å¤§å¤´&quot;</span>, <span class="string">&quot;http://wuhuqifei.com&quot;</span>, <span class="string">&quot;763882220@qq.com&quot;</span>))</span><br><span class="line">                .build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2ã€ç¼–å†™Controllerå¹¶ä½¿ç”¨æ³¨è§£æ¥æ·»åŠ ä¿¡æ¯"><a href="#2-2ã€ç¼–å†™Controllerå¹¶ä½¿ç”¨æ³¨è§£æ¥æ·»åŠ ä¿¡æ¯" class="headerlink" title="2.2ã€ç¼–å†™Controllerå¹¶ä½¿ç”¨æ³¨è§£æ¥æ·»åŠ ä¿¡æ¯"></a>2.2ã€ç¼–å†™Controllerå¹¶ä½¿ç”¨æ³¨è§£æ¥æ·»åŠ ä¿¡æ¯</h2><h3 id="2-2-1ã€UserController"><a href="#2-2-1ã€UserController" class="headerlink" title="2.2.1ã€UserController"></a>2.2.1ã€UserController</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/user&quot;)</span></span><br><span class="line"><span class="meta">@Api(tags = &quot;ç”¨æˆ·ç®¡ç†æ§åˆ¶å™¨&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UserController</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserService userService;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®ç”¨æˆ·idè·å–ç”¨æˆ·ä¿¡æ¯&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> User <span class="title">getUserById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.getById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PostMapping(&quot;addUser&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ·»åŠ ç”¨æˆ·å¯¹è±¡&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">addUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.save(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@PutMapping(&quot;update&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">updateUser</span><span class="params">(<span class="meta">@RequestBody</span> User user)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.saveOrUpdate(user);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="meta">@ApiOperation(&quot;æ ¹æ®idåˆ é™¤ç”¨æˆ·&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">deleteUser</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span> Long id)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.removeById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@GetMapping(&quot;findAll&quot;)</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> List&lt;User&gt; <span class="title">getAllUser</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> userService.list();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-2-2ã€å¸¸ç”¨æ³¨è§£è¯´æ˜"><a href="#2-2-2ã€å¸¸ç”¨æ³¨è§£è¯´æ˜" class="headerlink" title="2.2.2ã€å¸¸ç”¨æ³¨è§£è¯´æ˜"></a>2.2.2ã€å¸¸ç”¨æ³¨è§£è¯´æ˜</h3><blockquote><p>swaggeråŠswagger-bootstrap-uiçš„å¸¸ç”¨æ³¨è§£æœ‰ä¸¤ä¸ªï¼Œåˆ†åˆ«ä¸º@Apiä¸@ApiOperation</p></blockquote><ul><li>@Api</li></ul><blockquote><p>è¿™ä¸ªæ³¨è§£ç”¨äºControllerç±»ä¸Šï¼Œå¯ä»¥ä½¿ç”¨è¯¥æ³¨è§£çš„tagså±æ€§æ¥ä¸ºæ§åˆ¶å™¨æ·»åŠ å¤‡æ³¨</p></blockquote><ul><li>@ApiOperation</li></ul><blockquote><p>è¿™ä¸ªæ³¨è§£ç”¨äºæ§åˆ¶å™¨çš„æ–¹æ³•ä¸Šï¼Œç”¨äºç»™æ§åˆ¶å™¨çš„å…·ä½“æ–¹æ³•æ·»åŠ æ³¨è§£</p></blockquote><h2 id="2-3ã€ä½¿ç”¨"><a href="#2-3ã€ä½¿ç”¨" class="headerlink" title="2.3ã€ä½¿ç”¨"></a>2.3ã€ä½¿ç”¨</h2><h3 id="2-3-1ã€åœ¨ä¸»å¯åŠ¨ç±»ä¸­æ·»åŠ æ³¨è§£ï¼Œå°†swaggeré…ç½®ç±»çº³å…¥è¢«æ‰«æèŒƒå›´"><a href="#2-3-1ã€åœ¨ä¸»å¯åŠ¨ç±»ä¸­æ·»åŠ æ³¨è§£ï¼Œå°†swaggeré…ç½®ç±»çº³å…¥è¢«æ‰«æèŒƒå›´" class="headerlink" title="2.3.1ã€åœ¨ä¸»å¯åŠ¨ç±»ä¸­æ·»åŠ æ³¨è§£ï¼Œå°†swaggeré…ç½®ç±»çº³å…¥è¢«æ‰«æèŒƒå›´"></a>2.3.1ã€åœ¨ä¸»å¯åŠ¨ç±»ä¸­æ·»åŠ æ³¨è§£ï¼Œå°†swaggeré…ç½®ç±»çº³å…¥è¢«æ‰«æèŒƒå›´</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.hzx.mpblog.mapper&quot;)</span></span><br><span class="line"><span class="meta">@ComponentScan(&quot;com.hzx.mpblog&quot;)</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MpApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MpApplication.class);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost:8848/doc.html&quot;</span>);</span><br><span class="line">        System.out.println(<span class="string">&quot;http://localhost:8848/swagger-ui.html&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨ä¸»å¯åŠ¨ç±»çš„ä¸¤ä¸ªè¾“å‡ºè¯­å¥ä¸­ï¼Œ<a href="http://localhost:8848/doc.html%E6%98%AFswagger-bootstrap-ui%E7%9A%84%E8%AE%BF%E9%97%AE%E5%9C%B0%E5%9D%80%E3%80%82">http://localhost:8848/doc.htmlæ˜¯swagger-bootstrap-uiçš„è®¿é—®åœ°å€ã€‚</a></p><p><a href="http://localhost:8848/swagger-ui.html%E6%98%AFswagger%E7%9A%84%E8%AE%BF%E9%97%AE%E5%9C%B0%E5%9D%80%E3%80%82">http://localhost:8848/swagger-ui.htmlæ˜¯swaggerçš„è®¿é—®åœ°å€ã€‚</a></p></blockquote><h3 id="2-3-2ã€å¯åŠ¨ä¸»å¯åŠ¨ç±»"><a href="#2-3-2ã€å¯åŠ¨ä¸»å¯åŠ¨ç±»" class="headerlink" title="2.3.2ã€å¯åŠ¨ä¸»å¯åŠ¨ç±»"></a>2.3.2ã€å¯åŠ¨ä¸»å¯åŠ¨ç±»</h3><blockquote><p>åˆ†åˆ«è¿›å…¥ä¸¤ä¸ªé“¾æ¥ä¸­æŸ¥çœ‹æ•ˆæœ</p></blockquote><ul><li>swagger</li></ul><blockquote><p>ä¸»é¡µé¢è¯´æ˜</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153717308.png" alt="image-20210129153717308"></p><blockquote><p>ç‚¹å‡»æ–¹æ³•è¿›å…¥æ–¹æ³•è¯´æ˜åŠæµ‹è¯•ç•Œé¢ï¼Œç‚¹å‡»try it out</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153734979.png" alt="image-20210129153734979"></p><blockquote><p>åœ¨å‚æ•°è¾“å…¥æ¡†ä¸­è¾“å…¥å‚æ•°ï¼Œç‚¹å‡»executeæ‰§è¡Œæ–¹æ³•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153751549.png" alt="image-20210129153751549"></p><blockquote><p>æµ‹è¯•ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153803544.png" alt="image-20210129153803544"></p><ul><li>swagger-bootstrap-ui</li></ul><blockquote><p>ä¸»é¡µé¢è¯´æ˜</p><p>swagger-bootstrap-uiå°†æµ‹è¯•é¡µé¢ä¸æ–¹æ³•è¯´æ˜é¡µé¢åˆ†å¼€ï¼Œåœ¨</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153813279.png" alt="image-20210129153813279"></p><blockquote><p>æ–¹æ³•è¯´æ˜</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153821304.png" alt="image-20210129153821304"></p><blockquote><p>æ–¹æ³•æµ‹è¯•</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153830894.png" alt="image-20210129153830894"></p><blockquote><p>æµ‹è¯•ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153838469.png" alt="image-20210129153838469"></p>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Javaåº”ç”¨å­¦ä¹ ï¼ˆä¸€ï¼‰-Mybatis-plusæ¡†æ¶</title>
      <link href="posts/2091692756.html"/>
      <url>posts/2091692756.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h1 id="ä¸€ã€MPç®€ä»‹"><a href="#ä¸€ã€MPç®€ä»‹" class="headerlink" title="ä¸€ã€MPç®€ä»‹"></a>ä¸€ã€MPç®€ä»‹</h1><blockquote><p><a href="https://github.com/baomidou/mybatis-plus">MyBatis-Plus</a>ï¼ˆç®€ç§° MPï¼‰æ˜¯ä¸€ä¸ª <a href="http://www.mybatis.org/mybatis-3/">MyBatis</a> çš„å¢å¼ºå·¥å…·ï¼Œåœ¨ MyBatis çš„åŸºç¡€ä¸Šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œä¸ºç®€åŒ–å¼€å‘ã€æé«˜æ•ˆç‡è€Œç”Ÿã€‚</p></blockquote><h2 id="1-1ã€ç‰¹æ€§"><a href="#1-1ã€ç‰¹æ€§" class="headerlink" title="1.1ã€ç‰¹æ€§"></a>1.1ã€ç‰¹æ€§</h2><ul><li><strong>æ— ä¾µå…¥</strong>ï¼šåªåšå¢å¼ºä¸åšæ”¹å˜ï¼Œå¼•å…¥å®ƒä¸ä¼šå¯¹ç°æœ‰å·¥ç¨‹äº§ç”Ÿå½±å“ï¼Œå¦‚ä¸èˆ¬é¡ºæ»‘</li><li><strong>æŸè€—å°</strong>ï¼šå¯åŠ¨å³ä¼šè‡ªåŠ¨æ³¨å…¥åŸºæœ¬ CURDï¼Œæ€§èƒ½åŸºæœ¬æ— æŸè€—ï¼Œç›´æ¥é¢å‘å¯¹è±¡æ“ä½œ</li><li><strong>å¼ºå¤§çš„ CRUD æ“ä½œ</strong>ï¼šå†…ç½®é€šç”¨ Mapperã€é€šç”¨ Serviceï¼Œä»…ä»…é€šè¿‡å°‘é‡é…ç½®å³å¯å®ç°å•è¡¨å¤§éƒ¨åˆ† CRUD æ“ä½œï¼Œæ›´æœ‰å¼ºå¤§çš„æ¡ä»¶æ„é€ å™¨ï¼Œæ»¡è¶³å„ç±»ä½¿ç”¨éœ€æ±‚</li><li><strong>æ”¯æŒ Lambda å½¢å¼è°ƒç”¨</strong>ï¼šé€šè¿‡ Lambda è¡¨è¾¾å¼ï¼Œæ–¹ä¾¿çš„ç¼–å†™å„ç±»æŸ¥è¯¢æ¡ä»¶ï¼Œæ— éœ€å†æ‹…å¿ƒå­—æ®µå†™é”™</li><li><strong>æ”¯æŒä¸»é”®è‡ªåŠ¨ç”Ÿæˆ</strong>ï¼šæ”¯æŒå¤šè¾¾ 4 ç§ä¸»é”®ç­–ç•¥ï¼ˆå†…å«åˆ†å¸ƒå¼å”¯ä¸€ ID ç”Ÿæˆå™¨ - Sequenceï¼‰ï¼Œå¯è‡ªç”±é…ç½®ï¼Œå®Œç¾è§£å†³ä¸»é”®é—®é¢˜</li><li><strong>æ”¯æŒ ActiveRecord æ¨¡å¼</strong>ï¼šæ”¯æŒ ActiveRecord å½¢å¼è°ƒç”¨ï¼Œå®ä½“ç±»åªéœ€ç»§æ‰¿ Model ç±»å³å¯è¿›è¡Œå¼ºå¤§çš„ CRUD æ“ä½œ</li><li><strong>æ”¯æŒè‡ªå®šä¹‰å…¨å±€é€šç”¨æ“ä½œ</strong>ï¼šæ”¯æŒå…¨å±€é€šç”¨æ–¹æ³•æ³¨å…¥ï¼ˆ Write once, use anywhere ï¼‰</li><li><strong>å†…ç½®ä»£ç ç”Ÿæˆå™¨</strong>ï¼šé‡‡ç”¨ä»£ç æˆ–è€… Maven æ’ä»¶å¯å¿«é€Ÿç”Ÿæˆ Mapper ã€ Model ã€ Service ã€ Controller å±‚ä»£ç ï¼Œæ”¯æŒæ¨¡æ¿å¼•æ“ï¼Œæ›´æœ‰è¶…å¤šè‡ªå®šä¹‰é…ç½®ç­‰æ‚¨æ¥ä½¿ç”¨</li><li><strong>å†…ç½®åˆ†é¡µæ’ä»¶</strong>ï¼šåŸºäº MyBatis ç‰©ç†åˆ†é¡µï¼Œå¼€å‘è€…æ— éœ€å…³å¿ƒå…·ä½“æ“ä½œï¼Œé…ç½®å¥½æ’ä»¶ä¹‹åï¼Œå†™åˆ†é¡µç­‰åŒäºæ™®é€š List æŸ¥è¯¢</li><li><strong>åˆ†é¡µæ’ä»¶æ”¯æŒå¤šç§æ•°æ®åº“</strong>ï¼šæ”¯æŒ MySQLã€MariaDBã€Oracleã€DB2ã€H2ã€HSQLã€SQLiteã€Postgreã€SQLServer ç­‰å¤šç§æ•°æ®åº“</li><li><strong>å†…ç½®æ€§èƒ½åˆ†ææ’ä»¶</strong>ï¼šå¯è¾“å‡º Sql è¯­å¥ä»¥åŠå…¶æ‰§è¡Œæ—¶é—´ï¼Œå»ºè®®å¼€å‘æµ‹è¯•æ—¶å¯ç”¨è¯¥åŠŸèƒ½ï¼Œèƒ½å¿«é€Ÿæªå‡ºæ…¢æŸ¥è¯¢</li><li><strong>å†…ç½®å…¨å±€æ‹¦æˆªæ’ä»¶</strong>ï¼šæä¾›å…¨è¡¨ delete ã€ update æ“ä½œæ™ºèƒ½åˆ†æé˜»æ–­ï¼Œä¹Ÿå¯è‡ªå®šä¹‰æ‹¦æˆªè§„åˆ™ï¼Œé¢„é˜²è¯¯æ“ä½œ</li></ul><h2 id="1-2ã€æ”¯æŒçš„æ•°æ®åº“"><a href="#1-2ã€æ”¯æŒçš„æ•°æ®åº“" class="headerlink" title="1.2ã€æ”¯æŒçš„æ•°æ®åº“"></a>1.2ã€æ”¯æŒçš„æ•°æ®åº“</h2><blockquote><p>ä»»ä½•èƒ½ä½¿ç”¨ mybatis è¿›è¡Œ crud, å¹¶ä¸”æ”¯æŒæ ‡å‡† sql çš„æ•°æ®åº“</p></blockquote><h1 id="äºŒã€å¿«é€Ÿå…¥é—¨"><a href="#äºŒã€å¿«é€Ÿå…¥é—¨" class="headerlink" title="äºŒã€å¿«é€Ÿå…¥é—¨"></a>äºŒã€å¿«é€Ÿå…¥é—¨</h1><blockquote><p>ä½¿ç”¨ä¸€ä¸ªspringbooté¡¹ç›®æ¥ä½“éªŒMPçš„å¼ºå¤§ä¹‹å¤„ã€‚</p></blockquote><h2 id="2-1ã€å»ºç«‹å…¥é—¨é¡¹ç›®çš„æ•°æ®åº“ä¸é¡¹ç›®"><a href="#2-1ã€å»ºç«‹å…¥é—¨é¡¹ç›®çš„æ•°æ®åº“ä¸é¡¹ç›®" class="headerlink" title="2.1ã€å»ºç«‹å…¥é—¨é¡¹ç›®çš„æ•°æ®åº“ä¸é¡¹ç›®"></a>2.1ã€å»ºç«‹å…¥é—¨é¡¹ç›®çš„æ•°æ®åº“ä¸é¡¹ç›®</h2><blockquote><p>å»ºè¡¨</p></blockquote><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">create database mp;</span><br><span class="line">use mp;</span><br><span class="line"></span><br><span class="line">create table user(</span><br><span class="line">    id bigint(20) primary key auto_increment,</span><br><span class="line">    name varchar(50),</span><br><span class="line">    email varchar(50),</span><br><span class="line">    age int</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">insert into</span><br><span class="line">    user(name, email, age)</span><br><span class="line">VALUES</span><br><span class="line">       (&#39;A&#39;,&#39;a@qq.com&#39;,18),</span><br><span class="line">       (&#39;B&#39;,&#39;b@qq.com&#39;,19),</span><br><span class="line">       (&#39;C&#39;,&#39;c@qq.com&#39;,12),</span><br><span class="line">       (&#39;D&#39;,&#39;d@qq.com&#39;,11),</span><br><span class="line">       (&#39;E&#39;,&#39;e@qq.com&#39;,111);</span><br></pre></td></tr></table></figure><blockquote><p>å»ºç«‹spring-booté¡¹ç›®ï¼Œå¼•å…¥ä¾èµ–</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependencies</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-web<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.springframework.boot<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>spring-boot-starter-test<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">scope</span>&gt;</span>test<span class="tag">&lt;/<span class="name">scope</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.1.3.RELEASE<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.projectlombok<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>lombok<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.16.22<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>com.baomidou<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mybatis-plus-boot-starter<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>3.1.0<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>mysql<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>mysql-connector-java<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>8.0.19<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>junit<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">version</span>&gt;</span>4.13<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependencies</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>é¡¹ç›®çš„application.ymlé…ç½®æ–‡ä»¶å¦‚ä¸‹</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">datasource:</span></span><br><span class="line">    <span class="attr">driver-class-name:</span> <span class="string">com.mysql.cj.jdbc.Driver</span></span><br><span class="line">    <span class="attr">url:</span> <span class="string">jdbc:mysql://localhost:3306/mp?useUnicode=true&amp;characterEncoding=utf8&amp;useSSL=false&amp;nullCatalogMeansCurrent=true&amp;serverTimezone=Asia/Shanghai</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">tianxin1230.</span></span><br><span class="line">    <span class="attr">username:</span> <span class="string">root</span></span><br></pre></td></tr></table></figure><blockquote><p>ç¼–å†™ä¸»å¯åŠ¨ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@MapperScan(&quot;com.hzx.mpblog.mapper&quot;)</span></span><br><span class="line"><span class="meta">@SpringBootApplication</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MpApplication</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        SpringApplication.run(MpApplication.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æ ¹æ®æ•°æ®åº“è¡¨å»ºç«‹å¯¹åº”entityå®ä½“ç±»ï¼Œè¿™é‡Œä½¿ç”¨Lombokæ’ä»¶å¹¶å¼€å¯é“¾å¼ç¼–ç¨‹æ¥ç®€åŒ–å¼€å‘</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç¼–å†™UserMapperæ¥å£ï¼Œè¯¥æ¥å£éœ€è¦ç»§æ‰¿BaseMapper&lt; T &gt;ï¼Œå…¶ä¸­Tä¸ºè¦æ“ä½œçš„æ•°æ®åº“è¡¨å¯¹åº”çš„å®ä½“ç±»</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Repository</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">UserMapper</span> <span class="keyword">extends</span> <span class="title">BaseMapper</span>&lt;<span class="title">User</span>&gt; </span>&#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-2ã€ç¼–å†™æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•"><a href="#2-2ã€ç¼–å†™æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•" class="headerlink" title="2.2ã€ç¼–å†™æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•"></a>2.2ã€ç¼–å†™æµ‹è¯•ç±»è¿›è¡Œæµ‹è¯•</h2><blockquote><p>ç¼–å†™æµ‹è¯•ç±»ï¼Œæµ‹è¯•mybatis-plusä¸ºæˆ‘ä»¬æä¾›çš„æŸ¥è¯¢æ‰€æœ‰æ–¹æ³•</p></blockquote><ul><li>åœ¨selectListä¸­ï¼Œå¯ä»¥ä¼ å…¥ä¸€ä¸ªQueryWrapperæŸ¥è¯¢æ¡ä»¶æ„é€ å™¨å¯¹è±¡ï¼Œä½†ç”±äºè¿™é‡Œéœ€è¦æŸ¥è¯¢æ‰€æœ‰å¯¹è±¡ï¼Œæ‰€ä»¥ä¸åŠ æ¡ä»¶ç­›é€‰ï¼Œä¼ å…¥null</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SpringBootTest</span></span><br><span class="line"><span class="meta">@RunWith(SpringRunner.class)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MpApplicationTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> UserMapper userMapper;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testFindAll</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;User&gt; userList = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">        userList.forEach(user -&gt;</span><br><span class="line">            System.out.println(user)</span><br><span class="line">        );</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153047772.png" alt="image-20210129153047772"></p><h2 id="2-3ã€æ·»åŠ é…ç½®è¾“å‡ºsqlè¯­å¥"><a href="#2-3ã€æ·»åŠ é…ç½®è¾“å‡ºsqlè¯­å¥" class="headerlink" title="2.3ã€æ·»åŠ é…ç½®è¾“å‡ºsqlè¯­å¥"></a>2.3ã€æ·»åŠ é…ç½®è¾“å‡ºsqlè¯­å¥</h2><blockquote><p>æˆ‘ä»¬å¯ä»¥åœ¨application.ymlä¸­æ·»åŠ é…ç½®ï¼Œè®©mybatis-plusåœ¨æ‰§è¡Œæ—¶è¾“å‡ºçš„sqlè¯­å¥</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># æ‰“å°sqlè¯­å¥</span></span><br><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">configuration:</span></span><br><span class="line">    <span class="attr">log-impl:</span> <span class="string">org.apache.ibatis.logging.stdout.StdOutImpl</span></span><br></pre></td></tr></table></figure><blockquote><p>é‡æ–°å¯åŠ¨ï¼Œæµ‹è¯•ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153056405.png" alt="image-20210129153056405"></p><h1 id="ä¸‰ã€CRUDæ‰©å±•"><a href="#ä¸‰ã€CRUDæ‰©å±•" class="headerlink" title="ä¸‰ã€CRUDæ‰©å±•"></a>ä¸‰ã€CRUDæ‰©å±•</h1><h2 id="3-1ã€insertæµ‹è¯•æ’å…¥æ•°æ®"><a href="#3-1ã€insertæµ‹è¯•æ’å…¥æ•°æ®" class="headerlink" title="3.1ã€insertæµ‹è¯•æ’å…¥æ•°æ®"></a>3.1ã€insertæµ‹è¯•æ’å…¥æ•°æ®</h2><blockquote><p>ä½¿ç”¨Mybatis-plusè‡ªå¸¦çš„æ’å…¥æ–¹æ³•è¿›è¡Œæµ‹è¯•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setName(<span class="string">&quot;å°æ˜&quot;</span>)</span><br><span class="line">            .setAge(<span class="number">18</span>)</span><br><span class="line">            .setEmail(<span class="string">&quot;xiaoming@qq.com&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.insert(user);</span><br><span class="line">    System.out.println(result == <span class="number">1</span> ? <span class="string">&quot;æ’å…¥æˆåŠŸï¼&quot;</span> : <span class="string">&quot;æ’å…¥å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹testInsert()çš„æ‰§è¡Œç»“æœå¹¶å†æ¬¡å¯åŠ¨testFindAll()æ–¹æ³•</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153116620.png" alt="image-20210129153116620"></p><blockquote><p>åœ¨è¿™æ¬¡æ’å…¥æ“ä½œä¸­ï¼Œæˆ‘ä»¬æ²¡æœ‰æŒ‡å®šæ’å…¥æ•°æ®åº“å¯¹è±¡çš„idï¼Œè¿™ä¸ªå±æ€§æ˜¯Mybatis-plusä¸ºæˆ‘ä»¬ç”Ÿæˆçš„ï¼ŒMybatis-plusæä¾›çš„ä¸»é”®ç”Ÿæˆç­–ç•¥åœ¨æšä¸¾ç±»IdTypeä¸­.</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">enum</span> <span class="title">IdType</span> </span>&#123;</span><br><span class="line">    AUTO(<span class="number">0</span>),</span><br><span class="line">    NONE(<span class="number">1</span>),</span><br><span class="line">    INPUT(<span class="number">2</span>),</span><br><span class="line">    ID_WORKER(<span class="number">3</span>),</span><br><span class="line">    UUID(<span class="number">4</span>),</span><br><span class="line">    ID_WORKER_STR(<span class="number">5</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="3-1-1ã€é›ªèŠ±ç®—æ³•"><a href="#3-1-1ã€é›ªèŠ±ç®—æ³•" class="headerlink" title="3.1.1ã€é›ªèŠ±ç®—æ³•"></a>3.1.1ã€é›ªèŠ±ç®—æ³•</h3><blockquote><ul><li>é›ªèŠ±ç®—æ³•æ˜¯æ¨ç‰¹å¼€æºçš„åˆ†å¸ƒå¼IDç”Ÿæˆç®—æ³•ï¼Œç»“æœæ˜¯ä¸€ä¸ªlongå‹çš„IDã€‚</li><li>æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šä½¿ç”¨41bitä½œä¸ºæ¯«ç§’æ•°ï¼Œ10bitä½œä¸ºåŠå…¶çš„IDï¼ˆ5ä¸ªbitæ˜¯æ•°æ®ä¸­å¿ƒï¼Œ5ä¸ªbitçš„åŠå…¶IDï¼‰ï¼Œ12bitä½œä¸ºæ¯«ç§’çš„æµæ°´å·ï¼ˆæ„å‘³ç€æ¯ä¸ªèŠ‚ç‚¹åœ¨æ¯ç§’å¯ä»¥äº§ç”Ÿ4096ä¸ªIdï¼‰ï¼Œæœ€åè¿˜æœ‰ä¸€ä¸ªç¬¦å·ä½æ°¸è¿œæ˜¯0</li></ul></blockquote><h3 id="3-1-2ã€ä¸»é”®è‡ªå¢"><a href="#3-1-2ã€ä¸»é”®è‡ªå¢" class="headerlink" title="3.1.2ã€ä¸»é”®è‡ªå¢"></a>3.1.2ã€ä¸»é”®è‡ªå¢</h3><blockquote><p>é…ç½®ä¸»é”®è‡ªå¢</p><ul><li>åœ¨å®ä½“ç±»å­—æ®µä¸Šä½¿ç”¨@TableId(type = IdType.AUTO)</li><li>è¦æ±‚æ•°æ®åº“å­—æ®µä¸€å®šæ˜¯è‡ªå¢çš„ï¼Œå¦åˆ™ä¼šæŠ¥é”™</li></ul></blockquote><h3 id="3-1-3ã€å…¶ä½™ä¸»é”®ç±»å‹"><a href="#3-1-3ã€å…¶ä½™ä¸»é”®ç±»å‹" class="headerlink" title="3.1.3ã€å…¶ä½™ä¸»é”®ç±»å‹"></a>3.1.3ã€å…¶ä½™ä¸»é”®ç±»å‹</h3><blockquote><p>AUTO(0)ï¼šè‡ªå¢<br>NONE(1)ï¼šä¸ä½¿ç”¨<br>INPUT(2)ï¼šæ‰‹åŠ¨è¾“å…¥<br>ID_WORKER(3)ï¼šé»˜è®¤å”¯ä¸€å…¨å±€id<br>UUID(4)ï¼šuuid<br>ID_WORKER_STR(5)ï¼šé»˜è®¤å”¯ä¸€å…¨å±€idå­—ç¬¦ä¸²å½¢å¼</p></blockquote><h2 id="3-2ã€updateæ›´æ–°æ“ä½œ"><a href="#3-2ã€updateæ›´æ–°æ“ä½œ" class="headerlink" title="3.2ã€updateæ›´æ–°æ“ä½œ"></a>3.2ã€updateæ›´æ–°æ“ä½œ</h2><blockquote><p>ä½¿ç”¨mybatis-plusæä¾›çš„updateByIdæ–¹æ³•å¯ä»¥å¿«é€Ÿä¿®æ”¹è¡¨ä¸­æ•°æ®ï¼Œæ›´æ–°Idä¸º2Lçš„å¯¹è±¡ä¿¡æ¯</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">2L</span>)</span><br><span class="line">        .setName(<span class="string">&quot;èŠœæ¹–&quot;</span>)</span><br><span class="line">        .setEmail(<span class="string">&quot;wuhu@qq.com&quot;</span>)</span><br><span class="line">        .setAge(<span class="number">18</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.updateById(user);</span><br><span class="line">    System.out.println(result == <span class="number">1</span> ? <span class="string">&quot;ä¿®æ”¹æˆåŠŸï¼&quot;</span> : <span class="string">&quot;ä¿®æ”¹å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æŸ¥çœ‹ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153136022.png" alt="image-20210129153136022"></p><h2 id="3-3ã€Mybatis-plusçš„è‡ªåŠ¨å¡«å……åŠŸèƒ½"><a href="#3-3ã€Mybatis-plusçš„è‡ªåŠ¨å¡«å……åŠŸèƒ½" class="headerlink" title="3.3ã€Mybatis-plusçš„è‡ªåŠ¨å¡«å……åŠŸèƒ½"></a>3.3ã€Mybatis-plusçš„è‡ªåŠ¨å¡«å……åŠŸèƒ½</h2><blockquote><p>åœ¨å®é™…å¼€å‘ä¸­ï¼Œæ•°æ®åº“å¾€å¾€æœ‰create_timeå’Œupdate_timeä¸¤ä¸ªå­—æ®µï¼Œå¯¹äºè¿™ä¸¤ä¸ªå­—æ®µï¼Œæˆ‘ä»¬ä¸å¸Œæœ›æ‰‹åŠ¨å¡«å……ï¼Œè€Œå¸Œæœ›ç¨‹åºæˆ–è€…æ•°æ®åº“è‡ªåŠ¨å¡«å……ï¼Œmpæä¾›äº†è¿™ä¸ªåŠŸèƒ½ã€‚</p><p>åœ¨æ•°æ®åº“ä¸­æ·»åŠ create_timeå’Œupdate_timeä¸¤ä¸ªå±æ€§ï¼Œå¹¶åœ¨å®ä½“ç±»ä¸­æ·»åŠ å¯¹äºå­—æ®µã€‚</p></blockquote><h3 id="3-3-1ã€æ•°æ®åº“çº§åˆ«å¡«å……"><a href="#3-3-1ã€æ•°æ®åº“çº§åˆ«å¡«å……" class="headerlink" title="3.3.1ã€æ•°æ®åº“çº§åˆ«å¡«å……"></a>3.3.1ã€æ•°æ®åº“çº§åˆ«å¡«å……</h3><blockquote><p>åœ¨æ–°å»ºçš„ä¸¤ä¸ªå±æ€§ä¸‹é¢å‹¾é€‰æ ¹æ®æ—¶é—´æˆ³è‡ªåŠ¨æ›´æ–°å³å¯ï¼Œè¿™ç§æ–¹å¼ä¸æ¨èä½¿ç”¨</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153147791.png" alt="image-20210129153147791"></p><h3 id="3-3-2ã€ä»£ç çº§åˆ«è‡ªåŠ¨å¡«å……"><a href="#3-3-2ã€ä»£ç çº§åˆ«è‡ªåŠ¨å¡«å……" class="headerlink" title="3.3.2ã€ä»£ç çº§åˆ«è‡ªåŠ¨å¡«å……"></a>3.3.2ã€ä»£ç çº§åˆ«è‡ªåŠ¨å¡«å……</h3><ul><li>åœ¨å®ä½“ç±»çš„createTimeå’ŒupdateTimeå­—æ®µä¸Šæ·»åŠ æ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@Accessors(chain = true)</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * å­—æ®µæ·»åŠ æ—¶å¡«å……å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT)</span></span><br><span class="line">    <span class="keyword">private</span> Date createTime;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * å­—æ®µæ·»åŠ /æ›´æ–°æ—¶å¡«å……å†…å®¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@TableField(fill = FieldFill.INSERT_UPDATE)</span></span><br><span class="line">    <span class="keyword">private</span> Date updateTime;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç¼–å†™ä¸€ä¸ªå¤„ç†å™¨ç”¨äºå¤„ç†è¿™ä¸¤ä¸ªæ³¨è§£</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Component</span></span><br><span class="line"><span class="meta">@Slf4j</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyMetaObjectHandler</span> <span class="keyword">implements</span> <span class="title">MetaObjectHandler</span> </span>&#123;</span><br><span class="line">    <span class="comment">//æ’å…¥æ—¶çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">insertFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;createTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//æ›´æ–°æ—¶çš„å¡«å……ç­–ç•¥</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">updateFill</span><span class="params">(MetaObject metaObject)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.setFieldValByName(<span class="string">&quot;updateTime&quot;</span>,<span class="keyword">new</span> Date(),metaObject);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>åœ¨ä¸»å¯åŠ¨ç±»ä¸­æ·»åŠ ç»„ä»¶æ‰«ææ³¨è§£</li><li>æµ‹è¯•æ’å…¥ï¼ŒæŸ¥çœ‹æ˜¯å¦è‡ªåŠ¨å¡«å……</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testInsert</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setName(<span class="string">&quot;å°æ˜111&quot;</span>)</span><br><span class="line">            .setAge(<span class="number">18</span>)</span><br><span class="line">            .setEmail(<span class="string">&quot;xiaoming@qq.com&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.insert(user);</span><br><span class="line">    System.out.println(result == <span class="number">1</span> ? <span class="string">&quot;æ’å…¥æˆåŠŸï¼&quot;</span> : <span class="string">&quot;æ’å…¥å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdate</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">2L</span>)</span><br><span class="line">        .setName(<span class="string">&quot;èŠœæ¹–222&quot;</span>)</span><br><span class="line">        .setEmail(<span class="string">&quot;wuhu@qq.com&quot;</span>)</span><br><span class="line">        .setAge(<span class="number">18</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.updateById(user);</span><br><span class="line">    System.out.println(result == <span class="number">1</span> ? <span class="string">&quot;ä¿®æ”¹æˆåŠŸï¼&quot;</span> : <span class="string">&quot;ä¿®æ”¹å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å¯åŠ¨testFindAllæ–¹æ³•æŸ¥çœ‹ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153158628.png" alt="image-20210129153158628"></p><ul><li>è‡ªåŠ¨å¡«å……ä½¿ç”¨æˆåŠŸã€‚</li></ul><h2 id="3-4ã€ä¹è§‚é”å’Œæ‚²è§‚é”"><a href="#3-4ã€ä¹è§‚é”å’Œæ‚²è§‚é”" class="headerlink" title="3.4ã€ä¹è§‚é”å’Œæ‚²è§‚é”"></a>3.4ã€ä¹è§‚é”å’Œæ‚²è§‚é”</h2><blockquote><p>æ‚²è§‚é”ååˆ†æ‚²è§‚ï¼Œä»–æ€»æ˜¯è®¤ä¸ºä¼šå‡ºç°é—®é¢˜ï¼Œæ— è®ºå¹²ä»€ä¹ˆéƒ½ä¼šä¸Šé”ï¼</p><p>è€Œä¹è§‚é”ååˆ†ä¹è§‚ï¼Œä»–æ€»æ˜¯è®¤ä¸ºä¸ä¼šå‡ºç°é—®é¢˜ï¼Œæ— è®ºå¹²ä»€ä¹ˆéƒ½ä¸å»ä¸Šé”ï¼å¦‚æœå‡ºç°äº†é—®é¢˜ï¼Œå†æ¬¡æ›´æ–°å€¼æµ‹è¯•ã€‚</p><p>ä¸‹é¢ä»‹ç»Mybatis-plusä¸­ä¹è§‚é”çš„å®ç°æ–¹æ³•</p></blockquote><h3 id="3-4-1ã€ä¹è§‚é”çš„å®ç°æ–¹å¼"><a href="#3-4-1ã€ä¹è§‚é”çš„å®ç°æ–¹å¼" class="headerlink" title="3.4.1ã€ä¹è§‚é”çš„å®ç°æ–¹å¼"></a>3.4.1ã€ä¹è§‚é”çš„å®ç°æ–¹å¼</h3><blockquote><p>å–å‡ºè®°å½•æ—¶ï¼Œè·å–å½“å‰version</p><p>æ›´æ–°æ—¶å¸¦ä¸Šè¿™ä¸ªversion</p><p>æ‰§è¡Œæ›´æ–°æ—¶ï¼Œset version = newVersion where version = oldVersion</p><p>å¦‚æœversionä¸å¯¹ï¼Œå°±æ›´æ–°å¤±è´¥</p></blockquote><ul><li>ä¾‹å­</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"># ä¹è§‚é”ï¼š</span><br><span class="line"># 1 å…ˆæŸ¥è¯¢ï¼Œè·å¾—ç‰ˆæœ¬å·version &#x3D; 1</span><br><span class="line"># å‡è®¾ç°æœ‰ABä¸¤ä¸ªçº¿ç¨‹åœ¨æ‰§è¡Œè¿™æ¡updateè¯­å¥ï¼Œå½“Aæœªæ‰§è¡Œå®Œæˆæ—¶ï¼ŒBæŠ¢å…ˆå®Œæˆè¿™æ¬¡æ›´æ–°ï¼Œé‚£ä¹ˆæ­¤æ—¶ç”±äºç‰ˆæœ¬å·versionå·²ç»ä¸º2ï¼Œæ‰€ä»¥Açº¿ç¨‹çš„æ›´æ–°å·¥ä½œä¸ä¼šæˆåŠŸï¼Œæ­¤æ—¶å°±ä¿è¯äº†çº¿ç¨‹é—´çš„é€šè®¯å®‰å…¨</span><br><span class="line"></span><br><span class="line">update user set name &#x3D; &quot;èŠœæ¹–&quot;,version &#x3D; version + 1 where id &#x3D; 2 and version &#x3D; 1;</span><br></pre></td></tr></table></figure><blockquote><p>ç»™æ•°æ®åº“è¡¨ä¸­æ·»åŠ ä¸€ä¸ªversionå±æ€§</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153213565.png" alt="image-20210129153213565"></p><blockquote><p>ç»™å®ä½“ç±»ä¸­æ·»åŠ ä¸€ä¸ªversionå­—æ®µï¼ŒåŒæ—¶åœ¨ä¸Šé¢æ·»åŠ ä¸€ä¸ª@Versionæ³¨è§£ï¼Œè¡¨æ˜è¿™æ˜¯ä¸€ä¸ªä¹è§‚é”</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Version</span></span><br><span class="line"><span class="keyword">private</span> Integer version;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨é…ç½®ç±»ä¸­æ³¨å†Œä¹è§‚é”ç»„ä»¶</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="meta">@EnableTransactionManagement</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MyBatisPlusConfig</span>  </span>&#123;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ³¨å†Œä¹è§‚é”æ’ä»¶</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> OptimisticLockerInterceptor <span class="title">optimisticLockerInterceptor</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> OptimisticLockerInterceptor();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-5ã€selectæŸ¥è¯¢æ“ä½œ"><a href="#3-5ã€selectæŸ¥è¯¢æ“ä½œ" class="headerlink" title="3.5ã€selectæŸ¥è¯¢æ“ä½œ"></a>3.5ã€selectæŸ¥è¯¢æ“ä½œ</h2><h3 id="3-5-1ã€æ ¹æ®idæŸ¥è¯¢æ•°æ®"><a href="#3-5-1ã€æ ¹æ®idæŸ¥è¯¢æ•°æ®" class="headerlink" title="3.5.1ã€æ ¹æ®idæŸ¥è¯¢æ•°æ®"></a>3.5.1ã€æ ¹æ®idæŸ¥è¯¢æ•°æ®</h3><blockquote><p>æ ¹æ®ä¼ å…¥çš„ä¸»é”®å€¼æŸ¥è¯¢æ•°æ®</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = userMapper.selectById(<span class="number">1L</span>);</span><br><span class="line">    System.out.println(user);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153228587.png" alt="image-20210129153228587"></p><h3 id="3-5-2ã€æ ¹æ®é›†åˆå¯¹è±¡æŸ¥è¯¢æ•°æ®"><a href="#3-5-2ã€æ ¹æ®é›†åˆå¯¹è±¡æŸ¥è¯¢æ•°æ®" class="headerlink" title="3.5.2ã€æ ¹æ®é›†åˆå¯¹è±¡æŸ¥è¯¢æ•°æ®"></a>3.5.2ã€æ ¹æ®é›†åˆå¯¹è±¡æŸ¥è¯¢æ•°æ®</h3><blockquote><p>ä¼ å…¥ä¸€ä¸ªä¸»é”®é›†åˆï¼Œæ ¹æ®ä¼ å…¥çš„å¤šä¸ªä¸»é”®å€¼æŸ¥è¯¢å¤šæ¡æ•°æ®ï¼Œä½¿ç”¨selectBatchIdsæ–¹æ³•ï¼Œè¯¥æ–¹æ³•å®é™…ä¸Šä½¿ç”¨mysqlä¸­çš„inå…³é”®å­—</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectBatchIds(Arrays.asList(<span class="number">1L</span>, <span class="number">2L</span>, <span class="number">5L</span>));</span><br><span class="line">    users.forEach(user -&gt;</span><br><span class="line">        System.out.println(user)</span><br><span class="line">    );</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153239557.png" alt="image-20210129153239557"></p><h3 id="3-5-3ã€æ ¹æ®Mapå¯¹è±¡æŸ¥è¯¢æ•°æ®"><a href="#3-5-3ã€æ ¹æ®Mapå¯¹è±¡æŸ¥è¯¢æ•°æ®" class="headerlink" title="3.5.3ã€æ ¹æ®Mapå¯¹è±¡æŸ¥è¯¢æ•°æ®"></a>3.5.3ã€æ ¹æ®Mapå¯¹è±¡æŸ¥è¯¢æ•°æ®</h3><blockquote><p>ä¼ å…¥ä¸€ä¸ªmapï¼Œmpå°†ä¼šä»¥é”®ä¸ºå­—æ®µï¼Œå€¼ä¸ºå­—æ®µå€¼è¿›è¡Œæ‹¼æ¥å¹¶æŸ¥è¯¢ï¼Œå¦‚æœmapä¸­æœ‰å¤šä¸ªé”®å€¼å¯¹ï¼Œé‚£ä¹ˆä¼šä»¥andå…³é”®è¯æ‹¼æ¥</p></blockquote><ul><li>å½“mapä¸­åªæœ‰ä¸€ä¸ªé”®å€¼å¯¹æ—¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;id&quot;</span>,<span class="number">1L</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectByMap(map);</span><br><span class="line">    users.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153248616.png" alt="image-20210129153248616"></p><ul><li>å½“mapä¸­åŒ…å«å¤šä¸ªé”®å€¼å¯¹æ—¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testSelectByMaps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap&lt;String, Object&gt;();</span><br><span class="line">    map.put(<span class="string">&quot;id&quot;</span>,<span class="number">2L</span>);</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;èŠœæ¹–222&quot;</span>);</span><br><span class="line">    List&lt;User&gt; users = userMapper.selectByMap(map);</span><br><span class="line">    users.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153259081.png" alt="image-20210129153259081"></p><h3 id="3-5-4ã€åˆ†é¡µæŸ¥è¯¢"><a href="#3-5-4ã€åˆ†é¡µæŸ¥è¯¢" class="headerlink" title="3.5.4ã€åˆ†é¡µæŸ¥è¯¢"></a>3.5.4ã€åˆ†é¡µæŸ¥è¯¢</h3><blockquote><p>ä¸€èˆ¬æ¥è¯´ï¼Œåˆ†é¡µæŸ¥è¯¢çš„å®ç°æœ‰ä»¥ä¸‹å‡ ç§æ–¹å¼</p><ul><li>ä½¿ç”¨limitå…³é”®å­—è¿›è¡Œåˆ†é¡µ</li><li>ä½¿ç”¨PageHelperå’ŒPageInfoç­‰ç¬¬ä¸‰æ–¹æ’ä»¶è¿›è¡Œåˆ†é¡µ</li><li>ä½¿ç”¨Mybatis-plusè‡ªå¸¦çš„åˆ†é¡µæ’ä»¶è¿›è¡Œåˆ†é¡µ</li></ul><p>ä¸‹é¢ä»‹ç»mpçš„åˆ†é¡µæ’ä»¶</p></blockquote><ul><li>åœ¨mybatis-plusé…ç½®ç±»ä¸­é…ç½®æ‹¦æˆªå™¨ç»„ä»¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testPage</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * ç¬¬ä¸€ä¸ªå‚æ•°ï¼šå½“å‰é¡µ</span></span><br><span class="line"><span class="comment">     * ç¬¬äºŒä¸ªå‚æ•°ï¼šæ¯é¡µæ•°æ®æ¡æ•°</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    Page&lt;User&gt; page = <span class="keyword">new</span> Page&lt;&gt;(<span class="number">1</span>,<span class="number">2</span>);</span><br><span class="line">    <span class="comment">//ä½¿ç”¨Mybatis-plusæä¾›çš„selectPageæ–¹æ³•ï¼Œä¼ å…¥åˆ†é¡µå¯¹è±¡page</span></span><br><span class="line">    IPage&lt;User&gt; userIPage = userMapper.selectPage(page, <span class="keyword">null</span>);</span><br><span class="line">    <span class="comment">//å¾—åˆ°çš„Pageå¯¹è±¡ä¸­ï¼Œrecordså±æ€§å°±æ˜¯éœ€è¦çš„é›†åˆï¼Œè¯¥é›†åˆä¸­åŒ…å«äº†æŸ¥è¯¢çš„ç»“æœ</span></span><br><span class="line">    List&lt;User&gt; records = userIPage.getRecords();</span><br><span class="line">    records.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153308347.png" alt="image-20210129153308347"></p><h3 id="3-5-5ã€åˆ†é¡µæ’ä»¶Pageå±æ€§ç®€ä»‹"><a href="#3-5-5ã€åˆ†é¡µæ’ä»¶Pageå±æ€§ç®€ä»‹" class="headerlink" title="3.5.5ã€åˆ†é¡µæ’ä»¶Pageå±æ€§ç®€ä»‹"></a>3.5.5ã€åˆ†é¡µæ’ä»¶Pageå±æ€§ç®€ä»‹</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Page</span>&lt;<span class="title">T</span>&gt; <span class="keyword">implements</span> <span class="title">IPage</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; records;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> total;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> size;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">long</span> current;</span><br><span class="line">    <span class="keyword">private</span> String[] ascs;</span><br><span class="line">    <span class="keyword">private</span> String[] descs;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> optimizeCountSql;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">boolean</span> isSearchCount;</span><br><span class="line">&#125;    </span><br></pre></td></tr></table></figure><blockquote><ul><li>List<T> recordsâ€“ç”¨æ¥å­˜æ”¾æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®</li><li>long totalâ€“è¿”å›è®°å½•çš„æ€»æ•°</li><li>long sizeâ€“æ¯é¡µæ˜¾ç¤ºæ¡æ•°ï¼Œé»˜è®¤ 10</li><li>long currentâ€“å½“å‰é¡µ,é»˜è®¤1</li><li>String[] ascsâ€“å‡åºå­—æ®µé›†åˆ</li><li>String[] descsâ€“é™åºå­—æ®µé›†åˆ</li><li>boolean optimizeCountSqlâ€“è‡ªåŠ¨ä¼˜åŒ–count  sqlï¼Œé»˜è®¤ä¸ºtrue</li><li>boolean isSearchCountâ€“æ˜¯å¦è¿›è¡ŒcountæŸ¥è¯¢ï¼Œé»˜è®¤ä¸ºtrue</li></ul></blockquote><h2 id="3-6ã€deleteåˆ é™¤æ“ä½œ"><a href="#3-6ã€deleteåˆ é™¤æ“ä½œ" class="headerlink" title="3.6ã€deleteåˆ é™¤æ“ä½œ"></a>3.6ã€deleteåˆ é™¤æ“ä½œ</h2><h3 id="3-6-1ã€æ ¹æ®idåˆ é™¤è®°å½•"><a href="#3-6-1ã€æ ¹æ®idåˆ é™¤è®°å½•" class="headerlink" title="3.6.1ã€æ ¹æ®idåˆ é™¤è®°å½•"></a>3.6.1ã€æ ¹æ®idåˆ é™¤è®°å½•</h3><blockquote><p>ä½¿ç”¨mpæä¾›çš„deleteByIdæ–¹æ³•ï¼Œè¿”å›å€¼ä¸ºæ•°æ®åº“è¡¨ä¸­å—å½±å“æ•°æ®æ¡æ•°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteById</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteById(<span class="number">1L</span>);</span><br><span class="line">    System.out.println(result == <span class="number">1</span> ? <span class="string">&quot;åˆ é™¤æˆåŠŸï¼&quot;</span> : <span class="string">&quot;åˆ é™¤å¤±è´¥ï¼&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153320211.png" alt="image-20210129153320211"></p><h3 id="3-6-2ã€é€šè¿‡ä¼ å…¥çš„é›†åˆå¯¹è±¡è¿›è¡Œæ‰¹é‡åˆ é™¤"><a href="#3-6-2ã€é€šè¿‡ä¼ å…¥çš„é›†åˆå¯¹è±¡è¿›è¡Œæ‰¹é‡åˆ é™¤" class="headerlink" title="3.6.2ã€é€šè¿‡ä¼ å…¥çš„é›†åˆå¯¹è±¡è¿›è¡Œæ‰¹é‡åˆ é™¤"></a>3.6.2ã€é€šè¿‡ä¼ å…¥çš„é›†åˆå¯¹è±¡è¿›è¡Œæ‰¹é‡åˆ é™¤</h3><blockquote><p>ä½¿ç”¨mpæä¾›çš„deleteBatchIdsæ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByIds</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteBatchIds(Arrays.asList(<span class="number">2L</span>,<span class="number">3L</span>,<span class="number">1L</span>));</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœï¼šç”±äºæ•°æ®åº“ä¸­idä¸º1Lçš„æ•°æ®ä¸å­˜åœ¨ï¼Œæ‰€ä»¥å½±å“çš„æ•°æ®æ¡æ•°åªæœ‰ä¸¤æ¡ï¼Œä¸æ‰¹é‡æ’å…¥ä¸€æ ·ï¼Œä½¿ç”¨äº†mysqlä¸­çš„Inå…³é”®å­—</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153331310.png" alt="image-20210129153331310"></p><h3 id="3-6-3ã€é€šè¿‡ä¼ å…¥çš„mapè¿›è¡Œåˆ é™¤"><a href="#3-6-3ã€é€šè¿‡ä¼ å…¥çš„mapè¿›è¡Œåˆ é™¤" class="headerlink" title="3.6.3ã€é€šè¿‡ä¼ å…¥çš„mapè¿›è¡Œåˆ é™¤"></a>3.6.3ã€é€šè¿‡ä¼ å…¥çš„mapè¿›è¡Œåˆ é™¤</h3><blockquote><p>ä¸é€šè¿‡mapè¿›è¡ŒæŸ¥è¯¢ç±»ä¼¼ï¼Œå½“æœ‰å¤šä¸ªé”®å€¼å¯¹æ—¶ï¼Œä½¿ç”¨andæ‹¼æ¥</p></blockquote><ul><li>åªæœ‰ä¸€ä¸ªé”®å€¼å¯¹æ—¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByMap</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;E&quot;</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteByMap(map);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153341026.png" alt="image-20210129153341026"></p><ul><li>ä¼ å…¥å¤šä¸ªé”®å€¼å¯¹æ—¶</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testDeleteByMaps</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Map&lt;String, Object&gt; map = <span class="keyword">new</span> HashMap();</span><br><span class="line">    map.put(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å°æ˜&quot;</span>);</span><br><span class="line">    map.put(<span class="string">&quot;age&quot;</span>,<span class="number">18</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteByMap(map);</span><br><span class="line">    System.out.println(result);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153354773.png" alt="image-20210129153354773"></p><h2 id="3-7ã€é…ç½®é€»è¾‘åˆ é™¤"><a href="#3-7ã€é…ç½®é€»è¾‘åˆ é™¤" class="headerlink" title="3.7ã€é…ç½®é€»è¾‘åˆ é™¤"></a>3.7ã€é…ç½®é€»è¾‘åˆ é™¤</h2><blockquote><p>é€»è¾‘åˆ é™¤ï¼šåœ¨æ•°æ®åº“ä¸­æ²¡æœ‰è¢«ç§»é™¤ï¼Œåªæ˜¯ä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥ä½¿è¿™ä¸€æ¡è®°å½•å¤±æ•ˆ</p><p>ç‰©ç†åˆ é™¤ï¼šä»æ•°æ®åº“ä¸­ç›´æ¥ç§»é™¤</p><p>ç®¡ç†å‘˜å¯ä»¥æŸ¥çœ‹è¢«åˆ é™¤çš„è®°å½•ï¼Œç±»ä¼¼äºå›æ”¶ç«™</p></blockquote><h3 id="3-7-1ã€é…ç½®æ­¥éª¤"><a href="#3-7-1ã€é…ç½®æ­¥éª¤" class="headerlink" title="3.7.1ã€é…ç½®æ­¥éª¤"></a>3.7.1ã€é…ç½®æ­¥éª¤</h3><blockquote><p>åœ¨è¡¨ä¸­æ·»åŠ ä¸€ä¸ªdeletedå­—æ®µï¼Œ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153422780.png" alt="image-20210129153422780"></p><blockquote><p>åœ¨å®ä½“ç±»ä¸­æ·»åŠ ä¸€ä¸ªdeletedå­—æ®µï¼Œå¹¶æ·»åŠ æ³¨è§£</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * é€»è¾‘åˆ é™¤å­—æ®µ</span></span><br><span class="line"><span class="comment"> * æ·»åŠ ä¸€ä¸ªé€»è¾‘åˆ é™¤æ³¨è§£</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@TableLogic</span></span><br><span class="line"><span class="keyword">private</span> Integer deleted;</span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®é€»è¾‘åˆ é™¤ç»„ä»¶</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//é…ç½®é€»è¾‘åˆ é™¤ç»„ä»¶</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> ISqlInjector <span class="title">sqlInjector</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> LogicSqlInjector();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åœ¨application.ymlæ–‡ä»¶ä¸­é…ç½®</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">mybatis-plus:</span></span><br><span class="line">  <span class="attr">global-config:</span></span><br><span class="line">    <span class="attr">db-config:</span></span><br><span class="line">      <span class="attr">logic-delete-value:</span> <span class="number">1</span></span><br><span class="line">      <span class="attr">logic-not-delete-value:</span> <span class="number">0</span></span><br></pre></td></tr></table></figure><ul><li>å½“deletedå€¼ä¸º1æ—¶ï¼Œè¯æ˜è¯¥æ•°æ®è¢«é€»è¾‘åˆ é™¤</li><li>å½“deletedå€¼ä¸º0æ—¶ï¼Œè¯æ˜è¯¥æ•°æ®æ²¡æœ‰è¢«é€»è¾‘åˆ é™¤</li></ul><h3 id="3-7-2ã€æµ‹è¯•é€»è¾‘åˆ é™¤"><a href="#3-7-2ã€æµ‹è¯•é€»è¾‘åˆ é™¤" class="headerlink" title="3.7.2ã€æµ‹è¯•é€»è¾‘åˆ é™¤"></a>3.7.2ã€æµ‹è¯•é€»è¾‘åˆ é™¤</h3><blockquote><p>å…ˆåœ¨æ•°æ®åº“ä¸­æ–°æ’å…¥å‡ æ¡æ•°æ®ï¼Œä»¥ä¾¿åé¢çš„æµ‹è¯•</p></blockquote><ul><li>é€»è¾‘åˆ é™¤idä¸º3Lçš„æ•°æ®</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testLoginDeleted</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.deleteById(<span class="number">3L</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœï¼šä½¿ç”¨äº†updateè¯­å¥</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153433435.png" alt="image-20210129153433435"></p><h1 id="å››ã€æ€§èƒ½åˆ†ææ’ä»¶"><a href="#å››ã€æ€§èƒ½åˆ†ææ’ä»¶" class="headerlink" title="å››ã€æ€§èƒ½åˆ†ææ’ä»¶"></a>å››ã€æ€§èƒ½åˆ†ææ’ä»¶</h1><blockquote><p>æˆ‘ä»¬åœ¨å¹³æ—¶å¼€å‘ä¸­ï¼Œä¼šé‡åˆ°ä¸€äº›æ…¢sqlï¼Œmpæä¾›äº†ä¸€ä¸ªæ€§èƒ½åˆ†ææ’ä»¶ï¼Œå¦‚æœè¶…è¿‡æŒ‡å®šæ—¶é—´ï¼Œå°±åœæ­¢è¿è¡Œ</p></blockquote><h2 id="4-1ã€ä½œç”¨"><a href="#4-1ã€ä½œç”¨" class="headerlink" title="4.1ã€ä½œç”¨"></a>4.1ã€ä½œç”¨</h2><blockquote><p>æ€§èƒ½åˆ†ææ‹¦æˆªå™¨ï¼Œç”¨äºè¾“å‡ºæ¯æ¡sqlè¯­å¥åŠå…¶æ‰§è¡Œæ—¶é—´</p></blockquote><h2 id="4-2ã€ä½¿ç”¨"><a href="#4-2ã€ä½¿ç”¨" class="headerlink" title="4.2ã€ä½¿ç”¨"></a>4.2ã€ä½¿ç”¨</h2><blockquote><p>åœ¨application.ymlä¸­é…ç½®å¼€å‘ç¯å¢ƒï¼Œå°†å½“å‰ç¯å¢ƒè®¾ç½®ä¸ºdev</p></blockquote><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">spring:</span></span><br><span class="line">  <span class="attr">profiles:</span></span><br><span class="line">    <span class="attr">active:</span> <span class="string">dev</span></span><br></pre></td></tr></table></figure><blockquote><p>åœ¨é…ç½®ç±»ä¸­é…ç½®sqlæ‰§è¡Œæ•ˆç‡åˆ†ææ’ä»¶</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * sqlæ‰§è¡Œæ•ˆç‡åˆ†ææ’ä»¶</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@Profile</span>(&#123;&quot;dev&quot;,&quot;test&quot;&#125;)è¡¨ç¤ºæ­¤æ’ä»¶åªåœ¨ç”Ÿäº§å’Œæµ‹è¯•ç¯å¢ƒä¸‹ä½¿ç”¨</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Bean</span></span><br><span class="line"><span class="meta">@Profile(&#123;&quot;dev&quot;,&quot;test&quot;&#125;)</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> PerformanceInterceptor <span class="title">performanceInterceptor</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    PerformanceInterceptor performanceInterceptor = <span class="keyword">new</span> PerformanceInterceptor();</span><br><span class="line">    <span class="comment">//è®¾ç½®sqlæ‰§è¡Œçš„æœ€å¤§æ—¶é—´ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ—¶é—´å°±ä¸æ‰§è¡Œ</span></span><br><span class="line">    performanceInterceptor.setMaxTime(<span class="number">1</span>);</span><br><span class="line">    <span class="comment">//è®¾ç½®æ ¼å¼åŒ–SQLè¯­å¥ï¼ˆç¾åŒ–ï¼‰</span></span><br><span class="line">    performanceInterceptor.setFormat(<span class="keyword">true</span>);</span><br><span class="line">    <span class="keyword">return</span> performanceInterceptor;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="4-3ã€æµ‹è¯•"><a href="#4-3ã€æµ‹è¯•" class="headerlink" title="4.3ã€æµ‹è¯•"></a>4.3ã€æµ‹è¯•</h2><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testUpdateAndSelect</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    User user = <span class="keyword">new</span> User();</span><br><span class="line">    user.setId(<span class="number">1L</span>);</span><br><span class="line">    user.setName(<span class="string">&quot;èŠœæ¹–&quot;</span>);</span><br><span class="line">    user.setEmail(<span class="string">&quot;wuhu@qq.com&quot;</span>);</span><br><span class="line">    user.setAge(<span class="number">1222</span>);</span><br><span class="line">    <span class="keyword">int</span> result = userMapper.updateById(user);</span><br><span class="line"></span><br><span class="line">    System.out.println(result);</span><br><span class="line">    List&lt;User&gt; userList = userMapper.selectList(<span class="keyword">null</span>);</span><br><span class="line">    userList.forEach(System.out :: println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœâ€“æŠ¥å‘Šè¯¥sqlè¶…æ—¶</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153444986.png" alt="image-20210129153444986"></p><blockquote><p>å°†æœ€å¤§æ—¶é—´è®¾ç½®ä¸º100msï¼Œå†æ¬¡æµ‹è¯•ï¼Œä¿®æ”¹       performanceInterceptor.setMaxTime(100);</p></blockquote><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153458241.png" alt="image-20210129153458241"></p><h1 id="äº”ã€æ¡ä»¶æ„é€ å™¨Wrapper"><a href="#äº”ã€æ¡ä»¶æ„é€ å™¨Wrapper" class="headerlink" title="äº”ã€æ¡ä»¶æ„é€ å™¨Wrapper"></a>äº”ã€æ¡ä»¶æ„é€ å™¨Wrapper</h1><blockquote><p>Wrapperæ˜¯ä¸€ä¸ªæ¥å£ï¼Œæˆ‘ä»¬ä½¿ç”¨Wrapperçš„å®ç°ç±»ï¼šQueryWrapperæ¥å®ç°æ¡ä»¶æ„é€ </p></blockquote><h2 id="5-1ã€QueryWrapperçš„ä¸€äº›æ–¹æ³•"><a href="#5-1ã€QueryWrapperçš„ä¸€äº›æ–¹æ³•" class="headerlink" title="5.1ã€QueryWrapperçš„ä¸€äº›æ–¹æ³•"></a>5.1ã€QueryWrapperçš„ä¸€äº›æ–¹æ³•</h2><h3 id="5-1-1ã€isNotNull-â€œåˆ—åâ€"><a href="#5-1-1ã€isNotNull-â€œåˆ—åâ€" class="headerlink" title="5.1.1ã€isNotNull(â€œåˆ—åâ€)"></a>5.1.1ã€isNotNull(â€œåˆ—åâ€)</h3><blockquote><p>è¿™ä¸ªå­—æ®µçš„å€¼ä¸ä¸ºç©º</p></blockquote><h3 id="5-1-2ã€ge-eq-ne-le-gt-lt-â€œåˆ—åâ€-å€¼"><a href="#5-1-2ã€ge-eq-ne-le-gt-lt-â€œåˆ—åâ€-å€¼" class="headerlink" title="5.1.2ã€ge/eq/ne/le/gt/lt(â€œåˆ—åâ€,å€¼)"></a>5.1.2ã€ge/eq/ne/le/gt/lt(â€œåˆ—åâ€,å€¼)</h3><blockquote><p>è¿™ä¸ªå­—æ®µçš„å€¼å¿…é¡»å¤§äºç­‰äº/ç­‰äº/ä¸ç­‰äº/å°äºç­‰äº/ä¸¥æ ¼å¤§äº/ä¸¥æ ¼å°äºä¼ å…¥çš„å€¼</p></blockquote><h3 id="5-1-3ã€between-â€œåˆ—åâ€-å·¦è¾¹å€¼-å³è¾¹å€¼"><a href="#5-1-3ã€between-â€œåˆ—åâ€-å·¦è¾¹å€¼-å³è¾¹å€¼" class="headerlink" title="5.1.3ã€between(â€œåˆ—åâ€,å·¦è¾¹å€¼,å³è¾¹å€¼)"></a>5.1.3ã€between(â€œåˆ—åâ€,å·¦è¾¹å€¼,å³è¾¹å€¼)</h3><blockquote><p>è¿™ä¸ªå±æ€§çš„å€¼å¿…é¡»åœ¨å·¦è¾¹å€¼å’Œå³è¾¹å€¼ä¹‹é—´</p></blockquote><h3 id="5-1-4ã€notLike-â€œåˆ—åâ€-å€¼"><a href="#5-1-4ã€notLike-â€œåˆ—åâ€-å€¼" class="headerlink" title="5.1.4ã€notLike(â€œåˆ—åâ€,å€¼)"></a>5.1.4ã€notLike(â€œåˆ—åâ€,å€¼)</h3><blockquote><p>å­—æ®µå€¼ not like â€œ%å€¼%â€</p></blockquote><h3 id="5-1-5ã€likeLeft-likeRight-â€œåˆ—åâ€-å€¼"><a href="#5-1-5ã€likeLeft-likeRight-â€œåˆ—åâ€-å€¼" class="headerlink" title="5.1.5ã€likeLeft/likeRight(â€œåˆ—åâ€,å€¼)"></a>5.1.5ã€likeLeft/likeRight(â€œåˆ—åâ€,å€¼)</h3><blockquote><p>å­—æ®µ like â€œ%å€¼â€/â€œå€¼%â€</p></blockquote><h3 id="5-1-6ã€in-notIn-â€œåˆ—åâ€-Object-â€¦values"><a href="#5-1-6ã€in-notIn-â€œåˆ—åâ€-Object-â€¦values" class="headerlink" title="5.1.6ã€in/notIn(â€œåˆ—åâ€,Object â€¦values)"></a>5.1.6ã€in/notIn(â€œåˆ—åâ€,Object â€¦values)</h3><blockquote><p>å­—æ®µ  in/notIn(v0,v1â€¦vn)</p></blockquote><h3 id="5-1-7ã€inSql-noInSql-â€œåˆ—åâ€-sqlè¯­å¥"><a href="#5-1-7ã€inSql-noInSql-â€œåˆ—åâ€-sqlè¯­å¥" class="headerlink" title="5.1.7ã€inSql/noInSql(â€œåˆ—åâ€,sqlè¯­å¥)"></a>5.1.7ã€inSql/noInSql(â€œåˆ—åâ€,sqlè¯­å¥)</h3><blockquote><p>å­—æ®µ in/notIn (sqlè¯­å¥)ï¼Œä¾‹å¦‚ inSql/notInSql(â€œidâ€,select * from user where id &lt; 3)</p><p>ç­‰ä»·äºid in/notIn (select * from user where id &lt; 3)</p></blockquote><h3 id="5-1-8ã€åˆ†ç»„æ’åº"><a href="#5-1-8ã€åˆ†ç»„æ’åº" class="headerlink" title="5.1.8ã€åˆ†ç»„æ’åº"></a>5.1.8ã€åˆ†ç»„æ’åº</h3><blockquote><ul><li>groupBy(Râ€¦ columns); // ç­‰ä»·äº GROUP BY å­—æ®µ, â€¦ï¼Œ ä¾‹: groupBy(â€œidâ€, â€œnameâ€) â€”&gt; group by id,name</li><li>orderByAsc(Râ€¦ columns); // ç­‰ä»·äº ORDER BY å­—æ®µ, â€¦ ASCï¼Œ ä¾‹: orderByAsc(â€œidâ€, â€œnameâ€) â€”&gt; order by id ASC,name ASC</li><li>orderByDesc(Râ€¦ columns); // ç­‰ä»·äº ORDER BY å­—æ®µ, â€¦ DESCï¼Œ ä¾‹: orderByDesc(â€œidâ€, â€œnameâ€) â€”&gt; order by id DESC,name DESC</li><li>having(String sqlHaving, Objectâ€¦ params); // ç­‰ä»·äº HAVING ( sqlè¯­å¥ )ï¼Œ ä¾‹: having(â€œsum(age) &gt; {0}â€, 11) â€”&gt; having sum(age) &gt; 11</li></ul></blockquote><h2 id="5-2ã€æŸ¥è¯¢ç¤ºä¾‹"><a href="#5-2ã€æŸ¥è¯¢ç¤ºä¾‹" class="headerlink" title="5.2ã€æŸ¥è¯¢ç¤ºä¾‹"></a>5.2ã€æŸ¥è¯¢ç¤ºä¾‹</h2><blockquote><p>æŸ¥è¯¢nameã€emailä¸ä¸ºç©ºï¼Œä¸”å¹´é¾„å¤§äºç­‰äº12å²çš„ç”¨æˆ·(.isNotNull()ã€.ge())</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢nameã€emailä¸ä¸ºç©ºï¼Œä¸”å¹´é¾„å¤§äºç­‰äº12å²çš„ç”¨æˆ·(.isNotNull()ã€.ge())</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuestion01</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    wrapper.isNotNull(<span class="string">&quot;email&quot;</span>);</span><br><span class="line">    wrapper.isNotNull(<span class="string">&quot;name&quot;</span>);</span><br><span class="line">    wrapper.ge(<span class="string">&quot;age&quot;</span>,<span class="number">12</span>);</span><br><span class="line">    List users = userMapper.selectList(wrapper);</span><br><span class="line">    users.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li><p>ç»“æœ</p></li><li><p>sqlè¯­å¥ä¸ºï¼š</p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#x3D;&#x3D;&gt;  Preparing: SELECT id,name,age,email,create_time,update_time,version,deleted FROM user WHERE deleted&#x3D;0 AND email IS NOT NULL AND name IS NOT NULL AND age &gt;&#x3D; ? </span><br><span class="line">&#x3D;&#x3D;&gt; Parameters: 12(Integer)</span><br></pre></td></tr></table></figure><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153512076.png" alt="image-20210129153512076"></p><blockquote><p>æŸ¥è¯¢nameå±æ€§ç­‰äºâ€å°æ˜â€çš„ç”¨æˆ·</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢nameå±æ€§ç­‰äº&quot;å°æ˜&quot;çš„ç”¨æˆ·</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuestion02</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    wrapper.eq(<span class="string">&quot;name&quot;</span>,<span class="string">&quot;å°æ˜&quot;</span>);</span><br><span class="line">    List users = userMapper.selectList(wrapper);</span><br><span class="line">    users.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153519861.png" alt="image-20210129153519861"></p><blockquote><p>æŸ¥è¯¢å¹´é¾„åœ¨10-30ä¹‹é—´çš„<strong>ç”¨æˆ·ä¸ªæ•°</strong></p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢å¹´é¾„åœ¨10-30ä¹‹é—´çš„ç”¨æˆ·ä¸ªæ•°</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuestion03</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    wrapper.between(<span class="string">&quot;age&quot;</span>,<span class="number">10</span>,<span class="number">30</span>);</span><br><span class="line">    <span class="keyword">int</span> count = userMapper.selectCount(wrapper);</span><br><span class="line">    System.out.println(count);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153527524.png" alt="image-20210129153527524"></p><blockquote><p>æŸ¥è¯¢idå°äºç­‰äº4ä¸”æ²¡è¢«é€»è¾‘åˆ é™¤çš„ç”¨æˆ·</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢idå°äºç­‰äº4ä¸”æ²¡è¢«é€»è¾‘åˆ é™¤çš„ç”¨æˆ·</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuestion04</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    String inSql = <span class="string">&quot;select id from user where id &lt;= 4&quot;</span>;</span><br><span class="line">    wrapper.inSql(<span class="string">&quot;id&quot;</span>,inSql);</span><br><span class="line">    List users = userMapper.selectList(wrapper);</span><br><span class="line">    users.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>sqlè¯­å¥ä¸ºï¼š</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT id,name,age,email,create_time,update_time,version,deleted FROM user WHERE deleted&#x3D;0 AND id IN (select id from user where id &lt;&#x3D; 4)</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153535669.png" alt="image-20210129153535669"></p><blockquote><p>é€šè¿‡idè¿›è¡Œé™åºæ’åº</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æŸ¥è¯¢æ‰€æœ‰ç”¨æˆ·ï¼Œå¹¶æ ¹æ®idè¿›è¡Œé™åºæ’åº</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">testQuestion05</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    QueryWrapper wrapper = <span class="keyword">new</span> QueryWrapper();</span><br><span class="line">    wrapper.orderByDesc(<span class="string">&quot;id&quot;</span>);</span><br><span class="line">    List users = userMapper.selectList(wrapper);</span><br><span class="line">    users.forEach(user -&gt; System.out.println(user));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153544738.png" alt="image-20210129153544738"></p><h1 id="å…­ã€ä»£ç ç”Ÿæˆå™¨"><a href="#å…­ã€ä»£ç ç”Ÿæˆå™¨" class="headerlink" title="å…­ã€ä»£ç ç”Ÿæˆå™¨"></a>å…­ã€ä»£ç ç”Ÿæˆå™¨</h1><h2 id="6-1ã€ä»‹ç»"><a href="#6-1ã€ä»‹ç»" class="headerlink" title="6.1ã€ä»‹ç»"></a>6.1ã€ä»‹ç»</h2><blockquote><p>AutoGenerator æ˜¯ MyBatis-Plus çš„ä»£ç ç”Ÿæˆå™¨ï¼Œé€šè¿‡ AutoGenerator å¯ä»¥å¿«é€Ÿç”Ÿæˆ Entityã€Mapperã€Mapper XMLã€Serviceã€Controller ç­‰å„ä¸ªæ¨¡å—çš„ä»£ç ï¼Œæå¤§çš„æå‡äº†å¼€å‘æ•ˆç‡ã€‚</p></blockquote><h2 id="6-2ã€ä½¿ç”¨"><a href="#6-2ã€ä½¿ç”¨" class="headerlink" title="6.2ã€ä½¿ç”¨"></a>6.2ã€ä½¿ç”¨</h2><h3 id="6-2-1ã€å¼•å…¥ä¾èµ–"><a href="#6-2-1ã€å¼•å…¥ä¾èµ–" class="headerlink" title="6.2.1ã€å¼•å…¥ä¾èµ–"></a>6.2.1ã€å¼•å…¥ä¾èµ–</h3><blockquote><p>ä»£ç ç”Ÿæˆå™¨éœ€è¦ä½¿ç”¨æ¨¡æ¿å¼•æ“ï¼Œè¿™é‡Œä½¿ç”¨velocityæ¨¡æ¿å¼•æ“</p></blockquote><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">dependency</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.velocity<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>velocity-engine-core<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.2<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">dependency</span>&gt;</span></span><br></pre></td></tr></table></figure><blockquote><p>é…ç½®éœ€è¦ç”Ÿæˆå¯¹äºåå°çš„æ•°æ®åº“ï¼Œè¿™é‡Œä»¥leyou_shopæ•°æ®åº“çš„userè¡¨ä¸ºä¾‹ï¼Œç”Ÿæˆåå°ä»£ç </p></blockquote><h3 id="6-2-2ã€ç¼–å†™ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨CodeAutoCreatorç±»"><a href="#6-2-2ã€ç¼–å†™ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨CodeAutoCreatorç±»" class="headerlink" title="6.2.2ã€ç¼–å†™ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨CodeAutoCreatorç±»"></a>6.2.2ã€ç¼–å†™ä»£ç è‡ªåŠ¨ç”Ÿæˆå™¨CodeAutoCreatorç±»</h3><blockquote><p>è¿™é‡Œä»¥leyou_shopåº“çš„spuè¡¨ä¸ºä¾‹</p></blockquote><ul><li>è¡¨ç»“æ„å¦‚ä¸‹</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153552969.png" alt="image-20210129153552969"></p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.DbType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.annotation.IdType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.AutoGenerator;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.DataSourceConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.GlobalConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.PackageConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.StrategyConfig;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.DateType;</span><br><span class="line"><span class="keyword">import</span> com.baomidou.mybatisplus.generator.config.rules.NamingStrategy;</span><br><span class="line"><span class="keyword">import</span> org.junit.Test;</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@author</span> è”¡å¤§å¤´</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@title</span>: CodeAutoGenerator</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@projectName</span> mybatis-plus-blog</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span>: TODO</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@date</span> 2020/12/1016:47</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">CodeAutoGenerator</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">generator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 1ã€åˆ›å»ºä»£ç ç”Ÿæˆå™¨</span></span><br><span class="line">        AutoGenerator mpg = <span class="keyword">new</span> AutoGenerator();</span><br><span class="line">        <span class="comment">// 2ã€å…¨å±€é…ç½®</span></span><br><span class="line">        GlobalConfig gc = <span class="keyword">new</span> GlobalConfig();</span><br><span class="line">        String projectPath = System.getProperty(<span class="string">&quot;user.dir&quot;</span>);</span><br><span class="line">        gc.setOutputDir(<span class="string">&quot;E:\\java\\blog\\src\\main\\java&quot;</span>);</span><br><span class="line">        gc.setAuthor(<span class="string">&quot;è”¡å¤§å¤´&quot;</span>);</span><br><span class="line">        gc.setOpen(<span class="keyword">false</span>); <span class="comment">//ç”Ÿæˆåæ˜¯å¦æ‰“å¼€èµ„æºç®¡ç†å™¨</span></span><br><span class="line">        gc.setFileOverride(<span class="keyword">false</span>); <span class="comment">//é‡æ–°ç”Ÿæˆæ—¶æ–‡ä»¶æ˜¯å¦è¦†ç›–</span></span><br><span class="line">        gc.setServiceName(<span class="string">&quot;%sService&quot;</span>);<span class="comment">//å»æ‰Serviceæ¥å£çš„é¦–å­—æ¯I</span></span><br><span class="line">        gc.setIdType(IdType.AUTO); <span class="comment">//ä¸»é”®ç­–ç•¥</span></span><br><span class="line">        gc.setDateType(DateType.ONLY_DATE);<span class="comment">//å®šä¹‰ç”Ÿæˆçš„å®ä½“ç±»ä¸­æ—¥æœŸç±»å‹</span></span><br><span class="line">        gc.setSwagger2(<span class="keyword">true</span>);<span class="comment">//å¼€å¯Swagger2æ¨¡å¼</span></span><br><span class="line"></span><br><span class="line">        mpg.setGlobalConfig(gc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 3ã€æ•°æ®æºé…ç½®</span></span><br><span class="line">        DataSourceConfig dsc = <span class="keyword">new</span> DataSourceConfig();</span><br><span class="line">        dsc.setUrl(<span class="string">&quot;jdbc:mysql://localhost:3306/leyou_shop?serverTimezone=UTC&quot;</span>);</span><br><span class="line">        dsc.setDriverName(<span class="string">&quot;com.mysql.cj.jdbc.Driver&quot;</span>);</span><br><span class="line">        dsc.setUsername(<span class="string">&quot;root&quot;</span>);</span><br><span class="line">        dsc.setPassword(<span class="string">&quot;tianxin1230.&quot;</span>);</span><br><span class="line">        dsc.setDbType(DbType.MYSQL);</span><br><span class="line">        mpg.setDataSource(dsc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 4ã€åŒ…é…ç½®</span></span><br><span class="line">        PackageConfig pc = <span class="keyword">new</span> PackageConfig();</span><br><span class="line">        pc.setParent(<span class="string">&quot;com.hzx&quot;</span>);</span><br><span class="line">        pc.setModuleName(<span class="string">&quot;mpblog&quot;</span>); <span class="comment">//æ¨¡å—å</span></span><br><span class="line">        pc.setController(<span class="string">&quot;controller&quot;</span>);</span><br><span class="line">        pc.setEntity(<span class="string">&quot;entity&quot;</span>);</span><br><span class="line">        pc.setService(<span class="string">&quot;service&quot;</span>);</span><br><span class="line">        pc.setMapper(<span class="string">&quot;mapper&quot;</span>);</span><br><span class="line">        mpg.setPackageInfo(pc);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// 5ã€ç­–ç•¥é…ç½®</span></span><br><span class="line">        StrategyConfig strategy = <span class="keyword">new</span> StrategyConfig();</span><br><span class="line">        strategy.setInclude(<span class="string">&quot;spu&quot;</span>);</span><br><span class="line">        strategy.setNaming(NamingStrategy.underline_to_camel);<span class="comment">//æ•°æ®åº“è¡¨æ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥</span></span><br><span class="line">        strategy.setTablePrefix(pc.getModuleName() + <span class="string">&quot;_&quot;</span>); <span class="comment">//ç”Ÿæˆå®ä½“æ—¶å»æ‰è¡¨å‰ç¼€</span></span><br><span class="line"></span><br><span class="line">        strategy.setColumnNaming(NamingStrategy.underline_to_camel);<span class="comment">//æ•°æ®åº“è¡¨å­—æ®µæ˜ å°„åˆ°å®ä½“çš„å‘½åç­–ç•¥</span></span><br><span class="line">        strategy.setEntityLombokModel(<span class="keyword">true</span>); <span class="comment">// lombok æ¨¡å‹ @Accessors(chain = true) setteré“¾å¼æ“ä½œ</span></span><br><span class="line"></span><br><span class="line">        strategy.setRestControllerStyle(<span class="keyword">true</span>); <span class="comment">//restful apié£æ ¼æ§åˆ¶å™¨</span></span><br><span class="line">        strategy.setControllerMappingHyphenStyle(<span class="keyword">true</span>); <span class="comment">//urlä¸­é©¼å³°è½¬è¿å­—ç¬¦</span></span><br><span class="line"></span><br><span class="line">        mpg.setStrategy(strategy);</span><br><span class="line">        <span class="comment">// 6ã€æ‰§è¡Œ</span></span><br><span class="line">        mpg.execute();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="6-3ã€æµ‹è¯•åŠè¯´æ˜"><a href="#6-3ã€æµ‹è¯•åŠè¯´æ˜" class="headerlink" title="6.3ã€æµ‹è¯•åŠè¯´æ˜"></a>6.3ã€æµ‹è¯•åŠè¯´æ˜</h2><blockquote><p>ç”Ÿæˆè·¯å¾„ã€ä¸»é”®ç­–ç•¥</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153604973.png" alt="image-20210129153604973"></p><blockquote><p>è®¾ç½®åŒ…åå’Œæ¨¡å—å</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153612043.png" alt="image-20210129153612043"></p><blockquote><p>è®¾ç½®è¦ç”Ÿæˆçš„è¡¨</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153620219.png" alt="image-20210129153620219"></p><blockquote><p>å¯åŠ¨ç¨‹åºï¼ŒæŸ¥çœ‹ç»“æœ</p></blockquote><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153637898.png" alt="image-20210129153637898"></p><blockquote><p>Mybatis-plusåªå¯¹mybatisåšå¢å¼ºï¼Œä¸åšä¿®æ”¹ï¼Œæ‰€ä»¥Mybatisæœ‰çš„åŠŸèƒ½ï¼ŒMPå‡èƒ½å®ç°ï¼Œå¯¹äºä¸€äº›å¤æ‚çš„æŸ¥è¯¢ï¼Œå¯ä»¥ä½¿ç”¨å†™xmlæ–‡ä»¶çš„æ–¹å¼æ¥å®Œæˆã€‚</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> æ¡†æ¶å­¦ä¹  </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
            <tag> ğŸ‘¢Spring Boot </tag>
            
            <tag> ğŸ’Mybatis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>è®¾è®¡æ¨¡å¼å­¦ä¹ æ€»ç»“ï¼ˆä¸€ï¼‰-å•ä¾‹æ¨¡å¼</title>
      <link href="posts/1986796058.html"/>
      <url>posts/1986796058.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1ã€å•ä¾‹æ¨¡å¼ä»‹ç»"><a href="#1ã€å•ä¾‹æ¨¡å¼ä»‹ç»" class="headerlink" title="1ã€å•ä¾‹æ¨¡å¼ä»‹ç»"></a>1ã€å•ä¾‹æ¨¡å¼ä»‹ç»</h2><blockquote><p>å•ä¾‹æ¨¡å¼ï¼ˆSingleton Patternï¼‰æ˜¯ Java ä¸­æœ€ç®€å•çš„è®¾è®¡æ¨¡å¼ä¹‹ä¸€ã€‚è¿™ç§ç±»å‹çš„è®¾è®¡æ¨¡å¼å±äºåˆ›å»ºå‹æ¨¡å¼ï¼Œå®ƒæä¾›äº†ä¸€ç§åˆ›å»ºå¯¹è±¡çš„æœ€ä½³æ–¹å¼ã€‚</p><p>è¿™ç§æ¨¡å¼æ¶‰åŠåˆ°ä¸€ä¸ªå•ä¸€çš„ç±»ï¼Œè¯¥ç±»è´Ÿè´£åˆ›å»ºè‡ªå·±çš„å¯¹è±¡ï¼ŒåŒæ—¶ç¡®ä¿åªæœ‰å•ä¸ªå¯¹è±¡è¢«åˆ›å»ºã€‚è¿™ä¸ªç±»æä¾›äº†ä¸€ç§è®¿é—®å…¶å”¯ä¸€çš„å¯¹è±¡çš„æ–¹å¼ï¼Œå¯ä»¥ç›´æ¥è®¿é—®ï¼Œä¸éœ€è¦å®ä¾‹åŒ–è¯¥ç±»çš„å¯¹è±¡ã€‚</p><p><strong>æ³¨æ„ï¼š</strong></p><ul><li>1ã€å•ä¾‹ç±»åªèƒ½æœ‰ä¸€ä¸ªå®ä¾‹ã€‚</li><li>2ã€å•ä¾‹ç±»å¿…é¡»è‡ªå·±åˆ›å»ºè‡ªå·±çš„å”¯ä¸€å®ä¾‹ã€‚</li><li>3ã€å•ä¾‹ç±»å¿…é¡»ç»™æ‰€æœ‰å…¶ä»–å¯¹è±¡æä¾›è¿™ä¸€å®ä¾‹ã€‚</li></ul><p>ä¸‹é¢ä»‹ç»å‡ ç§å•ä¾‹æ¨¡å¼çš„å®ç°æ–¹æ³•</p></blockquote><h2 id="2ã€é¥¿æ±‰å¼"><a href="#2ã€é¥¿æ±‰å¼" class="headerlink" title="2ã€é¥¿æ±‰å¼"></a>2ã€é¥¿æ±‰å¼</h2><blockquote><p>è¿™ç§å•ä¾‹æ¨¡å¼å®ç°ç®€å•ï¼Œä¸”åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¿è¯äº†å¹¶å‘å…¨ï¼Œä½†ç¼ºç‚¹æ˜¯æ— æ³•å®ç°æ‡’åŠ è½½ï¼Œæ–¹æ³•å•ä¾‹åœ¨ç±»åŠ è½½çš„æ—¶å€™å°±ä¼šè¢«åˆ›å»ºï¼Œå¯èƒ½ä¼šé€ æˆç©ºé—´æµªè´¹ï¼Œè¿™ç§å•ä¾‹æ¨¡å¼ä¼šè¢«åå°„å’Œåºåˆ—åŒ–å·¥å…·ç ´åã€‚</p></blockquote><blockquote><p>å®ç°æ€è·¯</p></blockquote><ul><li>åœ¨ç±»ä¸­new ä¸€ä¸ªé™æ€ç±»å¯¹è±¡instance</li><li>ç§æœ‰åŒ–æ„é€ æ–¹æ³•</li><li>ç¼–å†™ä¸€ä¸ªé™æ€æ–¹æ³•ç”¨äºè¿”å›ç¬¬ä¸€æ­¥newçš„instanceå¯¹è±¡</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton01</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton01 instance = <span class="keyword">new</span> Singleton01();</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton01</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton01 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ä¸ªå®ç°æ–¹æ³•åœ¨é«˜å¹¶å‘ä¸‹çº¿ç¨‹å®‰å…¨ï¼Œä½†å¯ä»¥è¢«åå°„å’Œåºåˆ—åŒ–å·¥å…·ç ´åï¼Œä¸‹é¢ä¸€ä¸€è¿›è¡Œæµ‹è¯•</p></blockquote><h3 id="2-1ã€ä½¿ç”¨åå°„ç ´å"><a href="#2-1ã€ä½¿ç”¨åå°„ç ´å" class="headerlink" title="2.1ã€ä½¿ç”¨åå°„ç ´å"></a>2.1ã€ä½¿ç”¨åå°„ç ´å</h3><ul><li>æµ‹è¯•ä»£ç </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Singleton01.class;</span><br><span class="line">Constructor constructor = clazz.getDeclaredConstructor();</span><br><span class="line">constructor.setAccessible(<span class="keyword">true</span>);</span><br><span class="line"><span class="comment">//ä½¿ç”¨åå°„è·å–çš„æ„é€ å™¨æ–°å»ºçš„å¯¹è±¡</span></span><br><span class="line">Singleton01 singleton01 = (Singleton01) constructor.newInstance();</span><br><span class="line"><span class="comment">//ä½¿ç”¨å•ä¾‹ç±»æ–¹æ³•è·å–çš„å¯¹è±¡</span></span><br><span class="line">Singleton01 instance = getInstance();</span><br><span class="line"><span class="comment">//æ¯”è¾ƒåœ°å€</span></span><br><span class="line">System.out.println(singleton01 == instance);</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152932524.png" alt="image-20210129152932524"></p><h3 id="2-2ã€ä½¿ç”¨åºåˆ—åŒ–å·¥å…·è¿›è¡Œç ´åï¼Œä¸‹é¢ç»™å‡ºåºåˆ—åŒ–å·¥å…·åŠæ¼”ç¤ºä»£ç "><a href="#2-2ã€ä½¿ç”¨åºåˆ—åŒ–å·¥å…·è¿›è¡Œç ´åï¼Œä¸‹é¢ç»™å‡ºåºåˆ—åŒ–å·¥å…·åŠæ¼”ç¤ºä»£ç " class="headerlink" title="2.2ã€ä½¿ç”¨åºåˆ—åŒ–å·¥å…·è¿›è¡Œç ´åï¼Œä¸‹é¢ç»™å‡ºåºåˆ—åŒ–å·¥å…·åŠæ¼”ç¤ºä»£ç "></a>2.2ã€ä½¿ç”¨åºåˆ—åŒ–å·¥å…·è¿›è¡Œç ´åï¼Œä¸‹é¢ç»™å‡ºåºåˆ—åŒ–å·¥å…·åŠæ¼”ç¤ºä»£ç </h3><ul><li>åºåˆ—åŒ–å·¥å…·ç±»</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SerializationUtils</span> </span>&#123;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * åºåˆ—åŒ–å¯¹è±¡</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> obj å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> åºåˆ—åŒ–åçš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">byte</span>[] serialize(Object obj) <span class="keyword">throws</span> IOException &#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == obj) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (</span><br><span class="line">                ByteArrayOutputStream byteArrayOutputStream = <span class="keyword">new</span> ByteArrayOutputStream();</span><br><span class="line">                ObjectOutputStream out = <span class="keyword">new</span> ObjectOutputStream(byteArrayOutputStream);</span><br><span class="line">        ) &#123;</span><br><span class="line"></span><br><span class="line">            out.writeObject(obj);</span><br><span class="line">            <span class="keyword">return</span> byteArrayOutputStream.toByteArray();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * ååºåˆ—åŒ–</span></span><br><span class="line"><span class="comment">     *</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> bytes å¯¹è±¡åºåˆ—åŒ–åçš„å­—èŠ‚æ•°ç»„</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> ååºåˆ—åŒ–åçš„å¯¹è±¡</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> IOException</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@throws</span> ClassNotFoundException</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Object <span class="title">deserialize</span><span class="params">(<span class="keyword">byte</span>[] bytes)</span> <span class="keyword">throws</span> IOException, ClassNotFoundException </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (<span class="keyword">null</span> == bytes) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span> (</span><br><span class="line">                ByteArrayInputStream byteArrayInputStream = <span class="keyword">new</span> ByteArrayInputStream(bytes);</span><br><span class="line">                ObjectInputStream in = <span class="keyword">new</span> ObjectInputStream(byteArrayInputStream);</span><br><span class="line">        ) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> in.readObject();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>æµ‹è¯•ä»£ç </li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//è·å–å•ä¾‹å¯¹è±¡å¹¶è¿›è¡Œåºåˆ—åŒ–</span></span><br><span class="line">Singleton01 instance = getInstance();</span><br><span class="line"><span class="keyword">byte</span>[] bytes = SerializationUtils.serialize(instance);</span><br><span class="line"><span class="comment">//è¿›è¡Œååºåˆ—åŒ–ï¼Œè·å–instanceå¯¹è±¡</span></span><br><span class="line">Singleton01 deserializeInstance = (Singleton01)SerializationUtils.deserialize(bytes);</span><br><span class="line"><span class="comment">//æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„åœ°å€</span></span><br><span class="line">System.out.println(instance);</span><br><span class="line">System.out.println(deserializeInstance);</span><br><span class="line">System.out.println(instance == deserializeInstance);</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152944497.png" alt="image-20210129152944497"></p><h3 id="2-3ã€é—®é¢˜è§£å†³æ–¹æ¡ˆ"><a href="#2-3ã€é—®é¢˜è§£å†³æ–¹æ¡ˆ" class="headerlink" title="2.3ã€é—®é¢˜è§£å†³æ–¹æ¡ˆ"></a>2.3ã€é—®é¢˜è§£å†³æ–¹æ¡ˆ</h3><blockquote><p>å¯¹äºåå°„ï¼Œæˆ‘ä»¬å¯ä»¥åœ¨ç§æœ‰çš„æ„é€ å‡½æ•°ä¸­åšä¸€äº›å¤„ç†ï¼Œå½“ç”¨æˆ·è¿›å…¥é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„æ„é€ æ–¹æ³•æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥åˆ¤æ–­å½“å‰é™æ€å¯¹è±¡instanceæ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œç›´æ¥æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼Œè®©å…¶ä»–äººä¸èƒ½ç”¨åå°„æ¥ç ´åå•ä¾‹æ¨¡å¼ã€‚</p></blockquote><ul><li>ä»£ç å®ç°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">private</span> <span class="title">Singleton01</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>å†æ¬¡æ‰§è¡Œä¸Šé¢çš„æµ‹è¯•ä»£ç ï¼Œç»“æœä¸º</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://raw.githubusercontent.com/tianxin763882220/images/master/blog/20201208151900.png" alt="image-20201208151900669"></p><blockquote><p>ç”±äºç±»çš„é™æ€æˆå‘˜çš„åºåˆ—åŒ–é—®é¢˜ï¼Œæ‰€ä»¥æ¯æ¬¡ååºåˆ—åŒ–éƒ½ä¼šnewä¸€ä¸ªç±»å¯¹è±¡ï¼Œæˆ‘ä»¬å¯ä»¥å†™ä¸€ä¸ªreadResloveæ–¹æ³•æ¥æ—¶å…¶åºåˆ—åŒ–å’Œååºåˆ—åŒ–ä½¿ç”¨çš„éƒ½æ˜¯åŒä¸€ä¸ªinstanceå¯¹è±¡ã€‚</p></blockquote><ul><li>ä»£ç å®ç°</li></ul><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152958851.png" alt="image-20210129152958851"></p><h2 id="3ã€é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„æ”¹è¿›â€“ç™»è®°å¼"><a href="#3ã€é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„æ”¹è¿›â€“ç™»è®°å¼" class="headerlink" title="3ã€é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„æ”¹è¿›â€“ç™»è®°å¼"></a>3ã€é¥¿æ±‰å¼å•ä¾‹æ¨¡å¼çš„æ”¹è¿›â€“ç™»è®°å¼</h2><blockquote><p>ç™»è®°å¼å•ä¾‹æ¨¡å¼é‡‡ç”¨äº†ä¸€ä¸ªé™æ€å†…éƒ¨ç±»æ¥æŒæœ‰è¯¥ç±»çš„å•å®ä¾‹å¯¹è±¡ï¼Œåœ¨å¤–éƒ¨ç±»è¢«åŠ è½½æ—¶ï¼Œé™æ€å†…éƒ¨ç±»ä¸ä¼šè¢«åŠ è½½ï¼Œå³ç±»çš„å•ä¾‹å¯¹è±¡ä¸ä¼šè¢«åˆ›å»ºï¼Œå½“ç”¨æˆ·ç¬¬ä¸€æ¬¡ä½¿ç”¨ç±»çš„getInstanceæ–¹æ³•æ—¶ï¼Œç±»çš„å•å®ä¾‹æ‰ä¼šè¢«åŠ è½½ï¼Œè¿™æ ·æ—¢ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆèµ·åˆ°äº†æ‡’åŠ è½½çš„æ•ˆæœã€‚</p></blockquote><h3 id="3-1ã€ç™»è®°å¼å®ç°æ€è·¯"><a href="#3-1ã€ç™»è®°å¼å®ç°æ€è·¯" class="headerlink" title="3.1ã€ç™»è®°å¼å®ç°æ€è·¯"></a>3.1ã€ç™»è®°å¼å®ç°æ€è·¯</h3><ul><li>åœ¨ç±»ä¸­æ·»åŠ ä¸€ä¸ªé™æ€å†…éƒ¨ç±»SingtonHolderï¼Œç±»ä¸­å­˜æ”¾å¤–éƒ¨ç±»çš„å”¯ä¸€å®ä¾‹instance</li><li>ç§æœ‰åŒ–æ„é€ å™¨ï¼Œåœ¨æ„é€ å™¨ä¸­é€šè¿‡åˆ¤æ–­é™æ€å†…éƒ¨ç±»ä¸­instanceå®ä¾‹æ˜¯å¦ä¸ºç©ºæ¥å†³å®šè¦ä¸è¦æŠ›å‡ºå¼‚å¸¸ã€‚</li><li>åœ¨å¤–éƒ¨ç±»ä¸­æ„å»ºä¸€ä¸ªé™æ€æ–¹æ³•getInstanceæ¥è¿”å›ç±»çš„å•å®ä¾‹ã€‚</li><li>å†™ä¸€ä¸ªreadResloveæ–¹æ³•æ¥é˜²æ­¢åºåˆ—åŒ–ç ´åå•ä¾‹ã€‚</li></ul><h3 id="3-2ã€ä»£ç å®ç°"><a href="#3-2ã€ä»£ç å®ç°" class="headerlink" title="3.2ã€ä»£ç å®ç°"></a>3.2ã€ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton02</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="class"><span class="keyword">class</span> <span class="title">SingletonHolder</span> </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="keyword">static</span> Singleton02 instance = <span class="keyword">new</span> Singleton02();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton02</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(SingletonHolder.instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton02 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> SingletonHolder.instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>é™æ€å†…éƒ¨ç±»çš„åŠ è½½æ—¶æœºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨Sington2çš„æ„é€ å‡½æ•°ä¸­è¾“å‡ºä¸€æ®µè¯­å¥æ¥åˆ¤æ–­é™æ€å†…éƒ¨ç±»çš„åŠ è½½æ—¶é—´ã€‚</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">Class clazz = Class.forName(<span class="string">&quot;singleton.Singleton02&quot;</span>);</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;-----------------------------------&quot;</span>);</span><br><span class="line"></span><br><span class="line">Singleton02 instance = getInstance();</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153010304.png" alt="image-20210129153010304"></p><ul><li>ç»“è®ºï¼šé™æ€å†…éƒ¨ç±»åœ¨å¤–éƒ¨ç±»åŠ è½½æ—¶ä¸ä¼šè¢«åŠ è½½ï¼Œè€Œæ˜¯åœ¨ç”¨æˆ·ç¬¬ä¸€æ¬¡è°ƒç”¨getInstanceæ–¹æ³•æ—¶æ‰åŠ è½½ã€‚</li></ul><blockquote><p>å°ç»“ï¼šå¯¹äºé¥¿æ±‰å¼ï¼Œæ¨èä½¿ç”¨ç™»è®°å¼ã€‚</p></blockquote><h2 id="4ã€æ‡’æ±‰å¼å’ŒåŒæ£€é”"><a href="#4ã€æ‡’æ±‰å¼å’ŒåŒæ£€é”" class="headerlink" title="4ã€æ‡’æ±‰å¼å’ŒåŒæ£€é”"></a>4ã€æ‡’æ±‰å¼å’ŒåŒæ£€é”</h2><blockquote><p>æ‡’æ±‰å¼å•ä¾‹æ¨¡å¼æ„å‘³ç€åœ¨ç±»åŠ è½½æ—¶ä¸åˆ›å»ºç±»çš„å•å®ä¾‹å¯¹è±¡ï¼Œè€Œæ˜¯å½“ç”¨æˆ·éœ€è¦å®ä¾‹æ—¶æ‰å»åˆ›å»ºå¯¹è±¡ï¼Œè¿™ç§æ–¹æ³•å®ç°äº†æ‡’åŠ è½½ï¼Œä¸”å®ç°ç®€å•ï¼Œä½†ä¸èƒ½ä¿è¯å¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å•ä¾‹å”¯ä¸€æ€§ã€‚</p></blockquote><h3 id="4-1ã€ä»£ç å®ç°"><a href="#4-1ã€ä»£ç å®ç°" class="headerlink" title="4.1ã€ä»£ç å®ç°"></a>4.1ã€ä»£ç å®ç°</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Singleton03</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Singleton03 instance;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">Singleton03</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Singleton03 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton03();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™ç§å•ä¾‹æ¨¡å¼å­˜åœ¨è®¸å¤šé—®é¢˜ï¼Œé™¤äº†å‰é¢æåˆ°çš„å¯ä»¥ç”¨åå°„å’Œåºåˆ—åŒ–å·¥å…·ç ´åå¤–ï¼Œè¿™ç§å•ä¾‹æ¨¡å¼åœ¨å¤šçº¿ç¨‹å¹¶å‘ç¯å¢ƒä¸‹ä¸èƒ½ä¿è¯å•ä¾‹çš„å”¯ä¸€æ€§ï¼Œç»™å‡ºæµ‹è¯•ä»£ç </p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">200</span>; i++) &#123;</span><br><span class="line">    <span class="keyword">new</span> Thread(<span class="keyword">new</span> Runnable() &#123;</span><br><span class="line">        <span class="meta">@Override</span></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">run</span><span class="params">()</span> </span>&#123;</span><br><span class="line">            System.out.println(getInstance());</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;).start();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>ç»“æœï¼šå¯ä»¥çœ‹åˆ°å‡ºç°äº†ä¸¤ä¸ªå¯¹è±¡ï¼Œæ‰€ä»¥éœ€è¦å¯¹è¿™ç§æ¨¡å¼è¿›è¡Œæ”¹è¿›</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129153022773.png" alt="image-20210129153022773"></p><h3 id="4-2ã€è§£å†³æ‡’æ±‰å¼åœ¨å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜"><a href="#4-2ã€è§£å†³æ‡’æ±‰å¼åœ¨å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜" class="headerlink" title="4.2ã€è§£å†³æ‡’æ±‰å¼åœ¨å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜"></a>4.2ã€è§£å†³æ‡’æ±‰å¼åœ¨å¤šçº¿ç¨‹å¹¶å‘ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜</h3><blockquote><p>åœ¨getInstanceæ–¹æ³•ä¸­æ·»åŠ ä¸€ä¸ªsynchronizdå—é”å®šä»£ç ï¼Œå°±å¯ä»¥è§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä¸‹é¢ç»™å‡ºä»£ç å®ç°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Singleton04 <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">synchronized</span> (Singleton04.class) &#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            instance = <span class="keyword">new</span> Singleton04();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>è¿™æ ·å°±å¯ä»¥ä¿è¯å¤šçº¿ç¨‹ä¸‹çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼Œä½†è¿™ç§ç›´æ¥åŠ åŒæ­¥å—çš„ä»£ç ä¼šå½±å“ç¨‹åºçš„æ€§èƒ½ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥é€šè¿‡å¼•è¿›åŒæ£€é”æ¨¡å¼çš„æ–¹æ³•åœ¨ä¿è¯çº¿ç¨‹å®‰å…¨çš„å‰æä¸‹å°½å¯èƒ½åœ°ä¿è¯æ€§èƒ½ã€‚</p></blockquote><h3 id="4-3ã€åŒæ£€é”"><a href="#4-3ã€åŒæ£€é”" class="headerlink" title="4.3ã€åŒæ£€é”"></a>4.3ã€åŒæ£€é”</h3><blockquote><p>åŒæ ·å¯¹getInstanceæ–¹æ³•è¿›è¡Œæ”¹é€ ï¼Œåœ¨åŒæ­¥å—å¤–å†æ¬¡æ·»åŠ ä¸€ä¸ªåˆ¤æ–­ï¼Œå³å•ä¾‹å¯¹è±¡ä¸ºç©ºæ—¶ï¼Œæ‰è¿›å…¥åŒæ­¥å—åŠä»¥åä»£ç ï¼Œä»£ç å®ç°å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DoubleCheckLock <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">synchronized</span> (DoubleCheckLock.class) &#123;</span><br><span class="line">            <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                instance = <span class="keyword">new</span> DoubleCheckLock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> instance;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å‡è®¾ABåŒæ—¶è¿›å…¥ç¬¬ä¸€ä¸ªifåˆ¤æ–­ï¼Œç”±äºsynchronizedå—çš„å­˜åœ¨ï¼ŒABæœ‰ä¸€ä¸ªçº¿ç¨‹ä¼šè¿›å…¥åŒæ­¥å—ä¸­ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…ï¼Œè¿›å…¥åŒæ­¥å—çš„çº¿ç¨‹åˆ¤æ–­å½“å‰å•å®ä¾‹å¯¹è±¡ä¸ºç©ºï¼Œäºæ˜¯ä¼šåˆå§‹åŒ–å¯¹è±¡ï¼Œç„¶åé€€å‡ºsynchronizedå—ï¼Œæ­¤æ—¶å¦å¤–çš„çº¿ç¨‹è¿›å…¥ä»£ç å—æ—¶ï¼Œç”±äºinstanceå·²ç»è¢«åˆå§‹åŒ–ï¼Œæ‰€ä»¥ä¼šç›´æ¥è¿”å›å·²ç»åˆå§‹åŒ–çš„instanceã€‚ä¹‹åçš„çº¿ç¨‹åœ¨è¿›å…¥synchronizedå—æ—¶ä¼šå…ˆè¿›è¡Œä¸€æ¬¡åˆ¤æ–­ï¼Œæ­¤æ—¶çš„instanceå·²ç»ä¸ä¸ºç©ºï¼Œæ‰€ä»¥ç›´æ¥è¿”å›instanceã€‚</p></blockquote><ul><li>å¯èƒ½é‡åˆ°çš„é—®é¢˜</li></ul><blockquote><p>ç”±äºJVMæœºå­˜åœ¨æŒ‡ä»¤é‡æ’ï¼ŒåŒæ—¶åˆå§‹åŒ–instanceå¯¹è±¡ï¼ˆinstance = new DoubleCheckLock()ï¼‰æ‰§è¡Œçš„æ“ä½œå¦‚ä¸‹</p><p>1 åˆ†é…å¯¹è±¡å†…å­˜ç©ºé—´</p><p>2 åˆå§‹åŒ–å¯¹è±¡</p><p>3 instanceæŒ‡å‘1åˆ†é…çš„ç©ºé—´</p><p>å‡ºç°æŒ‡ä»¤é‡æ’åï¼Œæ‰§è¡Œçš„æ“ä½œå¦‚ä¸‹</p><p>1 åˆ†é…å¯¹è±¡å†…å­˜ç©ºé—´</p><p>2 instanceæŒ‡å‘1åˆ†é…çš„ç©ºé—´</p><p>3 åˆå§‹åŒ–å¯¹è±¡</p><p>å¦‚æœæ­¤æ—¶å…¶ä»–çº¿ç¨‹åœ¨æŒ‡ä»¤é‡æ’çš„ç¬¬2æ­¥å°±å¯¹instanceè¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆå¯èƒ½æ‹¿åˆ°ä¸€ä¸ªç©ºçš„instanceå¯¹è±¡ï¼Œå› ä¸ºåœ¨æŒ‡ä»¤æ’åºçš„ç¬¬2æ­¥æ“ä½œåï¼ŒinstanceæŒ‡å‘çš„åœ°å€å·²ç»ä¸ä¸ºç©ºã€‚</p></blockquote><ul><li>è§£å†³æ–¹æ¡ˆï¼šä½¿ç”¨<strong>volatile</strong>å…³é”®å­—ä¿®é¥°instanceå˜é‡</li></ul><blockquote><p>åŒæ£€é”çš„å®Œæ•´å®ç°ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DoubleCheckLock</span> <span class="keyword">implements</span> <span class="title">Serializable</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> <span class="keyword">volatile</span> DoubleCheckLock instance;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * åœ¨æ„é€ æ–¹æ³•ä¸­é˜²æ­¢åå°„ç ´åå•ä¾‹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="title">DoubleCheckLock</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> IllegalStateException();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> DoubleCheckLock <span class="title">getInstance</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">synchronized</span> (DoubleCheckLock.class) &#123;</span><br><span class="line">                <span class="keyword">if</span>(instance == <span class="keyword">null</span>) &#123;</span><br><span class="line">                    instance = <span class="keyword">new</span> DoubleCheckLock();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * ç¼–å†™ä¸€ä¸ªreadResolveæ–¹æ³•é˜²æ­¢åºåˆ—åŒ–ç ´åå•ä¾‹æ¨¡å¼</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span> å½“å‰ç±»çš„å•å®ä¾‹å¯¹è±¡</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Object <span class="title">readResolve</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> instance;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> è®¾è®¡æ¨¡å¼ </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ï¼ˆäºŒï¼‰-å­—ç¬¦ä¸²ç›¸å…³é—®é¢˜</title>
      <link href="posts/4173931752.html"/>
      <url>posts/4173931752.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1ã€Stringã€StringBufferä¸StringBuilderçš„åŒºåˆ«"><a href="#1ã€Stringã€StringBufferä¸StringBuilderçš„åŒºåˆ«" class="headerlink" title="1ã€Stringã€StringBufferä¸StringBuilderçš„åŒºåˆ«"></a>1ã€Stringã€StringBufferä¸StringBuilderçš„åŒºåˆ«</h2><h3 id="1-1ã€Stringç±»"><a href="#1-1ã€Stringç±»" class="headerlink" title="1.1ã€Stringç±»"></a>1.1ã€Stringç±»</h3><blockquote><p>åˆ†ææºç å¯çŸ¥ï¼ŒStringå¯¹è±¡çš„å†…å®¹æ˜¯å­˜å‚¨åœ¨ä¸€ä¸ªcharæ•°ç»„ä¸­ï¼Œä¸”è¿™ä¸ªæ•°ç»„ä½¿ç”¨finalä¿®é¥°ï¼Œè¿™ä¹Ÿæ˜¯Stringå¯¹è±¡ä¸å¯å˜çš„åŸå› ã€‚å½“è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æ—¶ï¼Œè™šæ‹Ÿæœºä¼šæ–°å»ºä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œç„¶åå°†æ–°çš„å­—ç¬¦ä¸²å¯¹è±¡èµ‹å€¼ç»™åŸæ¥çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯çœŸçš„ä¿®æ”¹äº†åŸæ¥å­—ç¬¦ä¸²å¯¹è±¡çš„å€¼ã€‚</p><p>å­—ç¬¦ä¸²é‡å†™äº†Objectçˆ¶ç±»çš„equalsæ–¹æ³•ã€‚</p></blockquote><h3 id="1-2ã€StringBufferç±»å’ŒStringBuilderç±»"><a href="#1-2ã€StringBufferç±»å’ŒStringBuilderç±»" class="headerlink" title="1.2ã€StringBufferç±»å’ŒStringBuilderç±»"></a>1.2ã€StringBufferç±»å’ŒStringBuilderç±»</h3><blockquote><p>è¿™ä¸¤ä¸ªç±»å‡ç»§æ‰¿äºAbstractStringBuilderç±»ï¼Œä½†åˆ†ææºç å¯çŸ¥StringBufferçš„æ–¹æ³•éƒ½æ·»åŠ äº†synchronizedå…³é”®è¯è¿›è¡Œä¿®é¥°ï¼Œæ‰€ä»¥StringBufferæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨synchronizedä¿®é¥°æ–¹æ³•çš„StringBuilderæ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ï¼Œä½†StringBuilderçš„é€Ÿåº¦è¦è¿œè¿œé«˜äºStringBufferï¼Œæ‰€ä»¥åœ¨èƒ½ä¿è¯çº¿ç¨‹å®‰å…¨çš„æƒ…å†µä¸‹ï¼ŒStringBuilderçš„ä¼˜å…ˆçº§è¦é«˜äºStringBufferã€‚</p></blockquote><h3 id="1-3ã€æ€»ç»“"><a href="#1-3ã€æ€»ç»“" class="headerlink" title="1.3ã€æ€»ç»“"></a>1.3ã€æ€»ç»“</h3><ul><li>Stringæ˜¯ä¸€ä¸ªfinalä¿®é¥°çš„ç±»ï¼Œæ‰€æœ‰çš„å±æ€§ä¹Ÿæ˜¯finalçš„ï¼Œæ‰€ä»¥Stringå…·æœ‰ä¸å¯å˜æ€§ï¼Œä¹Ÿå°±æ˜¯å¯¹å­—ç¬¦ä¸²çš„æ“ä½œï¼Œå¦‚æ‹¼æ¥ã€å‰ªåˆ‡éƒ½ä¼šäº§ç”Ÿæ–°çš„Stringå¯¹è±¡ã€‚</li><li>StringBufferæœ¬è´¨æ˜¯ä¸€ä¸ªçº¿ç¨‹å®‰å…¨çš„å¯ä¿®æ”¹å­—ç¬¦ä¸²åºåˆ—ã€‚å› ä¸ºä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥ä¼šå¸¦æ¥é¢å¤–çš„æ€§èƒ½æ¶ˆè€—ã€‚</li><li>StringBuilderæœ¬è´¨ä¸Šå’ŒStringBufferæ²¡æœ‰åŒºåˆ«ï¼Œä½†æ˜¯StringBuilderå»æ‰äº†çº¿ç¨‹å®‰å…¨éƒ¨åˆ†æé«˜äº†æ“ä½œæ•ˆç‡ï¼Œæ˜¯ç»å¤§éƒ¨åˆ†æƒ…å†µä¸‹å­—ç¬¦ä¸²æ‹¼æ¥çš„é¦–é€‰ã€‚</li><li>å¦‚æœç¡®å®šæ‹¼æ¥å­—ç¬¦ä¸²ä¼šå‘ç”Ÿå¤šæ¬¡ï¼Œå¹¶ä¸”é•¿åº¦å¯é¢„è®¡ï¼Œé‚£ä¹ˆå¯ä»¥åœ¨å¼€å§‹çš„æ—¶å€™æŒ‡å®šåˆé€‚çš„å¤§å°ï¼Œé¿å…æ•°ç»„æ‰©å®¹é€ æˆçš„å¼€é”€ã€‚</li></ul><h2 id="2ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šæ¬¡çš„å­—ç¬¦å’Œå‡ºç°çš„æ¬¡æ•°"><a href="#2ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šæ¬¡çš„å­—ç¬¦å’Œå‡ºç°çš„æ¬¡æ•°" class="headerlink" title="2ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šæ¬¡çš„å­—ç¬¦å’Œå‡ºç°çš„æ¬¡æ•°"></a>2ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šæ¬¡çš„å­—ç¬¦å’Œå‡ºç°çš„æ¬¡æ•°</h2><blockquote><p>éå†å­—ç¬¦ä¸²ï¼Œå¹¶ä½¿ç”¨ä¸€ä¸ªHashMapæ¥å­˜å‚¨å‡ºç°å­—ç¬¦åŠå‡ºç°çš„æ¬¡æ•°ï¼Œä»¥å­—ç¬¦ä¸ºkeyï¼Œæ¬¡æ•°ä¸ºvalueã€‚è§£é¢˜æ€è·¯å¦‚ä¸‹</p></blockquote><ul><li><p>å‡å®šå­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šçš„å­—ç¬¦maxCodeä¸ºå½“å‰å­—ç¬¦ä¸²çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå‡ºç°æ¬¡æ•°maxCountåˆå§‹åŒ–ä¸º0</p></li><li><p>éå†å­—ç¬¦ä¸²ï¼Œåˆ¤æ–­å½“å‰å­—ç¬¦æ˜¯å¦åœ¨hashmapçš„keyä¸­ï¼Œå¦‚æœåŒ…å«ï¼Œä»¤æ¬¡æ•°+1ï¼Œå¦åˆ™å°†è¯¥å­—ç¬¦ä¸ºkeyï¼Œ1ä¸ºvalueæ”¾å…¥hashmapä¸­</p></li><li><p>åˆ¤æ–­maxCountå’Œå½“å‰å­—ç¬¦å‡ºç°æ¬¡æ•°çš„å…³ç³»ï¼Œå¦‚æœmaxCountå°äºå½“å‰å­—ç¬¦å‡ºç°æ¬¡æ•°ï¼Œå°±ä»¤maxCode = å½“å‰å­—ç¬¦ï¼Œç„¶åæ›´æ–°maxCodeï¼Œæœ€åè¿”å›maxCodeå’ŒmaxCountå³å¯ã€‚</p></li></ul><blockquote><p>ä»£ç å®ç°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­å‡ºç°æœ€å¤šæ¬¡çš„å­—ç¬¦å’Œå‡ºç°çš„æ¬¡æ•°</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> str ç›®æ ‡å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> ä»¥maxCodeä¸ºé”®ã€maxCountä¸ºå€¼çš„map</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Map&lt;Character, Integer&gt; <span class="title">findMostCodeAndCount</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span> maxCode = str.charAt(<span class="number">0</span>);</span><br><span class="line">    <span class="keyword">int</span> maxCount = <span class="number">0</span>;</span><br><span class="line">    Map&lt;Character, Integer&gt; map = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">        Character currentCode = str.charAt(i);</span><br><span class="line">        Integer count = map.get(currentCode);</span><br><span class="line">        <span class="keyword">if</span>(count == <span class="keyword">null</span>) &#123;</span><br><span class="line">            count = <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            count++;</span><br><span class="line">        &#125;</span><br><span class="line">        map.put(currentCode, count);</span><br><span class="line">        <span class="keyword">if</span>(maxCount &lt; count) &#123;</span><br><span class="line">            maxCode = currentCode;</span><br><span class="line">            maxCount = count;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Map&lt;Character, Integer&gt; result = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    result.put(maxCode,maxCount);</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ä»£ç åŠç»“æœ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">&quot;abcacba&quot;</span>;</span><br><span class="line">Map result = findMostCodeAndCount(str);</span><br><span class="line">System.out.println(result);</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152842664.png" alt="image-20210129152842664"></p><h2 id="3ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡é‡å¤å‡ºç°çš„å­—ç¬¦"><a href="#3ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡é‡å¤å‡ºç°çš„å­—ç¬¦" class="headerlink" title="3ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡é‡å¤å‡ºç°çš„å­—ç¬¦"></a>3ã€æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡é‡å¤å‡ºç°çš„å­—ç¬¦</h2><blockquote><p>ä½¿ç”¨ä¸€ä¸ªHashSetæ¥è§£å†³é—®é¢˜ï¼Œç”±äºSetæœ‰ä¸å…è®¸å…ƒç´ é‡å¤çš„æ€§è´¨ï¼ŒSetçš„addæ–¹æ³•åœ¨æ·»åŠ é‡å¤å€¼æ˜¯ä¼šè¿”å›falseï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªæ€§è´¨æ¥åˆ¤æ–­å…ƒç´ æ˜¯å¦é‡å¤ã€‚</p></blockquote><blockquote><p>ä»£ç å®ç°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * æ‰¾å‡ºå­—ç¬¦ä¸²ä¸­ç¬¬ä¸€æ¬¡é‡å¤å‡ºç°çš„å­—ç¬¦</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> str ç›®æ ‡å­—ç¬¦ä¸²</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span> è¿”å›ç¬¬ä¸€æ¬¡é‡å¤çš„å­—ç¬¦</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Character <span class="title">getFirstRepeat</span><span class="params">(String str)</span> </span>&#123;</span><br><span class="line">    Set&lt;Character&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    Character result = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; str.length(); i++) &#123;</span><br><span class="line">        Character currentCode = str.charAt(i);</span><br><span class="line">        <span class="keyword">if</span>(!set.add(currentCode)) &#123;</span><br><span class="line">            result = currentCode;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ä»£ç å’Œç»“æœ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">String str = <span class="string">&quot;abcacba&quot;</span>;</span><br><span class="line">Character result = getFirstRepeat(str);</span><br><span class="line">System.out.println(result);</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152855053.png" alt="image-20210129152855053"></p><h2 id="4ã€ä¸¤ä¸ªå¤§æ•°ä¹‹å’Œ"><a href="#4ã€ä¸¤ä¸ªå¤§æ•°ä¹‹å’Œ" class="headerlink" title="4ã€ä¸¤ä¸ªå¤§æ•°ä¹‹å’Œ"></a>4ã€ä¸¤ä¸ªå¤§æ•°ä¹‹å’Œ</h2><blockquote><p>é¢˜ç›®æè¿°ï¼šç°åœ¨æœ‰ä¸¤ä¸ªæ•°ï¼Œä½æ•°å‡è¶…è¿‡1000ä½ï¼Œä¾‹å¦‚</p><ul><li><p>String a = â€œ123343432â€¦â€</p></li><li><p>String b = â€œ3974928374928â€¦â€</p></li></ul><p>è¿™ä¸¤ä¸ªå¤§æ•°æ— æ³•è½¬æ¢ä¸ºIntegerè®¡ç®—ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸¤ä¸ªæ•°ç»„æ¥å­˜å‚¨è¿™ä¸¤ä¸ªæ•°ï¼Œç„¶åè¿›è¡Œè®¡ç®—ã€‚</p><p>è§£é¢˜æ€è·¯å¦‚ä¸‹</p></blockquote><ul><li>è®¾è¿™ä¸¤ä¸ªæ•°ä¸­å¤§çš„æ•°çš„ä½æ•°ä½mï¼Œåˆ™ç»“æœçš„æœ€å¤§ä½æ•°ä½m+1</li><li>ç”¨ä¸€ä¸ªintæ•°ç»„æ¥å­˜å‚¨ç»“æœ</li></ul><blockquote><p>ä»£ç å®ç°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * ç¼–ç¨‹ä¸¤ä¸ªå¤§æ•°ä¹‹å’Œ</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> num1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> num2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">sumOfBigNum</span><span class="params">(String num1,String num2)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">char</span>[] largeArray = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">char</span>[] smallArray = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">if</span>(num1.length() &gt;= num2.length()) &#123;</span><br><span class="line">        largeArray = num1.toCharArray();</span><br><span class="line">        smallArray = num2.toCharArray();</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        largeArray = num2.toCharArray();</span><br><span class="line">        smallArray = num1.toCharArray();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[largeArray.length + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; largeArray.length; i++) &#123;</span><br><span class="line">        res[i] = largeArray[largeArray.length - i - <span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; smallArray.length; i++) &#123;</span><br><span class="line">        res[i] += smallArray[smallArray.length - i - <span class="number">1</span>] - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; res.length - <span class="number">1</span>; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(res[i] &gt; <span class="number">9</span>) &#123;</span><br><span class="line">            res[i + <span class="number">1</span>] += res[i] / <span class="number">10</span>;</span><br><span class="line">            res[i] %= <span class="number">10</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    StringBuilder stringBuilder = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = res.length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        stringBuilder.append(res[i]);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String result = stringBuilder.toString();</span><br><span class="line">    <span class="keyword">if</span>(result.startsWith(<span class="string">&quot;0&quot;</span>)) &#123;</span><br><span class="line">        result = result.substring(<span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ä»£ç å’Œç»“æœ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">String num1 = <span class="string">&quot;12345&quot;</span>;</span><br><span class="line">String num2 = <span class="string">&quot;56756&quot;</span>;</span><br><span class="line">Integer n1 = Integer.valueOf(num1);</span><br><span class="line">Integer n2 = Integer.valueOf(num2);</span><br><span class="line">Integer sum = n1 + n2;</span><br><span class="line">System.out.println(<span class="string">&quot;è®¡ç®—æœºè®¡ç®—ç»“æœä¸ºï¼š&quot;</span> + sum);</span><br><span class="line">System.out.println(<span class="string">&quot;å‡½æ•°è®¡ç®—ç»“æœä½ï¼š&quot;</span> + sumOfBigNum(num1,num2));</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152910086.png" alt="image-20210129152910086"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>æ•°æ®ç»“æ„ä¸ç®—æ³•å­¦ä¹ ï¼ˆä¸€ï¼‰--å•é“¾è¡¨ç›¸å…³ç®—æ³•</title>
      <link href="posts/3227196086.html"/>
      <url>posts/3227196086.html</url>
      
        <content type="html"><![CDATA[<link rel="stylesheet" class="aplayer-secondary-style-marker" href="\assets\css\APlayer.min.css"><script src="\assets\js\APlayer.min.js" class="aplayer-secondary-script-marker"></script><h2 id="1ã€ä½¿ç”¨javaå®ç°å•é“¾è¡¨"><a href="#1ã€ä½¿ç”¨javaå®ç°å•é“¾è¡¨" class="headerlink" title="1ã€ä½¿ç”¨javaå®ç°å•é“¾è¡¨"></a>1ã€ä½¿ç”¨javaå®ç°å•é“¾è¡¨</h2><blockquote><p>å»ºç«‹NodeèŠ‚ç‚¹ç±»çš„ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Node</span> </span>&#123;</span><br><span class="line">    Integer data;</span><br><span class="line">    Node next;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Node</span><span class="params">(Integer data)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.data = data;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Node&#123;&quot;</span> +</span><br><span class="line">                <span class="string">&quot;data=&quot;</span> + data +</span><br><span class="line">                <span class="string">&#x27;&#125;&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>å»ºç«‹é“¾è¡¨ç±»å¹¶ç¼–å†™é“¾è¡¨ç±»çš„æ·»åŠ èŠ‚ç‚¹å’Œéå†æ–¹æ³•</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">LinkedList</span> </span>&#123;</span><br><span class="line">    Node head;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * æ·»åŠ èŠ‚ç‚¹çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> node å¾…æ·»åŠ èŠ‚ç‚¹</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">addNode</span><span class="params">(Node node)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.head == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="comment">//å¦‚æœå½“å‰å¤´èŠ‚ç‚¹ä¸ºç©ºï¼Œé‚£ä¹ˆå°†ä¼ å…¥çš„èŠ‚ç‚¹ä½œä¸ºå¤´èŠ‚ç‚¹</span></span><br><span class="line">            <span class="keyword">this</span>.head = node;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//ç”±äºå•é“¾è¡¨çš„å¤´èŠ‚ç‚¹ä¸å¯ç§»åŠ¨ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªä¸´æ—¶æŒ‡é’ˆæ¥è¾…åŠ©æˆ‘ä»¬æ·»åŠ èŠ‚ç‚¹ã€‚</span></span><br><span class="line">        Node temp = head;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(temp.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//é€€å‡ºå¾ªç¯æ—¶ï¼ŒtempèŠ‚ç‚¹æŒ‡å‘é“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ­¤æ—¶å°†ä¼ å…¥èŠ‚ç‚¹æŒ‚åœ¨tempä¹‹åå³å¯</span></span><br><span class="line">        temp.next = node;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/***</span></span><br><span class="line"><span class="comment">     * éå†é“¾è¡¨çš„æ–¹æ³•</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">list</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">this</span>.head == <span class="keyword">null</span>) &#123;</span><br><span class="line">            System.out.println(<span class="string">&quot;é“¾è¡¨ä¸ºç©ºï¼Œæ— æ³•éå†ï¼&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        Node temp = head;</span><br><span class="line">        <span class="keyword">while</span>(<span class="keyword">true</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(temp == <span class="keyword">null</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(temp);</span><br><span class="line">            temp = temp.next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2ã€ç¼–å†™ä»£ç å®ç°å•é“¾è¡¨çš„åè½¬"><a href="#2ã€ç¼–å†™ä»£ç å®ç°å•é“¾è¡¨çš„åè½¬" class="headerlink" title="2ã€ç¼–å†™ä»£ç å®ç°å•é“¾è¡¨çš„åè½¬"></a>2ã€ç¼–å†™ä»£ç å®ç°å•é“¾è¡¨çš„åè½¬</h2><blockquote><p>è¿™é‡Œä½¿ç”¨<strong>é€’å½’</strong>æ¥å®Œæˆå•é“¾è¡¨çš„åè½¬ï¼Œè¿™ä¸ªç®—æ³•çš„æ€è·¯å¤§ä½“å¦‚ä¸‹</p></blockquote><ul><li>å‡è®¾ç°åœ¨æœ‰ä¸€æ¡å•é“¾è¡¨ï¼š1-2-3-4-NULLï¼Œåœ¨æ¯æ¬¡è¿›å…¥å€’ç½®å‡½æ•°reverseä¹‹å‰ï¼Œéœ€è¦å¯¹ä¼ å…¥çš„èŠ‚ç‚¹è¿›è¡Œåˆ¤æ–­ï¼Œå½“ä¼ å…¥çš„èŠ‚ç‚¹ä¸ºç©ºæˆ–è€…ä¼ å…¥èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸä¸ºç©ºæ—¶ï¼Œè¯æ˜è¯¥é“¾è¡¨ä¸éœ€è¦åè½¬ï¼Œç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹ã€‚</li><li>å½“ä¼ å…¥èŠ‚ç‚¹çš„æŒ‡é’ˆåŸŸä¸ä¸ºç©ºæ—¶ï¼Œå°†è¯¥èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„nextåŸŸæŒ‡å‘è‡ªå·±ï¼ŒåŒæ—¶å°†è¯¥èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸç½®ä¸ºç©ºï¼Œè¿™æ ·å°±å½¢æˆäº†å±€éƒ¨æ„ä¹‰ä¸Šçš„é“¾è¡¨èŠ‚ç‚¹åè½¬ï¼Œç”±äºæˆ‘ä»¬ä½¿ç”¨äº†é€’å½’ï¼Œå¹¶è®¾ç½®äº†é€’å½’é€€å‡ºæ¡ä»¶ï¼ˆå½“å‰ä¼ å…¥èŠ‚ç‚¹ä¸ºç©ºæˆ–è€…å½“å‰ä¼ å…¥èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸä¸ºç©ºï¼‰ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ€è·¯ï¼Œå®Œæˆå¯¹é“¾è¡¨çš„åè½¬</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152444803.png" alt="image-20210129152444803"></p><blockquote><p>å®ç°ä»£ç å¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * </span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> head</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">reverse</span><span class="params">(Node head)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(head == <span class="keyword">null</span> || head.next == <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="comment">//å¦‚æœè¿›å…¥è¿™ä¸ªifå—ä¸­ï¼Œè¯æ˜å½“å‰headä¸å…¶ä¹‹åç»“ç‚¹å½¢æˆçš„é“¾è¡¨ä¸éœ€è¦åè½¬</span></span><br><span class="line">        <span class="comment">//ä¾‹å¦‚1-2-3-4ä¸­çš„4ä¸éœ€è¦åè½¬ï¼Œç›´æ¥è¿”å›è¯¥èŠ‚ç‚¹å³å¯</span></span><br><span class="line">        <span class="keyword">return</span> head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//å¦‚æœé“¾è¡¨é•¿åº¦å¤§äºç­‰äº2ï¼Œè¿›è¡Œé€’å½’</span></span><br><span class="line">    Node reverseNode = reverse(head.next);</span><br><span class="line">    <span class="comment">//å°†å½“å‰èŠ‚ç‚¹ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸæŒ‡å‘è‡ªå·±</span></span><br><span class="line">    head.next.next = head;</span><br><span class="line">    <span class="comment">//å°†å½“å‰èŠ‚ç‚¹çš„nextæŒ‡é’ˆåŸŸç½®ç©º</span></span><br><span class="line">    head.next = <span class="keyword">null</span>;</span><br><span class="line">    <span class="keyword">return</span> reverseNode;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>åˆ›å»ºä¸€ä¸ªé“¾è¡¨ï¼š1-2-3-4-5ï¼Œæµ‹è¯•ä»£ç ä¸ç»“æœå¦‚ä¸‹</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">LinkedList linkedList = <span class="keyword">new</span> LinkedList();</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">5</span>; i++) &#123;</span><br><span class="line">    linkedList.addNode(<span class="keyword">new</span> Node(i + <span class="number">1</span>));</span><br><span class="line">&#125;</span><br><span class="line">System.out.println(<span class="string">&quot;åè½¬å‰:&quot;</span>);</span><br><span class="line">linkedList.list();</span><br><span class="line">LinkedList reverseList = <span class="keyword">new</span> LinkedList(reverse(linkedList.head));</span><br><span class="line">System.out.println(<span class="string">&quot;åè½¬å:&quot;</span>);</span><br><span class="line">reverseList.list();</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152457748.png" alt="image-20210129152457748"></p><h2 id="3ã€å°†ä¸¤ä¸ªæœ‰åºå•é“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºå•é“¾è¡¨"><a href="#3ã€å°†ä¸¤ä¸ªæœ‰åºå•é“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºå•é“¾è¡¨" class="headerlink" title="3ã€å°†ä¸¤ä¸ªæœ‰åºå•é“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºå•é“¾è¡¨"></a>3ã€å°†ä¸¤ä¸ªæœ‰åºå•é“¾è¡¨åˆå¹¶ä¸ºä¸€ä¸ªæœ‰åºå•é“¾è¡¨</h2><blockquote><p>å°†Aé“¾è¡¨ï¼š1-2-3-nullä¸Bé“¾è¡¨2-3-6-nullåˆå¹¶ä¸ºä¸€å¼ æœ‰åºé“¾è¡¨ï¼Œè§£é¢˜æ€è·¯å¦‚ä¸‹</p></blockquote><ul><li>æ–°å»ºä¸€ä¸ªé“¾è¡¨tempï¼Œç„¶åä½¿ç”¨æŒ‡é’ˆéå†ABé“¾è¡¨ï¼Œå¯¹æ¯ä¸€æ¬¡éå†å‡ºæ¥çš„èŠ‚ç‚¹çš„dataå€¼è¿›è¡Œæ¯”è¾ƒï¼Œå°†dataå€¼è¾ƒå°çš„èŠ‚ç‚¹ä»åŸé“¾è¡¨ä¸­æ‘˜é™¤ï¼Œç„¶ååŠ åˆ°tempé“¾è¡¨ä¸­ï¼Œç›´åˆ°æœ‰ä¸€æ¡é“¾è¡¨è¢«æ‘˜ç©ºã€‚</li><li>æ­¤æ—¶å¦‚æœAé“¾è¡¨è¢«æ‘˜ç©ºï¼Œé‚£ä¹ˆå°†Bé“¾è¡¨å‰©ä½™çš„èŠ‚ç‚¹æŒ‚åœ¨tempèŠ‚ç‚¹çš„æœ€åé¢ï¼Œç”±äºBé“¾è¡¨å’Œtempé“¾è¡¨æœ¬æ¥å°±æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥å¾—å‡ºçš„ç»“æœä»ç„¶æ˜¯ä¸€ä¸ªæœ‰åºåˆ—è¡¨ï¼Œåä¹‹äº¦ç„¶ã€‚</li></ul><blockquote><p>ä»£ç å®ç°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * åˆå¹¶ä¸¤ä¸ªæœ‰åºé“¾è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> list1 é“¾è¡¨1</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> list2 é“¾è¡¨2</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> LinkedList <span class="title">mergeTwoList</span><span class="params">(LinkedList list1,LinkedList list2)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//åˆ›å»ºä¸€ä¸ª</span></span><br><span class="line">    LinkedList temp = <span class="keyword">new</span> LinkedList(<span class="keyword">new</span> Node(Integer.MIN_VALUE));</span><br><span class="line">    Node cur = temp.head;</span><br><span class="line">    <span class="keyword">while</span>(list1.head != <span class="keyword">null</span> &amp;&amp; list2.head != <span class="keyword">null</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span>(list1.head.data &lt; list2.head.data) &#123;</span><br><span class="line">            cur.next = list1.head;</span><br><span class="line">            list1.head = list1.head.next;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            cur.next = list2.head;</span><br><span class="line">            list2.head = list2.head.next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æ¯ä¸€æ¬¡å¾ªç¯åéƒ½éœ€è¦å°†curåç§»</span></span><br><span class="line">        cur = cur.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//é€€å‡ºå¾ªç¯æ—¶ï¼Œè‡³å°‘æœ‰ä¸€ä¸ªé“¾è¡¨ä¸ºç©º</span></span><br><span class="line">    <span class="comment">//å¦‚æœæ˜¯ç¬¬ä¸€ä¸ªé“¾è¡¨ä¸ºç©ºï¼Œé‚£ä¹ˆå°†cur.nextæŒ‡å‘ç¬¬äºŒä¸ªé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼Œç”±äºç¬¬äºŒä¸ªé“¾è¡¨æœ¬èº«å°±æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥åˆå¹¶åä»ç„¶æœ‰åº</span></span><br><span class="line">    <span class="keyword">if</span>(list1.head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        cur.next = list2.head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(list2.head == <span class="keyword">null</span>) &#123;</span><br><span class="line">        cur.next = list1.head;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//ç”±äºtempçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ä¸ºMIN_VALUEï¼Œä¸ºæ— æ•ˆèŠ‚ç‚¹ï¼Œæ‰€ä»¥è¿”å›ä¸‹ä¸€ä¸ª</span></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">new</span> LinkedList(temp.head.next);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ä»£ç åŠç»“æœ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">LinkedList list1 = <span class="keyword">new</span> LinkedList();</span><br><span class="line">list1.addNode(<span class="keyword">new</span> Node(<span class="number">1</span>));</span><br><span class="line">list1.addNode(<span class="keyword">new</span> Node(<span class="number">2</span>));</span><br><span class="line">list1.addNode(<span class="keyword">new</span> Node(<span class="number">4</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;é“¾è¡¨1ä¸º:&quot;</span>);</span><br><span class="line">list1.list();</span><br><span class="line"></span><br><span class="line">LinkedList list2 = <span class="keyword">new</span> LinkedList();</span><br><span class="line">list2.addNode(<span class="keyword">new</span> Node(<span class="number">1</span>));</span><br><span class="line">list2.addNode(<span class="keyword">new</span> Node(<span class="number">3</span>));</span><br><span class="line">list2.addNode(<span class="keyword">new</span> Node(<span class="number">4</span>));</span><br><span class="line">System.out.println(<span class="string">&quot;é“¾è¡¨2ä¸º:&quot;</span>);</span><br><span class="line">list2.list();</span><br><span class="line"></span><br><span class="line">LinkedList result = mergeTwoList(list1,list2);</span><br><span class="line">System.out.println(<span class="string">&quot;åˆå¹¶ç»“æœä¸º:&quot;</span>);</span><br><span class="line">result.list();</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152513991.png" alt="image-20210129152513991"></p><h2 id="4ã€è¿”å›é“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹"><a href="#4ã€è¿”å›é“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹" class="headerlink" title="4ã€è¿”å›é“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹"></a>4ã€è¿”å›é“¾è¡¨ä¸­å€’æ•°ç¬¬Kä¸ªç»“ç‚¹</h2><blockquote><p>è¿”å›é“¾è¡¨å€’æ•°ç¬¬Kä¸ªç»“ç‚¹ï¼Œç»“é¢˜æ€è·¯å¦‚ä¸‹</p></blockquote><ul><li>åˆ›å»ºä¸¤ä¸ªæŒ‡é’ˆbeforeå’Œafterï¼Œå¹¶å°†å…¶æŒ‡å‘é“¾è¡¨å¤´èŠ‚ç‚¹head</li><li>å…ˆè®©afterç»“ç‚¹å‰è¿›kæ­¥ï¼Œå¦‚æœåœ¨æ­¤è¿‡ç¨‹ä¸­afterç»“ç‚¹å·²ç»èµ°å‡ºé“¾è¡¨çš„èŒƒå›´ï¼ˆå³ç§»åŠ¨è¿‡ç¨‹ä¸­afterå·²ä¸ºç©ºï¼‰ï¼Œé‚£ä¹ˆè¯æ˜è¾“å…¥çš„kä¸åˆæ³•ï¼Œæ­¤æ—¶è¿”å›nullã€‚</li><li>å®Œæˆä¸Šä¸€æ­¥çš„æ“ä½œåï¼Œè¿›è¡Œå¾ªç¯å¹¶ä½¿beforeå’ŒafteråŒæ—¶è¿›è¡Œç§»åŠ¨ï¼Œç›´åˆ°afterä¸ºç©ºæ—¶é€€å‡ºå¾ªç¯ï¼Œæ­¤æ—¶beforeæŒ‡å‘çš„å…ƒç´ å³ä¸ºé“¾è¡¨çš„å€’æ•°ç¬¬kä¸ªç»“ç‚¹ã€‚</li></ul><blockquote><p>ä»£ç å®ç°</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/***</span></span><br><span class="line"><span class="comment"> * è·å–é“¾è¡¨çš„å€’æ•°ç¬¬kä¸ªç»“ç‚¹</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> list é“¾è¡¨</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@param</span> k</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">static</span> Node <span class="title">getKthFromEnd</span><span class="params">(LinkedList list,<span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(list.head == <span class="keyword">null</span> || list == <span class="keyword">null</span> || k &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    Node before = list.head;</span><br><span class="line">    Node after = list.head;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>;i &lt; k;i++) &#123;</span><br><span class="line">        <span class="keyword">if</span>(after == <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        after = after.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span>(after != <span class="keyword">null</span>) &#123;</span><br><span class="line">        before = before.next;</span><br><span class="line">        after = after.next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> before;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><blockquote><p>æµ‹è¯•ä»£ç ä»¥åŠç»“æœï¼Œè¿™é‡Œçš„é“¾è¡¨ä½¿ç”¨ä¸Šé¢åˆå¹¶é“¾è¡¨çš„ç»“æœ</p></blockquote><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">LinkedList result = mergeTwoList(list1,list2);</span><br><span class="line">System.out.println(<span class="string">&quot;åˆå¹¶ç»“æœä¸º:&quot;</span>);</span><br><span class="line">result.list();</span><br><span class="line"></span><br><span class="line">System.out.println(<span class="string">&quot;å€’æ•°ç¬¬3ä¸ªç»“ç‚¹å€¼ä¸º:&quot;</span> + getKthFromEnd(result,<span class="number">2</span>));</span><br></pre></td></tr></table></figure><ul><li>ç»“æœ</li></ul><p><img src= "/img/loading.gif" data-lazy-src="https://gitee.com/sutianxin/my-hexo-blog-photo/raw/master/image-20210129152527059.png" alt="image-20210129152527059"></p>]]></content>
      
      
      <categories>
          
          <category> æ•°æ®ç»“æ„ä¸ç®—æ³• </category>
          
      </categories>
      
      
        <tags>
            
            <tag> â˜•Java </tag>
            
            <tag> ğŸ’»åç«¯å­¦ä¹  </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
